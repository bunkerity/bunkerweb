
<!doctype html>
<html lang="es" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation of BunkerWeb, the open source and next generation WAF.">
      
      
      
        <link rel="canonical" href="https://docs.bunkerweb.io/latest/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.20">
    
    
      
        <title>Print Site - Documentación de BunkerWeb</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.e53b48f4.min.css">
      
      


    
    
    <script async
            defer
            data-domain="docs.bunkerweb.io"
            src="https://data.bunkerity.com/js/script.js"></script>

    <script defer>
      window.addEventListener('DOMContentLoaded', (e) => {

        const customHeaders = document.querySelectorAll('[data-custom-header]')
        customHeaders.forEach(header => {
          const getHeaders = document.querySelectorAll(`#${header.getAttribute('id')}`);
          getHeaders.forEach(el => {

            if(!el.hasAttribute('data-custom-header')) el.remove()
        })})
      })
    </script>

    <script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script>

    <script defer>
  // Lazy load images and embed youtube videos
  window.addEventListener("load", () => {
    document.querySelectorAll("[data-src]").forEach((el) => {
      el.setAttribute("src", el.getAttribute("data-src"));
    });
  });
  // Add missing label
  try {
    document
      .querySelector('div.md-search[data-md-component="search"][role="dialog"]')
      .setAttribute("aria-label", "Search in documentation");
  } catch (err) {}
    </script>

    <script defer>
      window.addEventListener('DOMContentLoaded', () => {
        const bannerEl = document.querySelector('aside.md-banner');
        let defaultContent = [{ "content" : '<p>Get the most of BunkerWeb by upgrading to the PRO version. Click <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&utm_source=doc">here</a> and use the <strong>freetrial</strong> promo code to get started.</p>'},
        { "content" : '<p>Need premium support or tailored consulting around BunkerWeb ? Check out our <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc#services">professional services</a>.</p>'},
        { "content" : '<p>Be part of the Bunker community by joining the <a style="text-decoration:underline; color: white;" href="https://discord.bunkerweb.io">Discord chat</a> and following us on <a style="text-decoration:underline; color: white;" href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>.</p>'}
        ]

      function setBannerStyle() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        bannerEl.style.backgroundColor = "#2eac68";
        bannerItem.style.textAlign = "center";
        bannerItem.style.transition = "all 0.5s ease-out";
      }

      function setDefault() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        const clone = bannerItem.cloneNode(true);
        clone.innerHTML = defaultContent[0]["content"];
        bannerEl.replaceChild(clone, bannerItem);
      }

      function startBannerLoop() {
        const switchDelay = 7000;
        let i = 0;

        setInterval(() => {
          // Update or reset index
          if(i + 1 === defaultContent.length) {
            i = 0;
          } else {
            i++;
          }

          // Prepare data with next el with opacity 0 too
          const currItem = bannerEl.querySelector('.md-banner__inner');
          currItem.style.opacity = 0;
          const clone = currItem.cloneNode(true);
          clone.innerHTML = defaultContent[i]["content"];
          setTimeout(() => {
            bannerEl.replaceChild(clone, currItem);
            setTimeout(() => {
              const newItem = bannerEl.querySelector('.md-banner__inner');
              newItem.style.opacity = 1;
            }, 20);
          }, 600);

        }, switchDelay);
      }

      function runBanner() {
        startBannerLoop();
        // Try to get dynamic content
        // Else keep static ones
        // fetch("https://www.bunkerweb.io/api/bw-ui-news")
        // .then((res) => {
        //   return res.json();
        // })
        // .then((res) => {
        //   defaultContent = res.data[0].data;
        //   startBannerLoop();
        // })
        // .catch((e) => {
        //   startBannerLoop();
        // });
      }

        setBannerStyle();
        setDefault();
        runBanner()

      })
    </script>

    
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/extra.css">
    
    <script>__md_scope=new URL("/latest",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#es" class="md-skip">
          Saltar a contenido
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
    📢 Looking for BunkerWeb PRO version, technical support or tailored services ? Visit the
    <a href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc"
       style="color: #3f6ec6;
              text-decoration: underline">BunkerWeb Panel</a>
    for more information on our enterprise offers.

          </div>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
    You're not viewing the
    documentation of the latest version.
    <a href="..//latest">
        <strong>Click here to view latest.</strong>
    </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("/latest"),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Cabecera">
    <a href="../es/" title="Documentación de BunkerWeb" class="md-header__button md-logo" aria-label="Documentación de BunkerWeb" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentación de BunkerWeb
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="Seleccionar idioma">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../web-ui/" hreflang="en" class="md-select__link">
              English - 🇬🇧
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../fr/web-ui/" hreflang="fr" class="md-select__link">
              Français - 🇫🇷
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../de/web-ui/" hreflang="de" class="md-select__link">
              Deutsch - 🇩🇪
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../es/web-ui/" hreflang="es" class="md-select__link">
              Español - 🇪🇸
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Búsqueda" placeholder="Búsqueda" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Buscar">
        
        <button type="reset" class="md-search__icon md-icon" title="Limpiar" aria-label="Limpiar" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Inicializando búsqueda
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bunkerity/bunkerweb" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Pestañas" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/" class="md-tabs__link">
        
  
  
    
  
  Introducción

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/concepts/" class="md-tabs__link">
        
  
  
    
  
  Conceptos

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/integrations/" class="md-tabs__link">
        
  
  
    
  
  Integraciones

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/quickstart-guide/" class="md-tabs__link">
        
  
  
    
  
  Guía de inicio rápido

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/features/" class="md-tabs__link">
        
  
  
    
  
  Funcionalidades

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/advanced/" class="md-tabs__link">
        
  
  
    
  
  Usos avanzados

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/web-ui/" class="md-tabs__link">
        
  
  
    
  
  Interfaz web

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/api/" class="md-tabs__link">
        
  
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/upgrading/" class="md-tabs__link">
        
  
  
    
  
  Actualización

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/troubleshooting/" class="md-tabs__link">
        
  
  
    
  
  Solución de problemas

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/plugins/" class="md-tabs__link">
        
  
  
    
  
  Plugins

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/professional-services/" class="md-tabs__link">
        
  
  
    
  
  Servicios profesionales

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../es/about/" class="md-tabs__link">
        
  
  
    
  
  Acerca de

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navegación" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../es/" title="Documentación de BunkerWeb" class="md-nav__button md-logo" aria-label="Documentación de BunkerWeb" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    Documentación de BunkerWeb
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bunkerity/bunkerweb" title="Ir al repositorio" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introducción
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Conceptos
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/integrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integraciones
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/quickstart-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guía de inicio rápido
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Funcionalidades
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Usos avanzados
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/web-ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interfaz web
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/upgrading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Actualización
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Solución de problemas
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/professional-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Servicios profesionales
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../es/about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Acerca de
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="es" heading-number="1"><h1 id="es-introduccion">Introducción</h1>
<h2 id="es-descripcion-general">Descripción general</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/intro-overview.svg" width="800" />
  </p>
<figcaption>¡Haz que tus servicios web sean seguros por defecto!</figcaption>
</figure>
<p>BunkerWeb es un Firewall de Aplicaciones Web (WAF) de código abierto y de última generación.</p>
<p>Como un servidor web con todas las funciones (basado en <a href="https://nginx.org/">NGINX</a> internamente), protege tus servicios web para hacerlos "seguros por defecto". BunkerWeb se integra sin problemas en tus entornos existentes (<a href="#es-integrations-linux">Linux</a>, <a href="#es-integrations-docker">Docker</a>, <a href="#es-integrations-swarm">Swarm</a>, <a href="#es-integrations-kubernetes">Kubernetes</a>, …) como un proxy inverso y es totalmente configurable (no te preocupes, hay una <a href="#es-web-ui">impresionante interfaz de usuario web</a> si no te gusta la CLI) para satisfacer tus casos de uso específicos. En otras palabras, la ciberseguridad ya no es una molestia.</p>
<p>BunkerWeb incluye <a href="#es-advanced-security-tuning">características de seguridad</a> principales como parte del núcleo, pero se puede ampliar fácilmente con otras adicionales gracias a un <a href="#es-plugins">sistema de plugins</a>.</p>
<h2 id="es-por-que-bunkerweb">¿Por qué BunkerWeb?</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/oybLtyhWJIo" title="Descripción general de BunkerWeb" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<ul>
<li>
<p><strong>Fácil integración en entornos existentes</strong>: Integra sin problemas BunkerWeb en diversos entornos como Linux, Docker, Swarm, Kubernetes y más. Disfruta de una transición fluida y una implementación sin complicaciones.</p>
</li>
<li>
<p><strong>Altamente personalizable</strong>: Adapta BunkerWeb a tus requisitos específicos con facilidad. Habilita, deshabilita y configura características sin esfuerzo, lo que te permite personalizar la configuración de seguridad según tu caso de uso único.</p>
</li>
<li>
<p><strong>Seguro por defecto</strong>: BunkerWeb proporciona seguridad mínima lista para usar y sin complicaciones para tus servicios web. Experimenta tranquilidad y protección mejorada desde el principio.</p>
</li>
<li>
<p><strong>Impresionante interfaz de usuario web</strong>: Toma el control de BunkerWeb de manera más eficiente con la excepcional interfaz de usuario web (UI). Navega por la configuración y las opciones sin esfuerzo a través de una interfaz gráfica fácil de usar, eliminando la necesidad de la interfaz de línea de comandos (CLI).</p>
</li>
<li>
<p><strong>Sistema de plugins</strong>: Amplía las capacidades de BunkerWeb para satisfacer tus propios casos de uso. Integra sin problemas medidas de seguridad adicionales y personaliza la funcionalidad de BunkerWeb según tus requisitos específicos.</p>
</li>
<li>
<p><strong>Libre como en "libertad"</strong>: BunkerWeb está licenciado bajo la licencia libre <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">AGPLv3</a>, abrazando los principios de libertad y apertura. Disfruta de la libertad de usar, modificar y distribuir el software, respaldado por una comunidad de apoyo.</p>
</li>
<li>
<p><strong>Servicios profesionales</strong>: Obtén soporte técnico, consultoría a medida y desarrollo personalizado directamente de los mantenedores de BunkerWeb. Visita el <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a> para más información.</p>
</li>
</ul>
<h2 id="es-caracteristicas-de-seguridad">Características de seguridad</h2>
<p>Explora la impresionante gama de características de seguridad que ofrece BunkerWeb. Aunque no es exhaustiva, aquí hay algunos puntos destacados:</p>
<ul>
<li>
<p>Soporte <strong>HTTPS</strong> con automatización transparente de <strong>Let's Encrypt</strong>: Asegura fácilmente tus servicios web con la integración automatizada de Let's Encrypt, garantizando la comunicación cifrada entre los clientes y tu servidor.</p>
</li>
<li>
<p><strong>Seguridad web de última generación</strong>: Benefíciate de medidas de seguridad web de vanguardia, incluyendo cabeceras de seguridad HTTP completas, prevención de fugas de datos y técnicas de fortalecimiento de TLS.</p>
</li>
<li>
<p><strong>WAF ModSecurity</strong> integrado con el <strong>OWASP Core Rule Set</strong>: Disfruta de una protección mejorada contra ataques a aplicaciones web con la integración de ModSecurity, fortalecida por el reconocido OWASP Core Rule Set.</p>
</li>
<li>
<p><strong>Baneo automático</strong> de comportamientos extraños basados en códigos de estado HTTP: BunkerWeb identifica y bloquea inteligentemente actividades sospechosas al banear automáticamente los comportamientos que desencadenan códigos de estado HTTP anómalos.</p>
</li>
<li>
<p>Aplica <strong>límites de conexión y de solicitudes</strong> para los clientes: Establece límites en el número de conexiones y solicitudes de los clientes, previniendo el agotamiento de recursos y asegurando un uso justo de los recursos del servidor.</p>
</li>
<li>
<p><strong>Bloquea bots</strong> con <strong>verificación basada en desafíos</strong>: Mantén a raya a los bots maliciosos desafiándolos a resolver acertijos como cookies, pruebas de JavaScript, captchas, hCaptcha, reCAPTCHA o Turnstile, bloqueando eficazmente el acceso no autorizado.</p>
</li>
<li>
<p><strong>Bloquea IPs maliciosas conocidas</strong> con listas negras externas y <strong>DNSBL</strong>: Utiliza listas negras externas y listas negras basadas en DNS (DNSBL) para bloquear proactivamente direcciones IP maliciosas conocidas, reforzando tu defensa contra posibles amenazas.</p>
</li>
<li>
<p><strong>Y mucho más...</strong>: BunkerWeb está repleto de una plétora de características de seguridad adicionales que van más allá de esta lista, brindándote una protección integral y tranquilidad.</p>
</li>
</ul>
<p>Para profundizar en las características de seguridad principales, te invitamos a explorar la sección de <a href="#es-advanced-security-tuning">ajuste de seguridad</a> de la documentación. Descubre cómo BunkerWeb te permite ajustar y optimizar las medidas de seguridad según tus necesidades específicas.</p>
<h2 id="es-demo">Demo</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/ZhYV-QELzA4" title="Engañando a herramientas y escáneres automatizados" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<p>Un sitio web de demostración protegido con BunkerWeb está disponible en <a href="https://demo.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">demo.bunkerweb.io</a>. Siéntete libre de visitarlo y realizar algunas pruebas de seguridad.</p>
<h2 id="es-interfaz-de-usuario-web">Interfaz de usuario web</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/tGS3pzquEjY" title="Interfaz de usuario web de BunkerWeb" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<p>BunkerWeb ofrece una <a href="#es-web-ui">interfaz de usuario</a> opcional para gestionar tus instancias y sus configuraciones. Una demostración en línea de solo lectura está disponible en <a href="https://demo-ui.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">demo-ui.bunkerweb.io</a>. Siéntete libre de probarla tú mismo.</p>
<h2 id="es-bunkerweb-cloud">BunkerWeb Cloud</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/bunkerweb-cloud.webp" width="600" />
  </p>
<figcaption>BunkerWeb Cloud</figcaption>
</figure>
<p>¿No quieres autohospedar y gestionar tu(s) propia(s) instancia(s) de BunkerWeb? Podría interesarte BunkerWeb Cloud, nuestra oferta SaaS totalmente gestionada para BunkerWeb.</p>
<p>Prueba nuestra <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">oferta de BunkerWeb Cloud</a> y obtén acceso a:</p>
<ul>
<li>Una instancia de BunkerWeb totalmente gestionada alojada en nuestra nube</li>
<li>Todas las características de BunkerWeb, incluidas las PRO</li>
<li>Una plataforma de monitorización con paneles y alertas</li>
<li>Soporte técnico para ayudarte con la configuración</li>
</ul>
<p>Si estás interesado en la oferta de BunkerWeb Cloud, no dudes en <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contactarnos</a> para que podamos discutir tus necesidades.</p>
<h2 id="es-version-pro">Versión PRO</h2>
<div class="admonition tip">
<p class="admonition-title">Prueba gratuita de BunkerWeb PRO</p>
<p>¿Quieres probar rápidamente BunkerWeb PRO durante un mes? Usa el código <code>freetrial</code> al realizar tu pedido en el <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a> o haciendo clic <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">aquí</a> para aplicar directamente el código de promoción (se hará efectivo al finalizar la compra).</p>
</div>
<p>Al usar BunkerWeb, tienes la opción de elegir la versión que deseas utilizar: de código abierto o PRO.</p>
<p>Ya sea para una seguridad mejorada, una experiencia de usuario enriquecida o un seguimiento técnico, la versión BunkerWeb PRO te permite beneficiarte plenamente de BunkerWeb y satisfacer tus necesidades profesionales.</p>
<p>En la documentación o en la interfaz de usuario, las características PRO están anotadas con una corona <img src="../es/assets/img/pro-icon.svg" alt="icono de corona pro" height="32px" width="32px"> para distinguirlas de las integradas en la versión de código abierto.</p>
<p>Puedes actualizar de la versión de código abierto a la PRO fácilmente y en cualquier momento. El proceso es sencillo:</p>
<ul>
<li>Reclama tu <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">prueba gratuita en el panel de BunkerWeb</a> usando el código de promoción <code>freetrial</code> al finalizar la compra</li>
<li>Una vez conectado al área de cliente, copia tu clave de licencia PRO</li>
<li>Pega tu clave privada en BunkerWeb usando la <a href="#es-web-ui-upgrade-to-pro">interfaz de usuario web</a> o la <a href="#es-features-pro">configuración específica</a></li>
</ul>
<p>No dudes en visitar el <a href="https://panel.bunkerweb.io/knowledgebase?utm_campaign=self&amp;utm_source=doc">panel de BunkerWeb</a> o <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contactarnos</a> si tienes alguna pregunta sobre la versión PRO.</p>
<h2 id="es-servicios-profesionales">Servicios profesionales</h2>
<p>Aprovecha al máximo BunkerWeb accediendo a servicios profesionales directamente de los mantenedores del proyecto. Desde soporte técnico hasta consultoría y desarrollo a medida, estamos aquí para ayudarte a proteger tus servicios web.</p>
<p>Encontrarás más información visitando el <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a>, nuestra plataforma dedicada a los servicios profesionales.</p>
<p>No dudes en <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contactarnos</a> si tienes alguna pregunta. Estaremos encantados de responder a tus necesidades.</p>
<h2 id="es-ecosistema-comunidad-y-recursos">Ecosistema, comunidad y recursos</h2>
<p>Sitios web, herramientas y recursos oficiales sobre BunkerWeb:</p>
<ul>
<li><a href="https://www.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Sitio web</strong></a>: Obtén más información, noticias y artículos sobre BunkerWeb.</li>
<li><a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Panel</strong></a>: Una plataforma dedicada para solicitar y gestionar servicios profesionales (p. ej., soporte técnico) en torno a BunkerWeb.</li>
<li><a href="https://docs.bunkerweb.io"><strong>Documentación</strong></a>: Documentación técnica de la solución BunkerWeb.</li>
<li><a href="https://demo.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Demo</strong></a>: Sitio web de demostración de BunkerWeb. No dudes en intentar ataques para probar la robustez de la solución.</li>
<li><a href="https://demo-ui.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Interfaz de usuario web</strong></a>: Demostración en línea de solo lectura de la interfaz de usuario web de BunkerWeb.</li>
<li><a href="https://threatmap.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Mapa de amenazas</strong></a>: Ciberataques en vivo bloqueados por instancias de BunkerWeb en todo el mundo.</li>
</ul>
<p>Comunidad y redes sociales:</p>
<ul>
<li><a href="https://discord.com/invite/fTf46FmtyD"><strong>Discord</strong></a></li>
<li><a href="https://www.linkedin.com/company/bunkerity/"><strong>LinkedIn</strong></a></li>
<li><a href="https://x.com/bunkerity"><strong>X (Anteriormente Twitter)</strong></a></li>
<li><a href="https://www.reddit.com/r/BunkerWeb/"><strong>Reddit</strong></a></li>
</ul></section><section class="print-page" id="es-concepts" heading-number="2"><h1 id="es-concepts-conceptos">Conceptos</h1>
<h2 id="es-concepts-arquitectura">Arquitectura</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/concepts.svg" width="600" /></p>
</figure>
<p>Dentro de tu infraestructura, BunkerWeb actúa como un proxy inverso frente a tus servicios web. La arquitectura típica implica acceder a BunkerWeb desde Internet, que luego reenvía las solicitudes al servicio de aplicación apropiado en una red segura.</p>
<p>Usar BunkerWeb de esta manera (arquitectura clásica de proxy inverso) con descarga de TLS y políticas de seguridad centralizadas mejora el rendimiento al reducir la sobrecarga de cifrado en los servidores backend, al tiempo que garantiza un control de acceso consistente, mitigación de amenazas y cumplimiento de normativas en todos los servicios.</p>
<h2 id="es-concepts-integraciones">Integraciones</h2>
<p>El primer concepto es la integración de BunkerWeb en el entorno de destino. Preferimos usar la palabra "integración" en lugar de "instalación" porque uno de los objetivos de BunkerWeb es integrarse sin problemas en los entornos existentes.</p>
<p>Las siguientes integraciones son oficialmente compatibles:</p>
<ul>
<li><a href="#es-integrations-docker">Docker</a></li>
<li><a href="#es-integrations-linux">Linux</a></li>
<li><a href="#es-integrations-docker-autoconf">Docker autoconf</a></li>
<li><a href="#es-integrations-kubernetes">Kubernetes</a></li>
<li><a href="#es-integrations-swarm">Swarm</a></li>
</ul>
<p>Si crees que se debería admitir una nueva integración, no dudes en abrir un <a href="https://github.com/bunkerity/bunkerweb/issues">nuevo issue</a> en el repositorio de GitHub.</p>
<div class="admonition info">
<p class="admonition-title">Para saber más</p>
<p>Los detalles técnicos de todas las integraciones de BunkerWeb están disponibles en la <a href="#es-integrations">sección de integraciones</a> de la documentación.</p>
</div>
<h2 id="es-concepts-configuraciones">Configuraciones</h2>
<div class="admonition tip">
<p class="admonition-title">Configuraciones de BunkerWeb PRO</p>
<p>Algunos plugins están reservados para la <strong>versión PRO</strong>. ¿Quieres probar rápidamente BunkerWeb PRO durante un mes? Usa el código <code>freetrial</code> al realizar tu pedido en el <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">panel de BunkerWeb</a> o haciendo clic <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">aquí</a> para aplicar directamente el código de promoción (se hará efectivo al finalizar la compra).</p>
</div>
<p>Una vez que BunkerWeb esté integrado en tu entorno, necesitarás configurarlo para servir y proteger tus aplicaciones web.</p>
<p>La configuración de BunkerWeb se realiza utilizando lo que llamamos "configuraciones" o "variables". Cada configuración se identifica por un nombre como <code>AUTO_LETS_ENCRYPT</code> o <code>USE_ANTIBOT</code>. Puedes asignar valores a estas configuraciones para configurar BunkerWeb.</p>
<p>Aquí hay un ejemplo ficticio de una configuración de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>SERVER_NAME=www.example.com
AUTO_LETS_ENCRYPT=yes
USE_ANTIBOT=captcha
REFERRER_POLICY=no-referrer
USE_MODSECURITY=no
USE_GZIP=yes
USE_BROTLI=no
</code></pre></div>
<p>Ten en cuenta que si estás utilizando la interfaz de usuario web, los nombres de las configuraciones también se muestran además de una etiqueta "fácil de usar":</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/settings-ui1.png" width="800" />
  </p>
<figcaption>Nombre de la configuración en la interfaz de usuario web</figcaption>
</figure>
<p>También puedes usar la barra de búsqueda y especificar directamente el nombre de una configuración:</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/settings-ui2.png" width="600" />
  </p>
<figcaption>Búsqueda de configuraciones en la interfaz de usuario web</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Para saber más</p>
<p>La lista completa de configuraciones disponibles con descripciones y posibles valores está disponible en la <a href="#es-features">sección de características</a> de la documentación.</p>
</div>
<h2 id="es-concepts-modo-multisitio">Modo multisitio</h2>
<p>Comprender el modo multisitio es esencial al utilizar BunkerWeb. Como nuestro enfoque principal es proteger las aplicaciones web, nuestra solución está intrínsecamente vinculada al concepto de "hosts virtuales" o "vhosts" (más información <a href="https://es.wikipedia.org/wiki/Alojamiento_virtual">aquí</a>). Estos hosts virtuales permiten servir múltiples aplicaciones web desde una única instancia o clúster.</p>
<p>Por defecto, BunkerWeb tiene el modo multisitio deshabilitado. Esto significa que solo se servirá una aplicación web, y todas las configuraciones se aplicarán a ella. Esta configuración es ideal cuando tienes una sola aplicación que proteger, ya que no necesitas preocuparte por las configuraciones multisitio.</p>
<p>Sin embargo, cuando el modo multisitio está habilitado, BunkerWeb se vuelve capaz de servir y proteger múltiples aplicaciones web. Cada aplicación web se identifica por un nombre de servidor único y tiene su propio conjunto de configuraciones. Este modo resulta beneficioso cuando tienes múltiples aplicaciones que asegurar y prefieres utilizar una única instancia (o un clúster) de BunkerWeb.</p>
<p>La activación del modo multisitio se controla mediante la configuración <code>MULTISITE</code>, que se puede establecer en <code>yes</code> para habilitarlo o <code>no</code> para mantenerlo deshabilitado (el valor predeterminado).</p>
<p>Cada configuración dentro de BunkerWeb tiene un contexto específico que determina dónde se puede aplicar. Si el contexto se establece en "global", la configuración no se puede aplicar por servidor o sitio, sino que se aplica a toda la configuración en su conjunto. Por otro lado, si el contexto es "multisitio", la configuración se puede aplicar globalmente y por servidor. Para definir una configuración multisitio para un servidor específico, simplemente agrega el nombre del servidor como prefijo al nombre de la configuración. Por ejemplo, <code>app1.example.com_AUTO_LETS_ENCRYPT</code> o <code>app2.example.com_USE_ANTIBOT</code> son ejemplos de nombres de configuración con prefijos de nombre de servidor. Cuando una configuración multisitio se define globalmente sin un prefijo de servidor, todos los servidores heredan esa configuración. Sin embargo, los servidores individuales aún pueden anular la configuración si la misma configuración se define con un prefijo de nombre de servidor.</p>
<p>Comprender las complejidades del modo multisitio y sus configuraciones asociadas te permite adaptar el comportamiento de BunkerWeb a tus requisitos específicos, garantizando una protección óptima para tus aplicaciones web.</p>
<p>Aquí hay un ejemplo ficticio de una configuración multisitio de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>MULTISITE=yes
SERVER_NAME=app1.example.com app2.example.com app3.example.com
AUTO_LETS_ENCRYPT=yes
USE_GZIP=yes
USE_BROTLI=yes
app1.example.com_USE_ANTIBOT=javascript
app1.example.com_USE_MODSECURITY=no
app2.example.com_USE_ANTIBOT=cookie
app2.example.com_WHITELIST_COUNTRY=FR
app3.example.com_USE_BAD_BEHAVIOR=no
</code></pre></div>
<p>Ten en cuenta que el modo multisitio es implícito cuando se utiliza la interfaz de usuario web. Tienes la opción de aplicar configuraciones directamente a tus servicios o de establecer una configuración global que se aplicará a todos tus servicios (aún puedes aplicar excepciones directamente a servicios específicos):</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/ui-multisite.png" width="600" />
  </p>
<figcaption>Aplicar una configuración a todos los servicios desde la interfaz de usuario web</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Para saber más</p>
<p>Encontrarás ejemplos concretos del modo multisitio en los <a href="#es-advanced">usos avanzados</a> de la documentación y en el directorio de <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/examples">ejemplos</a> del repositorio.</p>
</div>
<h2 id="es-concepts-configuraciones-personalizadas">Configuraciones personalizadas</h2>
<p>Para abordar desafíos únicos y satisfacer casos de uso específicos, BunkerWeb ofrece la flexibilidad de las configuraciones personalizadas. Si bien las configuraciones proporcionadas y los <a href="#es-plugins">plugins externos</a> cubren una amplia gama de escenarios, puede haber situaciones que requieran una personalización adicional.</p>
<p>BunkerWeb está construido sobre el reconocido servidor web NGINX, que proporciona un potente sistema de configuración. Esto significa que puedes aprovechar las capacidades de configuración de NGINX para satisfacer tus necesidades específicas. Las configuraciones personalizadas de NGINX se pueden incluir en varios <a href="https://docs.nginx.com/nginx/admin-guide/basic-functionality/managing-configuration-files/#contexts">contextos</a> como HTTP o servidor, lo que te permite ajustar el comportamiento de BunkerWeb según tus requisitos. Ya sea que necesites personalizar configuraciones globales o aplicar configuraciones a bloques de servidor específicos, BunkerWeb te permite optimizar su comportamiento para alinearse perfectamente con tu caso de uso.</p>
<p>Otro componente integral de BunkerWeb es el Firewall de Aplicaciones Web ModSecurity. Con configuraciones personalizadas, tienes la flexibilidad de abordar falsos positivos o agregar reglas personalizadas para mejorar aún más la protección proporcionada por ModSecurity. Estas configuraciones personalizadas te permiten ajustar el comportamiento del firewall y asegurar que se alinee con los requisitos específicos de tus aplicaciones web.</p>
<p>Al aprovechar las configuraciones personalizadas, desbloqueas un mundo de posibilidades para adaptar el comportamiento y las medidas de seguridad de BunkerWeb precisamente a tus necesidades. Ya sea ajustando las configuraciones de NGINX o afinando ModSecurity, BunkerWeb proporciona la flexibilidad para enfrentar tus desafíos únicos de manera efectiva.</p>
<p>La gestión de configuraciones personalizadas desde la interfaz de usuario web se realiza a través del menú <strong>Configuraciones</strong>:</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/configs-ui.png" width="800" />
  </p>
<figcaption>Gestionar configuraciones personalizadas desde la interfaz de usuario web</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Para saber más</p>
<p>Encontrarás ejemplos concretos de configuraciones personalizadas en los <a href="#es-advanced-custom-configurations">usos avanzados</a> de la documentación y en el directorio de <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/examples">ejemplos</a> del repositorio.</p>
</div>
<h2 id="es-concepts-base-de-datos">Base de datos</h2>
<p>BunkerWeb almacena de forma segura su configuración actual en una base de datos de backend, que contiene datos esenciales para un funcionamiento sin problemas. La siguiente información se almacena en la base de datos:</p>
<ul>
<li>
<p><strong>Configuraciones para todos los servicios</strong>: La base de datos contiene las configuraciones definidas para todos los servicios proporcionados por BunkerWeb. Esto asegura que tus configuraciones y preferencias se conserven y sean fácilmente accesibles.</p>
</li>
<li>
<p><strong>Configuraciones personalizadas</strong>: Cualquier configuración personalizada que crees también se almacena en la base de datos de backend. Esto incluye configuraciones personalizadas y modificaciones adaptadas a tus requisitos específicos.</p>
</li>
<li>
<p><strong>Instancias de BunkerWeb</strong>: La información sobre las instancias de BunkerWeb, incluida su configuración y detalles relevantes, se almacena en la base de datos. Esto permite una fácil gestión y monitoreo de múltiples instancias si corresponde.</p>
</li>
<li>
<p><strong>Metadatos sobre la ejecución de trabajos</strong>: La base de datos almacena metadatos relacionados con la ejecución de varios trabajos dentro de BunkerWeb. Esto incluye información sobre tareas programadas, procesos de mantenimiento y otras actividades automatizadas.</p>
</li>
<li>
<p><strong>Archivos en caché</strong>: BunkerWeb utiliza mecanismos de almacenamiento en caché para mejorar el rendimiento. La base de datos contiene archivos en caché, lo que garantiza una recuperación y entrega eficientes de los recursos a los que se accede con frecuencia.</p>
</li>
</ul>
<p>Bajo el capó, cada vez que editas una configuración o agregas una nueva, BunkerWeb almacena automáticamente los cambios en la base de datos, garantizando la persistencia y coherencia de los datos. BunkerWeb admite múltiples opciones de bases de datos de backend, como SQLite, MariaDB, MySQL y PostgreSQL.</p>
<p>Configurar la base de datos es sencillo utilizando la configuración <code>DATABASE_URI</code>, que sigue los formatos especificados para cada base de datos compatible:</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Cuando se utiliza la Integración de Docker, debes establecer la variable de entorno <code>DATABASE_URI</code> en todos los contenedores de BunkerWeb (excepto el propio contenedor de BunkerWeb), para garantizar que todos los componentes puedan acceder a la base de datos correctamente. Esto es crucial para mantener la integridad y la funcionalidad del sistema.</p>
<p>En todos los casos, asegúrate de que <code>DATABASE_URI</code> esté configurado antes de iniciar BunkerWeb, ya que es necesario para un funcionamiento correcto.</p>
</div>
<ul>
<li><strong>SQLite</strong>: <code>sqlite:///var/lib/bunkerweb/db.sqlite3</code></li>
<li><strong>MariaDB</strong>: <code>mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db</code></li>
<li><strong>MySQL</strong>: <code>mysql+pymysql://bunkerweb:changeme@bw-db:3306/db</code></li>
<li><strong>PostgreSQL</strong>: <code>postgresql://bunkerweb:changeme@bw-db:5432/db</code></li>
</ul>
<p>Al especificar el URI de la base de datos apropiado en la configuración, puedes integrar BunkerWeb sin problemas con tu backend de base de datos preferido, garantizando un almacenamiento eficiente y confiable de tus datos de configuración.</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/bunkerweb_db.svg" width="800" />
  </p>
<figcaption>Esquema de la base de datos</figcaption>
</figure>
<h2 id="es-concepts-programador">Programador</h2>
<p>Para una coordinación y automatización fluidas, BunkerWeb emplea un servicio especializado conocido como el programador. El programador desempeña un papel vital para garantizar un funcionamiento sin problemas al realizar las siguientes tareas:</p>
<ul>
<li>
<p><strong>Almacenar configuraciones y configuraciones personalizadas</strong>: El programador es responsable de almacenar todas las configuraciones y configuraciones personalizadas dentro de la base de datos de backend. Esto centraliza los datos de configuración, haciéndolos fácilmente accesibles y manejables.</p>
</li>
<li>
<p><strong>Ejecutar diversas tareas (trabajos)</strong>: El programador se encarga de la ejecución de diversas tareas, conocidas como trabajos. Estos trabajos abarcan una gama de actividades, como el mantenimiento periódico, las actualizaciones programadas o cualquier otra tarea automatizada requerida por BunkerWeb.</p>
</li>
<li>
<p><strong>Generar la configuración de BunkerWeb</strong>: El programador genera una configuración que es fácilmente comprensible por BunkerWeb. Esta configuración se deriva de las configuraciones almacenadas y las configuraciones personalizadas, asegurando que todo el sistema funcione de manera cohesiva.</p>
</li>
<li>
<p><strong>Actuar como intermediario para otros servicios</strong>: El programador actúa como intermediario, facilitando la comunicación y coordinación entre los diferentes componentes de BunkerWeb. Interactúa con servicios como la interfaz de usuario web o la autoconfiguración, asegurando un flujo de información y un intercambio de datos fluidos.</p>
</li>
</ul>
<p>En esencia, el programador sirve como el cerebro de BunkerWeb, orquestando diversas operaciones y asegurando el buen funcionamiento del sistema.</p>
<p>Dependiendo del enfoque de integración, el entorno de ejecución del programador puede diferir. En las integraciones basadas en contenedores, el programador se ejecuta dentro de su contenedor dedicado, proporcionando aislamiento y flexibilidad. Por otro lado, para las integraciones basadas en Linux, el programador está autocontenido dentro del servicio bunkerweb, simplificando el proceso de implementación y gestión.</p>
<p>Al emplear el programador, BunkerWeb agiliza la automatización y coordinación de tareas esenciales, permitiendo un funcionamiento eficiente y confiable de todo el sistema.</p>
<p>Si estás utilizando la interfaz de usuario web, puedes gestionar los trabajos del programador haciendo clic en <strong>Trabajos</strong> en el menú:</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/jobs-ui.png" width="800" />
  </p>
<figcaption>Gestionar trabajos desde la interfaz de usuario web</figcaption>
</figure>
<h3 id="es-concepts-comprobacion-del-estado-de-las-instancias">Comprobación del estado de las instancias</h3>
<p>Desde la versión 1.6.0, el programador posee un sistema de comprobación de estado incorporado que monitorea la salud de las instancias. Si una instancia deja de estar saludable, el programador dejará de enviarle la configuración. Si la instancia vuelve a estar saludable, el programador reanudará el envío de la configuración.</p>
<p>El intervalo de comprobación de estado se establece mediante la variable de entorno <code>HEALTHCHECK_INTERVAL</code>, con un valor predeterminado de <code>30</code>, lo que significa que el programador comprobará la salud de las instancias cada 30 segundos.</p>
<h2 id="es-concepts-plantillas">Plantillas</h2>
<p>BunkerWeb aprovecha el poder de las plantillas para simplificar el proceso de configuración y mejorar la flexibilidad. Las plantillas proporcionan un enfoque estructurado y estandarizado para definir configuraciones y configuraciones personalizadas, garantizando la coherencia y la facilidad de uso.</p>
<ul>
<li>
<p><strong>Plantillas predefinidas</strong>: La versión comunitaria ofrece tres plantillas predefinidas que encapsulan configuraciones personalizadas y configuraciones comunes. Estas plantillas sirven como punto de partida para configurar BunkerWeb, permitiendo una configuración y despliegue rápidos. Las plantillas predefinidas son las siguientes:</p>
<ul>
<li><strong>low</strong>: Una plantilla básica que proporciona configuraciones esenciales para la protección de aplicaciones web.</li>
<li><strong>medium</strong>: Una plantilla equilibrada que ofrece una mezcla de características de seguridad y optimizaciones de rendimiento.</li>
<li><strong>high</strong>: Una plantilla avanzada que se centra en medidas de seguridad robustas y protección integral.</li>
</ul>
</li>
<li>
<p><strong>Plantillas personalizadas</strong>: Además de las plantillas predefinidas, BunkerWeb permite a los usuarios crear plantillas personalizadas adaptadas a sus requisitos específicos. Las plantillas personalizadas permiten un ajuste fino de las configuraciones y configuraciones personalizadas, asegurando que BunkerWeb se alinee perfectamente con las necesidades del usuario.</p>
</li>
</ul>
<p>Con la interfaz de usuario web, las plantillas están disponibles a través del <strong>modo fácil</strong> cuando agregas o editas un servicio:</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/templates-ui.png" width="800" />
  </p>
<figcaption>Uso de plantillas desde la interfaz de usuario web</figcaption>
</figure>
<p><strong>Creación de plantillas personalizadas</strong></p>
<p>Crear una plantilla personalizada es un proceso sencillo que implica definir las configuraciones deseadas, las configuraciones personalizadas y los pasos en un formato estructurado.</p>
<ul>
<li><strong>Estructura de la plantilla</strong>: Una plantilla personalizada consta de un nombre, una serie de configuraciones, configuraciones personalizadas y pasos opcionales. La estructura de la plantilla se define en un archivo JSON que cumple con el formato especificado. Los componentes clave de una plantilla personalizada incluyen:<ul>
<li><strong>Configuraciones</strong>: Una configuración se define con un nombre y un valor correspondiente. Este valor anulará el valor predeterminado de la configuración. <strong>Solo se admiten configuraciones multisitio.</strong></li>
<li><strong>Configuraciones personalizadas</strong>: Una configuración personalizada es una ruta a un archivo de configuración de NGINX que se incluirá como una configuración personalizada. Para saber dónde colocar el archivo de configuración personalizada, consulta el ejemplo del árbol de un plugin a continuación. <strong>Solo se admiten tipos de configuración multisitio.</strong></li>
<li><strong>Pasos</strong>: Un paso contiene un título, un subtítulo, configuraciones y configuraciones personalizadas. Cada paso representa un paso de configuración que el usuario puede seguir para configurar BunkerWeb de acuerdo con la plantilla personalizada en la interfaz de usuario web.</li>
</ul>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Especificaciones sobre los pasos</p>
<p>Si se declaran pasos, <strong>no es obligatorio incluir todas las configuraciones y configuraciones personalizadas en las secciones de configuraciones y configuraciones personalizadas</strong>. Ten en cuenta que cuando una configuración o una configuración personalizada se declara en un paso, al usuario se le permitirá realizar ediciones en la interfaz de usuario web.</p>
</div>
<ul>
<li>
<p><strong>Archivo de plantilla</strong>: La plantilla personalizada se define en un archivo JSON en una carpeta <code>templates</code> dentro del directorio del plugin que se adhiere a la estructura especificada. El archivo de plantilla contiene un nombre, las configuraciones, las configuraciones personalizadas y los pasos necesarios para configurar BunkerWeb de acuerdo con las preferencias del usuario.</p>
</li>
<li>
<p><strong>Selección de una plantilla</strong>: Una vez definida la plantilla personalizada, los usuarios pueden seleccionarla durante el proceso de configuración en modo fácil de un servicio en la interfaz de usuario web. También se puede seleccionar una plantilla con la configuración <code>USE_TEMPLATE</code> en la configuración. El nombre del archivo de la plantilla (sin la extensión <code>.json</code>) debe especificarse como el valor de la configuración <code>USE_TEMPLATE</code>.</p>
</li>
</ul>
<p>Ejemplo de un archivo de plantilla personalizada:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;nombre de la plantilla&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// opcional</span>
<span class="w">    </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;SETTING_1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;valor&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;SETTING_2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;valor&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="c1">// opcional</span>
<span class="w">    </span><span class="nt">&quot;configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;modsec/false_positives.conf&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;modsec/non_editable.conf&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;modsec-crs/custom_rules.conf&quot;</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="c1">// opcional</span>
<span class="w">    </span><span class="nt">&quot;steps&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Título 1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;subtitle&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subtítulo 1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;SETTING_1&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;modsec-crs/custom_rules.conf&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Título 2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;subtitle&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subtítulo 2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;SETTING_2&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;modsec/false_positives.conf&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Ejemplo de un árbol de un plugin que incluye plantillas personalizadas:
<div class="highlight"><pre><span></span><code>.
├── plugin.json
└── templates
    ├── my_other_template.json
    ├── my_template
    │   └── configs
    │       ├── modsec
    │       │   ├── false_positives.conf
    │       │   └── non_editable.conf
    │       └── modsec-crs
    │           └── custom_rules.conf
    └── my_template.json
</code></pre></div></p></section><section class="print-page" id="es-integrations" heading-number="3"><h1 id="es-integrations-integraciones">Integraciones</h1>
<h2 id="es-integrations-bunkerweb-cloud">BunkerWeb Cloud</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/bunkerweb-cloud.webp" width="600" />
  </p>
<figcaption>BunkerWeb Cloud</figcaption>
</figure>
<p>BunkerWeb Cloud será la forma más fácil de empezar con BunkerWeb. Te ofrece un servicio de BunkerWeb totalmente gestionado sin complicaciones. ¡Piénsalo como un BunkerWeb-como-un-Servicio!</p>
<p>Prueba nuestra <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">oferta de BunkerWeb Cloud</a> y obtén acceso a:</p>
<ul>
<li>Una instancia de BunkerWeb totalmente gestionada alojada en nuestra nube</li>
<li>Todas las características de BunkerWeb, incluidas las PRO</li>
<li>Una plataforma de monitorización con paneles y alertas</li>
<li>Soporte técnico para ayudarte con la configuración</li>
</ul>
<p>Si estás interesado en la oferta de BunkerWeb Cloud, no dudes en <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contactarnos</a> para que podamos discutir tus necesidades.</p>
<h2 id="es-integrations-imagen-todo-en-uno-aio">Imagen Todo en Uno (AIO)</h2>
<figure>
<p><img align="center," alt="Marcador de posición del gráfico de arquitectura AIO" src="../assets/img/aio-graph-placeholder.png" width="600" />
  </p>
<figcaption>Arquitectura Todo en Uno de BunkerWeb (AIO)</figcaption>
</figure>
<h3 id="es-integrations-despliegue">Despliegue</h3>
<p>Para desplegar el contenedor todo en uno, todo lo que tienes que hacer es ejecutar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Por defecto, el contenedor expone:</p>
<ul>
<li>8080/tcp para HTTP</li>
<li>8443/tcp para HTTPS</li>
<li>8443/udp para QUIC</li>
<li>7000/tcp para el acceso a la interfaz de usuario web sin BunkerWeb delante (no recomendado para producción)</li>
<li>8888/tcp para la API cuando <code>SERVICE_API=yes</code> (uso interno; prefiere exponerla a través de BunkerWeb como un proxy inverso en lugar de publicarla directamente)</li>
</ul>
<p>La imagen Todo en Uno viene con varios servicios integrados, que se pueden controlar mediante variables de entorno:</p>
<ul>
<li><code>SERVICE_UI=yes</code> (predeterminado) - Habilita el servicio de la interfaz de usuario web</li>
<li><code>SERVICE_SCHEDULER=yes</code> (predeterminado) - Habilita el servicio del Programador</li>
<li><code>SERVICE_API=no</code> (predeterminado) - Habilita el servicio de la API (plano de control de FastAPI)</li>
<li><code>AUTOCONF_MODE=no</code> (predeterminado) - Habilita el servicio de autoconfiguración</li>
<li><code>USE_REDIS=yes</code> (predeterminado) - Habilita la instancia de <a href="#es-integrations-integracion-con-redis">Redis</a> integrada</li>
<li><code>USE_CROWDSEC=no</code> (predeterminado) - La integración con <a href="#es-integrations-integracion-con-crowdsec">CrowdSec</a> está deshabilitada por defecto</li>
</ul>
<h3 id="es-integrations-integracion-de-la-api">Integración de la API</h3>
<p>La imagen Todo en Uno incorpora la API de BunkerWeb. Está deshabilitada por defecto y se puede habilitar estableciendo <code>SERVICE_API=yes</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Seguridad</p>
<p>La API es un plano de control privilegiado. No la expongas directamente a Internet. Mantenla en una red interna, restringe las IP de origen con <code>API_WHITELIST_IPS</code>, requiere autenticación (<code>API_TOKEN</code> o usuarios de API + Biscuit), y preferiblemente accede a ella a través de BunkerWeb como un proxy inverso en una ruta difícil de adivinar.</p>
</div>
<p>Habilitación rápida (independiente) — publica el puerto de la API; solo para pruebas:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">SERVICE_API</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">API_WHITELIST_IPS</span><span class="o">=</span><span class="s2">&quot;127.0.0.0/8&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">API_TOKEN</span><span class="o">=</span><span class="s2">&quot;changeme&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">8888</span>:8888/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Recomendado (detrás de BunkerWeb) — no publiques el <code>8888</code>; en su lugar, haz un proxy inverso:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api-&lt;unguessable&gt;&quot;</span>
<span class="w">      </span><span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bunkerweb-aio:8888&quot;</span>

<span class="w">  </span><span class="nt">bunkerweb-aio</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-all-in-one:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SERVICE_API</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="c1"># Opcionalmente, establece un token de anulación de administrador</span>
<span class="w">      </span><span class="c1"># API_TOKEN: &quot;changeme&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
</code></pre></div>
<p>Los detalles sobre la autenticación, los permisos (ACL), la limitación de velocidad, TLS y las opciones de configuración están disponibles en la <a href="#es-api">documentación de la API</a>.</p>
<h3 id="es-integrations-accediendo-al-asistente-de-configuracion">Accediendo al asistente de configuración</h3>
<p>Por defecto, el asistente de configuración se inicia automáticamente cuando ejecutas el contenedor AIO por primera vez. Para acceder a él, sigue estos pasos:</p>
<ol>
<li><strong>Inicia el contenedor AIO</strong> como se indicó <a href="#es-integrations-despliegue">anteriormente</a>, asegurándote de que <code>SERVICE_UI=yes</code> (predeterminado).</li>
<li><strong>Accede a la UI</strong> a través de tu punto de acceso principal de BunkerWeb, p. ej., <code>https://tu-dominio</code>.</li>
</ol>
<blockquote>
<p>Sigue los siguientes pasos en la <a href="#es-quickstart-guide-complete-the-setup-wizard">Guía de inicio rápido</a> para configurar la Interfaz de Usuario Web.</p>
</blockquote>
<h3 id="es-integrations-integracion-con-redis">Integración con Redis</h3>
<p>La imagen <strong>Todo en Uno</strong> de BunkerWeb incluye Redis listo para usar para la <a href="#es-advanced-persistence-of-bans-and-reports">persistencia de baneos e informes</a>. Para gestionar Redis:</p>
<ul>
<li>Para deshabilitar Redis, establece <code>USE_REDIS=no</code> o apunta <code>REDIS_HOST</code> a un host externo.</li>
<li>Los registros de Redis aparecen con el prefijo <code>[REDIS]</code> en los registros de Docker y en <code>/var/log/bunkerweb/redis.log</code>.</li>
</ul>
<h3 id="es-integrations-integracion-con-crowdsec">Integración con CrowdSec</h3>
<p>La imagen Docker <strong>Todo en Uno</strong> de BunkerWeb viene con CrowdSec totalmente integrado, sin necesidad de contenedores adicionales ni configuración manual. Sigue los pasos a continuación para habilitar, configurar y ampliar CrowdSec en tu despliegue.</p>
<p>Por defecto, CrowdSec está <strong>deshabilitado</strong>. Para activarlo, simplemente añade la variable de entorno <code>USE_CROWDSEC</code>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<ul>
<li>
<p>Cuando <code>USE_CROWDSEC=yes</code>, el punto de entrada hará lo siguiente:</p>
<ol>
<li><strong>Registrará</strong> e <strong>iniciará</strong> el agente local de CrowdSec (a través de <code>cscli</code>).</li>
<li><strong>Instalará o actualizará</strong> las colecciones y analizadores predeterminados.</li>
<li><strong>Configurará</strong> el bouncer <code>crowdsec-bunkerweb-bouncer/v1.6</code>.</li>
</ol>
</li>
</ul>
<hr />
<h4 id="es-integrations-colecciones-y-analizadores-predeterminados">Colecciones y Analizadores Predeterminados</h4>
<p>En el primer inicio (o después de una actualización), estos activos se instalan y mantienen actualizados automáticamente:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Tipo</th>
<th style="text-align: left;">Nombre</th>
<th style="text-align: left;">Propósito</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><strong>Colección</strong></td>
<td style="text-align: left;"><code>crowdsecurity/nginx</code></td>
<td style="text-align: left;">Defiende los servidores Nginx contra una amplia gama de ataques basados en HTTP, desde fuerza bruta hasta intentos de inyección.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Colección</strong></td>
<td style="text-align: left;"><code>crowdsecurity/appsec-virtual-patching</code></td>
<td style="text-align: left;">Ofrece un conjunto de reglas de estilo WAF actualizado dinámicamente que apunta a CVEs conocidos, parcheado automáticamente a diario para proteger las aplicaciones web de vulnerabilidades recién descubiertas.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Colección</strong></td>
<td style="text-align: left;"><code>crowdsecurity/appsec-generic-rules</code></td>
<td style="text-align: left;">Complementa <code>crowdsecurity/appsec-virtual-patching</code> con heurísticas para patrones de ataque genéricos a nivel de aplicación, como enumeración, recorrido de rutas y sondeos automatizados, llenando los vacíos donde las reglas específicas de CVE aún no existen.</td>
</tr>
<tr>
<td style="text-align: left;"><strong>Analizador</strong></td>
<td style="text-align: left;"><code>crowdsecurity/geoip-enrich</code></td>
<td style="text-align: left;">Enriquece los eventos con contexto de GeoIP.</td>
</tr>
</tbody>
</table>
<details>
<summary><strong>Cómo funciona internamente</strong></summary>

El script de punto de entrada invoca:

<div class="highlight"><pre><span></span><code>cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/nginx
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-virtual-patching
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-generic-rules
cscli<span class="w"> </span>install<span class="w"> </span>parser<span class="w">     </span>crowdsecurity/geoip-enrich
</code></pre></div>

</details>

<hr />
<h4 id="es-integrations-anadir-colecciones-adicionales">Añadir Colecciones Adicionales</h4>
<p>¿Necesitas más cobertura? Define <code>CROWDSEC_EXTRA_COLLECTIONS</code> con una lista de colecciones del Hub separadas por espacios:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_EXTRA_COLLECTIONS</span><span class="o">=</span><span class="s2">&quot;crowdsecurity/apache2 crowdsecurity/mysql&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Cómo funciona internamente</p>
<p>El script recorre cada nombre e instala o actualiza según sea necesario, sin necesidad de pasos manuales.</p>
</div>
<hr />
<h4 id="es-integrations-deshabilitar-analizadores-especificos">Deshabilitar Analizadores Específicos</h4>
<p>Si quieres mantener la configuración predeterminada pero deshabilitar explícitamente uno o más analizadores, proporciona una lista separada por espacios a través de <code>CROWDSEC_DISABLED_PARSERS</code>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_DISABLED_PARSERS</span><span class="o">=</span><span class="s2">&quot;crowdsecurity/geoip-enrich foo/bar-parser&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Notas:
- La lista se aplica después de que se instalen/actualicen los elementos requeridos; solo se eliminan los analizadores que listas.
- Usa los slugs del hub como se muestra en <code>cscli parsers list</code> (p. ej., <code>crowdsecurity/geoip-enrich</code>).</p>
<hr />
<h4 id="es-integrations-conmutador-de-appsec">Conmutador de AppSec</h4>
<p>Las características de <a href="https://docs.crowdsec.net/docs/appsec/intro/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">AppSec</a> de CrowdSec —impulsadas por las colecciones <code>appsec-virtual-patching</code> y <code>appsec-generic-rules</code>— están <strong>habilitadas por defecto</strong>.</p>
<p>Para <strong>deshabilitar</strong> toda la funcionalidad de AppSec (WAF/parches virtuales), establece:</p>
<div class="highlight"><pre><span></span><code>-e<span class="w"> </span><span class="nv">CROWDSEC_APPSEC_URL</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</code></pre></div>
<p>Esto desactiva efectivamente el punto final de AppSec para que no se apliquen reglas.</p>
<hr />
<h4 id="es-integrations-api-externa-de-crowdsec">API Externa de CrowdSec</h4>
<p>Si operas una instancia remota de CrowdSec, apunta el contenedor a tu API:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_API</span><span class="o">=</span><span class="s2">&quot;https://crowdsec.example.com:8000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing<span class="sb">```</span>

*<span class="w">   </span>El<span class="w"> </span>**registro<span class="w"> </span>local**<span class="w"> </span>se<span class="w"> </span>omite<span class="w"> </span>cuando<span class="w"> </span><span class="sb">`</span>CROWDSEC_API<span class="sb">`</span><span class="w"> </span>no<span class="w"> </span>es<span class="w"> </span><span class="sb">`</span><span class="m">127</span>.0.0.1<span class="sb">`</span><span class="w"> </span>o<span class="w"> </span><span class="sb">`</span>localhost<span class="sb">`</span>.
*<span class="w">   </span>**AppSec**<span class="w"> </span>se<span class="w"> </span>deshabilita<span class="w"> </span>por<span class="w"> </span>defecto<span class="w"> </span>cuando<span class="w"> </span>se<span class="w"> </span>usa<span class="w"> </span>una<span class="w"> </span>API<span class="w"> </span>externa.<span class="w"> </span>Para<span class="w"> </span>habilitarlo,<span class="w"> </span>establece<span class="w"> </span><span class="sb">`</span>CROWDSEC_APPSEC_URL<span class="sb">`</span><span class="w"> </span>en<span class="w"> </span>tu<span class="w"> </span>punto<span class="w"> </span>final<span class="w"> </span>deseado.
*<span class="w">   </span>El<span class="w"> </span>registro<span class="w"> </span>del<span class="w"> </span>bouncer<span class="w"> </span>todavía<span class="w"> </span>se<span class="w"> </span>realiza<span class="w"> </span>contra<span class="w"> </span>la<span class="w"> </span>API<span class="w"> </span>remota.
*<span class="w">   </span>Para<span class="w"> </span>reutilizar<span class="w"> </span>una<span class="w"> </span>clave<span class="w"> </span>de<span class="w"> </span>bouncer<span class="w"> </span>existente,<span class="w"> </span>proporciona<span class="w"> </span><span class="sb">`</span>CROWDSEC_API_KEY<span class="sb">`</span><span class="w"> </span>con<span class="w"> </span>tu<span class="w"> </span>token<span class="w"> </span>pregenerado.

---

!!!<span class="w"> </span>tip<span class="w"> </span><span class="s2">&quot;Más opciones&quot;</span>
<span class="w">    </span>Para<span class="w"> </span>una<span class="w"> </span>cobertura<span class="w"> </span>completa<span class="w"> </span>de<span class="w"> </span>todas<span class="w"> </span>las<span class="w"> </span>opciones<span class="w"> </span>de<span class="w"> </span>CrowdSec<span class="w"> </span><span class="o">(</span>escenarios<span class="w"> </span>personalizados,<span class="w"> </span>registros,<span class="w"> </span>solución<span class="w"> </span>de<span class="w"> </span>problemas<span class="w"> </span>y<span class="w"> </span>más<span class="o">)</span>,<span class="w"> </span>consulta<span class="w"> </span>la<span class="w"> </span><span class="o">[</span>documentación<span class="w"> </span>del<span class="w"> </span>plugin<span class="w"> </span>de<span class="w"> </span>BunkerWeb<span class="w"> </span>CrowdSec<span class="o">](</span>features.md#crowdsec<span class="o">)</span><span class="w"> </span>o<span class="w"> </span>visita<span class="w"> </span>el<span class="w"> </span><span class="o">[</span>sitio<span class="w"> </span>web<span class="w"> </span>oficial<span class="w"> </span>de<span class="w"> </span>CrowdSec<span class="o">](</span>https://www.crowdsec.net/?utm_source<span class="o">=</span>external-docs<span class="p">&amp;</span><span class="nv">utm_medium</span><span class="o">=</span>cta<span class="p">&amp;</span><span class="nv">utm_campaign</span><span class="o">=</span>bunker-web-docs<span class="o">)</span>.

<span class="c1">## Docker</span>

&lt;figure<span class="w"> </span>markdown&gt;
<span class="w">  </span>!<span class="o">[</span>Descripción<span class="w"> </span>general<span class="o">](</span>assets/img/integration-docker.svg<span class="o">){</span><span class="w"> </span><span class="nv">align</span><span class="o">=</span>center,<span class="w"> </span><span class="nv">width</span><span class="o">=</span><span class="s2">&quot;600&quot;</span><span class="w"> </span><span class="o">}</span>
<span class="w">  </span>&lt;figcaption&gt;Integración<span class="w"> </span>con<span class="w"> </span>Docker&lt;/figcaption&gt;
&lt;/figure&gt;

Usar<span class="w"> </span>BunkerWeb<span class="w"> </span>como<span class="w"> </span>un<span class="w"> </span>contenedor<span class="w"> </span>de<span class="w"> </span><span class="o">[</span>Docker<span class="o">](</span>https://www.docker.com/<span class="o">)</span><span class="w"> </span>ofrece<span class="w"> </span>un<span class="w"> </span>enfoque<span class="w"> </span>conveniente<span class="w"> </span>y<span class="w"> </span>sencillo<span class="w"> </span>para<span class="w"> </span>probar<span class="w"> </span>y<span class="w"> </span>utilizar<span class="w"> </span>la<span class="w"> </span>solución,<span class="w"> </span>especialmente<span class="w"> </span>si<span class="w"> </span>ya<span class="w"> </span>estás<span class="w"> </span>familiarizado<span class="w"> </span>con<span class="w"> </span>la<span class="w"> </span>tecnología<span class="w"> </span>Docker.

Para<span class="w"> </span>facilitar<span class="w"> </span>tu<span class="w"> </span>despliegue<span class="w"> </span>en<span class="w"> </span>Docker,<span class="w"> </span>proporcionamos<span class="w"> </span>imágenes<span class="w"> </span>preconstruidas<span class="w"> </span>listas<span class="w"> </span>para<span class="w"> </span>usar<span class="w"> </span>en<span class="w"> </span><span class="o">[</span>Docker<span class="w"> </span>Hub<span class="o">](</span>https://hub.docker.com/r/bunkerity/bunkerweb<span class="o">)</span>,<span class="w"> </span>compatibles<span class="w"> </span>con<span class="w"> </span>múltiples<span class="w"> </span>arquitecturas.<span class="w"> </span>Estas<span class="w"> </span>imágenes<span class="w"> </span>preconstruidas<span class="w"> </span>están<span class="w"> </span>optimizadas<span class="w"> </span>y<span class="w"> </span>preparadas<span class="w"> </span>para<span class="w"> </span>su<span class="w"> </span>uso<span class="w"> </span>en<span class="w"> </span>las<span class="w"> </span>siguientes<span class="w"> </span>arquitecturas:

-<span class="w"> </span>x64<span class="w"> </span><span class="o">(</span><span class="m">64</span><span class="w"> </span>bits<span class="o">)</span>
-<span class="w"> </span>x86
-<span class="w"> </span>armv8<span class="w"> </span><span class="o">(</span>ARM<span class="w"> </span><span class="m">64</span><span class="w"> </span>bits<span class="o">)</span>
-<span class="w"> </span>armv7<span class="w"> </span><span class="o">(</span>ARM<span class="w"> </span><span class="m">32</span><span class="w"> </span>bits<span class="o">)</span>

Al<span class="w"> </span>acceder<span class="w"> </span>a<span class="w"> </span>estas<span class="w"> </span>imágenes<span class="w"> </span>preconstruidas<span class="w"> </span>desde<span class="w"> </span>Docker<span class="w"> </span>Hub,<span class="w"> </span>puedes<span class="w"> </span>obtener<span class="w"> </span>y<span class="w"> </span>ejecutar<span class="w"> </span>rápidamente<span class="w"> </span>BunkerWeb<span class="w"> </span>dentro<span class="w"> </span>de<span class="w"> </span>tu<span class="w"> </span>entorno<span class="w"> </span>Docker,<span class="w"> </span>eliminando<span class="w"> </span>la<span class="w"> </span>necesidad<span class="w"> </span>de<span class="w"> </span>extensos<span class="w"> </span>procesos<span class="w"> </span>de<span class="w"> </span>configuración.<span class="w"> </span>Este<span class="w"> </span>enfoque<span class="w"> </span>simplificado<span class="w"> </span>te<span class="w"> </span>permite<span class="w"> </span>concentrarte<span class="w"> </span>en<span class="w"> </span>aprovechar<span class="w"> </span>las<span class="w"> </span>capacidades<span class="w"> </span>de<span class="w"> </span>BunkerWeb<span class="w"> </span>sin<span class="w"> </span>complejidades<span class="w"> </span>innecesarias.

Ya<span class="w"> </span>sea<span class="w"> </span>que<span class="w"> </span>estés<span class="w"> </span>realizando<span class="w"> </span>pruebas,<span class="w"> </span>desarrollando<span class="w"> </span>aplicaciones<span class="w"> </span>o<span class="w"> </span>desplegando<span class="w"> </span>BunkerWeb<span class="w"> </span>en<span class="w"> </span>producción,<span class="w"> </span>la<span class="w"> </span>opción<span class="w"> </span>de<span class="w"> </span>contenedorización<span class="w"> </span>de<span class="w"> </span>Docker<span class="w"> </span>proporciona<span class="w"> </span>flexibilidad<span class="w"> </span>y<span class="w"> </span>facilidad<span class="w"> </span>de<span class="w"> </span>uso.<span class="w"> </span>Adoptar<span class="w"> </span>este<span class="w"> </span>método<span class="w"> </span>te<span class="w"> </span>permite<span class="w"> </span>aprovechar<span class="w"> </span>al<span class="w"> </span>máximo<span class="w"> </span>las<span class="w"> </span>características<span class="w"> </span>de<span class="w"> </span>BunkerWeb<span class="w"> </span>mientras<span class="w"> </span>te<span class="w"> </span>beneficias<span class="w"> </span>de<span class="w"> </span>las<span class="w"> </span>ventajas<span class="w"> </span>de<span class="w"> </span>la<span class="w"> </span>tecnología<span class="w"> </span>Docker.

<span class="sb">```</span>shell
docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb:testing
</code></pre></div>
<p>Las imágenes de Docker también están disponibles en <a href="https://github.com/orgs/bunkerity/packages?repo_name=bunkerweb">GitHub packages</a> y se pueden descargar usando la dirección del repositorio <code>ghcr.io</code>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/bunkerity/bunkerweb:testing
</code></pre></div>
<p>Los conceptos clave para la integración con Docker incluyen:</p>
<ul>
<li><strong>Variables de entorno</strong>: Configura BunkerWeb fácilmente usando variables de entorno. Estas variables te permiten personalizar varios aspectos del comportamiento de BunkerWeb, como la configuración de red, las opciones de seguridad y otros parámetros.</li>
<li><strong>Contenedor del programador</strong>: Gestiona la configuración y ejecuta trabajos usando un contenedor dedicado llamado el <a href="#es-concepts-scheduler">programador</a>.</li>
<li><strong>Redes</strong>: Las redes de Docker desempeñan un papel vital en la integración de BunkerWeb. Estas redes tienen dos propósitos principales: exponer puertos a los clientes y conectarse a los servicios web ascendentes. Al exponer los puertos, BunkerWeb puede aceptar solicitudes entrantes de los clientes, permitiéndoles acceder a los servicios web protegidos. Además, al conectarse a los servicios web ascendentes, BunkerWeb puede enrutar y gestionar el tráfico de manera eficiente, proporcionando una mayor seguridad y rendimiento.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Ten en cuenta que nuestras instrucciones asumen que estás utilizando SQLite como el backend de base de datos predeterminado, según lo configurado por el ajuste <code>DATABASE_URI</code>. Sin embargo, también se admiten otros backends de bases de datos. Consulta los archivos docker-compose en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio para obtener más información.</p>
</div>
<h3 id="es-integrations-variables-de-entorno">Variables de entorno</h3>
<p>Las configuraciones se pasan al Programador usando las variables de entorno de Docker:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MY_SETTING=value</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ANOTHER_SETTING=another value</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Esto se usa para persistir la caché y otros datos como las copias de seguridad</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Lista completa</p>
<p>Para la lista completa de variables de entorno, consulta la <a href="#es-features">sección de configuraciones</a> de la documentación.</p>
</div>
<h3 id="es-integrations-usando-secretos-de-docker">Usando secretos de Docker</h3>
<p>En lugar de pasar configuraciones sensibles a través de variables de entorno, puedes almacenarlas como secretos de Docker. Para cada configuración que quieras asegurar, crea un secreto de Docker con el nombre que coincida con la clave de la configuración (en mayúsculas). Los scripts de punto de entrada de BunkerWeb cargan automáticamente los secretos desde <code>/run/secrets</code> y los exportan como variables de entorno.</p>
<p>Ejemplo:
<div class="highlight"><pre><span></span><code><span class="c1"># Crear un secreto de Docker para ADMIN_PASSWORD</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;S3cr3tP@ssw0rd&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>ADMIN_PASSWORD<span class="w"> </span>-<span class="sb">```</span>

Monta<span class="w"> </span>los<span class="w"> </span>secretos<span class="w"> </span>al<span class="w"> </span>desplegar:
<span class="sb">```</span>yaml
services:
<span class="w">  </span>bw-ui:
<span class="w">    </span>secrets:
<span class="w">      </span>-<span class="w"> </span>ADMIN_PASSWORD
...
secrets:
<span class="w">  </span>ADMIN_PASSWORD:
<span class="w">    </span>external:<span class="w"> </span><span class="nb">true</span><span class="sb">```</span>

Esto<span class="w"> </span>asegura<span class="w"> </span>que<span class="w"> </span>las<span class="w"> </span>configuraciones<span class="w"> </span>sensibles<span class="w"> </span>se<span class="w"> </span>mantengan<span class="w"> </span>fuera<span class="w"> </span>del<span class="w"> </span>entorno<span class="w"> </span>y<span class="w"> </span>de<span class="w"> </span>los<span class="w"> </span>registros.

<span class="c1">### Programador</span>

El<span class="w"> </span><span class="o">[</span>programador<span class="o">](</span>concepts.md#scheduler<span class="o">)</span><span class="w"> </span>se<span class="w"> </span>ejecuta<span class="w"> </span>en<span class="w"> </span>su<span class="w"> </span>propio<span class="w"> </span>contenedor,<span class="w"> </span>que<span class="w"> </span>también<span class="w"> </span>está<span class="w"> </span>disponible<span class="w"> </span>en<span class="w"> </span>Docker<span class="w"> </span>Hub:

<span class="sb">```</span>shell
docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-scheduler:testing<span class="sb">```</span>

!!!<span class="w"> </span>info<span class="w"> </span><span class="s2">&quot;Configuraciones de BunkerWeb&quot;</span>

<span class="w">    </span>Desde<span class="w"> </span>la<span class="w"> </span>versión<span class="w"> </span><span class="sb">`</span><span class="m">1</span>.6.0<span class="sb">`</span>,<span class="w"> </span>el<span class="w"> </span>contenedor<span class="w"> </span>del<span class="w"> </span>Programador<span class="w"> </span>es<span class="w"> </span>donde<span class="w"> </span>defines<span class="w"> </span>las<span class="w"> </span>configuraciones<span class="w"> </span>para<span class="w"> </span>BunkerWeb.<span class="w"> </span>El<span class="w"> </span>Programador<span class="w"> </span>luego<span class="w"> </span>envía<span class="w"> </span>la<span class="w"> </span>configuración<span class="w"> </span>al<span class="w"> </span>contenedor<span class="w"> </span>de<span class="w"> </span>BunkerWeb.

<span class="w">    </span>⚠<span class="w"> </span>**Importante**:<span class="w"> </span>Todas<span class="w"> </span>las<span class="w"> </span>configuraciones<span class="w"> </span>relacionadas<span class="w"> </span>con<span class="w"> </span>la<span class="w"> </span>API<span class="w"> </span><span class="o">(</span>como<span class="w"> </span><span class="sb">`</span>API_HTTP_PORT<span class="sb">`</span>,<span class="w"> </span><span class="sb">`</span>API_LISTEN_IP<span class="sb">`</span>,<span class="w"> </span><span class="sb">`</span>API_SERVER_NAME<span class="sb">`</span>,<span class="w"> </span><span class="sb">`</span>API_WHITELIST_IP<span class="sb">`</span>,<span class="w"> </span>y<span class="w"> </span><span class="sb">`</span>API_TOKEN<span class="sb">`</span><span class="w"> </span>si<span class="w"> </span>lo<span class="w"> </span>usas<span class="o">)</span><span class="w"> </span>**también<span class="w"> </span>deben<span class="w"> </span>definirse<span class="w"> </span>en<span class="w"> </span>el<span class="w"> </span>contenedor<span class="w"> </span>de<span class="w"> </span>BunkerWeb**.<span class="w"> </span>Las<span class="w"> </span>configuraciones<span class="w"> </span>deben<span class="w"> </span>ser<span class="w"> </span>idénticas<span class="w"> </span>en<span class="w"> </span>ambos<span class="w"> </span>contenedores<span class="p">;</span><span class="w"> </span>de<span class="w"> </span>lo<span class="w"> </span>contrario,<span class="w"> </span>el<span class="w"> </span>contenedor<span class="w"> </span>de<span class="w"> </span>BunkerWeb<span class="w"> </span>no<span class="w"> </span>aceptará<span class="w"> </span>las<span class="w"> </span>solicitudes<span class="w"> </span>de<span class="w"> </span>la<span class="w"> </span>API<span class="w"> </span>del<span class="w"> </span>Programador.

<span class="w">    </span><span class="sb">```</span>yaml
<span class="w">    </span>x-bw-api-env:<span class="w"> </span><span class="p">&amp;</span>bw-api-env
<span class="w">      </span><span class="c1"># Usamos un ancla para evitar repetir las mismas configuraciones en ambos contenedores</span>
<span class="w">      </span>API_HTTP_PORT:<span class="w"> </span><span class="s2">&quot;5000&quot;</span><span class="w"> </span><span class="c1"># Valor predeterminado</span>
<span class="w">      </span>API_LISTEN_IP:<span class="w"> </span><span class="s2">&quot;0.0.0.0&quot;</span><span class="w"> </span><span class="c1"># Valor predeterminado</span>
<span class="w">      </span>API_SERVER_NAME:<span class="w"> </span><span class="s2">&quot;bwapi&quot;</span><span class="w"> </span><span class="c1"># Valor predeterminado</span>
<span class="w">      </span>API_WHITELIST_IP:<span class="w"> </span><span class="s2">&quot;127.0.0.0/24 10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Configura esto según tu red</span>
<span class="w">      </span><span class="c1"># Token opcional; si se establece, el Programador envía Authorization: Bearer &lt;token&gt;</span>
<span class="w">      </span>API_TOKEN:<span class="w"> </span><span class="s2">&quot;&quot;</span>

<span class="w">    </span>services:
<span class="w">      </span>bunkerweb:
<span class="w">        </span>image:<span class="w"> </span>bunkerity/bunkerweb:testing
<span class="w">        </span>environment:
<span class="w">          </span><span class="c1"># Esto establecerá las configuraciones de la API para el contenedor de BunkerWeb</span>
<span class="w">          </span>&lt;&lt;:<span class="w"> </span>*bw-api-env
<span class="w">        </span>restart:<span class="w"> </span><span class="s2">&quot;unless-stopped&quot;</span>
<span class="w">        </span>networks:
<span class="w">          </span>-<span class="w"> </span>bw-universe

<span class="w">      </span>bw-scheduler:
<span class="w">        </span>image:<span class="w"> </span>bunkerity/bunkerweb-scheduler:testing
<span class="w">        </span>environment:
<span class="w">          </span><span class="c1"># Esto establecerá las configuraciones de la API para el contenedor del Programador</span>
<span class="w">          </span>&lt;&lt;:<span class="w"> </span>*bw-api-env
<span class="w">        </span>volumes:
<span class="w">          </span>-<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="c1"># Esto se usa para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">        </span>restart:<span class="w"> </span><span class="s2">&quot;unless-stopped&quot;</span>
<span class="w">        </span>networks:
<span class="w">          </span>-<span class="w"> </span>bw-universe
<span class="w">    </span>...
<span class="w">    </span><span class="sb">```</span>

Se<span class="w"> </span>necesita<span class="w"> </span>un<span class="w"> </span>volumen<span class="w"> </span>para<span class="w"> </span>almacenar<span class="w"> </span>la<span class="w"> </span>base<span class="w"> </span>de<span class="w"> </span>datos<span class="w"> </span>SQLite<span class="w"> </span>y<span class="w"> </span>las<span class="w"> </span>copias<span class="w"> </span>de<span class="w"> </span>seguridad<span class="w"> </span>utilizadas<span class="w"> </span>por<span class="w"> </span>el<span class="w"> </span>programador:

<span class="sb">```</span>yaml
...
services:
<span class="w">  </span>bw-scheduler:
<span class="w">    </span>image:<span class="w"> </span>bunkerity/bunkerweb-scheduler:testing
<span class="w">    </span>volumes:
<span class="w">      </span>-<span class="w"> </span>bw-storage:/data
...
volumes:
<span class="w">  </span>bw-storage:
</code></pre></div></p>
<div class="admonition warning">
<p class="admonition-title">Usar una carpeta local para datos persistentes</p>
<p>El programador se ejecuta como un <strong>usuario sin privilegios con UID 101 y GID 101</strong> dentro del contenedor. Esto mejora la seguridad: en caso de que se explote una vulnerabilidad, el atacante no tendrá privilegios completos de root (UID/GID 0).</p>
<p>Sin embargo, si usas una <strong>carpeta local para datos persistentes</strong>, debes <strong>establecer los permisos correctos</strong> para que el usuario sin privilegios pueda escribir datos en ella. Por ejemplo:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Alternativamente, si la carpeta ya existe:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Si estás utilizando <a href="https://docs.docker.com/engine/security/rootless">Docker en modo sin raíz</a> o <a href="https://podman.io/">Podman</a>, los UID y GID en el contenedor se mapearán a diferentes en el host. Primero necesitarás verificar tu subuid y subgid iniciales:</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>Por ejemplo, si tienes un valor de <strong>100000</strong>, el UID/GID mapeado será <strong>100100</strong> (100000 + 100):</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>O si la carpeta ya existe:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
</div>
<h3 id="es-integrations-redes">Redes</h3>
<p>Por defecto, el contenedor de BunkerWeb escucha (dentro del contenedor) en <strong>8080/tcp</strong> para <strong>HTTP</strong>, <strong>8443/tcp</strong> para <strong>HTTPS</strong>, y <strong>8443/udp</strong> para <strong>QUIC</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Puertos privilegiados en modo sin raíz o al usar Podman</p>
<p>Si estás usando <a href="https://docs.docker.com/engine/security/rootless">Docker en modo sin raíz</a> y quieres redirigir puertos privilegiados (&lt; 1024) como el 80 y 443 a BunkerWeb, por favor consulta los prerrequisitos <a href="https://docs.docker.com/engine/security/rootless/#exposing-privileged-ports">aquí</a>.</p>
<p>Si estás usando <a href="https://podman.io/">Podman</a>, puedes reducir el número mínimo para puertos no privilegiados:
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>sysctl<span class="w"> </span>net.ipv4.ip_unprivileged_port_start<span class="o">=</span><span class="m">1</span>
</code></pre></div></p>
</div>
<p>La pila típica de BunkerWeb cuando se usa la integración con Docker contiene los siguientes contenedores:</p>
<ul>
<li>BunkerWeb</li>
<li>Programador</li>
<li>Tus servicios</li>
</ul>
<p>Para fines de defensa en profundidad, recomendamos encarecidamente crear al menos tres redes Docker diferentes:</p>
<ul>
<li><code>bw-services</code>: para BunkerWeb y tus servicios web</li>
<li><code>bw-universe</code>: para BunkerWeb y el programador</li>
<li><code>bw-db</code>: para la base de datos (si estás usando una)</li>
</ul>
<p>Para asegurar la comunicación entre el programador y la API de BunkerWeb, <strong>autoriza las llamadas a la API</strong>. Usa la configuración <code>API_WHITELIST_IP</code> para especificar las direcciones IP y subredes permitidas. Para una protección más fuerte, establece <code>API_TOKEN</code> en ambos contenedores; el programador incluirá automáticamente <code>Authorization: Bearer &lt;token&gt;</code>.</p>
<p><strong>Se recomienda encarecidamente usar una subred estática para la red <code>bw-universe</code></strong> para mejorar la seguridad. Al implementar estas medidas, puedes asegurar que solo las fuentes autorizadas puedan acceder a la API de BunkerWeb, reduciendo el riesgo de acceso no autorizado o actividades maliciosas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir las mismas configuraciones en ambos contenedores</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># Token de API opcional</span>
<span class="w">  </span><span class="c1"># Token de API opcional para acceso autenticado a la API</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Esta configuración es obligatoria para especificar la instancia de BunkerWeb</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Subred estática para que solo las fuentes autorizadas puedan acceder a la API de BunkerWeb</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="es-integrations-archivo-compose-completo">Archivo compose completo</h3>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir las mismas configuraciones para ambos contenedores</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Esta configuración es obligatoria para especificar la instancia de BunkerWeb</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Subred estática para que solo las fuentes autorizadas puedan acceder a la API de BunkerWeb</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="es-integrations-compilar-desde-el-codigo-fuente">Compilar desde el código fuente</h3>
<p>Alternativamente, si prefieres un enfoque más práctico, tienes la opción de compilar la imagen de Docker directamente desde el <a href="https://github.com/bunkerity/bunkerweb">código fuente</a>. Compilar la imagen desde el código fuente te da un mayor control y personalización sobre el proceso de despliegue. Sin embargo, ten en cuenta que este método puede tardar un tiempo en completarse, dependiendo de la configuración de tu hardware (puedes tomarte un café ☕ si es necesario).</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw<span class="w"> </span>-f<span class="w"> </span>src/bw/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-scheduler<span class="w"> </span>-f<span class="w"> </span>src/scheduler/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-autoconf<span class="w"> </span>-f<span class="w"> </span>src/autoconf/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<h2 id="es-integrations-linux">Linux</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/integration-linux.svg" width="600" />
  </p>
<figcaption>Integración con Linux</figcaption>
</figure>
<p>Las distribuciones de Linux compatibles con BunkerWeb (arquitecturas amd64/x86_64 y arm64/aarch64) incluyen:</p>
<ul>
<li>Debian 12 "Bookworm"</li>
<li>Debian 13 "Trixie"</li>
<li>Ubuntu 22.04 "Jammy"</li>
<li>Ubuntu 24.04 "Noble"</li>
<li>Fedora 41 y 42</li>
<li>Red Hat Enterprise Linux (RHEL) 8, 9 y 10</li>
</ul>
<h3 id="es-integrations-script-de-instalacion-facil">Script de instalación fácil</h3>
<p>Para una experiencia de instalación simplificada, BunkerWeb proporciona un script de instalación fácil que maneja automáticamente todo el proceso de configuración, incluida la instalación de NGINX, la configuración del repositorio y la configuración del servicio.</p>
<h4 id="es-integrations-inicio-rapido">Inicio rápido</h4>
<p>Para empezar, descarga el script de instalación y su suma de verificación, luego verifica la integridad del script antes de ejecutarlo.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Descargar el script y su suma de verificación</span>
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/vtesting/install-bunkerweb.sh
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/vtesting/install-bunkerweb.sh.sha256

<span class="c1"># Verificar la suma de verificación</span>
sha256sum<span class="w"> </span>-c<span class="w"> </span>install-bunkerweb.sh.sha256

<span class="c1"># Si la verificación es exitosa, ejecuta el script</span>
chmod<span class="w"> </span>+x<span class="w"> </span>install-bunkerweb.sh
sudo<span class="w"> </span>./install-bunkerweb.sh
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Aviso de seguridad</p>
<p><strong>Siempre verifica la integridad del script de instalación antes de ejecutarlo.</strong></p>
<p>Descarga el archivo de suma de verificación y utiliza una herramienta como <code>sha256sum</code> para confirmar que el script no ha sido alterado o manipulado.</p>
<p>Si la verificación de la suma de verificación falla, <strong>no ejecutes el script</strong>—puede que no sea seguro.</p>
</div>
<h4 id="es-integrations-como-funciona">Cómo funciona</h4>
<p>El script de instalación fácil es una herramienta poderosa diseñada para simplificar la configuración de BunkerWeb en un sistema Linux nuevo. Automatiza los siguientes pasos clave:</p>
<ol>
<li><strong>Análisis del sistema</strong>: Detecta tu sistema operativo y lo verifica contra la lista de distribuciones compatibles.</li>
<li><strong>Personalización de la instalación</strong>: En modo interactivo, te pide que elijas un tipo de instalación (Todo en uno, Gestor, Trabajador, etc.) y decidas si habilitar el asistente de configuración basado en la web.</li>
<li><strong>Integraciones opcionales</strong>: Ofrece instalar y configurar automáticamente el <a href="#es-integrations-integracion-de-crowdsec-con-el-script">Motor de Seguridad CrowdSec</a>.</li>
<li><strong>Gestión de dependencias</strong>: Instala la versión correcta de NGINX requerida por BunkerWeb desde fuentes oficiales y bloquea la versión para evitar actualizaciones no deseadas.</li>
<li><strong>Instalación de BunkerWeb</strong>: Añade el repositorio de paquetes de BunkerWeb, instala los paquetes necesarios y bloquea la versión.</li>
<li><strong>Configuración del servicio</strong>: Configura y habilita los servicios <code>systemd</code> correspondientes a tu tipo de instalación elegido.</li>
<li><strong>Guía post-instalación</strong>: Proporciona los siguientes pasos claros para ayudarte a empezar con tu nueva instancia de BunkerWeb.</li>
</ol>
<h4 id="es-integrations-instalacion-interactiva">Instalación interactiva</h4>
<p>Cuando se ejecuta sin ninguna opción, el script entra en un modo interactivo que te guía a través del proceso de configuración. Se te pedirá que tomes las siguientes decisiones:</p>
<ol>
<li><strong>Tipo de instalación</strong>: Selecciona los componentes que quieres instalar.<ul>
<li><strong>Pila completa (predeterminado)</strong>: Una instalación todo en uno que incluye BunkerWeb, el Programador y la Interfaz de Usuario Web.</li>
<li><strong>Gestor</strong>: Instala el Programador y la Interfaz de Usuario Web, destinado a gestionar uno o más trabajadores remotos de BunkerWeb.</li>
<li><strong>Trabajador</strong>: Instala solo la instancia de BunkerWeb, que puede ser gestionada por un Gestor remoto.</li>
<li><strong>Solo Programador</strong>: Instala solo el componente del Programador.</li>
<li><strong>Solo Interfaz de Usuario Web</strong>: Instala solo el componente de la Interfaz de Usuario Web.</li>
</ul>
</li>
<li><strong>Asistente de configuración</strong>: Elige si habilitar el asistente de configuración basado en la web. Esto es muy recomendable para los usuarios primerizos.</li>
<li><strong>Integración con CrowdSec</strong>: Opta por instalar el motor de seguridad CrowdSec para una protección avanzada contra amenazas en tiempo real.</li>
<li><strong>CrowdSec AppSec</strong>: Si eliges instalar CrowdSec, también puedes habilitar el componente de Seguridad de Aplicaciones (AppSec), que añade capacidades de WAF.</li>
<li><strong>Servicio de API</strong>: Elige si habilitar el servicio opcional de la API de BunkerWeb. Está deshabilitado por defecto en las instalaciones de Linux.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Instalaciones de Gestor y Programador</p>
<p>Si eliges el tipo de instalación <strong>Gestor</strong> o <strong>Solo Programador</strong>, también se te pedirá que proporciones las direcciones IP o los nombres de host de tus instancias de trabajador de BunkerWeb.</p>
</div>
<h4 id="es-integrations-opciones-de-linea-de-comandos">Opciones de línea de comandos</h4>
<p>Para configuraciones no interactivas o automatizadas, el script se puede controlar con indicadores de línea de comandos:</p>
<p><strong>Opciones generales:</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Opción</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>-v, --version VERSION</code></td>
<td style="text-align: left;">Especifica la versión de BunkerWeb a instalar (p. ej., <code>testing</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><code>-w, --enable-wizard</code></td>
<td style="text-align: left;">Habilita el asistente de configuración.</td>
</tr>
<tr>
<td style="text-align: left;"><code>-n, --no-wizard</code></td>
<td style="text-align: left;">Deshabilita el asistente de configuración.</td>
</tr>
<tr>
<td style="text-align: left;"><code>-y, --yes</code></td>
<td style="text-align: left;">Se ejecuta en modo no interactivo usando las respuestas predeterminadas para todas las preguntas.</td>
</tr>
<tr>
<td style="text-align: left;"><code>-f, --force</code></td>
<td style="text-align: left;">Fuerza a que la instalación continúe incluso en una versión de SO no compatible.</td>
</tr>
<tr>
<td style="text-align: left;"><code>-q, --quiet</code></td>
<td style="text-align: left;">Instalación silenciosa (suprime la salida).</td>
</tr>
<tr>
<td style="text-align: left;"><code>--api</code>, <code>--enable-api</code></td>
<td style="text-align: left;">Habilita el servicio systemd de la API (FastAPI) (deshabilitado por defecto).</td>
</tr>
<tr>
<td style="text-align: left;"><code>--no-api</code></td>
<td style="text-align: left;">Deshabilita explícitamente el servicio de la API.</td>
</tr>
<tr>
<td style="text-align: left;"><code>-h, --help</code></td>
<td style="text-align: left;">Muestra el mensaje de ayuda con todas las opciones disponibles.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--dry-run</code></td>
<td style="text-align: left;">Muestra lo que se instalaría sin hacerlo.</td>
</tr>
</tbody>
</table>
<p><strong>Tipos de instalación:</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Opción</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>--full</code></td>
<td style="text-align: left;">Instalación de pila completa (BunkerWeb, Programador, UI). Este es el predeterminado.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--manager</code></td>
<td style="text-align: left;">Instala el Programador y la UI para gestionar trabajadores remotos.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--worker</code></td>
<td style="text-align: left;">Instala solo la instancia de BunkerWeb.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--scheduler-only</code></td>
<td style="text-align: left;">Instala solo el componente del Programador.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--ui-only</code></td>
<td style="text-align: left;">Instala solo el componente de la Interfaz de Usuario Web.</td>
</tr>
</tbody>
</table>
<p><strong>Integraciones de seguridad:</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Opción</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>--crowdsec</code></td>
<td style="text-align: left;">Instala y configura el motor de seguridad CrowdSec.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--no-crowdsec</code></td>
<td style="text-align: left;">Omite la instalación de CrowdSec.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--crowdsec-appsec</code></td>
<td style="text-align: left;">Instala CrowdSec con el componente AppSec (incluye capacidades de WAF).</td>
</tr>
</tbody>
</table>
<p><strong>Opciones avanzadas:</strong></p>
<table>
<thead>
<tr>
<th style="text-align: left;">Opción</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>--instances "IP1 IP2"</code></td>
<td style="text-align: left;">Lista de instancias de BunkerWeb separadas por espacios (requerido para los modos manager/scheduler).</td>
</tr>
</tbody>
</table>
<p><strong>Ejemplo de uso:</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Ejecutar en modo interactivo (recomendado para la mayoría de los usuarios)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh

<span class="c1"># Instalación no interactiva con valores predeterminados (pila completa, asistente habilitado)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--yes

<span class="c1"># Instalar un nodo Trabajador sin el asistente de configuración</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--worker<span class="w"> </span>--no-wizard

<span class="c1"># Instalar una versión específica</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--version<span class="w"> </span>testing

<span class="c1"># Configuración del Gestor con instancias de trabajador remotas (se requieren instancias)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--manager<span class="w"> </span>--instances<span class="w"> </span><span class="s2">&quot;192.168.1.10 192.168.1.11&quot;</span>

<span class="c1"># Instalación completa con CrowdSec y AppSec</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--crowdsec-appsec

<span class="c1"># Instalación silenciosa no interactiva</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--quiet<span class="w"> </span>--yes

<span class="c1"># Vista previa de la instalación sin ejecutarla</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--dry-run

<span class="c1"># Habilitar la API durante la instalación fácil (no interactiva)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--yes<span class="w"> </span>--api

<span class="c1"># Error: CrowdSec no se puede usar con instalaciones de trabajador</span>
<span class="c1"># sudo ./install-bunkerweb.sh --worker --crowdsec  # Esto fallará</span>

<span class="c1"># Error: Se requieren instancias para el gestor en modo no interactivo</span>
<span class="c1"># sudo ./install-bunkerweb.sh --manager --yes  # Esto fallará sin --instances</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Notas importantes sobre la compatibilidad de las opciones</p>
<p><strong>Limitaciones de CrowdSec:</strong>
- Las opciones de CrowdSec (<code>--crowdsec</code>, <code>--crowdsec-appsec</code>) solo son compatibles con los tipos de instalación <code>--full</code> (predeterminado) y <code>--manager</code>
- No se pueden usar con instalaciones <code>--worker</code>, <code>--scheduler-only</code> o <code>--ui-only</code></p>
<p><strong>Requisitos de las instancias:</strong>
- La opción <code>--instances</code> solo es válida con los tipos de instalación <code>--manager</code> y <code>--scheduler-only</code>
- Cuando se usan <code>--manager</code> o <code>--scheduler-only</code> con <code>--yes</code> (modo no interactivo), la opción <code>--instances</code> es obligatoria
- Formato: <code>--instances "192.168.1.10 192.168.1.11 192.168.1.12"</code></p>
<p><strong>Interactivo vs No interactivo:</strong>
- El modo interactivo (predeterminado) pedirá los valores requeridos que falten
- El modo no interactivo (<code>--yes</code>) requiere que todas las opciones necesarias se proporcionen a través de la línea de comandos</p>
</div>
<h4 id="es-integrations-integracion-de-crowdsec-con-el-script">Integración de CrowdSec con el script</h4>
<p>Si optas por instalar CrowdSec durante la configuración interactiva, el script automatiza completamente su integración con BunkerWeb:</p>
<ul>
<li>Añade el repositorio oficial de CrowdSec e instala el agente.</li>
<li>Crea un nuevo archivo de adquisición para que CrowdSec analice los registros de BunkerWeb (<code>access.log</code>, <code>error.log</code> y <code>modsec_audit.log</code>).</li>
<li>Instala colecciones esenciales (<code>crowdsecurity/nginx</code>) y analizadores (<code>crowdsecurity/geoip-enrich</code>).</li>
<li>Registra un bouncer para BunkerWeb y configura automáticamente la clave de la API en <code>/etc/bunkerweb/variables.env</code>.</li>
<li>Si también seleccionas el <strong>Componente AppSec</strong>, instala las colecciones <code>appsec-virtual-patching</code> y <code>appsec-generic-rules</code> y configura el punto final de AppSec para BunkerWeb.</li>
</ul>
<p>Esto proporciona una integración perfecta y lista para usar para una potente prevención de intrusiones.</p>
<h4 id="es-integrations-consideraciones-sobre-rhel">Consideraciones sobre RHEL</h4>
<div class="admonition warning">
<p class="admonition-title">Soporte de base de datos externa en sistemas basados en RHEL</p>
<p>Si planeas usar una base de datos externa (recomendado para producción), debes instalar el paquete de cliente de base de datos apropiado:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Para MariaDB</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mariadb

<span class="c1"># Para MySQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql

<span class="c1"># Para PostgreSQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>postgresql
</code></pre></div>
<p>Esto es necesario para que el Programador de BunkerWeb se conecte a tu base de datos externa.</p>
</div>
<h4 id="es-integrations-despues-de-la-instalacion">Después de la instalación</h4>
<p>Dependiendo de tus elecciones durante la instalación:</p>
<p><strong>Con el asistente de configuración habilitado:</strong></p>
<ol>
<li>Accede al asistente de configuración en: <code>https://tu-ip-de-servidor/setup</code></li>
<li>Sigue la configuración guiada para configurar tu primer servicio protegido</li>
<li>Configura los certificados SSL/TLS y otras configuraciones de seguridad</li>
</ol>
<p><strong>Sin el asistente de configuración:</strong></p>
<ol>
<li>Edita <code>/etc/bunkerweb/variables.env</code> para configurar BunkerWeb manualmente</li>
<li>Añade la configuración de tu servidor y los servicios protegidos</li>
<li>Reinicia el programador: <code>sudo systemctl restart bunkerweb-scheduler</code></li>
</ol>
<h3 id="es-integrations-instalacion-usando-el-gestor-de-paquetes">Instalación usando el gestor de paquetes</h3>
<p>Asegúrate de tener <strong>NGINX 1.28.0 instalado antes de instalar BunkerWeb</strong>. Para todas las distribuciones, excepto Fedora, es obligatorio usar los paquetes precompilados del <a href="https://nginx.org/en/linux_packages.html">repositorio oficial de NGINX</a>. Compilar NGINX desde el código fuente o usar paquetes de diferentes repositorios no funcionará con los paquetes precompilados oficiales de BunkerWeb. Sin embargo, tienes la opción de compilar BunkerWeb desde el código fuente.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="es-integrations-__tabbed_1_1" name="es-integrations-__tabbed_1" type="radio" /><input id="es-integrations-__tabbed_1_2" name="es-integrations-__tabbed_1" type="radio" /><input id="es-integrations-__tabbed_1_3" name="es-integrations-__tabbed_1" type="radio" /><input id="es-integrations-__tabbed_1_4" name="es-integrations-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-integrations-__tabbed_1_1">Debian Bookworm/Trixie</label><label for="es-integrations-__tabbed_1_2">Ubuntu</label><label for="es-integrations-__tabbed_1_3">Fedora</label><label for="es-integrations-__tabbed_1_4">RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>El primer paso es añadir el repositorio oficial de NGINX:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>debian-archive-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/debian `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>Ahora deberías poder instalar NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Versión de prueba/desarrollo</p>
<p>Si usas la versión <code>testing</code> o <code>dev</code>, necesitarás añadir la directiva <code>force-bad-version</code> a tu archivo <code>/etc/dpkg/dpkg.cfg</code> antes de instalar BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Deshabilitar el asistente de configuración</p>
<p>Si no quieres usar el asistente de configuración de la interfaz de usuario web cuando se instale BunkerWeb, exporta la siguiente variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Y finalmente instala BunkerWeb testing:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span>testing
</code></pre></div>
<p>Para evitar la actualización de los paquetes de NGINX y/o BunkerWeb al ejecutar <code>apt upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>El primer paso es añadir el repositorio oficial de NGINX:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>ubuntu-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/ubuntu `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>Ahora deberías poder instalar NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Versión de prueba/desarrollo</p>
<p>Si usas la versión <code>testing</code> o <code>dev</code>, necesitarás añadir la directiva <code>force-bad-version</code> a tu archivo <code>/etc/dpkg/dpkg.cfg</code> antes de instalar BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Deshabilitar el asistente de configuración</p>
<p>Si no quieres usar el asistente de configuración de la interfaz de usuario web cuando se instale BunkerWeb, exporta la siguiente variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Y finalmente instala BunkerWeb testing:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span>testing
</code></pre></div>
<p>Para evitar la actualización de los paquetes de NGINX y/o BunkerWeb al ejecutar <code>apt upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Pruebas de actualización de Fedora</p>
<p>Si no encuentras la versión de NGINX listada en el repositorio estable, puedes habilitar el repositorio <code>updates-testing</code>:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>setopt<span class="w"> </span>updates-testing.enabled<span class="o">=</span><span class="m">1</span>
</code></pre></div>
</div>
<p>Fedora ya proporciona NGINX 1.28.0 que nosotros soportamos</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Deshabilitar el asistente de configuración</p>
<p>Si no quieres usar el asistente de configuración de la interfaz de usuario web cuando se instale BunkerWeb, exporta la siguiente variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Y finalmente instala BunkerWeb testing:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-testing
</code></pre></div>
<p>Para evitar la actualización de los paquetes de NGINX y/o BunkerWeb al ejecutar <code>dnf upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>El primer paso es añadir el repositorio oficial de NGINX. Crea el siguiente archivo en <code>/etc/yum.repos.d/nginx.repo</code>:</p>
<div class="highlight"><pre><span></span><code>[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true

[nginx-mainline]
name=nginx mainline repo
baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/
gpgcheck=1
enabled=0
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true
</code></pre></div>
<p>Ahora deberías poder instalar NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Deshabilitar el asistente de configuración</p>
<p>Si no quieres usar el asistente de configuración de la interfaz de usuario web cuando se instale BunkerWeb, exporta la siguiente variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Y finalmente instala BunkerWeb testing:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>check-update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-testing
</code></pre></div>
<p>Para evitar la actualización de los paquetes de NGINX y/o BunkerWeb al ejecutar <code>dnf upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
</div>
</div>
<h3 id="es-integrations-configuracion-y-servicio">Configuración y servicio</h3>
<p>La configuración manual de BunkerWeb se realiza editando el archivo <code>/etc/bunkerweb/variables.env</code>:</p>
<div class="highlight"><pre><span></span><code>MY_SETTING_1=value1
MY_SETTING_2=value2
...
</code></pre></div>
<p>Cuando se instala, BunkerWeb viene con tres servicios <code>bunkerweb</code>, <code>bunkerweb-scheduler</code> y <code>bunkerweb-ui</code> que puedes gestionar usando <code>systemctl</code>.</p>
<p>Si editas manualmente la configuración de BunkerWeb usando <code>/etc/bunkerweb/variables.env</code>, un reinicio del servicio <code>bunkerweb-scheduler</code> será suficiente para generar y recargar la configuración sin ningún tiempo de inactividad. Pero dependiendo del caso (como cambiar los puertos de escucha) es posible que necesites reiniciar el servicio <code>bunkerweb</code>.</p>
<h3 id="es-integrations-alta-disponibilidad">Alta disponibilidad</h3>
<p>El programador puede separarse de la instancia de BunkerWeb para proporcionar alta disponibilidad. En este caso, el programador se instalará en un servidor separado y podrá gestionar múltiples instancias de BunkerWeb.</p>
<h4 id="es-integrations-gestor">Gestor</h4>
<p>Para instalar solo el programador en un servidor, puedes exportar las siguientes variables antes de ejecutar la instalación de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">MANAGER_MODE</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
<p>Alternativamente, también puedes exportar las siguientes variables para habilitar solo el programador:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<h4 id="es-integrations-trabajador">Trabajador</h4>
<p>En otro servidor, para instalar solo BunkerWeb, puedes exportar las siguientes variables antes de ejecutar la instalación de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">WORKER_MODE</span><span class="o">=</span>yes
</code></pre></div>
<p>Alternativamente, también puedes exportar las siguientes variables para habilitar solo BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<h4 id="es-integrations-interfaz-de-usuario-web">Interfaz de usuario web</h4>
<p>La interfaz de usuario web se puede instalar en un servidor separado para proporcionar una interfaz dedicada para gestionar las instancias de BunkerWeb. Para instalar solo la interfaz de usuario web, puedes exportar las siguientes variables antes de ejecutar la instalación de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>yes
</code></pre></div>
<h2 id="es-integrations-autoconfiguracion-de-docker">Autoconfiguración de Docker</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/integration-autoconf.svg" width="600" />
  </p>
<figcaption>Integración de autoconfiguración de Docker</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Integración con Docker</p>
<p>La integración de autoconfiguración de Docker es una "evolución" de la de Docker. Por favor, lee primero la <a href="#es-integrations-docker">sección de integración con Docker</a> si es necesario.</p>
</div>
<p>Hay disponible un enfoque alternativo para solucionar el inconveniente de tener que recrear el contenedor cada vez que hay una actualización. Utilizando otra imagen llamada <strong>autoconf</strong>, puedes automatizar la reconfiguración en tiempo real de BunkerWeb sin necesidad de recrear el contenedor.</p>
<p>Para aprovechar esta funcionalidad, en lugar de definir variables de entorno para el contenedor de BunkerWeb, puedes añadir <strong>etiquetas</strong> a tus contenedores de aplicaciones web. La imagen <strong>autoconf</strong> escuchará entonces los eventos de Docker y gestionará sin problemas las actualizaciones de configuración para BunkerWeb.</p>
<p>Este proceso "<em>automágico</em>" simplifica la gestión de las configuraciones de BunkerWeb. Al añadir etiquetas a tus contenedores de aplicaciones web, puedes delegar las tareas de reconfiguración a <strong>autoconf</strong> sin la intervención manual de tener que recrear el contenedor. Esto agiliza el proceso de actualización y mejora la comodidad.</p>
<p>Al adoptar este enfoque, puedes disfrutar de la reconfiguración en tiempo real de BunkerWeb sin la molestia de tener que recrear el contenedor, lo que lo hace más eficiente y fácil de usar.</p>
<div class="admonition info">
<p class="admonition-title">Modo multisitio</p>
<p>La integración de autoconfiguración de Docker implica el uso del <strong>modo multisitio</strong>. Por favor, consulta la <a href="#es-concepts-multisite-mode">sección de multisitio</a> de la documentación para obtener más información.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Ten en cuenta que nuestras instrucciones asumen que estás utilizando MariaDB como el backend de base de datos predeterminado, según lo configurado por el ajuste <code>DATABASE_URI</code>. Sin embargo, entendemos que puedes preferir utilizar backends alternativos para tu integración con Docker. Si ese es el caso, ten la seguridad de que otros backends de bases de datos también son posibles. Consulta los archivos docker-compose en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio para obtener más información.</p>
</div>
<p>Para habilitar las actualizaciones de configuración automatizadas, incluye un contenedor adicional llamado <code>bw-autoconf</code> en la pila. Este contenedor aloja el servicio de autoconfiguración, que gestiona los cambios de configuración dinámicos para BunkerWeb.</p>
<p>Para admitir esta funcionalidad, utiliza un backend de base de datos "real" dedicado (p. ej., MariaDB, MySQL o PostgreSQL) para el almacenamiento de configuración sincronizado. Al integrar <code>bw-autoconf</code> y un backend de base de datos adecuado, estableces la infraestructura para una gestión de configuración automatizada y sin problemas en BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir las mismas configuraciones para ambos contenedores</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Etiqueta obligatoria para que el servicio de autoconfiguración identifique la instancia de BunkerWeb</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># No necesitamos especificar la instancia de BunkerWeb aquí, ya que son detectadas automáticamente por el servicio de autoconfiguración</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># El nombre del servidor se rellenará con las etiquetas de los servicios</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Configuración obligatoria para la autoconfiguración</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># El socket de Docker</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Base de datos en la red <code>bw-db</code></p>
<p>El contenedor de la base de datos no está incluido intencionadamente en la red <code>bw-universe</code>. Es utilizado por los contenedores <code>bw-autoconf</code> y <code>bw-scheduler</code> en lugar de directamente por BunkerWeb. Por lo tanto, el contenedor de la base de datos forma parte de la red <code>bw-db</code>, lo que mejora la seguridad al dificultar el acceso externo a la base de datos. <strong>Esta elección de diseño deliberada ayuda a proteger la base de datos y refuerza la perspectiva de seguridad general del sistema</strong>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Uso de Docker en modo sin raíz</p>
<p>Si estás utilizando <a href="https://docs.docker.com/engine/security/rootless">Docker en modo sin raíz</a>, necesitarás reemplazar el montaje del socket de docker con el siguiente valor: <code>$XDG_RUNTIME_DIR/docker.sock:/var/run/docker.sock:ro</code>.</p>
</div>
<h3 id="es-integrations-servicios-de-autoconfiguracion">Servicios de Autoconfiguración</h3>
<p>Una vez que la pila esté configurada, podrás crear el contenedor de la aplicación web y añadir las configuraciones como etiquetas usando el prefijo "bunkerweb." para configurar automáticamente BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="es-integrations-espacios-de-nombres">Espacios de nombres</h3>
<p>A partir de la versión <code>1.6.0</code>, las pilas de Autoconfiguración de BunkerWeb ahora admiten espacios de nombres. Esta característica te permite gestionar múltiples "<em>clústeres</em>" de instancias y servicios de BunkerWeb en el mismo host de Docker. Para aprovechar los espacios de nombres, simplemente establece la etiqueta <code>NAMESPACE</code> en tus servicios. Aquí tienes un ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Establece el espacio de nombres para el servicio</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Comportamiento del espacio de nombres</p>
<p>Por defecto, todas las pilas de Autoconfiguración escuchan a todos los espacios de nombres. Si quieres restringir una pila a espacios de nombres específicos, puedes establecer la variable de entorno <code>NAMESPACES</code> en el servicio <code>bw-autoconf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Establece el espacio de nombres para la instancia de BunkerWeb para que el servicio de autoconfiguración pueda detectarla</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Solo escucha a estos espacios de nombres</span>
<span class="nn">...</span>
</code></pre></div>
<p>Ten en cuenta que la variable de entorno <code>NAMESPACES</code> es una lista de espacios de nombres separados por espacios.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Especificaciones del espacio de nombres</p>
<p>Solo puede haber <strong>una base de datos</strong> y <strong>un Programador</strong> por espacio de nombres. Si intentas crear múltiples bases de datos o Programadores en el mismo espacio de nombres, las configuraciones terminarán en conflicto entre sí.</p>
<p>El Programador no necesita la etiqueta <code>NAMESPACE</code> para funcionar correctamente. Solo necesitará que la configuración <code>DATABASE_URI</code> esté correctamente configurada para que pueda acceder a la misma base de datos que el servicio de autoconfiguración.</p>
</div>
<h2 id="es-integrations-kubernetes">Kubernetes</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/integration-kubernetes.svg" width="600" />
  </p>
<figcaption>Integración con Kubernetes</figcaption>
</figure>
<p>Para automatizar la configuración de las instancias de BunkerWeb en un entorno de Kubernetes, el servicio de autoconfiguración sirve como un <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/">controlador de Ingress</a>. Configura las instancias de BunkerWeb basándose en los <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">recursos de Ingress</a> y también supervisa otros objetos de Kubernetes, como <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>, para configuraciones personalizadas.</p>
<p>Para una configuración óptima, se recomienda definir BunkerWeb como un <strong><a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a></strong>, lo que asegura que se cree un pod en todos los nodos, mientras que la <strong>autoconfiguración y el programador</strong> se definen como un <strong>único <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a> replicado</strong>.</p>
<p>Dada la presencia de múltiples instancias de BunkerWeb, es necesario establecer un almacén de datos compartido implementado como un servicio de <a href="https://redis.io/">Redis</a> o <a href="https://valkey.io/">Valkey</a>. Este servicio será utilizado por las instancias para almacenar en caché y compartir datos entre ellas. Se puede encontrar más información sobre la configuración de Redis/Valkey <a href="#es-features-redis">aquí</a>.</p>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Ten en cuenta que nuestras instrucciones asumen que estás utilizando MariaDB como el backend de base de datos predeterminado, según lo configurado por el ajuste <code>DATABASE_URI</code>. Sin embargo, entendemos que puedes preferir utilizar backends alternativos para tu integración con Docker. Si ese es el caso, ten la seguridad de que otros backends de bases de datos también son posibles. Consulta los archivos docker-compose en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio para obtener más información.</p>
<p>La configuración de backends de bases de datos en clúster está fuera del alcance de esta documentación.</p>
</div>
<p>Asegúrate de que los servicios de autoconfiguración tengan acceso a la API de Kubernetes. Se recomienda utilizar la <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">autorización RBAC</a> para este propósito.</p>
<div class="admonition warning">
<p class="admonition-title">CA personalizada para la API de Kubernetes</p>
<p>Si usas una CA personalizada para tu API de Kubernetes, puedes montar un archivo de paquete que contenga tus certificados intermedios y raíz en el controlador de ingress y establecer el valor del entorno <code>KUBERNETES_SSL_CA_CERT</code> en la ruta del paquete dentro del contenedor. Alternativamente, aunque no se recomienda, puedes deshabilitar la verificación de certificados estableciendo la variable de entorno <code>KUBERNETES_SSL_VERIFY</code> del controlador de ingress en <code>no</code> (el valor predeterminado es <code>yes</code>).</p>
</div>
<p>Además, <strong>es crucial establecer la variable de entorno <code>KUBERNETES_MODE</code> en <code>yes</code> cuando se utiliza la integración con Kubernetes</strong>. Esta variable es obligatoria para un funcionamiento correcto.</p>
<h3 id="es-integrations-metodos-de-instalacion">Métodos de instalación</h3>
<h4 id="es-integrations-usando-el-chart-de-helm-recomendado">Usando el chart de Helm (recomendado)</h4>
<p>La forma recomendada de instalar Kubernetes es usar el chart de Helm disponible en <code>https://repo.bunkerweb.io/charts</code>:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
</code></pre></div>
<p>Luego puedes usar el chart de Helm de bunkerweb de ese repositorio:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>-f<span class="w"> </span>myvalues.yaml<span class="w"> </span>mybunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>La lista completa de valores se encuentra en el archivo <a href="https://github.com/bunkerity/bunkerweb-helm/blob/main/charts/bunkerweb/values.yaml">charts/bunkerweb/values.yaml</a> del repositorio <a href="https://github.com/bunkerity/bunkerweb-helm">bunkerity/bunkerweb-helm</a>.</p>
<h4 id="es-integrations-archivos-yaml-completos">Archivos YAML completos</h4>
<p>En lugar de usar el chart de Helm, también puedes usar las plantillas YAML dentro de la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio de GitHub. Ten en cuenta que recomendamos encarecidamente usar el chart de Helm en su lugar.</p>
<h3 id="es-integrations-recursos-de-ingress">Recursos de Ingress</h3>
<p>Una vez que la pila de BunkerWeb para Kubernetes esté configurada y operativa con éxito (consulta los registros de autoconfiguración para obtener información detallada), puedes proceder a desplegar aplicaciones web dentro del clúster y declarar tu recurso de Ingress.</p>
<p>Es importante tener en cuenta que las configuraciones de BunkerWeb deben especificarse como anotaciones para el recurso de Ingress. Para la parte del dominio, utiliza el valor especial <strong><code>bunkerweb.io</code></strong>. Al incluir las anotaciones apropiadas, puedes configurar BunkerWeb en consecuencia para el recurso de Ingress.</p>
<div class="admonition info">
<p class="admonition-title">Soporte TLS</p>
<p>El controlador de ingress de BunkerWeb es totalmente compatible con certificados HTTPS personalizados utilizando la especificación tls como se muestra en el ejemplo. La configuración de soluciones como <code>cert-manager</code> para generar automáticamente secretos tls está fuera del alcance de esta documentación.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Se aplicará a todos los hosts en este ingress</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="c1"># Solo se aplicará al host www.example.com</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># TLS es opcional, también puedes usar Let&#39;s Encrypt integrado, por ejemplo</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1">#   - hosts:</span>
<span class="w">  </span><span class="c1">#       - www.example.com</span>
<span class="w">  </span><span class="c1">#     secretName: secret-example-tls</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="nn">...</span>
</code></pre></div>
<h3 id="es-integrations-espacios-de-nombres_1">Espacios de nombres</h3>
<p>A partir de la versión <code>1.6.0</code>, las pilas de autoconfiguración de BunkerWeb ahora admiten espacios de nombres. Esta característica te permite gestionar múltiples clústeres de instancias y servicios de BunkerWeb en el mismo clúster de Kubernetes. Para aprovechar los espacios de nombres, simplemente establece el campo de metadatos <code>namespace</code> en tus instancias y servicios de BunkerWeb. Aquí tienes un ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DaemonSet</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># Establece el espacio de nombres para la instancia de BunkerWeb</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Comportamiento del espacio de nombres</p>
<p>Por defecto, todas las pilas de Autoconfiguración escuchan a todos los espacios de nombres. Si quieres restringir una pila a espacios de nombres específicos, puedes establecer la variable de entorno <code>NAMESPACES</code> en el despliegue de <code>bunkerweb-controller</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># Establece el espacio de nombres para el Controlador</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">strategy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Recreate</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sa-bunkerweb</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">          </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Solo escucha a estos espacios de nombres</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
</code></pre></div>
<p>Ten en cuenta que la variable de entorno <code>NAMESPACES</code> es una lista de espacios de nombres separados por espacios.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Especificaciones del espacio de nombres</p>
<p>Solo puede haber <strong>una base de datos</strong> y <strong>un Programador</strong> por espacio de nombres. Si intentas crear múltiples bases de datos o Programadores en el mismo espacio de nombres, las configuraciones terminarán en conflicto entre sí.</p>
<p>El Programador no necesita la anotación <code>NAMESPACE</code> para funcionar correctamente. Solo necesitará que la configuración <code>DATABASE_URI</code> esté correctamente configurada para que pueda acceder a la misma base de datos que el servicio de autoconfiguración.</p>
</div>
<h3 id="es-integrations-clase-de-ingress">Clase de Ingress</h3>
<p>Cuando se instala usando los métodos oficiales de la documentación, BunkerWeb viene con la siguiente definición de <code>IngressClass</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IngressClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">controller</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.io/ingress-controller</span>
</code></pre></div>
<p>Para restringir los recursos <code>Ingress</code> monitoreados por el controlador de ingress, puedes establecer la variable de entorno <code>KUBERNETES_INGRESS_CLASS</code> con el valor <code>bunkerweb</code>. Luego, puedes aprovechar la directiva <code>ingressClassName</code> en tus definiciones de <code>Ingress</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
</code></pre></div>
<h3 id="es-integrations-nombre-de-dominio-personalizado">Nombre de dominio personalizado</h3>
<p>Si usas un nombre de dominio personalizado para tu clúster de Kubernetes diferente al predeterminado <code>kubernetes.local</code>, puedes establecer el valor usando la variable de entorno <code>KUBERNETES_DOMAIN_NAME</code> en el contenedor del programador.</p>
<h3 id="es-integrations-usar-con-un-controlador-de-ingress-existente">Usar con un controlador de ingress existente</h3>
<div class="admonition info">
<p class="admonition-title">Mantener tanto el controlador de ingress existente como BunkerWeb</p>
<p>Este es un caso de uso en el que quieres mantener un controlador de ingress existente como el de nginx. El flujo de tráfico típico será: Balanceador de Carga =&gt; Controlador de Ingress =&gt; BunkerWeb =&gt; Aplicación.</p>
</div>
<h4 id="es-integrations-instalacion-del-controlador-de-ingress-de-nginx">Instalación del controlador de ingress de nginx</h4>
<p>Instala el repositorio de helm de ingress nginx:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>ingress-nginx<span class="w"> </span>https://kubernetes.github.io/ingress-nginx
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>Instala el controlador de ingress de nginx con los valores predeterminados (puede que no funcione en tu propio clúster sin modificaciones, por favor consulta la <a href="https://kubernetes.github.io/ingress-nginx/">documentación</a>):</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>nginx<span class="w"> </span>--create-namespace<span class="w"> </span>nginx<span class="w"> </span>ingress-nginx/ingress-nginx
</code></pre></div>
<p>Extrae la dirección IP del LB:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>nginx-ingress-nginx-controller<span class="w"> </span>-n<span class="w"> </span>nginx<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span>
</code></pre></div>
<p>Configura las entradas DNS a la IP del LB (p. ej., subdominio <code>bunkerweb</code> para la UI de BW y <code>myapp</code> para la aplicación):</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nslookup<span class="w"> </span>bunkerweb.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>bunkerweb.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4
$<span class="w"> </span>nslookup<span class="w"> </span>myapp.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>myapp.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4<span class="sb">```</span>

**Instalación<span class="w"> </span>de<span class="w"> </span>BunkerWeb**

Instala<span class="w"> </span>el<span class="w"> </span>repositorio<span class="w"> </span>de<span class="w"> </span>helm<span class="w"> </span>de<span class="w"> </span>BunkerWeb:

<span class="sb">```</span>bash
helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>Crea el archivo <code>values.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Aquí configuraremos los valores necesarios para configurar BunkerWeb detrás de un controlador de ingress existente</span>
<span class="c1"># Flujo de tráfico con BW: LB =&gt; Controlador de Ingress existente =&gt; BunkerWeb =&gt; Servicio</span>
<span class="c1"># Flujo de tráfico sin BW: LB =&gt; Controlador de Ingress existente =&gt; Servicio</span>

<span class="c1"># Configuraciones globales</span>
<span class="nt">settings</span><span class="p">:</span>
<span class="w">  </span><span class="nt">misc</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Reemplaza con tu resolvedor de DNS</span>
<span class="w">    </span><span class="c1"># para obtenerlo: kubectl exec en un pod aleatorio y luego cat /etc/resolv.conf</span>
<span class="w">    </span><span class="c1"># si tienes una IP como servidor de nombres, haz una búsqueda de DNS inversa: nslookup &lt;IP&gt;</span>
<span class="w">    </span><span class="c1"># la mayoría de las veces es coredns.kube-system.svc.cluster.local o kube-dns.kube-system.svc.cluster.local</span>
<span class="w">    </span><span class="nt">dnsResolvers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kube-dns.kube-system.svc.cluster.local&quot;</span>
<span class="w">  </span><span class="nt">kubernetes</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Solo consideramos los recursos de Ingress con ingressClass bunkerweb para evitar conflictos con el controlador de ingress existente</span>
<span class="w">    </span><span class="nt">ingressClass</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">    </span><span class="c1"># Opcional: puedes elegir el(los) espacio(s) de nombres donde BunkerWeb escuchará los cambios de Ingress/ConfigMap</span>
<span class="w">    </span><span class="c1"># El valor predeterminado (en blanco) es todos los espacios de nombres</span>
<span class="w">    </span><span class="nt">namespaces</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="c1"># Sobrescribe el tipo de servicio bunkerweb-external a ClusterIP</span>
<span class="c1"># Ya que no necesitamos exponerlo al mundo exterior</span>
<span class="c1"># Usaremos el controlador de ingress existente para enrutar el tráfico a BunkerWeb</span>
<span class="nt">service</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>

<span class="c1"># Configuraciones de BunkerWeb</span>
<span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>

<span class="c1"># Configuraciones del programador</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Habilita el módulo de IP real para obtener la IP real de los clientes</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Configuraciones del controlador</span>
<span class="nt">controller</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>

<span class="c1"># Configuraciones de la UI</span>
<span class="nt">ui</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>
</code></pre></div>
<p>Instala BunkerWeb con valores personalizados:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>bunkerweb<span class="w"> </span>--create-namespace<span class="w"> </span>-f<span class="w"> </span>values.yaml<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>Revisa los registros y espera hasta que todo esté listo.</p>
<p><strong>Instalación de la Interfaz de Usuario Web</strong></p>
<p>Configura el siguiente ingress (asumiendo que el controlador de nginx está instalado):</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ui-bunkerweb</span>
<span class="w">  </span><span class="c1"># Reemplaza con tu espacio de nombres de BW si es necesario</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># HTTPS es obligatorio para la interfaz de usuario web, incluso si el tráfico es interno</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/backend-protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;HTTPS&quot;</span>
<span class="w">    </span><span class="c1"># Debemos establecer SNI para que BW pueda servir el vhost correcto</span>
<span class="w">    </span><span class="c1"># Reemplaza con tu dominio</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb.example.com&quot;</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-server-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;on&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Solo servido por el controlador de nginx y no por BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># Descomenta y edita si quieres usar tu propio certificado</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - bunkerweb.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Reemplaza con tu dominio</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># Creado por el chart de Helm</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="c1"># Usar el puerto HTTPS es obligatorio para la UI</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
</code></pre></div>
<p>Y ahora puedes proceder al asistente de configuración navegando a <code>https://bunkerweb.example.com/setup</code>.</p>
<p><strong>Protegiendo una aplicación existente</strong></p>
<p><strong>En primer lugar, deberás ir a Configuración Global, seleccionar el plugin SSL y luego deshabilitar la redirección automática de HTTP a HTTPS. Ten en cuenta que solo necesitas hacerlo una vez.</strong></p>
<p>Supongamos que tienes una aplicación en el espacio de nombres <code>myapp</code> que es accesible a través del servicio <code>myapp-service</code> en el puerto <code>5000</code>.</p>
<p>Necesitarás añadir un nuevo servicio en la interfaz de usuario web y rellenar la información requerida:</p>
<ul>
<li>Nombre del servidor: el dominio público de tu aplicación (p. ej., <code>myapp.example.com</code>)</li>
<li>SSL/TLS: tu controlador de ingress se encarga de esa parte, así que no lo habilites en BunkerWeb ya que el tráfico es interno dentro del clúster</li>
<li>Host del proxy inverso: la URL completa de tu aplicación dentro del clúster (p. ej., <code>http://myapp-service.myapp.svc.cluster.local:5000</code>)</li>
</ul>
<p>Una vez que se haya añadido el nuevo servicio, ahora puedes declarar un recurso de Ingress para ese servicio y enrutarlo al servicio de BunkerWeb en el puerto HTTP:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">  </span><span class="c1"># Reemplaza con tu espacio de nombres de BW si es necesario</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Solo servido por el controlador de nginx y no por BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># Descomenta y edita si quieres usar tu propio certificado</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - myapp.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Reemplaza con tu dominio</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># Creado por el chart de Helm</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>Puedes visitar <code>http(s)://myapp.example.com</code>, que ahora está protegido con BunkerWeb 🛡️</p>
<h2 id="es-integrations-swarm">Swarm</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/integration-swarm.svg" width="600" />
  </p>
<figcaption>Integración con Docker Swarm</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración con Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración con Kubernetes</a> en su lugar.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Soporte PRO</p>
<p><strong>Si necesitas soporte para Swarm</strong>, por favor contáctanos en <a href="mailto:contact@bunkerity.com">contact@bunkerity.com</a> o a través del <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">formulario de contacto</a>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Autoconfiguración de Docker</p>
<p>La integración con Swarm es similar a la de autoconfiguración de Docker (pero con servicios en lugar de contenedores). Por favor, lee primero la <a href="#es-integrations-docker-autoconf">sección de integración de autoconfiguración de Docker</a> si es necesario.</p>
</div>
<p>Para permitir la configuración automática de las instancias de BunkerWeb, el servicio <strong>autoconf</strong> requiere acceso a la API de Docker. Este servicio escucha los eventos de Docker Swarm, como la creación o eliminación de servicios, y configura sin problemas las <strong>instancias de BunkerWeb</strong> en tiempo real sin ningún tiempo de inactividad. También supervisa otros objetos de Swarm, como los <a href="https://docs.docker.com/engine/swarm/configs/">configs</a>, para configuraciones personalizadas.</p>
<p>Al igual que en la <a href="#es-integrations-docker-autoconf">integración de autoconfiguración de Docker</a>, la configuración de los servicios web se define mediante etiquetas que comienzan con el prefijo <strong>bunkerweb</strong>.</p>
<p>Para una configuración óptima, se recomienda programar el <strong>servicio BunkerWeb</strong> como un <strong><em>servicio global</em></strong> en todos los nodos, mientras que los <strong>servicios de autoconf, programador y proxy de la API de Docker</strong> deben programarse como <strong><em>servicios replicados únicos</em></strong>. Ten en cuenta que el servicio de proxy de la API de Docker debe programarse en un nodo gestor, a menos que lo configures para usar una API remota (lo que no se cubre en la documentación).</p>
<p>Dado que se están ejecutando múltiples instancias de BunkerWeb, se debe crear un almacén de datos compartido implementado como un servicio de <a href="https://redis.io/">Redis</a> o <a href="https://valkey.io/">Valkey</a>. Estas instancias utilizarán el servicio Redis/Valkey para almacenar en caché y compartir datos. Se pueden encontrar más detalles sobre la configuración de Redis/Valkey <a href="#es-features-redis">aquí</a>.</p>
<p>En cuanto al volumen de la base de datos, la documentación no especifica un enfoque concreto. La elección de una carpeta compartida o un controlador específico para el volumen de la base de datos depende de tu caso de uso particular y se deja como ejercicio para el lector.</p>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Ten en cuenta que nuestras instrucciones asumen que estás utilizando MariaDB como el backend de base de datos predeterminado, según lo configurado por el ajuste <code>DATABASE_URI</code>. Sin embargo, entendemos que puedes preferir utilizar backends alternativos para tu integración con Docker. Si ese es el caso, ten la seguridad de que otros backends de bases de datos también son posibles. Consulta los archivos docker-compose en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio para obtener más información.</p>
<p>La configuración de backends de bases de datos en clúster está fuera del alcance de esta documentación.</p>
</div>
<p>Aquí está la plantilla de la pila que puedes desplegar usando <code>docker stack deploy</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir las mismas configuraciones para ambos servicios</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Etiqueta obligatoria para que el servicio de autoconfiguración identifique la instancia de BunkerWeb</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># No necesitamos especificar la instancia de BunkerWeb aquí, ya que son detectadas automáticamente por el servicio de autoconfiguración</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># El nombre del servidor se rellenará con las etiquetas de los servicios</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Configuración obligatoria para la autoconfiguración</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># El socket de Docker</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Configuración obligatoria de Swarm</p>
<p>Ten en cuenta que la variable de entorno <code>SWARM_MODE: "yes"</code> es obligatoria cuando se utiliza la integración con Swarm.</p>
</div>
<h3 id="es-integrations-servicios-de-swarm">Servicios de Swarm</h3>
<p>Una vez que la pila de BunkerWeb Swarm esté configurada y en funcionamiento (consulta los registros de autoconfiguración y del programador para obtener más información), podrás desplegar aplicaciones web en el clúster y usar etiquetas para configurar dinámicamente BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="es-integrations-espacios-de-nombres_2">Espacios de nombres</h3>
<p>A partir de la versión <code>1.6.0</code>, las pilas de Autoconfiguración de BunkerWeb ahora admiten espacios de nombres. Esta característica te permite gestionar múltiples "<em>clústeres</em>" de instancias y servicios de BunkerWeb en el mismo host de Docker. Para aprovechar los espacios de nombres, simplemente establece la etiqueta <code>NAMESPACE</code> en tus servicios. Aquí tienes un ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Establece el espacio de nombres para el servicio</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Comportamiento del espacio de nombres</p>
<p>Por defecto, todas las pilas de Autoconfiguración escuchan a todos los espacios de nombres. Si quieres restringir una pila a espacios de nombres específicos, puedes establecer la variable de entorno <code>NAMESPACES</code> en el servicio <code>bw-autoconf</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Establece el espacio de nombres para la instancia de BunkerWeb</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">NAMESPACES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Solo escucha a estos espacios de nombres</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="nn">...</span>
</code></pre></div>
<p>Ten en cuenta que la variable de entorno <code>NAMESPACES</code> es una lista de espacios de nombres separados por espacios.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Especificaciones del espacio de nombres</p>
<p>Solo puede haber <strong>una base de datos</strong> y <strong>un Programador</strong> por espacio de nombres. Si intentas crear múltiples bases de datos o Programadores en el mismo espacio de nombres, las configuraciones terminarán en conflicto entre sí.</p>
<p>El Programador no necesita la etiqueta <code>NAMESPACE</code> para funcionar correctamente. Solo necesitará que la configuración <code>DATABASE_URI</code> esté correctamente configurada para que pueda acceder a la misma base de datos que el servicio de autoconfiguración.</p>
</div>
<h2 id="es-integrations-microsoft-azure">Microsoft Azure</h2>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/integration-azure.webp" width="600" />
  </p>
<figcaption>Integración con Azure</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Tamaño de VM recomendado</p>
<p>Ten en cuenta al elegir el SKU de la VM. Debes seleccionar un SKU compatible con VM de Gen2 y recomendamos empezar con la serie B2s o Ds2 para un uso óptimo.</p>
</div>
<p>Puedes desplegar fácilmente BunkerWeb en tu suscripción de Azure de varias maneras:</p>
<ul>
<li>Azure CLI en Cloud Shell</li>
<li>Plantilla ARM de Azure</li>
<li>Portal de Azure a través del Marketplace</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="es-integrations-__tabbed_2_1" name="es-integrations-__tabbed_2" type="radio" /><input id="es-integrations-__tabbed_2_2" name="es-integrations-__tabbed_2" type="radio" /><input id="es-integrations-__tabbed_2_3" name="es-integrations-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="es-integrations-__tabbed_2_1">Cloud Shell</label><label for="es-integrations-__tabbed_2_2">Plantilla ARM</label><label for="es-integrations-__tabbed_2_3">Marketplace</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Crea un grupo de recursos. Reemplaza el valor <code>RG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span>
</code></pre></div>
<p>Crea una VM con el SKU <code>Standard_B2s</code> en la ubicación del grupo de recursos. Reemplaza los valores <code>RG_NAME</code>, <code>VM_NAME</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span>
</code></pre></div>
<p>Comando completo. Reemplaza los valores <code>RG_NAME</code>, <code>VM_NAME</code>, <code>LOCATION</code>, <code>HOSTNAME</code>, <code>USERNAME</code>, <code>PUBLIC_IP</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code>, <code>NSG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--computer-name<span class="w"> </span><span class="s2">&quot;HOSTNAME&quot;</span><span class="w"> </span>--admin-username<span class="w"> </span><span class="s2">&quot;USERNAME&quot;</span><span class="w"> </span>--public-ip-address<span class="w"> </span><span class="s2">&quot;PUBLIC_IP&quot;</span><span class="w"> </span>--public-ip-address-allocation<span class="w"> </span>Static<span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--public-ip-sku<span class="w"> </span>Standard<span class="w"> </span>--os-disk-delete-option<span class="w"> </span>Delete<span class="w"> </span>--nic-delete-option<span class="w"> </span>Delete<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span><span class="w"> </span>--nsg<span class="w"> </span><span class="s2">&quot;NSG_NAME&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Requisito de permisos</p>
<p>Para desplegar una plantilla ARM, necesitas acceso de escritura en los recursos que estás desplegando y acceso a todas las operaciones en el tipo de recurso Microsoft.Resources/deployments.
Para desplegar una máquina virtual, necesitas los permisos Microsoft.Compute/virtualMachines/write y Microsoft.Resources/deployments/*. La operación what-if tiene los mismos requisitos de permisos.</p>
</div>
<p>Despliega la plantilla ARM:</p>
<p><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fbunkerity%2Fbunkerweb%2Fmaster%2Fmisc%2Fintegrations%2Fazure-arm-template.json" target="_blank"><img alt="Desplegar en Azure" src="../assets/img/integration-azure-deploy.svg" /></a></p>
</div>
<div class="tabbed-block">
<p>Inicia sesión en el <a href="https://portal.azure.com" target="_blank">portal de Azure</a>.</p>
<p>Obtén BunkerWeb desde el menú <a href="https://portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/bunkerity.bunkerweb" target="_blank">Crear un recurso</a>.</p>
<p>También puedes ir a través del <a href="https://azuremarketplace.microsoft.com/fr-fr/marketplace/apps/bunkerity.bunkerweb?tab=Overview" target="_blank">Marketplace</a>.</p>
</div>
</div>
</div>
<p>Puedes acceder al asistente de configuración navegando a la URI <code>https://your-ip-address/setup</code> de tu máquina virtual.</p></section><section class="print-page" id="es-quickstart-guide" heading-number="4"><h1 id="es-quickstart-guide-guia-de-inicio-rapido">Guía de inicio rápido</h1>
<div class="admonition info">
<p class="admonition-title">Requisitos previos</p>
<p>Esperamos que ya estés familiarizado con los <a href="#es-concepts">conceptos básicos</a> y que hayas seguido las <a href="#es-integrations">instrucciones de integración</a> para tu entorno.</p>
<p>Esta guía de inicio rápido asume que BunkerWeb es accesible desde Internet y que has configurado al menos dos dominios: uno para la interfaz de usuario web y otro para tu servicio web.</p>
<p><strong>Requisitos del sistema</strong></p>
<p>Las especificaciones mínimas recomendadas para BunkerWeb son una máquina con 2 (v)CPUs y 8 GB de RAM. Ten en cuenta que esto debería ser suficiente para entornos de prueba o configuraciones con muy pocos servicios.</p>
<p>Para entornos de producción con muchos servicios que proteger, recomendamos al menos 4 (v)CPUs y 16 GB de RAM. Los recursos deben ajustarse en función de tu caso de uso, el tráfico de red y los posibles ataques DDoS que puedas enfrentar.</p>
<p>Se recomienda encarecidamente habilitar la carga global de las reglas CRS (estableciendo el parámetro <code>USE_MODSECURITY_GLOBAL_CRS</code> en <code>yes</code>) si te encuentras en entornos con RAM limitada o en producción con muchos servicios. Puedes encontrar más detalles en la sección de <a href="#es-advanced-running-many-services-in-production">usos avanzados</a> de la documentación.</p>
</div>
<p>Esta guía de inicio rápido te ayudará a instalar rápidamente BunkerWeb y a proteger un servicio web utilizando la interfaz de usuario web.</p>
<p>Proteger las aplicaciones web existentes que ya son accesibles con el protocolo HTTP(S) es el objetivo principal de BunkerWeb: actuará como un <a href="https://es.wikipedia.org/wiki/Proxy_inverso">proxy inverso</a> clásico con características de seguridad adicionales.</p>
<p>Consulta la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/examples">carpeta de ejemplos</a> del repositorio para obtener ejemplos del mundo real.</p>
<h2 id="es-quickstart-guide-configuracion-basica">Configuración básica</h2>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="checked" id="es-quickstart-guide-__tabbed_1_1" name="es-quickstart-guide-__tabbed_1" type="radio" /><input id="es-quickstart-guide-__tabbed_1_2" name="es-quickstart-guide-__tabbed_1" type="radio" /><input id="es-quickstart-guide-__tabbed_1_3" name="es-quickstart-guide-__tabbed_1" type="radio" /><input id="es-quickstart-guide-__tabbed_1_4" name="es-quickstart-guide-__tabbed_1" type="radio" /><input id="es-quickstart-guide-__tabbed_1_5" name="es-quickstart-guide-__tabbed_1" type="radio" /><input id="es-quickstart-guide-__tabbed_1_6" name="es-quickstart-guide-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-quickstart-guide-__tabbed_1_1">Todo en uno</label><label for="es-quickstart-guide-__tabbed_1_2">Linux</label><label for="es-quickstart-guide-__tabbed_1_3">Docker</label><label for="es-quickstart-guide-__tabbed_1_4">Docker autoconf</label><label for="es-quickstart-guide-__tabbed_1_5">Kubernetes</label><label for="es-quickstart-guide-__tabbed_1_6">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Para desplegar el contenedor todo en uno, ejecuta el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Por defecto, el contenedor expone:</p>
<ul>
<li>8080/tcp para HTTP</li>
<li>8443/tcp para HTTPS</li>
<li>8443/udp para QUIC</li>
<li>7000/tcp para el acceso a la interfaz de usuario web sin BunkerWeb delante (no recomendado para producción)</li>
</ul>
<p>La imagen Todo en Uno viene con varios servicios integrados, que se pueden controlar mediante variables de entorno. Consulta la <a href="#es-integrations-all-in-one-aio-image">sección de la imagen Todo en Uno (AIO)</a> de la página de integraciones para más detalles.</p>
</div>
<div class="tabbed-block">
<p>Usa el script de instalación fácil para configurar BunkerWeb en las distribuciones de Linux compatibles. Instala y configura automáticamente NGINX, añade el repositorio de BunkerWeb y configura los servicios necesarios.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Descargar el script y su suma de comprobación</span>
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/vtesting/install-bunkerweb.sh
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/vtesting/install-bunkerweb.sh.sha256

<span class="c1"># Verificar la suma de comprobación</span>
sha256sum<span class="w"> </span>-c<span class="w"> </span>install-bunkerweb.sh.sha256

<span class="c1"># Si la comprobación es exitosa, ejecuta el script</span>
chmod<span class="w"> </span>+x<span class="w"> </span>install-bunkerweb.sh
sudo<span class="w"> </span>./install-bunkerweb.sh
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Aviso de seguridad</p>
<p>Verifica siempre la integridad del script con la suma de comprobación proporcionada antes de ejecutarlo.</p>
</div>
<p>Para métodos de instalación avanzados (gestor de paquetes, tipos de instalación, indicadores no interactivos, integración con CrowdSec, etc.), consulta la <a href="#es-integrations-linux">Integración con Linux</a>.</p>
</div>
<div class="tabbed-block">
<p>Aquí está el archivo docker compose completo que puedes usar; ten en cuenta que más adelante conectaremos el servicio web a la red <code>bw-services</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir las mismas configuraciones para ambos servicios</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Asegúrate de establecer el rango de IP correcto para que el programador pueda enviar la configuración a la instancia</span>
<span class="w">  </span><span class="c1"># Opcional: establece un token de API y refléjalo en ambos contenedores</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Este es el nombre que se usará para identificar la instancia en el Programador</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># Para soporte de QUIC / HTTP3</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span><span class="w"> </span><span class="c1"># Usamos el ancla para evitar repetir las mismas configuraciones para todos los servicios</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Asegúrate de establecer el nombre de instancia correcto</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">UI_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># Cámbialo si es necesario</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se usa para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w"> </span><span class="c1"># Servicio de Redis para la persistencia de informes/baneos/estadísticas</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">redis-server</span>
<span class="w">      </span><span class="no">--maxmemory 256mb</span>
<span class="w">      </span><span class="no">--maxmemory-policy allkeys-lru</span>
<span class="w">      </span><span class="no">--save 60 1000</span>
<span class="w">      </span><span class="no">--appendonly yes</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-data:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">redis-data</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Asegúrate de establecer el rango de IP correcto para que el programador pueda enviar la configuración a la instancia</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Aquí está el archivo docker compose completo que puedes usar; ten en cuenta que más adelante conectaremos el servicio web a la red <code>bw-services</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-ui-env</span>
<span class="w">  </span><span class="c1"># Anclamos las variables de entorno para evitar la duplicación</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># Para soporte de QUIC / HTTP3</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Establecemos la etiqueta de la instancia para permitir que la autoconfiguración detecte la instancia</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">UI_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># Cámbialo si es necesario</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">TOTP_ENCRYPTION_KEYS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una clave secreta más segura (consulta la sección de Requisitos previos)</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w"> </span><span class="c1"># Servicio de Redis para la persistencia de informes/baneos/estadísticas</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">redis-server</span>
<span class="w">      </span><span class="no">--maxmemory 256mb</span>
<span class="w">      </span><span class="no">--maxmemory-policy allkeys-lru</span>
<span class="w">      </span><span class="no">--save 60 1000</span>
<span class="w">      </span><span class="no">--appendonly yes</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-data:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">redis-data</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La forma recomendada de instalar Kubernetes es usar el chart de Helm disponible en <code>https://repo.bunkerweb.io/charts</code>:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
</code></pre></div>
<p>Luego puedes usar el chart de helm <code>bunkerweb</code> de ese repositorio:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>mybw<span class="w"> </span>bunkerweb/bunkerweb<span class="w"> </span>--namespace<span class="w"> </span>bunkerweb<span class="w"> </span>--create-namespace
</code></pre></div>
<p>Una vez instalado, puedes obtener la dirección IP del <code>LoadBalancer</code> para configurar tus dominios:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>-n<span class="w"> </span>bunkerweb<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>mybw-external<span class="w"> </span>-o<span class="o">=</span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Se puede encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Aquí está el archivo de la pila de docker compose completo que puedes usar; ten en cuenta que más adelante conectaremos el servicio web a la red <code>bw-services</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-ui-env</span>
<span class="w">  </span><span class="c1"># Anclamos las variables de entorno para evitar la duplicación</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># Para soporte de QUIC / HTTP3</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">      </span><span class="nt">UI_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># Cámbialo si es necesario</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">TOTP_ENCRYPTION_KEYS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una clave secreta más segura (consulta la sección de Requisitos previos)</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-quickstart-guide-completa-el-asistente-de-configuracion">Completa el asistente de configuración</h2>
<div class="admonition tip">
<p class="admonition-title">Accediendo al asistente de configuración</p>
<p>Puedes acceder al asistente de configuración navegando a la URI <code>https://tu-fqdn-o-direccion-ip/setup</code> de tu servidor.</p>
</div>
<h3 id="es-quickstart-guide-crea-una-cuenta-de-administrador">Crea una cuenta de administrador</h3>
<p>Deberías ver una página de configuración como esta:</p>
<figure>
<p><img align="center" alt="Página de inicio del Asistente de configuración" src="../assets/img/ui-wizard-step1.png" />
  </p>
<figcaption>Página de inicio del Asistente de configuración</figcaption>
</figure>
<p>Una vez en la página de configuración, puedes introducir el <strong>nombre de usuario, correo electrónico y contraseña del administrador</strong> y hacer clic en el botón "Siguiente".</p>
<h3 id="es-quickstart-guide-configura-el-proxy-inverso-https-y-otros-ajustes-avanzados">Configura el Proxy Inverso, HTTPS y otros ajustes avanzados</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="es-quickstart-guide-__tabbed_2_1" name="es-quickstart-guide-__tabbed_2" type="radio" /><input id="es-quickstart-guide-__tabbed_2_2" name="es-quickstart-guide-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="es-quickstart-guide-__tabbed_2_1">Configuración básica</label><label for="es-quickstart-guide-__tabbed_2_2">Configuración avanzada</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>El siguiente paso te pedirá que introduzcas el <strong>nombre del servidor</strong> (dominio/FQDN) que utilizará la interfaz de usuario web.</p>
<p>También puedes optar por habilitar <a href="#es-features-lets-encrypt">Let's Encrypt</a></p>
<p><figure markdown>
  <img align="center" alt="Asistente de configuración paso 2" src="../assets/img/ui-wizard-step2.png" />
  <figcaption>Asistente de configuración paso 2</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<p>El siguiente paso te pedirá que introduzcas el <strong>nombre del servidor</strong> (dominio/FQDN) que utilizará la interfaz de usuario web.</p>
<p>También puedes optar por habilitar <a href="#es-features-lets-encrypt">Let's Encrypt</a>.</p>
<p>Si expandes la sección <code>Ajustes avanzados</code>, también puedes configurar las siguientes opciones:</p>
<ul>
<li><strong>Proxy Inverso</strong>: Ajusta la configuración del Proxy Inverso para tu interfaz de administrador (p. ej., si quieres usar una ruta).</li>
<li><a href="#es-features-real-ip"><strong>IP Real</strong></a>: Configura los ajustes de IP Real para identificar correctamente la dirección IP del cliente (p. ej., si estás detrás de un balanceador de carga o un CDN).</li>
<li><a href="#es-features-custom-ssl-certificate"><strong>Certificado Personalizado</strong></a>: Sube un certificado TLS personalizado si no quieres usar Let's Encrypt.</li>
</ul>
<p><figure markdown>
  <img align="center" alt="Asistente de configuración paso 2" src="../assets/img/ui-wizard-step2-advanced.png" />
  <figcaption>Asistente de configuración paso 2 (avanzado)</figcaption>
</figure></p>
</div>
</div>
</div>
<h3 id="es-quickstart-guide-activacion-pro">Activación PRO</h3>
<p>Si tienes una licencia PRO, puedes activarla introduciendo tu clave de licencia en la sección <code>Actualizar a PRO</code>. Esto habilitará las características PRO de BunkerWeb.</p>
<figure>
<p><img align="center" alt="Paso PRO del Asistente de configuración" src="../assets/img/ui-wizard-step3.png" />
  </p>
<figcaption>Paso PRO del Asistente de configuración</figcaption>
</figure>
<h3 id="es-quickstart-guide-resumen-de-tu-configuracion">Resumen de tu configuración</h3>
<p>El último paso te dará un resumen de la configuración que has introducido. Puedes hacer clic en el botón "Configurar" para completar la configuración.</p>
<figure>
<p><img align="center" alt="Paso final del Asistente de configuración" src="../assets/img/ui-wizard-step4.png" />
  </p>
<figcaption>Paso final del Asistente de configuración</figcaption>
</figure>
<h2 id="es-quickstart-guide-accediendo-a-la-interfaz-web">Accediendo a la interfaz web</h2>
<p>Ahora puedes acceder a la interfaz web navegando al dominio que configuraste en el paso anterior y a la URI si la cambiaste (el valor predeterminado es <code>https://tu-dominio/</code>).</p>
<figure>
<p><img align="center" alt="Página de inicio de sesión de la interfaz web" src="../assets/img/ui-login.png" />
  </p>
<figcaption>Página de inicio de sesión de la interfaz web</figcaption>
</figure>
<p>Ahora puedes iniciar sesión con la cuenta de administrador que creaste durante el asistente de configuración.</p>
<figure>
<p><img align="center" alt="Inicio de la interfaz web" src="../assets/img/ui-home.png" />
  </p>
<figcaption>Inicio de la interfaz web</figcaption>
</figure>
<h2 id="es-quickstart-guide-creando-un-nuevo-servicio">Creando un nuevo servicio</h2>
<div class="tabbed-set tabbed-alternate" data-tabs="3:7"><input checked="checked" id="es-quickstart-guide-__tabbed_3_1" name="es-quickstart-guide-__tabbed_3" type="radio" /><input id="es-quickstart-guide-__tabbed_3_2" name="es-quickstart-guide-__tabbed_3" type="radio" /><input id="es-quickstart-guide-__tabbed_3_3" name="es-quickstart-guide-__tabbed_3" type="radio" /><input id="es-quickstart-guide-__tabbed_3_4" name="es-quickstart-guide-__tabbed_3" type="radio" /><input id="es-quickstart-guide-__tabbed_3_5" name="es-quickstart-guide-__tabbed_3" type="radio" /><input id="es-quickstart-guide-__tabbed_3_6" name="es-quickstart-guide-__tabbed_3" type="radio" /><input id="es-quickstart-guide-__tabbed_3_7" name="es-quickstart-guide-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="es-quickstart-guide-__tabbed_3_1">Interfaz de usuario web</label><label for="es-quickstart-guide-__tabbed_3_2">Todo en uno</label><label for="es-quickstart-guide-__tabbed_3_3">Archivo variables.env de Linux</label><label for="es-quickstart-guide-__tabbed_3_4">Docker</label><label for="es-quickstart-guide-__tabbed_3_5">Etiquetas de Docker autoconf</label><label for="es-quickstart-guide-__tabbed_3_6">Anotaciones de Kubernetes</label><label for="es-quickstart-guide-__tabbed_3_7">Etiquetas de Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Puedes crear un nuevo servicio navegando a la sección <code>Servicios</code> de la interfaz web y haciendo clic en el botón <code>➕ Crear nuevo servicio</code>.</p>
<p>Hay múltiples formas de crear un servicio usando la interfaz web:</p>
<ul>
<li>El <strong>Modo fácil</strong> te guiará a través del proceso de creación de un nuevo servicio.</li>
<li>El <strong>Modo avanzado</strong> te permitirá configurar el servicio con más opciones.</li>
<li>El <strong>Modo sin formato</strong> te permitirá introducir la configuración directamente como si editaras el archivo <code>variables.env</code>.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Servicio en borrador</p>
<p>Puedes crear un servicio en borrador para guardar tu progreso y volver a él más tarde. Simplemente haz clic en el botón <code>🌐 En línea</code> para cambiar el servicio al modo borrador.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="es-quickstart-guide-__tabbed_4_1" name="es-quickstart-guide-__tabbed_4" type="radio" /><input id="es-quickstart-guide-__tabbed_4_2" name="es-quickstart-guide-__tabbed_4" type="radio" /><input id="es-quickstart-guide-__tabbed_4_3" name="es-quickstart-guide-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="es-quickstart-guide-__tabbed_4_1">Modo fácil</label><label for="es-quickstart-guide-__tabbed_4_2">Modo avanzado</label><label for="es-quickstart-guide-__tabbed_4_3">Modo sin formato</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>En este modo, puedes elegir entre las plantillas disponibles y rellenar los campos obligatorios.</p>
<p><figure markdown>
  <img align="center" alt="Creación de servicio en modo fácil en la interfaz web" src="../assets/img/ui-create-service-easy.png" />
  <figcaption>Creación de servicio en modo fácil en la interfaz web</figcaption>
</figure></p>
<ul>
<li>Una vez que hayas seleccionado la plantilla, puedes rellenar los campos obligatorios y seguir las instrucciones para crear el servicio.</li>
<li>Una vez que hayas terminado de configurar el servicio, puedes hacer clic en el botón <code>💾 Guardar</code> para guardar la configuración.</li>
</ul>
</div>
<div class="tabbed-block">
<p>En este modo, puedes configurar el servicio con más opciones mientras ves todas las configuraciones disponibles de todos los diferentes plugins.</p>
<p><figure markdown>
  <img align="center" alt="Creación de servicio en modo avanzado en la interfaz web" src="../assets/img/ui-create-service-advanced.png" />
  <figcaption>Creación de servicio en modo avanzado en la interfaz web</figcaption>
</figure></p>
<ul>
<li>Para navegar entre los diferentes plugins, puedes usar el menú de navegación en el lado izquierdo de la página.</li>
<li>Cada configuración tiene una pequeña pieza de información que te ayudará a entender lo que hace.</li>
<li>Una vez que hayas terminado de configurar el servicio, puedes hacer clic en el botón <code>💾 Guardar</code> para guardar la configuración.</li>
</ul>
</div>
<div class="tabbed-block">
<p>En este modo, puedes introducir la configuración directamente como si editaras el archivo <code>variables.env</code>.</p>
<p><figure markdown>
  <img align="center" alt="Creación de servicio en modo SIN FORMATO en la interfaz web" src="../assets/img/ui-create-service-raw.png" />
  <figcaption>Creación de servicio en modo SIN FORMATO en la interfaz web</figcaption>
</figure></p>
<ul>
<li>Una vez que hayas terminado de configurar el servicio, puedes hacer clic en el botón <code>💾 Guardar</code> para guardar la configuración.</li>
</ul>
</div>
</div>
</div>
<p>🚀 Una vez que hayas guardado la configuración, deberías ver tu nuevo servicio en la lista de servicios.</p>
<p><figure markdown>
  <img align="center" alt="Página de servicios de la interfaz web" src="../assets/img/ui-services.png" />
  <figcaption>Página de servicios de la interfaz web</figcaption>
</figure></p>
<p>Si deseas editar el servicio, puedes hacer clic en el nombre del servicio o en el botón <code>📝 Editar</code>.</p>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la imagen Todo en Uno, los nuevos servicios se configuran añadiendo variables de entorno al comando <code>docker run</code> para el contenedor <code>bunkerweb-aio</code>. Si el contenedor ya está en ejecución, debes detenerlo y eliminarlo, y luego volver a ejecutarlo con las variables de entorno actualizadas.</p>
<p>Supongamos que quieres proteger una aplicación <code>myapp</code> (que se ejecuta en otro contenedor y es accesible como <code>http://myapp:8080</code> desde BunkerWeb) y hacerla disponible en <code>www.example.com</code>. Añadirías o modificarías las siguientes variables de entorno en tu comando <code>docker run</code>:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Primero, detén y elimina el contenedor existente si está en ejecución:</span>
<span class="c1"># docker stop bunkerweb-aio</span>
<span class="c1"># docker rm bunkerweb-aio</span>

<span class="c1"># Luego, vuelve a ejecutar el contenedor bunkerweb-aio con variables de entorno adicionales/actualizadas:</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="c1"># --- Añade/modifica estas variables de entorno para tu nuevo servicio ---</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">MULTISITE</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">SERVER_NAME</span><span class="o">=</span><span class="s2">&quot;www.example.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;www.example.com_USE_REVERSE_PROXY=yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;www.example.com_REVERSE_PROXY_HOST=http://myapp:8080&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;www.example.com_REVERSE_PROXY_URL=/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="c1"># --- Incluye cualquier otra variable de entorno existente para la UI, Redis, CrowdSec, etc. ---</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Tu contenedor de aplicación (<code>myapp</code>) y el contenedor <code>bunkerweb-aio</code> deben estar en la misma red de Docker para que BunkerWeb pueda alcanzarlo usando el nombre de host <code>myapp</code>.</p>
<p><strong>Ejemplo de configuración de red:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Crea una red de Docker personalizada (si aún no lo has hecho):</span>
docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>my-app-network

<span class="c1"># 2. Ejecuta tu contenedor de aplicación en esta red:</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>myapp<span class="w"> </span>--network<span class="w"> </span>my-app-network<span class="w"> </span>tu-imagen-de-aplicacion

<span class="c1"># 3. Añade --network my-app-network al comando docker run de bunkerweb-aio:</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--network<span class="w"> </span>my-app-network<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="c1">#   ... (todas las demás variables de entorno relevantes como se muestra en el ejemplo principal anterior) ...</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div></p>
<p>Asegúrate de reemplazar <code>myapp</code> con el nombre o IP real de tu contenedor de aplicación y <code>http://myapp:8080</code> con su dirección y puerto correctos.</p>
</div>
<div class="tabbed-block">
<p>Asumimos que has seguido la <a href="#es-quickstart-guide-__tabbed_1_2">Configuración básica</a> y que la integración con Linux está funcionando en tu máquina.</p>
<p>Puedes crear un nuevo servicio editando el archivo <code>variables.env</code> ubicado en el directorio <code>/etc/bunkerweb/</code>.</p>
<div class="highlight"><pre><span></span><code>nano<span class="w"> </span>/etc/bunkerweb/variables.env
</code></pre></div>
<p>Luego puedes añadir la siguiente configuración:</p>
<div class="highlight"><pre><span></span><code><span class="nv">SERVER_NAME</span><span class="o">=</span>www.example.com
<span class="nv">MULTISITE</span><span class="o">=</span>yes
www.example.com_USE_REVERSE_PROXY<span class="o">=</span>yes
www.example.com_REVERSE_PROXY_URL<span class="o">=</span>/
www.example.com_REVERSE_PROXY_HOST<span class="o">=</span>http://myapp:8080
</code></pre></div>
<p>Luego puedes recargar el servicio <code>bunkerweb-scheduler</code> para aplicar los cambios.</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Asumimos que has seguido la <a href="#es-quickstart-guide-__tabbed_1_3">Configuración básica</a> y que la integración con Docker está funcionando en tu máquina.</p>
<p>Debes tener una red llamada <code>bw-services</code> para que puedas conectar tu aplicación existente y configurar BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<p>Después de eso, puedes añadir manualmente el servicio en el archivo docker compose que creaste en el paso anterior:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">bw-scheduler</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">SERVER_NAME</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span><span class="w"> </span><span class="c1"># Cuando usas la integración con Docker, puedes establecer la configuración directamente en el programador, asegúrate de establecer el nombre de dominio correcto</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Habilita el modo multisitio para que puedas añadir múltiples servicios</span>
<span class="w">      </span><span class="nt">www.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://myapp:8080&quot;</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Luego puedes reiniciar el servicio <code>bw-scheduler</code> para aplicar los cambios.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>bw-scheduler<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>bw-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Asumimos que has seguido la <a href="#es-quickstart-guide-__tabbed_1_4">Configuración básica</a> y que la integración de autoconfiguración de Docker está funcionando en tu máquina.</p>
<p>Debes tener una red llamada <code>bw-services</code> para que puedas conectar tu aplicación existente y configurar BunkerWeb con etiquetas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://myapp:8080&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<p>Hacer esto creará automáticamente un nuevo servicio con las etiquetas proporcionadas como configuración.</p>
</div>
<div class="tabbed-block">
<p>Asumimos que has seguido la <a href="#es-quickstart-guide-__tabbed_1_5">Configuración básica</a> y que la pila de Kubernetes está funcionando en tu clúster.</p>
<p>Supongamos que tienes un Despliegue típico con un Servicio para acceder a la aplicación web desde dentro del clúster:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
</code></pre></div>
<p>Aquí está la definición de Ingress correspondiente para servir y proteger la aplicación web:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/DUMMY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app</span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Se puede encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Asumimos que has seguido la <a href="#es-quickstart-guide-__tabbed_1_5">Configuración básica</a> y que la pila de Swarm está funcionando en tu clúster y conectada a una red llamada <code>bw-services</code> para que puedas conectar tu aplicación existente y configurar BunkerWeb con etiquetas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://myapp:8080&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-quickstart-guide-para-saber-mas">Para saber más</h2>
<p>¡Felicidades! Acabas de instalar BunkerWeb y de asegurar tu primer servicio web. Ten en cuenta que BunkerWeb ofrece mucho más, tanto en términos de seguridad como de integraciones con otros sistemas y soluciones. Aquí tienes una lista de recursos y acciones que pueden ayudarte a seguir profundizando en el conocimiento de la solución:</p>
<ul>
<li>Únete a la comunidad de Bunker: <a href="https://discord.com/invite/fTf46FmtyD">Discord</a>, <a href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>, <a href="https://github.com/bunkerity">GitHub</a>, <a href="https://x.com/bunkerity">X (Anteriormente Twitter)</a></li>
<li>Echa un vistazo al <a href="https://www.bunkerweb.io/blog?utm_campaign=self&amp;utm_source=doc">blog oficial</a></li>
<li>Explora <a href="#es-advanced">casos de uso avanzados</a> en la documentación</li>
<li><a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">Ponte en contacto con nosotros</a> para discutir las necesidades de tu organización</li>
</ul></section><section class="print-page" id="es-features" heading-number="5"><h1 id="es-features-caracteristicas">Características</h1>
<p>Esta sección contiene la lista completa de ajustes admitidos por BunkerWeb. Si aún no está familiarizado con BunkerWeb, primero lea la sección de <a href="#es-concepts">conceptos</a> de la documentación. Siga las instrucciones de su <a href="#es-integrations">integración</a> para aplicar los ajustes.</p>
<h2 id="es-features-configuracion-global">Configuración global</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El plugin General proporciona el marco de configuración principal para BunkerWeb, permitiéndote definir los ajustes esenciales que controlan cómo se protegen y entregan tus servicios web. Este plugin fundamental gestiona aspectos básicos como los modos de seguridad, los valores predeterminados del servidor, el comportamiento de los registros y los parámetros operativos críticos para todo el ecosistema de BunkerWeb.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando BunkerWeb se inicia, el plugin General carga y aplica tus ajustes de configuración principales.</li>
<li>Los modos de seguridad se establecen de forma global o por sitio, determinando el nivel de protección aplicado.</li>
<li>Los ajustes predeterminados del servidor establecen valores de respaldo para cualquier configuración multisitio no especificada.</li>
<li>Los parámetros de registro controlan qué información se graba y cómo se formatea.</li>
<li>Estos ajustes crean la base sobre la que operan todos los demás plugins y funcionalidades de BunkerWeb.</li>
</ol>
<h3 id="es-features-modo-multisite">Modo Multisite</h3>
<p>Cuando <code>MULTISITE</code> se establece en <code>yes</code>, BunkerWeb puede alojar y proteger múltiples sitios web, cada uno con su propia configuración única. Esta característica es particularmente útil para escenarios como:</p>
<ul>
<li>Alojar múltiples dominios con configuraciones distintas</li>
<li>Ejecutar múltiples aplicaciones con diferentes requisitos de seguridad</li>
<li>Aplicar políticas de seguridad personalizadas a diferentes servicios</li>
</ul>
<p>En el modo multisitio, cada sitio se identifica por un <code>SERVER_NAME</code> único. Para aplicar ajustes específicos a un sitio, antepón el <code>SERVER_NAME</code> principal al nombre del ajuste. Por ejemplo:</p>
<ul>
<li><code>www.example.com_USE_ANTIBOT=captcha</code> habilita el CAPTCHA para <code>www.example.com</code>.</li>
<li><code>myapp.example.com_USE_GZIP=yes</code> habilita la compresión GZIP para <code>myapp.example.com</code>.</li>
</ul>
<p>Este enfoque asegura que los ajustes se apliquen al sitio correcto en un entorno multisitio.</p>
<h3 id="es-features-ajustes-multiples">Ajustes Múltiples</h3>
<p>Algunos ajustes en BunkerWeb admiten múltiples configuraciones para la misma característica. Para definir múltiples grupos de ajustes, añade un sufijo numérico al nombre del ajuste. Por ejemplo:</p>
<ul>
<li><code>REVERSE_PROXY_URL_1=/subdir</code> y <code>REVERSE_PROXY_HOST_1=http://myhost1</code> configuran el primer proxy inverso.</li>
<li><code>REVERSE_PROXY_URL_2=/anotherdir</code> y <code>REVERSE_PROXY_HOST_2=http://myhost2</code> configuran el segundo proxy inverso.</li>
</ul>
<p>Este patrón te permite gestionar múltiples configuraciones para características como proxies inversos, puertos u otros ajustes que requieren valores distintos para diferentes casos de uso.</p>
<h3 id="es-features-modos-de-seguridad">Modos de Seguridad</h3>
<p>El ajuste <code>SECURITY_MODE</code> determina cómo BunkerWeb maneja las amenazas detectadas. Esta característica flexible te permite elegir entre monitorizar o bloquear activamente la actividad sospechosa, dependiendo de tus necesidades específicas:</p>
<ul>
<li><strong><code>detect</code></strong>: Registra las amenazas potenciales sin bloquear el acceso. Este modo es útil para identificar y analizar falsos positivos de una manera segura y no disruptiva.</li>
<li><strong><code>block</code></strong> (predeterminado): Bloquea activamente las amenazas detectadas mientras registra los incidentes para prevenir el acceso no autorizado y proteger tu aplicación.</li>
</ul>
<p>Cambiar al modo <code>detect</code> puede ayudarte a identificar y resolver posibles falsos positivos sin interrumpir a los clientes legítimos. Una vez que estos problemas se resuelvan, puedes volver con confianza al modo <code>block</code> para una protección completa.</p>
<h3 id="es-features-ajustes-de-configuracion">Ajustes de Configuración</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:9"><input checked="checked" id="es-features-__tabbed_1_1" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_2" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_3" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_4" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_5" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_6" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_7" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_8" name="es-features-__tabbed_1" type="radio" /><input id="es-features-__tabbed_1_9" name="es-features-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_1_1">Ajustes Principales</label><label for="es-features-__tabbed_1_2">Ajustes de la API</label><label for="es-features-__tabbed_1_3">Ajustes de Red y Puertos</label><label for="es-features-__tabbed_1_4">Ajustes del Servidor de Stream</label><label for="es-features-__tabbed_1_5">Ajustes de Workers</label><label for="es-features-__tabbed_1_6">Ajustes de Memoria</label><label for="es-features-__tabbed_1_7">Ajustes de Registro</label><label for="es-features-__tabbed_1_8">Ajustes de Integración</label><label for="es-features-__tabbed_1_9">Ajustes de Nginx</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SERVER_NAME</code></td>
<td><code>www.example.com</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Dominio Principal:</strong> El nombre de dominio principal para este sitio. Requerido en modo multisitio.</td>
</tr>
<tr>
<td><code>BUNKERWEB_INSTANCES</code></td>
<td><code>127.0.0.1</code></td>
<td>global</td>
<td>No</td>
<td><strong>Instancias de BunkerWeb:</strong> Lista de instancias de BunkerWeb separadas por espacios.</td>
</tr>
<tr>
<td><code>MULTISITE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Múltiples Sitios:</strong> Establécelo en <code>yes</code> para permitir el alojamiento de múltiples sitios web con diferentes configuraciones.</td>
</tr>
<tr>
<td><code>SECURITY_MODE</code></td>
<td><code>block</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Nivel de Seguridad:</strong> Controla el nivel de aplicación de la seguridad. Opciones: <code>detect</code> o <code>block</code>.</td>
</tr>
<tr>
<td><code>SERVER_TYPE</code></td>
<td><code>http</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Tipo de Servidor:</strong> Define si el servidor es de tipo <code>http</code> o <code>stream</code>.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_API</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>No</td>
<td><strong>Activar API:</strong> Activa la API para controlar BunkerWeb.</td>
</tr>
<tr>
<td><code>API_HTTP_PORT</code></td>
<td><code>5000</code></td>
<td>global</td>
<td>No</td>
<td><strong>Puerto de la API:</strong> Número de puerto de escucha para la API.</td>
</tr>
<tr>
<td><code>API_HTTPS_PORT</code></td>
<td><code>6000</code></td>
<td>global</td>
<td>No</td>
<td><strong>Puerto HTTPS de la API:</strong> Número de puerto de escucha (TLS) para la API.</td>
</tr>
<tr>
<td><code>API_LISTEN_HTTP</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>No</td>
<td><strong>Escucha HTTP de la API:</strong> Habilita el listener HTTP para la API.</td>
</tr>
<tr>
<td><code>API_LISTEN_HTTPS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Escucha HTTPS de la API:</strong> Habilita el listener HTTPS (TLS) para la API.</td>
</tr>
<tr>
<td><code>API_LISTEN_IP</code></td>
<td><code>0.0.0.0</code></td>
<td>global</td>
<td>No</td>
<td><strong>IP de Escucha de la API:</strong> Dirección IP de escucha para la API.</td>
</tr>
<tr>
<td><code>API_SERVER_NAME</code></td>
<td><code>bwapi</code></td>
<td>global</td>
<td>No</td>
<td><strong>Nombre del Servidor de la API:</strong> Nombre del servidor (host virtual) para la API.</td>
</tr>
<tr>
<td><code>API_WHITELIST_IP</code></td>
<td><code>127.0.0.0/8</code></td>
<td>global</td>
<td>No</td>
<td><strong>IP de la Lista Blanca de la API:</strong> Lista de IP/redes permitidas para contactar con la API.</td>
</tr>
<tr>
<td><code>API_TOKEN</code></td>
<td></td>
<td>global</td>
<td>No</td>
<td><strong>Token de Acceso a la API (opcional):</strong> Si se establece, todas las solicitudes a la API deben incluir <code>Authorization: Bearer &lt;token&gt;</code>.</td>
</tr>
</tbody>
</table>
<p>Nota: por razones de arranque, si habilitas <code>API_TOKEN</code> debes establecerlo en el entorno de AMBAS, la instancia de BunkerWeb y el Programador. El Programador incluye automáticamente el encabezado <code>Authorization</code> cuando <code>API_TOKEN</code> está presente en su entorno. Si no se establece, no se envía ningún encabezado y BunkerWeb no aplicará la autenticación por token. Puedes exponer la API a través de HTTPS estableciendo <code>API_LISTEN_HTTPS=yes</code> (puerto: <code>API_HTTPS_PORT</code>, predeterminado <code>6000</code>).</p>
<p>Prueba de ejemplo con curl (reemplaza el token y el host):</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: bwapi&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$API_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>http://&lt;bunkerweb-host&gt;:5000/ping

curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: bwapi&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$API_TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span>--insecure<span class="w"> </span><span class="se">\</span>
<span class="w">     </span>https://&lt;bunkerweb-host&gt;:6000/ping
</code></pre></div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HTTP_PORT</code></td>
<td><code>8080</code></td>
<td>global</td>
<td>Sí</td>
<td><strong>Puerto HTTP:</strong> Número de puerto para el tráfico HTTP.</td>
</tr>
<tr>
<td><code>HTTPS_PORT</code></td>
<td><code>8443</code></td>
<td>global</td>
<td>Sí</td>
<td><strong>Puerto HTTPS:</strong> Número de puerto para el tráfico HTTPS.</td>
</tr>
<tr>
<td><code>USE_IPV6</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Soporte IPv6:</strong> Habilita la conectividad IPv6.</td>
</tr>
<tr>
<td><code>DNS_RESOLVERS</code></td>
<td><code>127.0.0.11</code></td>
<td>global</td>
<td>No</td>
<td><strong>Resolutores DNS:</strong> Direcciones DNS de los resolutores a usar.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LISTEN_STREAM</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Escucha de Stream:</strong> Habilita la escucha para no-ssl (passthrough).</td>
</tr>
<tr>
<td><code>LISTEN_STREAM_PORT</code></td>
<td><code>1337</code></td>
<td>multisite</td>
<td>Sí</td>
<td><strong>Puerto de Stream:</strong> Puerto de escucha para no-ssl (passthrough).</td>
</tr>
<tr>
<td><code>LISTEN_STREAM_PORT_SSL</code></td>
<td><code>4242</code></td>
<td>multisite</td>
<td>Sí</td>
<td><strong>Puerto SSL de Stream:</strong> Puerto de escucha para ssl (passthrough).</td>
</tr>
<tr>
<td><code>USE_TCP</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Escucha TCP:</strong> Habilita la escucha TCP (stream).</td>
</tr>
<tr>
<td><code>USE_UDP</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Escucha UDP:</strong> Habilita la escucha UDP (stream).</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WORKER_PROCESSES</code></td>
<td><code>auto</code></td>
<td>global</td>
<td>No</td>
<td><strong>Procesos Worker:</strong> Número de procesos worker. Establécelo en <code>auto</code> para usar los núcleos disponibles.</td>
</tr>
<tr>
<td><code>WORKER_CONNECTIONS</code></td>
<td><code>1024</code></td>
<td>global</td>
<td>No</td>
<td><strong>Conexiones por Worker:</strong> Número máximo de conexiones por worker.</td>
</tr>
<tr>
<td><code>WORKER_RLIMIT_NOFILE</code></td>
<td><code>2048</code></td>
<td>global</td>
<td>No</td>
<td><strong>Límite de Descriptores de Archivo:</strong> Número máximo de archivos abiertos por worker.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WORKERLOCK_MEMORY_SIZE</code></td>
<td><code>48k</code></td>
<td>global</td>
<td>No</td>
<td><strong>Tamaño de Memoria de Workerlock:</strong> Tamaño de lua_shared_dict para los workers de inicialización.</td>
</tr>
<tr>
<td><code>DATASTORE_MEMORY_SIZE</code></td>
<td><code>64m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Tamaño de Memoria del Datastore:</strong> Tamaño del datastore interno.</td>
</tr>
<tr>
<td><code>CACHESTORE_MEMORY_SIZE</code></td>
<td><code>64m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Tamaño de Memoria del Cachestore:</strong> Tamaño del cachestore interno.</td>
</tr>
<tr>
<td><code>CACHESTORE_IPC_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Tamaño de Memoria IPC del Cachestore:</strong> Tamaño del cachestore interno (ipc).</td>
</tr>
<tr>
<td><code>CACHESTORE_MISS_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Tamaño de Memoria de Fallos del Cachestore:</strong> Tamaño del cachestore interno (fallos).</td>
</tr>
<tr>
<td><code>CACHESTORE_LOCKS_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Tamaño de Memoria de Bloqueos del Cachestore:</strong> Tamaño del cachestore interno (bloqueos).</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LOG_FORMAT</code></td>
<td><code>$host $remote_addr - $request_id $remote_user [$time_local] \"$request\" $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\"</code></td>
<td>global</td>
<td>No</td>
<td><strong>Formato de Registro:</strong> El formato a usar para los registros de acceso.</td>
</tr>
<tr>
<td><code>LOG_LEVEL</code></td>
<td><code>notice</code></td>
<td>global</td>
<td>No</td>
<td><strong>Nivel de Registro:</strong> Nivel de verbosidad para los registros de errores. Opciones: <code>debug</code>, <code>info</code>, <code>notice</code>, <code>warn</code>, <code>error</code>, <code>crit</code>, <code>alert</code>, <code>emerg</code>.</td>
</tr>
<tr>
<td><code>TIMERS_LOG_LEVEL</code></td>
<td><code>debug</code></td>
<td>global</td>
<td>No</td>
<td><strong>Nivel de Registro de Temporizadores:</strong> Nivel de registro para los temporizadores. Opciones: <code>debug</code>, <code>info</code>, <code>notice</code>, <code>warn</code>, <code>err</code>, <code>crit</code>, <code>alert</code>, <code>emerg</code>.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Mejores Prácticas de Registro</p>
<ul>
<li>Para entornos de producción, usa los niveles de registro <code>notice</code>, <code>warn</code>, o <code>error</code> para minimizar el volumen de registros.</li>
<li>Para depurar problemas, establece temporalmente el nivel de registro en <code>debug</code> para obtener información más detallada.</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AUTOCONF_MODE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Modo Autoconf:</strong> Habilita la integración con Docker Autoconf.</td>
</tr>
<tr>
<td><code>SWARM_MODE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Modo Swarm:</strong> Habilita la integración con Docker Swarm.</td>
</tr>
<tr>
<td><code>KUBERNETES_MODE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Modo Kubernetes:</strong> Habilita la integración con Kubernetes.</td>
</tr>
<tr>
<td><code>USE_TEMPLATE</code></td>
<td></td>
<td>multisite</td>
<td>No</td>
<td><strong>Usar Plantilla:</strong> Plantilla de configuración a usar que sobrescribirá los valores predeterminados de ajustes específicos.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NGINX_PREFIX</code></td>
<td><code>/etc/nginx/</code></td>
<td>global</td>
<td>No</td>
<td><strong>Prefijo de Nginx:</strong> Dónde buscará Nginx las configuraciones.</td>
</tr>
<tr>
<td><code>SERVER_NAMES_HASH_BUCKET_SIZE</code></td>
<td></td>
<td>global</td>
<td>No</td>
<td><strong>Tamaño del Bucket de Hash de Nombres de Servidor:</strong> Valor para la directiva <code>server_names_hash_bucket_size</code>.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h3 id="es-features-configuraciones-de-ejemplo">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="es-features-__tabbed_2_1" name="es-features-__tabbed_2" type="radio" /><input id="es-features-__tabbed_2_2" name="es-features-__tabbed_2" type="radio" /><input id="es-features-__tabbed_2_3" name="es-features-__tabbed_2" type="radio" /><input id="es-features-__tabbed_2_4" name="es-features-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_2_1">Configuración Básica de Producción</label><label for="es-features-__tabbed_2_2">Modo de Desarrollo</label><label for="es-features-__tabbed_2_3">Configuración Multisite</label><label for="es-features-__tabbed_2_4">Configuración del Servidor de Stream</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración estándar para un sitio de producción con seguridad estricta:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;block&quot;</span>
<span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.com&quot;</span>
<span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;notice&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para un entorno de desarrollo con registro adicional:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;detect&quot;</span>
<span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dev.example.com&quot;</span>
<span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;debug&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para alojar múltiples sitios web:</p>
<div class="highlight"><pre><span></span><code><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Primer sitio</span>
<span class="nt">site1.example.com_SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;site1.example.com&quot;</span>
<span class="nt">site1.example.com_SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;block&quot;</span>

<span class="c1"># Segundo sitio</span>
<span class="nt">site2.example.com_SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;site2.example.com&quot;</span>
<span class="nt">site2.example.com_SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;detect&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para un servidor TCP/UDP:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SERVER_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span>
<span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream.example.com&quot;</span>
<span class="nt">LISTEN_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1337&quot;</span>
<span class="nt">USE_TCP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_UDP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-anti-ddos-pro">Anti DDoS <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Provides enhanced protection against DDoS attacks by analyzing and filtering suspicious traffic.</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIDDOS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable or disable anti DDoS protection to mitigate high traffic spikes.</td>
</tr>
<tr>
<td><code>ANTIDDOS_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Size of in-memory storage for DDoS metrics (e.g., 10M, 500k).</td>
</tr>
<tr>
<td><code>ANTIDDOS_THRESHOLD</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td>Maximum suspicious requests allowed from a single IP before blocking.</td>
</tr>
<tr>
<td><code>ANTIDDOS_WINDOW_TIME</code></td>
<td><code>10</code></td>
<td>global</td>
<td>no</td>
<td>Time window (seconds) to detect abnormal request patterns.</td>
</tr>
<tr>
<td><code>ANTIDDOS_STATUS_CODES</code></td>
<td><code>429 403 444</code></td>
<td>global</td>
<td>no</td>
<td>HTTP status codes treated as suspicious for DDoS analysis.</td>
</tr>
<tr>
<td><code>ANTIDDOS_DISTINCT_IP</code></td>
<td><code>5</code></td>
<td>global</td>
<td>no</td>
<td>Minimum distinct IP count before enabling anti DDoS measures.</td>
</tr>
</tbody>
</table>
<h2 id="es-features-antibot">Antibot</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Los atacantes suelen utilizar herramientas automatizadas (bots) para intentar explotar su sitio web. Para protegerse contra esto, BunkerWeb incluye una función "Antibot" que desafía a los usuarios a demostrar que son humanos. Si un usuario completa con éxito el desafío, se le concede acceso a su sitio web. Esta función está desactivada por defecto.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un usuario visita su sitio, BunkerWeb comprueba si ya ha superado el desafío antibot.</li>
<li>Si no, el usuario es redirigido a una página de desafío.</li>
<li>El usuario debe completar el desafío (por ejemplo, resolver un CAPTCHA, ejecutar JavaScript).</li>
<li>Si el desafío tiene éxito, el usuario es redirigido de nuevo a la página que intentaba visitar originalmente y puede navegar por su sitio web con normalidad.</li>
</ol>
<h3 id="es-features-como-usar">Cómo usar</h3>
<p>Siga estos pasos para habilitar y configurar la función Antibot:</p>
<ol>
<li><strong>Elija un tipo de desafío:</strong> Decida qué tipo de desafío antibot usar (p. ej., <a href="#es-features-__tabbed_3_3">captcha</a>, <a href="#es-features-__tabbed_3_5">hcaptcha</a>, <a href="#es-features-__tabbed_3_2">javascript</a>).</li>
<li><strong>Habilite la función:</strong> Establezca la configuración <code>USE_ANTIBOT</code> en el tipo de desafío elegido en su configuración de BunkerWeb.</li>
<li><strong>Configure los ajustes:</strong> Ajuste las otras configuraciones <code>ANTIBOT_*</code> según sea necesario. Para reCAPTCHA, hCaptcha, Turnstile y mCaptcha, debe crear una cuenta con el servicio respectivo y obtener claves de API.</li>
<li><strong>Importante:</strong> Asegúrese de que el <code>ANTIBOT_URI</code> sea una URL única en su sitio que no esté en uso.</li>
</ol>
<div class="admonition important">
<p class="admonition-title">Acerca de la configuración <code>ANTIBOT_URI</code></p>
</div>
<p>Asegúrese de que el <code>ANTIBOT_URI</code> sea una URL única en su sitio que no esté en uso.</p>
<div class="admonition warning">
<p class="admonition-title">Configuración de sesión en entornos de clúster</p>
</div>
<p>La función antibot utiliza cookies para rastrear si un usuario ha completado el desafío. Si está ejecutando BunkerWeb en un entorno de clúster (múltiples instancias de BunkerWeb), <strong>debe</strong> configurar la gestión de sesiones correctamente. Esto implica establecer las configuraciones <code>SESSIONS_SECRET</code> y <code>SESSIONS_NAME</code> con los <strong>mismos valores</strong> en todas las instancias de BunkerWeb. Si no lo hace, es posible que a los usuarios se les pida repetidamente que completen el desafío antibot. Puede encontrar más información sobre la configuración de sesiones <a href="#es-features-sessions">aquí</a>.</p>
<h3 id="es-features-configuraciones-comunes">Configuraciones comunes</h3>
<p>Las siguientes configuraciones son compartidas por todos los mecanismos de desafío:</p>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ANTIBOT_URI</code></td>
<td><code>/challenge</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL del desafío:</strong> La URL a la que se redirigirá a los usuarios para completar el desafío. Asegúrese de que esta URL no se utilice para nada más en su sitio.</td>
</tr>
<tr>
<td><code>ANTIBOT_TIME_RESOLVE</code></td>
<td><code>60</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Límite de tiempo del desafío:</strong> El tiempo máximo (en segundos) que un usuario tiene para completar el desafío. Después de este tiempo, se generará un nuevo desafío.</td>
</tr>
<tr>
<td><code>ANTIBOT_TIME_VALID</code></td>
<td><code>86400</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Validez del desafío:</strong> Cuánto tiempo (en segundos) es válido un desafío completado. Después de este tiempo, los usuarios tendrán que resolver un nuevo desafío.</td>
</tr>
</tbody>
</table>
<h3 id="es-features-excluir-trafico-de-los-desafios">Excluir tráfico de los desafíos</h3>
<p>BunkerWeb le permite especificar ciertos usuarios, IP o solicitudes que deben omitir por completo el desafío antibot. Esto es útil para incluir en la lista blanca servicios de confianza, redes internas o páginas específicas que siempre deben ser accesibles sin desafío:</p>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ANTIBOT_IGNORE_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL excluidas:</strong> Lista de patrones regex de URI separados por espacios que deben omitir el desafío.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP excluidas:</strong> Lista de direcciones IP o rangos CIDR separados por espacios que deben omitir el desafío.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_RDNS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>DNS inverso excluido:</strong> Lista de sufijos de DNS inverso separados por espacios que deben omitir el desafío.</td>
</tr>
<tr>
<td><code>ANTIBOT_RDNS_GLOBAL</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Solo IP globales:</strong> Si se establece en <code>yes</code>, solo realiza comprobaciones de DNS inverso en direcciones IP públicas.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN excluidos:</strong> Lista de números de ASN separados por espacios que deben omitir el desafío.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agents excluidos:</strong> Lista de patrones regex de User-Agent separados por espacios que deben omitir el desafío.</td>
</tr>
</tbody>
</table>
<p><strong>Ejemplos:</strong></p>
<ul>
<li><code>ANTIBOT_IGNORE_URI: "^/api/ ^/webhook/ ^/assets/"</code>
  Esto excluirá del desafío antibot todas las URI que comiencen con <code>/api/</code>, <code>/webhook/</code> o <code>/assets/</code>.</li>
<li><code>ANTIBOT_IGNORE_IP: "192.168.1.0/24 10.0.0.1"</code>
  Esto excluirá del desafío antibot la red interna <code>192.168.1.0/24</code> y la IP específica <code>10.0.0.1</code>.</li>
<li><code>ANTIBOT_IGNORE_RDNS: ".googlebot.com .bingbot.com"</code>
  Esto excluirá del desafío antibot las solicitudes de hosts con DNS inverso que terminen en <code>googlebot.com</code> o <code>bingbot.com</code>.</li>
<li><code>ANTIBOT_IGNORE_ASN: "15169 8075"</code>
  Esto excluirá del desafío antibot las solicitudes de los ASN 15169 (Google) y 8075 (Microsoft).</li>
<li><code>ANTIBOT_IGNORE_USER_AGENT: "^Mozilla.+Chrome.+Safari"</code>
  Esto excluirá del desafío antibot las solicitudes con User-Agents que coincidan con el patrón regex especificado.</li>
</ul>
<h3 id="es-features-mecanismos-de-desafio-compatibles">Mecanismos de desafío compatibles</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="3:1"><input checked="checked" id="es-features-__tabbed_3_1" name="es-features-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_3_1">Cookie</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>El desafío de Cookie es un mecanismo ligero que se basa en establecer una cookie en el navegador del usuario. Cuando un usuario accede al sitio, el servidor envía una cookie al cliente. En solicitudes posteriores, el servidor comprueba la presencia de esta cookie para verificar que el usuario es legítimo. Este método es simple y eficaz para la protección básica contra bots sin requerir interacción adicional del usuario.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>El servidor genera una cookie única y la envía al cliente.</li>
<li>El cliente debe devolver la cookie en las solicitudes posteriores.</li>
<li>Si la cookie falta o no es válida, el usuario es redirigido a la página del desafío.</li>
</ol>
<p><strong>Ajustes de configuración:</strong></p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Antibot:</strong> Establezca en <code>cookie</code> para habilitar el desafío de Cookie.</td>
</tr>
</tbody>
</table>
<pre><code>Consulte los [Ajustes comunes](#configuraciones-comunes) para opciones de configuración adicionales.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="4:1"><input checked="checked" id="es-features-__tabbed_4_1" name="es-features-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_4_1">JavaScript</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>El desafío de JavaScript requiere que el cliente resuelva una tarea computacional usando JavaScript. Este mecanismo asegura que el cliente tenga JavaScript habilitado y pueda ejecutar el código requerido, lo cual está típicamente fuera de la capacidad de la mayoría de los bots.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>El servidor envía un script de JavaScript al cliente.</li>
<li>El script realiza una tarea computacional (p. ej., hashing) y envía el resultado de vuelta al servidor.</li>
<li>El servidor verifica el resultado para confirmar la legitimidad del cliente.</li>
</ol>
<p><strong>Características principales:</strong></p>
<ul>
<li>El desafío genera dinámicamente una tarea única para cada cliente.</li>
<li>La tarea computacional implica hashing con condiciones específicas (p. ej., encontrar un hash con un prefijo determinado).</li>
</ul>
<p><strong>Ajustes de configuración:</strong></p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Antibot:</strong> Establezca en <code>javascript</code> para habilitar el desafío de JavaScript.</td>
</tr>
</tbody>
</table>
<pre><code>Consulte los [Ajustes comunes](#configuraciones-comunes) para opciones de configuración adicionales.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="5:1"><input checked="checked" id="es-features-__tabbed_5_1" name="es-features-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_5_1">Captcha</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>El desafío de Captcha es un mecanismo casero que genera desafíos basados en imágenes alojados completamente dentro de su entorno de BunkerWeb. Pone a prueba la capacidad de los usuarios para reconocer e interpretar caracteres aleatorios, asegurando que los bots automatizados sean bloqueados eficazmente sin depender de servicios externos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>El servidor genera una imagen CAPTCHA que contiene caracteres aleatorios.</li>
<li>El usuario debe introducir los caracteres que se muestran en la imagen en un campo de texto.</li>
<li>El servidor valida la entrada del usuario con el CAPTCHA generado.</li>
</ol>
<p><strong>Características principales:</strong></p>
<ul>
<li>Totalmente autoalojado, eliminando la necesidad de API de terceros.</li>
<li>Los desafíos generados dinámicamente aseguran la unicidad para cada sesión de usuario.</li>
<li>Utiliza un conjunto de caracteres personalizable para la generación de CAPTCHA.</li>
</ul>
<p><strong>Caracteres admitidos:</strong></p>
<p>El sistema CAPTCHA admite los siguientes tipos de caracteres:</p>
<ul>
<li><strong>Letras:</strong> Todas las letras minúsculas (a-z) y mayúsculas (A-Z)</li>
<li><strong>Números:</strong> 2, 3, 4, 5, 6, 7, 8, 9 (excluye 0 y 1 para evitar confusiones)</li>
<li><strong>Caracteres especiales:</strong> <code>+-/=%"'&amp;_(),.;:?!§`^ÄÖÜßäöüé''‚""„</code></li>
</ul>
<p>Para tener el conjunto completo de caracteres admitidos, consulte el <a href="https://www.dafont.com/moms-typewriter.charmap?back=theme">mapa de caracteres de la fuente</a> utilizada para el CAPTCHA.</p>
<p><strong>Ajustes de configuración:</strong></p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Antibot:</strong> Establezca en <code>captcha</code> para habilitar el desafío de Captcha.</td>
</tr>
<tr>
<td><code>ANTIBOT_CAPTCHA_ALPHABET</code></td>
<td><code>abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Alfabeto del Captcha:</strong> Una cadena de caracteres para usar en la generación del CAPTCHA. Caracteres admitidos: todas las letras (a-z, A-Z), números 2-9 (excluye 0 y 1) y caracteres especiales: <code>+-/=%"'&amp;_(),.;:?!§`^ÄÖÜßäöüé''‚""„</code></td>
</tr>
</tbody>
</table>
<pre><code>Consulte los [Ajustes comunes](#configuraciones-comunes) para opciones de configuración adicionales.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="6:1"><input checked="checked" id="es-features-__tabbed_6_1" name="es-features-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_6_1">reCAPTCHA</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Cuando está habilitado, reCAPTCHA se ejecuta en segundo plano (v3) para asignar una puntuación basada en el comportamiento del usuario. Una puntuación inferior al umbral configurado solicitará una verificación adicional o bloqueará la solicitud. Para los desafíos visibles (v2), los usuarios deben interactuar con el widget de reCAPTCHA antes de continuar.</p>
<p>Ahora hay dos formas de integrar reCAPTCHA:
*   La versión clásica (claves de sitio/secretas, punto final de verificación v2/v3)
*   La nueva versión que utiliza Google Cloud (ID del proyecto + clave de API). La versión clásica sigue disponible y se puede activar con <code>ANTIBOT_RECAPTCHA_CLASSIC</code>.</p>
<p>Para la versión clásica, obtenga sus claves de sitio y secretas en la <a href="https://www.google.com/recaptcha/admin">consola de administración de Google reCAPTCHA</a>.
Para la nueva versión, cree una clave de reCAPTCHA en su proyecto de Google Cloud y use el ID del proyecto y una clave de API (consulte la <a href="https://console.cloud.google.com/security/recaptcha">consola de reCAPTCHA de Google Cloud</a>). Todavía se requiere una clave de sitio.</p>
<p><strong>Ajustes de configuración:</strong></p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td>Habilitar antibot; establezca en <code>recaptcha</code> para habilitar reCAPTCHA.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_CLASSIC</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td>Usar reCAPTCHA clásico. Establezca en <code>no</code> para usar la nueva versión basada en Google Cloud.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td>Clave de sitio de reCAPTCHA. Requerida para las versiones clásica y nueva.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td>Clave secreta de reCAPTCHA. Requerida solo para la versión clásica.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_PROJECT_ID</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td>ID del proyecto de Google Cloud. Requerido solo para la nueva versión.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_API_KEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td>Clave de API de Google Cloud utilizada para llamar a la API de reCAPTCHA Enterprise. Requerida solo para la nueva versión.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_JA3</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td>Huella digital JA3 TLS opcional para incluir en las evaluaciones de Enterprise.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_JA4</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td>Huella digital JA4 TLS opcional para incluir en las evaluaciones de Enterprise.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_SCORE</code></td>
<td><code>0.7</code></td>
<td>multisite</td>
<td>no</td>
<td>Puntuación mínima requerida para pasar (se aplica tanto a la v3 clásica como a la nueva versión).</td>
</tr>
</tbody>
</table>
<pre><code>Consulte los [Ajustes comunes](#configuraciones-comunes) para opciones de configuración adicionales.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="7:1"><input checked="checked" id="es-features-__tabbed_7_1" name="es-features-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_7_1">hCaptcha</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Cuando está habilitado, hCaptcha proporciona una alternativa eficaz a reCAPTCHA al verificar las interacciones del usuario sin depender de un mecanismo de puntuación. Desafía a los usuarios con una prueba simple e interactiva para confirmar su legitimidad.</p>
<p>Para integrar hCaptcha con BunkerWeb, debe obtener las credenciales necesarias del panel de hCaptcha en <a href="https://www.hcaptcha.com">hCaptcha</a>. Estas credenciales incluyen una clave de sitio y una clave secreta.</p>
<p><strong>Ajustes de configuración:</strong></p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Antibot:</strong> Establezca en <code>hcaptcha</code> para habilitar el desafío de hCaptcha.</td>
</tr>
<tr>
<td><code>ANTIBOT_HCAPTCHA_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Clave del sitio de hCaptcha:</strong> Su clave de sitio de hCaptcha (obtenerla de hCaptcha).</td>
</tr>
<tr>
<td><code>ANTIBOT_HCAPTCHA_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Clave secreta de hCaptcha:</strong> Su clave secreta de hCaptcha (obtenerla de hCaptcha).</td>
</tr>
</tbody>
</table>
<pre><code>Consulte los [Ajustes comunes](#configuraciones-comunes) para opciones de configuración adicionales.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="8:1"><input checked="checked" id="es-features-__tabbed_8_1" name="es-features-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_8_1">Turnstile</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Turnstile es un mecanismo de desafío moderno y respetuoso con la privacidad que aprovecha la tecnología de Cloudflare para detectar y bloquear el tráfico automatizado. Valida las interacciones del usuario de manera fluida y en segundo plano, reduciendo la fricción para los usuarios legítimos y desalentando eficazmente a los bots.</p>
<p>Para integrar Turnstile con BunkerWeb, asegúrese de obtener las credenciales necesarias de <a href="https://www.cloudflare.com/turnstile">Cloudflare Turnstile</a>.</p>
<p><strong>Ajustes de configuración:</strong></p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Antibot:</strong> Establezca en <code>turnstile</code> para habilitar el desafío Turnstile.</td>
</tr>
<tr>
<td><code>ANTIBOT_TURNSTILE_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Clave del sitio de Turnstile:</strong> Su clave de sitio de Turnstile (obtenerla de Cloudflare).</td>
</tr>
<tr>
<td><code>ANTIBOT_TURNSTILE_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Clave secreta de Turnstile:</strong> Su clave secreta de Turnstile (obtenerla de Cloudflare).</td>
</tr>
</tbody>
</table>
<pre><code>Consulte los [Ajustes comunes](#configuraciones-comunes) para opciones de configuración adicionales.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="9:1"><input checked="checked" id="es-features-__tabbed_9_1" name="es-features-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_9_1">mCaptcha</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>mCaptcha es un mecanismo de desafío CAPTCHA alternativo que verifica la legitimidad de los usuarios presentando una prueba interactiva similar a otras soluciones antibot. Cuando está habilitado, desafía a los usuarios con un CAPTCHA proporcionado por mCaptcha, asegurando que solo los usuarios genuinos omitan las comprobaciones de seguridad automatizadas.</p>
<p>mCaptcha está diseñado pensando en la privacidad. Es totalmente compatible con el GDPR, lo que garantiza que todos los datos del usuario involucrados en el proceso de desafío cumplan con estrictos estándares de protección de datos. Además, mCaptcha ofrece la flexibilidad de ser autoalojado, lo que permite a las organizaciones mantener un control total sobre sus datos e infraestructura. Esta capacidad de autoalojamiento no solo mejora la privacidad, sino que también optimiza el rendimiento y la personalización para adaptarse a las necesidades específicas de implementación.</p>
<p>Para integrar mCaptcha con BunkerWeb, debe obtener las credenciales necesarias de la plataforma <a href="https://mcaptcha.org/">mCaptcha</a> o de su propio proveedor. Estas credenciales incluyen una clave de sitio y una clave secreta para la verificación.</p>
<p><strong>Ajustes de configuración:</strong></p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Antibot:</strong> Establezca en <code>mcaptcha</code> para habilitar el desafío mCaptcha.</td>
</tr>
<tr>
<td><code>ANTIBOT_MCAPTCHA_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Clave del sitio de mCaptcha:</strong> Su clave de sitio de mCaptcha (obtenerla de mCaptcha).</td>
</tr>
<tr>
<td><code>ANTIBOT_MCAPTCHA_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Clave secreta de mCaptcha:</strong> Su clave secreta de mCaptcha (obtenerla de mCaptcha).</td>
</tr>
<tr>
<td><code>ANTIBOT_MCAPTCHA_URL</code></td>
<td><code>https://demo.mcaptcha.org</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Dominio de mCaptcha:</strong> El dominio a utilizar para el desafío mCaptcha.</td>
</tr>
</tbody>
</table>
<pre><code>Consulte los [Ajustes comunes](#configuraciones-comunes) para opciones de configuración adicionales.
</code></pre>
<h3 id="es-features-configuraciones-de-ejemplo_1">Configuraciones de ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="10:8"><input checked="checked" id="es-features-__tabbed_10_1" name="es-features-__tabbed_10" type="radio" /><input id="es-features-__tabbed_10_2" name="es-features-__tabbed_10" type="radio" /><input id="es-features-__tabbed_10_3" name="es-features-__tabbed_10" type="radio" /><input id="es-features-__tabbed_10_4" name="es-features-__tabbed_10" type="radio" /><input id="es-features-__tabbed_10_5" name="es-features-__tabbed_10" type="radio" /><input id="es-features-__tabbed_10_6" name="es-features-__tabbed_10" type="radio" /><input id="es-features-__tabbed_10_7" name="es-features-__tabbed_10" type="radio" /><input id="es-features-__tabbed_10_8" name="es-features-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_10_1">Desafío de Cookie</label><label for="es-features-__tabbed_10_2">Desafío de JavaScript</label><label for="es-features-__tabbed_10_3">Desafío de Captcha</label><label for="es-features-__tabbed_10_4">reCAPTCHA Clásico</label><label for="es-features-__tabbed_10_5">reCAPTCHA (nuevo)</label><label for="es-features-__tabbed_10_6">Desafío de hCaptcha</label><label for="es-features-__tabbed_10_7">Desafío de Turnstile</label><label for="es-features-__tabbed_10_8">Desafío de mCaptcha</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar el desafío de Cookie:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cookie&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar el desafío de JavaScript:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;javascript&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar el desafío de Captcha:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;captcha&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">ANTIBOT_CAPTCHA_ALPHABET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;23456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ&quot;</span>
</code></pre></div>
<p>Nota: El ejemplo anterior utiliza los números del 2 al 9 y todas las letras, que son los caracteres más utilizados para los desafíos CAPTCHA. Puede personalizar el alfabeto para incluir caracteres especiales según sea necesario.</p>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para el reCAPTCHA clásico (claves de sitio/secretas):</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;recaptcha&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_CLASSIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SCORE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.7&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para el nuevo reCAPTCHA basado en Google Cloud (ID del proyecto + clave de API):</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;recaptcha&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_CLASSIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_PROJECT_ID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-gcp-project-id&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-gcp-api-key&quot;</span>
<span class="c1"># Huellas dactilares opcionales para mejorar las evaluaciones de Enterprise</span>
<span class="c1"># ANTIBOT_RECAPTCHA_JA3: &quot;&lt;ja3-fingerprint&gt;&quot;</span>
<span class="c1"># ANTIBOT_RECAPTCHA_JA4: &quot;&lt;ja4-fingerprint&gt;&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SCORE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.7&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar el desafío de hCaptcha:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hcaptcha&quot;</span>
<span class="nt">ANTIBOT_HCAPTCHA_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_HCAPTCHA_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar el desafío de Turnstile:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;turnstile&quot;</span>
<span class="nt">ANTIBOT_TURNSTILE_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_TURNSTILE_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar el desafío de mCaptcha:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mcaptcha&quot;</span>
<span class="nt">ANTIBOT_MCAPTCHA_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_MCAPTCHA_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_MCAPTCHA_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://demo.mcaptcha.org&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-auth-basic">Auth basic</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El plugin Auth Basic proporciona autenticación básica HTTP para proteger su sitio web o recursos específicos. Esta función añade una capa extra de seguridad al requerir que los usuarios introduzcan un nombre de usuario y una contraseña antes de acceder al contenido protegido. Este tipo de autenticación es fácil de implementar y es ampliamente compatible con los navegadores.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un usuario intenta acceder a un área protegida de su sitio web, el servidor envía un desafío de autenticación.</li>
<li>El navegador muestra un cuadro de diálogo de inicio de sesión pidiendo al usuario un nombre de usuario y una contraseña.</li>
<li>El usuario introduce sus credenciales, que se envían al servidor.</li>
<li>Si las credenciales son válidas, se le concede al usuario acceso al contenido solicitado.</li>
<li>Si las credenciales no son válidas, se le muestra al usuario un mensaje de error con el código de estado 401 No autorizado.</li>
</ol>
<h3 id="es-features-como-usar_1">Cómo usar</h3>
<p>Siga estos pasos para habilitar y configurar la autenticación básica:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_AUTH_BASIC</code> en <code>yes</code> en su configuración de BunkerWeb.</li>
<li><strong>Elija el ámbito de protección:</strong> Decida si proteger todo su sitio o solo URL específicas configurando el ajuste <code>AUTH_BASIC_LOCATION</code>.</li>
<li><strong>Defina las credenciales:</strong> Configure al menos un par de nombre de usuario y contraseña utilizando los ajustes <code>AUTH_BASIC_USER</code> y <code>AUTH_BASIC_PASSWORD</code>.</li>
<li><strong>Personalice el mensaje:</strong> Opcionalmente, cambie el <code>AUTH_BASIC_TEXT</code> para mostrar un mensaje personalizado en la solicitud de inicio de sesión.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_1">Ajustes de configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_AUTH_BASIC</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar autenticación básica:</strong> Establezca en <code>yes</code> para habilitar la autenticación básica.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_LOCATION</code></td>
<td><code>sitewide</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ámbito de protección:</strong> Establezca en <code>sitewide</code> para proteger todo el sitio, o especifique una ruta de URL (p. ej., <code>/admin</code>) para proteger solo áreas específicas.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_USER</code></td>
<td><code>changeme</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Nombre de usuario:</strong> El nombre de usuario requerido para la autenticación. Puede definir múltiples pares de nombre de usuario/contraseña.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_PASSWORD</code></td>
<td><code>changeme</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Contraseña:</strong> La contraseña requerida para la autenticación. Cada contraseña corresponde a un nombre de usuario.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_TEXT</code></td>
<td><code>Restricted area</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Texto de la solicitud:</strong> El mensaje que se muestra en la solicitud de autenticación mostrada a los usuarios.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de seguridad</p>
</div>
<p>La autenticación básica HTTP transmite las credenciales codificadas (no cifradas) en Base64. Aunque esto es aceptable cuando se utiliza sobre HTTPS, no debe considerarse seguro sobre HTTP plano. Habilite siempre SSL/TLS cuando utilice la autenticación básica.</p>
<div class="admonition tip">
<p class="admonition-title">Uso de múltiples credenciales</p>
</div>
<p>Puede configurar múltiples pares de nombre de usuario/contraseña para el acceso. Cada ajuste <code>AUTH_BASIC_USER</code> debe tener un ajuste <code>AUTH_BASIC_PASSWORD</code> correspondiente.</p>
<h3 id="es-features-configuraciones-de-ejemplo_2">Configuraciones de ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="11:3"><input checked="checked" id="es-features-__tabbed_11_1" name="es-features-__tabbed_11" type="radio" /><input id="es-features-__tabbed_11_2" name="es-features-__tabbed_11" type="radio" /><input id="es-features-__tabbed_11_3" name="es-features-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_11_1">Protección de todo el sitio</label><label for="es-features-__tabbed_11_2">Protección de áreas específicas</label><label for="es-features-__tabbed_11_3">Múltiples usuarios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Para proteger todo su sitio web con un único conjunto de credenciales:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_AUTH_BASIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">AUTH_BASIC_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sitewide&quot;</span>
<span class="nt">AUTH_BASIC_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secure_password&quot;</span>
<span class="nt">AUTH_BASIC_TEXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Admin</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Only&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para proteger solo una ruta específica, como un panel de administración:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_AUTH_BASIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">AUTH_BASIC_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/admin/&quot;</span>
<span class="nt">AUTH_BASIC_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secure_password&quot;</span>
<span class="nt">AUTH_BASIC_TEXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Admin</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Only&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para configurar múltiples usuarios con diferentes credenciales:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_AUTH_BASIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">AUTH_BASIC_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sitewide&quot;</span>
<span class="nt">AUTH_BASIC_TEXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Staff</span><span class="nv"> </span><span class="s">Area&quot;</span>

<span class="c1"># Primer usuario</span>
<span class="nt">AUTH_BASIC_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin_password&quot;</span>

<span class="c1"># Segundo usuario</span>
<span class="nt">AUTH_BASIC_USER_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;editor&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;editor_password&quot;</span>

<span class="c1"># Tercer usuario</span>
<span class="nt">AUTH_BASIC_USER_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;viewer&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;viewer_password&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-backup">Backup</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de copia de seguridad proporciona una solución de respaldo automatizada para proteger sus datos de BunkerWeb. Esta función garantiza la seguridad y disponibilidad de su importante base de datos mediante la creación de copias de seguridad periódicas según el cronograma que prefiera. Las copias de seguridad se almacenan en una ubicación designada y se pueden gestionar fácilmente a través de procesos automatizados y comandos manuales.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Su base de datos se respalda automáticamente según el cronograma que establezca (diario, semanal o mensual).</li>
<li>Las copias de seguridad se almacenan en un directorio específico de su sistema.</li>
<li>Las copias de seguridad antiguas se rotan automáticamente según su configuración de retención.</li>
<li>Puede crear copias de seguridad manualmente, enumerar las copias de seguridad existentes o restaurar desde una copia de seguridad en cualquier momento.</li>
<li>Antes de cualquier operación de restauración, el estado actual se respalda automáticamente como medida de seguridad.</li>
</ol>
<h3 id="es-features-como-usar_2">Cómo usar</h3>
<p>Siga estos pasos para configurar y utilizar la función de copia de seguridad:</p>
<ol>
<li><strong>Habilite la función:</strong> La función de copia de seguridad está habilitada por defecto. Si es necesario, puede controlarla con el ajuste <code>USE_BACKUP</code>.</li>
<li><strong>Configure el cronograma de copia de seguridad:</strong> Elija la frecuencia con la que deben realizarse las copias de seguridad estableciendo el parámetro <code>BACKUP_SCHEDULE</code>.</li>
<li><strong>Establezca la política de retención:</strong> Especifique cuántas copias de seguridad conservar utilizando el ajuste <code>BACKUP_ROTATION</code>.</li>
<li><strong>Defina la ubicación de almacenamiento:</strong> Elija dónde se almacenarán las copias de seguridad utilizando el ajuste <code>BACKUP_DIRECTORY</code>.</li>
<li><strong>Use los comandos de la CLI:</strong> Gestione las copias de seguridad manualmente con los comandos <code>bwcli plugin backup</code> cuando sea necesario.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_2">Ajustes de configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BACKUP</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Habilitar copia de seguridad:</strong> Establezca en <code>yes</code> para habilitar las copias de seguridad automáticas.</td>
</tr>
<tr>
<td><code>BACKUP_SCHEDULE</code></td>
<td><code>daily</code></td>
<td>global</td>
<td>no</td>
<td><strong>Frecuencia de la copia de seguridad:</strong> Con qué frecuencia se realizan las copias de seguridad. Opciones: <code>daily</code>, <code>weekly</code> o <code>monthly</code>.</td>
</tr>
<tr>
<td><code>BACKUP_ROTATION</code></td>
<td><code>7</code></td>
<td>global</td>
<td>no</td>
<td><strong>Retención de copias de seguridad:</strong> El número de archivos de copia de seguridad que se deben conservar. Las copias de seguridad más antiguas que este número se eliminarán automáticamente.</td>
</tr>
<tr>
<td><code>BACKUP_DIRECTORY</code></td>
<td><code>/var/lib/bunkerweb/backups</code></td>
<td>global</td>
<td>no</td>
<td><strong>Ubicación de la copia de seguridad:</strong> El directorio donde se almacenarán los archivos de copia de seguridad.</td>
</tr>
</tbody>
</table>
<h3 id="es-features-interfaz-de-linea-de-comandos">Interfaz de línea de comandos</h3>
<p>El complemento de copia de seguridad proporciona varios comandos de la CLI para gestionar sus copias de seguridad:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Listar todas las copias de seguridad disponibles</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>list

<span class="c1"># Crear una copia de seguridad manual</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save

<span class="c1"># Crear una copia de seguridad en una ubicación personalizada</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save<span class="w"> </span>--directory<span class="w"> </span>/ruta/a/ubicacion/personalizada

<span class="c1"># Restaurar desde la copia de seguridad más reciente</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>restore

<span class="c1"># Restaurar desde un archivo de copia de seguridad específico</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>restore<span class="w"> </span>/ruta/a/copia/de/seguridad/backup-sqlite-2023-08-15_12-34-56.zip
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">La seguridad es lo primero</p>
</div>
<p>Antes de cualquier operación de restauración, el complemento de copia de seguridad crea automáticamente una copia de seguridad del estado actual de su base de datos en una ubicación temporal. Esto proporciona una protección adicional en caso de que necesite revertir la operación de restauración.</p>
<div class="admonition warning">
<p class="admonition-title">Compatibilidad de la base de datos</p>
</div>
<p>El complemento de copia de seguridad es compatible con las bases de datos SQLite, MySQL/MariaDB y PostgreSQL. Las bases de datos de Oracle no son compatibles actualmente para las operaciones de copia de seguridad y restauración.</p>
<h3 id="es-features-configuraciones-de-ejemplo_3">Configuraciones de ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="12:3"><input checked="checked" id="es-features-__tabbed_12_1" name="es-features-__tabbed_12" type="radio" /><input id="es-features-__tabbed_12_2" name="es-features-__tabbed_12" type="radio" /><input id="es-features-__tabbed_12_3" name="es-features-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_12_1">Copias de seguridad diarias con retención de 7 días</label><label for="es-features-__tabbed_12_2">Copias de seguridad semanales con retención extendida</label><label for="es-features-__tabbed_12_3">Copias de seguridad mensuales en una ubicación personalizada</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Configuración por defecto que crea copias de seguridad diarias y conserva los 7 archivos más recientes:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BACKUP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BACKUP_SCHEDULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;daily&quot;</span>
<span class="nt">BACKUP_ROTATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;7&quot;</span>
<span class="nt">BACKUP_DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/lib/bunkerweb/backups&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para copias de seguridad menos frecuentes con una retención más prolongada:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BACKUP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BACKUP_SCHEDULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;weekly&quot;</span>
<span class="nt">BACKUP_ROTATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;12&quot;</span>
<span class="nt">BACKUP_DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/lib/bunkerweb/backups&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para copias de seguridad mensuales almacenadas en una ubicación personalizada:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BACKUP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BACKUP_SCHEDULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;monthly&quot;</span>
<span class="nt">BACKUP_ROTATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;24&quot;</span>
<span class="nt">BACKUP_DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/mnt/backup-drive/bunkerweb-backups&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-backup-s3-pro">Backup S3 <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>Automatically backup your data to an S3 bucket</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BACKUP_S3</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable or disable the S3 backup feature</td>
</tr>
<tr>
<td><code>BACKUP_S3_SCHEDULE</code></td>
<td><code>daily</code></td>
<td>global</td>
<td>no</td>
<td>The frequency of the backup</td>
</tr>
<tr>
<td><code>BACKUP_S3_ROTATION</code></td>
<td><code>7</code></td>
<td>global</td>
<td>no</td>
<td>The number of backups to keep</td>
</tr>
<tr>
<td><code>BACKUP_S3_ENDPOINT</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 endpoint</td>
</tr>
<tr>
<td><code>BACKUP_S3_BUCKET</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 bucket</td>
</tr>
<tr>
<td><code>BACKUP_S3_DIR</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 directory</td>
</tr>
<tr>
<td><code>BACKUP_S3_REGION</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 region</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_ID</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 access key ID</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_SECRET</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 access key secret</td>
</tr>
<tr>
<td><code>BACKUP_S3_COMP_LEVEL</code></td>
<td><code>6</code></td>
<td>global</td>
<td>no</td>
<td>The compression level of the backup zip file</td>
</tr>
</tbody>
</table>
<h2 id="es-features-bad-behavior">Bad behavior</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de Mal Comportamiento protege su sitio web al detectar y bloquear automáticamente las direcciones IP que generan demasiados errores o códigos de estado HTTP "malos" dentro de un período de tiempo específico. Esto ayuda a defenderse contra ataques de fuerza bruta, raspadores web, escáneres de vulnerabilidades y otras actividades maliciosas que podrían generar numerosas respuestas de error.</p>
<p>Los atacantes a menudo generan códigos de estado HTTP "sospechosos" al sondear o explotar vulnerabilidades, códigos que un usuario típico es poco probable que active en un período de tiempo determinado. Al detectar este comportamiento, BunkerWeb puede bloquear automáticamente la dirección IP infractora, obligando al atacante a usar una nueva dirección IP para continuar sus intentos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>El complemento supervisa las respuestas HTTP de su sitio.</li>
<li>Cuando un visitante recibe un código de estado HTTP "malo" (como 400, 401, 403, 404, etc.), el contador para esa dirección IP se incrementa.</li>
<li>Si una dirección IP excede el umbral configurado de códigos de estado malos dentro del período de tiempo especificado, la IP se bloquea automáticamente.</li>
<li>Las IP bloqueadas pueden ser bloqueadas a nivel de servicio (solo para el sitio específico) o globalmente (en todos los sitios), dependiendo de su configuración.</li>
<li>Los bloqueos expiran automáticamente después de la duración de bloqueo configurada, o permanecen permanentes si se configuran con <code>0</code>.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Beneficios clave</p>
<ol>
<li><strong>Protección automática:</strong> Detecta y bloquea clientes potencialmente maliciosos sin requerir intervención manual.</li>
<li><strong>Reglas personalizables:</strong> Ajuste con precisión lo que constituye un "mal comportamiento" según sus necesidades específicas.</li>
<li><strong>Conservación de recursos:</strong> Evita que los actores maliciosos consuman recursos del servidor con repetidas solicitudes no válidas.</li>
<li><strong>Ámbito flexible:</strong> Elija si los bloqueos deben aplicarse solo al servicio actual o globalmente a todos los servicios.</li>
<li><strong>Control de la duración del bloqueo:</strong> Establezca bloqueos temporales que expiran automáticamente después de la duración configurada, o bloqueos permanentes que permanecen hasta que se eliminan manualmente.</li>
</ol>
</div>
<h3 id="es-features-como-usar_3">Cómo usar</h3>
<p>Siga estos pasos para configurar y utilizar la función de Mal Comportamiento:</p>
<ol>
<li><strong>Habilite la función:</strong> La función de Mal Comportamiento está habilitada por defecto. Si es necesario, puede controlarla con la configuración <code>USE_BAD_BEHAVIOR</code>.</li>
<li><strong>Configure los códigos de estado:</strong> Defina qué códigos de estado HTTP deben considerarse "malos" utilizando la configuración <code>BAD_BEHAVIOR_STATUS_CODES</code>.</li>
<li><strong>Establezca los valores de umbral:</strong> Determine cuántas respuestas "malas" deben desencadenar un bloqueo utilizando la configuración <code>BAD_BEHAVIOR_THRESHOLD</code>.</li>
<li><strong>Configure los períodos de tiempo:</strong> Especifique la duración para contar las respuestas malas y la duración del bloqueo utilizando las configuraciones <code>BAD_BEHAVIOR_COUNT_TIME</code> y <code>BAD_BEHAVIOR_BAN_TIME</code>.</li>
<li><strong>Elija el ámbito del bloqueo:</strong> Decida si los bloqueos deben aplicarse solo al servicio actual o globalmente a todos los servicios utilizando la configuración <code>BAD_BEHAVIOR_BAN_SCOPE</code>.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Modo Stream</p>
</div>
<p>En <strong>modo stream</strong>, solo el código de estado <code>444</code> se considera "malo" y activará este comportamiento.</p>
<h3 id="es-features-ajustes-de-configuracion_3">Ajustes de configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BAD_BEHAVIOR</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Mal Comportamiento:</strong> Establezca en <code>yes</code> para habilitar la función de detección y bloqueo de mal comportamiento.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_STATUS_CODES</code></td>
<td><code>400 401 403 404 405 429 444</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Códigos de estado malos:</strong> Lista de códigos de estado HTTP que se contarán como comportamiento "malo" cuando se devuelvan a un cliente.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_THRESHOLD</code></td>
<td><code>10</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Umbral:</strong> El número de códigos de estado "malos" que una IP puede generar dentro del período de conteo antes de ser bloqueada.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_COUNT_TIME</code></td>
<td><code>60</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Período de conteo:</strong> La ventana de tiempo (en segundos) durante la cual se cuentan los códigos de estado malos para alcanzar el umbral.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_BAN_TIME</code></td>
<td><code>86400</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Duración del bloqueo:</strong> Cuánto tiempo (en segundos) permanecerá bloqueada una IP después de exceder el umbral. El valor por defecto es de 24 horas (86400 segundos). Establezca en <code>0</code> para bloqueos permanentes que nunca expiran.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_BAN_SCOPE</code></td>
<td><code>service</code></td>
<td>global</td>
<td>no</td>
<td><strong>Ámbito del bloqueo:</strong> Determina si los bloqueos se aplican solo al servicio actual (<code>service</code>) o a todos los servicios (<code>global</code>).</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Falsos positivos</p>
</div>
<p>Tenga cuidado al establecer el umbral y el tiempo de conteo. Establecer estos valores demasiado bajos puede bloquear inadvertidamente a usuarios legítimos que encuentren errores mientras navegan por su sitio.</p>
<div class="admonition tip">
<p class="admonition-title">Ajuste de su configuración</p>
</div>
<p>Comience con configuraciones conservadoras (umbral más alto, tiempo de bloqueo más corto) y ajústelas según sus necesidades específicas y patrones de tráfico. Supervise sus registros para asegurarse de que los usuarios legítimos no sean bloqueados por error.</p>
<h3 id="es-features-configuraciones-de-ejemplo_4">Configuraciones de ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="13:4"><input checked="checked" id="es-features-__tabbed_13_1" name="es-features-__tabbed_13" type="radio" /><input id="es-features-__tabbed_13_2" name="es-features-__tabbed_13" type="radio" /><input id="es-features-__tabbed_13_3" name="es-features-__tabbed_13" type="radio" /><input id="es-features-__tabbed_13_4" name="es-features-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_13_1">Configuración por defecto</label><label for="es-features-__tabbed_13_2">Configuración estricta</label><label for="es-features-__tabbed_13_3">Configuración permisiva</label><label for="es-features-__tabbed_13_4">Configuración de bloqueo permanente</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>La configuración por defecto proporciona un enfoque equilibrado adecuado para la mayoría de los sitios web:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">444&quot;</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;service&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para aplicaciones de alta seguridad donde se desea ser más agresivo al bloquear amenazas potenciales:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">444</span><span class="nv"> </span><span class="s">500</span><span class="nv"> </span><span class="s">502</span><span class="nv"> </span><span class="s">503&quot;</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;120&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;604800&quot;</span><span class="w">  </span><span class="c1"># 7 días</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;global&quot;</span><span class="w"> </span><span class="c1"># Bloquear en todos los servicios</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para sitios con alto tráfico legítimo donde se desea evitar falsos positivos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">429&quot;</span><span class="w">  </span><span class="c1"># Solo contar no autorizados, prohibidos y con límite de velocidad</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span><span class="w">  </span><span class="c1"># 1 hora</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;service&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para escenarios donde desea que los atacantes detectados sean bloqueados permanentemente hasta que se desbloqueen manualmente:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">444&quot;</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w">  </span><span class="c1"># Bloqueo permanente (nunca expira)</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;global&quot;</span><span class="w"> </span><span class="c1"># Bloquear en todos los servicios</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-blacklist">Blacklist</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento de Lista Negra proporciona una protección robusta para su sitio web al bloquear el acceso basado en varios atributos del cliente. Esta función defiende contra entidades maliciosas conocidas, escáneres y visitantes sospechosos al denegar el acceso basado en direcciones IP, redes, entradas de DNS inverso, ASN, agentes de usuario y patrones de URI específicos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>El complemento comprueba las solicitudes entrantes contra múltiples criterios de la lista negra (direcciones IP, redes, rDNS, ASN, User-Agent o patrones de URI).</li>
<li>Las listas negras se pueden especificar directamente en su configuración o cargar desde URL externas.</li>
<li>Si un visitante coincide con alguna regla de la lista negra (y no coincide con ninguna regla de omisión), se le deniega el acceso.</li>
<li>Las listas negras se actualizan automáticamente en un horario regular desde las URL configuradas.</li>
<li>Puede personalizar exactamente qué criterios se comprueban y se omiten según sus necesidades de seguridad específicas.</li>
</ol>
<h3 id="es-features-como-usar_4">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Lista Negra:</p>
<ol>
<li><strong>Habilite la función:</strong> La función de Lista Negra está habilitada por defecto. Si es necesario, puede controlarla con el ajuste <code>USE_BLACKLIST</code>.</li>
<li><strong>Configure las reglas de bloqueo:</strong> Defina qué IP, redes, patrones de rDNS, ASN, User-Agents o URI deben ser bloqueados.</li>
<li><strong>Configure las reglas de omisión:</strong> Especifique cualquier excepción que deba omitir las comprobaciones de la lista negra.</li>
<li><strong>Añada fuentes externas:</strong> Configure las URL para descargar y actualizar automáticamente los datos de la lista negra.</li>
<li><strong>Supervise la eficacia:</strong> Consulte la <a href="#es-web-ui">interfaz de usuario web</a> para ver las estadísticas de las solicitudes bloqueadas.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">modo stream</p>
</div>
<p>Cuando se utiliza el modo stream, solo se realizarán comprobaciones de IP, rDNS y ASN.</p>
<h3 id="es-features-ajustes-de-configuracion_4">Ajustes de configuración</h3>
<p><strong>General</strong></p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BLACKLIST</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Lista Negra:</strong> Establezca en <code>yes</code> para habilitar la función de lista negra.</td>
</tr>
<tr>
<td><code>BLACKLIST_COMMUNITY_LISTS</code></td>
<td><code>ip:danmeuk-tor-exit ua:mitchellkrogza-bad-user-agents</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Listas Negras de la Comunidad:</strong> Seleccione listas negras preconfiguradas mantenidas por la comunidad para incluirlas en el bloqueo.</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="14:1"><input checked="checked" id="es-features-__tabbed_14_1" name="es-features-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_14_1">Listas Negras de la Comunidad</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Le permite añadir rápidamente listas negras bien mantenidas y de origen comunitario sin tener que configurar manualmente las URL.</p>
<pre><code>El ajuste `BLACKLIST_COMMUNITY_LISTS` le permite seleccionar de fuentes de listas negras curadas. Las opciones disponibles incluyen:
</code></pre>
<table>
<thead>
<tr>
<th>ID</th>
<th>Descripción</th>
<th>Fuente</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ip:laurent-minne-data-shield-aggressive</code></td>
<td>Lista de bloqueo de IPv4 de Data-Shield. DST = Europa</td>
<td></td>
</tr>
<tr>
<td><code>https://raw.githubusercontent.com/duggytuxy/Data-Shield_IPv4_Blocklist/refs/heads/main/prod_data-shield_ipv4_blocklist.txt</code></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>ip:danmeuk-tor-exit</code></td>
<td>IP de nodos de salida de Tor (dan.me.uk)</td>
<td><code>https://www.dan.me.uk/torlist/?exit</code></td>
</tr>
<tr>
<td><code>ua:mitchellkrogza-bad-user-agents</code></td>
<td>Nginx Block Bad Bots, Spam Referrer Blocker, Vulnerability Scanners, User-Agents, Malware, Adware, Ransomware, Malicious Sites, con anti-DDOS, Wordpress Theme Detector Blocking y Fail2Ban Jail para infractores reincidentes</td>
<td><code>https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list</code></td>
</tr>
</tbody>
</table>
<pre><code>**Configuración:** Especifique múltiples listas separadas por espacios. Por ejemplo:
```yaml
BLACKLIST_COMMUNITY_LISTS: "ip:danmeuk-tor-exit ua:mitchellkrogza-bad-user-agents"
```

!!! tip "Comunidad vs Configuración Manual"
    Las listas negras de la comunidad proporcionan una forma conveniente de empezar con fuentes de listas negras probadas. Puede usarlas junto con configuraciones de URL manuales para una máxima flexibilidad.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="15:1"><input checked="checked" id="es-features-__tabbed_15_1" name="es-features-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_15_1">Dirección IP</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Bloquea a los visitantes según su dirección IP o red.</p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista Negra de IP:</strong> Lista de direcciones IP o redes (notación CIDR) a bloquear, separadas por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista de Omisión de IP:</strong> Lista de direcciones IP o redes que deben omitir las comprobaciones de la lista negra de IP.</td>
</tr>
<tr>
<td><code>BLACKLIST_IP_URLS</code></td>
<td><code>https://www.dan.me.uk/torlist/?exit</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista Negra de IP:</strong> Lista de URL que contienen direcciones IP o redes a bloquear, separadas por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_IP_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista de Omisión de IP:</strong> Lista de URL que contienen direcciones IP o redes a omitir.</td>
</tr>
</tbody>
</table>
<pre><code>El ajuste por defecto de `BLACKLIST_IP_URLS` incluye una URL que proporciona una **lista de nodos de salida de Tor conocidos**. Esta es una fuente común de tráfico malicioso y es un buen punto de partida para muchos sitios.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="16:1"><input checked="checked" id="es-features-__tabbed_16_1" name="es-features-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_16_1">DNS Inverso</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Bloquea a los visitantes según su nombre de dominio inverso. Esto es útil para bloquear escáneres y rastreadores conocidos basados en los dominios de su organización.</p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_RDNS</code></td>
<td><code>.shodan.io .censys.io</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista Negra de rDNS:</strong> Lista de sufijos de DNS inverso a bloquear, separados por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_RDNS_GLOBAL</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Solo Global para rDNS:</strong> Solo realizar comprobaciones de rDNS en direcciones IP globales cuando se establece en <code>yes</code>.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_RDNS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista de Omisión de rDNS:</strong> Lista de sufijos de DNS inverso que deben omitir las comprobaciones de la lista negra de rDNS.</td>
</tr>
<tr>
<td><code>BLACKLIST_RDNS_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista Negra de rDNS:</strong> Lista de URL que contienen sufijos de DNS inverso a bloquear, separadas por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_RDNS_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista de Omisión de rDNS:</strong> Lista de URL que contienen sufijos de DNS inverso a omitir.</td>
</tr>
</tbody>
</table>
<pre><code>El ajuste por defecto de `BLACKLIST_RDNS` incluye dominios de escáneres comunes como **Shodan** y **Censys**. Estos son a menudo utilizados por investigadores de seguridad y escáneres para identificar sitios vulnerables.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="17:1"><input checked="checked" id="es-features-__tabbed_17_1" name="es-features-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_17_1">ASN</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Bloquea a los visitantes de proveedores de red específicos. Los ASN son como los códigos postales de Internet: identifican a qué proveedor u organización pertenece una IP.</p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista Negra de ASN:</strong> Lista de Números de Sistema Autónomo a bloquear, separados por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista de Omisión de ASN:</strong> Lista de ASN que deben omitir las comprobaciones de la lista negra de ASN.</td>
</tr>
<tr>
<td><code>BLACKLIST_ASN_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista Negra de ASN:</strong> Lista de URL que contienen ASN a bloquear, separadas por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_ASN_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista de Omisión de ASN:</strong> Lista de URL que contienen ASN a omitir.</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="18:1"><input checked="checked" id="es-features-__tabbed_18_1" name="es-features-__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_18_1">Agente de Usuario</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Bloquea a los visitantes según el navegador o la herramienta que dicen estar usando. Esto es efectivo contra los bots que se identifican honestamente (como "ScannerBot" o "WebHarvestTool").</p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista Negra de User-Agent:</strong> Lista de patrones de User-Agent (expresión regular PCRE) a bloquear, separados por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista de Omisión de User-Agent:</strong> Lista de patrones de User-Agent que deben omitir las comprobaciones de la lista negra de User-Agent.</td>
</tr>
<tr>
<td><code>BLACKLIST_USER_AGENT_URLS</code></td>
<td><code>https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista Negra de User-Agent:</strong> Lista de URL que contienen patrones de User-Agent a bloquear.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_USER_AGENT_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista de Omisión de User-Agent:</strong> Lista de URL que contienen patrones de User-Agent a omitir.</td>
</tr>
</tbody>
</table>
<pre><code>El ajuste por defecto de `BLACKLIST_USER_AGENT_URLS` incluye una URL que proporciona una **lista de agentes de usuario maliciosos conocidos**. Estos son a menudo utilizados por bots y escáneres maliciosos para identificar sitios vulnerables.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="19:1"><input checked="checked" id="es-features-__tabbed_19_1" name="es-features-__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_19_1">URI</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Bloquea las solicitudes a URL específicas en su sitio. Esto es útil para bloquear intentos de acceso a páginas de administración, formularios de inicio de sesión u otras áreas sensibles que podrían ser objetivo de ataques.</p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista Negra de URI:</strong> Lista de patrones de URI (expresión regular PCRE) a bloquear, separados por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista de Omisión de URI:</strong> Lista de patrones de URI que deben omitir las comprobaciones de la lista negra de URI.</td>
</tr>
<tr>
<td><code>BLACKLIST_URI_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista Negra de URI:</strong> Lista de URL que contienen patrones de URI a bloquear, separadas por espacios.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_URI_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista de Omisión de URI:</strong> Lista de URL que contienen patrones de URI a omitir.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Soporte de Formato de URL</p>
</div>
<p>Todos los ajustes <code>*_URLS</code> admiten URL HTTP/HTTPS así como rutas de archivos locales usando el prefijo <code>file:///</code>. Se admite la autenticación básica usando el formato <code>http://usuario:contraseña@url</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Actualizaciones Regulares</p>
</div>
<p>Las listas negras de las URL se descargan y actualizan automáticamente cada hora para asegurar que su protección se mantenga actualizada contra las últimas amenazas.</p>
<h3 id="es-features-configuraciones-de-ejemplo_5">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="20:3"><input checked="checked" id="es-features-__tabbed_20_1" name="es-features-__tabbed_20" type="radio" /><input id="es-features-__tabbed_20_2" name="es-features-__tabbed_20" type="radio" /><input id="es-features-__tabbed_20_3" name="es-features-__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_20_1">Protección Básica de IP y User-Agent</label><label for="es-features-__tabbed_20_2">Protección Avanzada con Reglas Personalizadas</label><label for="es-features-__tabbed_20_3">Usando Archivos Locales</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que bloquea los nodos de salida de Tor conocidos y los agentes de usuario maliciosos comunes usando listas negras de la comunidad:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BLACKLIST_COMMUNITY_LISTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ip:danmeuk-tor-exit</span><span class="nv"> </span><span class="s">ua:mitchellkrogza-bad-user-agents&quot;</span>
</code></pre></div>
<p>Alternativamente, puede usar la configuración manual de URL:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BLACKLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://www.dan.me.uk/torlist/?exit&quot;</span>
<span class="nt">BLACKLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración más completa con entradas de lista negra personalizadas y excepciones:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Entradas de lista negra personalizadas</span>
<span class="nt">BLACKLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.100</span><span class="nv"> </span><span class="s">203.0.113.0/24&quot;</span>
<span class="nt">BLACKLIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.shodan.io</span><span class="nv"> </span><span class="s">.censys.io</span><span class="nv"> </span><span class="s">.scanner.com&quot;</span>
<span class="nt">BLACKLIST_ASN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16509</span><span class="nv"> </span><span class="s">14618&quot;</span><span class="w">  </span><span class="c1"># ASN de AWS y Amazon</span>
<span class="nt">BLACKLIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)SemrushBot(?:\b)</span><span class="nv"> </span><span class="s">(?:\b)AhrefsBot(?:\b)&quot;</span>
<span class="nt">BLACKLIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/wp-login</span><span class="err">\</span><span class="s">.php$</span><span class="nv"> </span><span class="s">^/administrator/&quot;</span>

<span class="c1"># Reglas de omisión personalizadas</span>
<span class="nt">BLACKLIST_IGNORE_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.200</span><span class="nv"> </span><span class="s">203.0.113.42&quot;</span>

<span class="c1"># Fuentes de listas negras externas</span>
<span class="nt">BLACKLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://www.dan.me.uk/torlist/?exit</span><span class="nv"> </span><span class="s">https://www.spamhaus.org/drop/drop.txt&quot;</span>
<span class="nt">BLACKLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración usando archivos locales para las listas negras:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BLACKLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/ip-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_RDNS_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/rdns-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_ASN_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/asn-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/user-agent-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_URI_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/uri-blacklist.txt&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-brotli">Brotli</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento Brotli permite la compresión eficiente de las respuestas HTTP utilizando el algoritmo Brotli. Esta función ayuda a reducir el uso de ancho de banda y a mejorar los tiempos de carga de la página al comprimir el contenido web antes de que se envíe al navegador del cliente.</p>
<p>En comparación con otros métodos de compresión como gzip, Brotli suele alcanzar mayores tasas de compresión, lo que se traduce en archivos de menor tamaño y una entrega de contenido más rápida.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un cliente solicita contenido de su sitio web, BunkerWeb comprueba si el cliente admite la compresión Brotli.</li>
<li>Si es compatible, BunkerWeb comprime la respuesta utilizando el algoritmo Brotli en el nivel de compresión que haya configurado.</li>
<li>El contenido comprimido se envía al cliente con las cabeceras adecuadas que indican la compresión Brotli.</li>
<li>El navegador del cliente descomprime el contenido antes de mostrarlo al usuario.</li>
<li>Tanto el uso de ancho de banda como los tiempos de carga de la página se reducen, mejorando la experiencia general del usuario.</li>
</ol>
<h3 id="es-features-como-usar_5">Cómo usar</h3>
<p>Siga estos pasos para configurar y utilizar la función de compresión Brotli:</p>
<ol>
<li><strong>Habilite la función:</strong> La función Brotli está desactivada por defecto. Habilítela estableciendo el ajuste <code>USE_BROTLI</code> en <code>yes</code>.</li>
<li><strong>Configure los tipos MIME:</strong> Especifique qué tipos de contenido deben comprimirse utilizando el ajuste <code>BROTLI_TYPES</code>.</li>
<li><strong>Establezca el tamaño mínimo:</strong> Defina el tamaño mínimo de respuesta para la compresión con <code>BROTLI_MIN_LENGTH</code> para evitar comprimir archivos muy pequeños.</li>
<li><strong>Elija el nivel de compresión:</strong> Seleccione su equilibrio preferido entre velocidad y tasa de compresión con <code>BROTLI_COMP_LEVEL</code>.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, la compresión se realiza automáticamente para las respuestas que cumplan los requisitos.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_5">Ajustes de configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BROTLI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Brotli:</strong> Establezca en <code>yes</code> para habilitar la compresión Brotli.</td>
</tr>
<tr>
<td><code>BROTLI_TYPES</code></td>
<td><code>application/atom+xml application/javascript application/json application/rss+xml application/vnd.ms-fontobject application/x-font-opentype application/x-font-truetype application/x-font-ttf application/x-javascript application/xhtml+xml application/xml font/eot font/opentype font/otf font/truetype image/svg+xml image/vnd.microsoft.icon image/x-icon image/x-win-bitmap text/css text/javascript text/plain text/xml</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tipos MIME:</strong> Lista de tipos de contenido que se comprimirán con Brotli.</td>
</tr>
<tr>
<td><code>BROTLI_MIN_LENGTH</code></td>
<td><code>1000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tamaño mínimo:</strong> El tamaño mínimo de respuesta (en bytes) para que se aplique la compresión Brotli.</td>
</tr>
<tr>
<td><code>BROTLI_COMP_LEVEL</code></td>
<td><code>6</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Nivel de compresión:</strong> Nivel de compresión de 0 (sin compresión) a 11 (compresión máxima). Los valores más altos consumen más CPU.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimización del nivel de compresión</p>
</div>
<p>El nivel de compresión por defecto (6) ofrece un buen equilibrio entre la tasa de compresión y el uso de la CPU. Para contenido estático o cuando los recursos de la CPU del servidor son abundantes, considere aumentarlo a 9-11 para una compresión máxima. Para contenido dinámico o cuando los recursos de la CPU son limitados, es posible que desee utilizar 4-5 para una compresión más rápida con una reducción de tamaño razonable.</p>
<div class="admonition info">
<p class="admonition-title">Soporte de navegadores</p>
</div>
<p>Brotli es compatible con todos los navegadores modernos, incluidos Chrome, Firefox, Edge, Safari y Opera. Los navegadores más antiguos recibirán automáticamente el contenido sin comprimir, lo que garantiza la compatibilidad.</p>
<h3 id="es-features-configuraciones-de-ejemplo_6">Configuraciones de ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="21:3"><input checked="checked" id="es-features-__tabbed_21_1" name="es-features-__tabbed_21" type="radio" /><input id="es-features-__tabbed_21_2" name="es-features-__tabbed_21" type="radio" /><input id="es-features-__tabbed_21_3" name="es-features-__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_21_1">Configuración básica</label><label for="es-features-__tabbed_21_2">Compresión máxima</label><label for="es-features-__tabbed_21_3">Rendimiento equilibrado</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración estándar que habilita Brotli con los ajustes por defecto:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BROTLI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BROTLI_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">application/xhtml+xml</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">BROTLI_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">BROTLI_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración optimizada para un ahorro máximo de compresión:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BROTLI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BROTLI_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/atom+xml</span><span class="nv"> </span><span class="s">application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/rss+xml</span><span class="nv"> </span><span class="s">application/vnd.ms-fontobject</span><span class="nv"> </span><span class="s">application/x-font-opentype</span><span class="nv"> </span><span class="s">application/x-font-truetype</span><span class="nv"> </span><span class="s">application/x-font-ttf</span><span class="nv"> </span><span class="s">application/x-javascript</span><span class="nv"> </span><span class="s">application/xhtml+xml</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">font/eot</span><span class="nv"> </span><span class="s">font/opentype</span><span class="nv"> </span><span class="s">font/otf</span><span class="nv"> </span><span class="s">font/truetype</span><span class="nv"> </span><span class="s">image/svg+xml</span><span class="nv"> </span><span class="s">image/vnd.microsoft.icon</span><span class="nv"> </span><span class="s">image/x-icon</span><span class="nv"> </span><span class="s">image/x-win-bitmap</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">BROTLI_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">BROTLI_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;11&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que equilibra la tasa de compresión con el uso de la CPU:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BROTLI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BROTLI_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain&quot;</span>
<span class="nt">BROTLI_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">BROTLI_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-bunkernet">BunkerNet</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento BunkerNet permite el intercambio colectivo de inteligencia sobre amenazas entre las instancias de BunkerWeb, creando una poderosa red de protección contra actores maliciosos. Al participar en BunkerNet, su instancia se beneficia y contribuye a una base de datos global de amenazas conocidas, mejorando la seguridad para toda la comunidad de BunkerWeb.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Su instancia de BunkerWeb se registra automáticamente con la API de BunkerNet para recibir un identificador único.</li>
<li>Cuando su instancia detecta y bloquea una dirección IP o comportamiento malicioso, informa anónimamente la amenaza a BunkerNet.</li>
<li>BunkerNet agrega la inteligencia sobre amenazas de todas las instancias participantes y distribuye la base de datos consolidada.</li>
<li>Su instancia descarga regularmente una base de datos actualizada de amenazas conocidas desde BunkerNet.</li>
<li>Esta inteligencia colectiva permite que su instancia bloquee proactivamente las direcciones IP que han exhibido comportamiento malicioso en otras instancias de BunkerWeb.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Beneficios clave</p>
<ol>
<li><strong>Defensa Colectiva:</strong> Aproveche los hallazgos de seguridad de miles de otras instancias de BunkerWeb a nivel mundial.</li>
<li><strong>Protección Proactiva:</strong> Bloquee a los actores maliciosos antes de que puedan atacar su sitio basándose en su comportamiento en otros lugares.</li>
<li><strong>Contribución a la Comunidad:</strong> Ayude a proteger a otros usuarios de BunkerWeb compartiendo datos de amenazas anónimos sobre los atacantes.</li>
<li><strong>Cero Configuración:</strong> Funciona desde el primer momento con valores predeterminados sensatos, requiriendo una configuración mínima.</li>
<li><strong>Enfoque en la Privacidad:</strong> Solo comparte la información de amenazas necesaria sin comprometer su privacidad ni la de sus usuarios.</li>
</ol>
</div>
<h3 id="es-features-como-usar_6">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función BunkerNet:</p>
<ol>
<li><strong>Habilite la función:</strong> La función BunkerNet está habilitada por defecto. Si es necesario, puede controlarla con la configuración <code>USE_BUNKERNET</code>.</li>
<li><strong>Registro inicial:</strong> En el primer arranque, su instancia se registrará automáticamente con la API de BunkerNet y recibirá un identificador único.</li>
<li><strong>Actualizaciones automáticas:</strong> Su instancia descargará automáticamente la última base de datos de amenazas en un horario regular.</li>
<li><strong>Informes automáticos:</strong> Cuando su instancia bloquee una dirección IP maliciosa, contribuirá automáticamente estos datos a la comunidad.</li>
<li><strong>Monitoree la protección:</strong> Consulte la <a href="#es-web-ui">interfaz de usuario web</a> para ver estadísticas sobre las amenazas bloqueadas por la inteligencia de BunkerNet.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_6">Ajustes de configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BUNKERNET</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar BunkerNet:</strong> Establezca en <code>yes</code> para habilitar el intercambio de inteligencia sobre amenazas de BunkerNet.</td>
</tr>
<tr>
<td><code>BUNKERNET_SERVER</code></td>
<td><code>https://api.bunkerweb.io</code></td>
<td>global</td>
<td>no</td>
<td><strong>Servidor BunkerNet:</strong> La dirección del servidor de la API de BunkerNet para compartir inteligencia sobre amenazas.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Protección de Red</p>
</div>
<p>Cuando BunkerNet detecta que una dirección IP ha estado involucrada en actividades maliciosas en múltiples instancias de BunkerWeb, añade esa IP a una lista negra colectiva. Esto proporciona una capa de defensa proactiva, protegiendo su sitio de amenazas antes de que puedan atacarlo directamente.</p>
<div class="admonition info">
<p class="admonition-title">Informes Anónimos</p>
</div>
<p>Al informar sobre amenazas a BunkerNet, su instancia solo comparte los datos necesarios para identificar la amenaza: la dirección IP, el motivo del bloqueo y datos contextuales mínimos. No se comparte información personal sobre sus usuarios ni detalles sensibles sobre su sitio.</p>
<h3 id="es-features-configuraciones-de-ejemplo_7">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="22:3"><input checked="checked" id="es-features-__tabbed_22_1" name="es-features-__tabbed_22" type="radio" /><input id="es-features-__tabbed_22_2" name="es-features-__tabbed_22" type="radio" /><input id="es-features-__tabbed_22_3" name="es-features-__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_22_1">Configuración por Defecto (Recomendada)</label><label for="es-features-__tabbed_22_2">Configuración Deshabilitada</label><label for="es-features-__tabbed_22_3">Configuración de Servidor Personalizado</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>La configuración por defecto habilita BunkerNet con el servidor oficial de la API de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BUNKERNET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BUNKERNET_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://api.bunkerweb.io&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Si prefiere no participar en la red de inteligencia sobre amenazas de BunkerNet:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BUNKERNET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para organizaciones que ejecutan su propio servidor BunkerNet (poco común):</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BUNKERNET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BUNKERNET_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://bunkernet.example.com&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="es-features-integracion-con-la-consola-de-crowdsec">Integración con la Consola de CrowdSec</h3>
<p>Si aún no está familiarizado con la integración de la Consola de CrowdSec, <a href="https://www.crowdsec.net/?utm_campaign=bunkerweb&amp;utm_source=doc">CrowdSec</a> aprovecha la inteligencia colectiva para combatir las ciberamenazas. Piense en ello como el "Waze de la ciberseguridad": cuando un servidor es atacado, otros sistemas en todo el mundo son alertados y protegidos de los mismos atacantes. Puede obtener más información al respecto <a href="https://www.crowdsec.net/about?utm_campaign=bunkerweb&amp;utm_source=blog">aquí</a>.</p>
<p>A través de nuestra asociación con CrowdSec, puede inscribir sus instancias de BunkerWeb en su <a href="https://app.crowdsec.net/signup?utm_source=external-blog&amp;utm_medium=cta&amp;utm_campaign=bunker-web-integration">Consola de CrowdSec</a>. Esto significa que los ataques bloqueados por BunkerWeb serán visibles en su Consola de CrowdSec junto con los ataques bloqueados por los Motores de Seguridad de CrowdSec, brindándole una vista unificada de las amenazas.</p>
<p>Es importante destacar que no es necesario instalar CrowdSec para esta integración (aunque recomendamos encarecidamente probarlo con el <a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/crowdsec">complemento de CrowdSec para BunkerWeb</a> para mejorar aún más la seguridad de sus servicios web). Además, puede inscribir sus Motores de Seguridad de CrowdSec en la misma cuenta de la Consola para una sinergia aún mayor.</p>
<p><strong>Paso #1: Cree su cuenta en la Consola de CrowdSec</strong></p>
<p>Vaya a la <a href="https://app.crowdsec.net/signup?utm_source=external-blog&amp;utm_medium=cta&amp;utm_campaign=bunker-web-integration">Consola de CrowdSec</a> y regístrese si aún no tiene una cuenta. Una vez hecho esto, anote la clave de inscripción que se encuentra en "Security Engines" después de hacer clic en "Add Security Engine":</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/crowdity1.png" />
  </p>
<figcaption>Obtenga su clave de inscripción de la Consola de CrowdSec</figcaption>
</figure>
<p><strong>Paso #2: Obtenga su ID de BunkerNet</strong></p>
<p>Activar la función BunkerNet (habilitada por defecto) es obligatorio si desea inscribir su(s) instancia(s) de BunkerWeb en su Consola de CrowdSec. Habilítela estableciendo <code>USE_BUNKERNET</code> en <code>yes</code>.</p>
<p>Para Docker, obtenga su ID de BunkerNet usando:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>mi-bw-scheduler<span class="w"> </span>cat<span class="w"> </span>/var/cache/bunkerweb/bunkernet/instance.id
</code></pre></div>
<p>Para Linux, use:</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/var/cache/bunkerweb/bunkernet/instance.id
</code></pre></div>
<p><strong>Paso #3: Inscriba su instancia usando el Panel</strong></p>
<p>Una vez que tenga su ID de BunkerNet y la clave de inscripción de la Consola de CrowdSec, <a href="https://panel.bunkerweb.io/store/bunkernet?utm_campaign=self&amp;utm_source=doc">solicite el producto gratuito "BunkerNet / CrowdSec" en el Panel</a>. Es posible que se le pida que cree una cuenta si aún no lo ha hecho.</p>
<p>Ahora puede seleccionar el servicio "BunkerNet / CrowdSec" y completar el formulario pegando su ID de BunkerNet y la clave de inscripción de la Consola de CrowdSec:</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/crowdity2.png" />
  </p>
<figcaption>Inscriba su instancia de BunkerWeb en la Consola de CrowdSec</figcaption>
</figure>
<p><strong>Paso #4: Acepte el nuevo motor de seguridad en la Consola</strong></p>
<p>Luego, vuelva a su Consola de CrowdSec y acepte el nuevo Motor de Seguridad:</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/crowdity3.png" />
  </p>
<figcaption>Acepte la inscripción en la Consola de CrowdSec</figcaption>
</figure>
<p><strong>¡Felicitaciones, su instancia de BunkerWeb ahora está inscrita en su Consola de CrowdSec!</strong></p>
<p>Consejo profesional: Al ver sus alertas, haga clic en la opción "columnas" y marque la casilla "contexto" para acceder a datos específicos de BunkerWeb.</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/crowdity4.png" />
  </p>
<figcaption>Datos de BunkerWeb mostrados en la columna de contexto</figcaption>
</figure>
<h2 id="es-features-cors">CORS</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento CORS habilita el Intercambio de Recursos de Origen Cruzado para su sitio web, permitiendo un acceso controlado a sus recursos desde diferentes dominios. Esta característica le ayuda a compartir su contenido de forma segura con sitios web de terceros de confianza, manteniendo la seguridad al definir explícitamente qué orígenes, métodos y encabezados están permitidos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un navegador realiza una solicitud de origen cruzado a su sitio web, primero envía una solicitud de comprobación previa (preflight) con el método <code>OPTIONS</code>.</li>
<li>BunkerWeb comprueba si el origen solicitante está permitido según su configuración.</li>
<li>Si está permitido, BunkerWeb responde con los encabezados CORS apropiados que definen lo que el sitio solicitante puede hacer.</li>
<li>Para los orígenes no permitidos, la solicitud puede ser denegada por completo o servida sin los encabezados CORS.</li>
<li>Se pueden configurar políticas adicionales de origen cruzado, como <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy">COEP</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy">COOP</a> y <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Resource-Policy">CORP</a>, para mejorar aún más la seguridad.</li>
</ol>
<h3 id="es-features-como-usar_7">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función CORS:</p>
<ol>
<li><strong>Habilite la función:</strong> La función CORS está deshabilitada por defecto. Establezca el ajuste <code>USE_CORS</code> en <code>yes</code> para habilitarla.</li>
<li><strong>Configure los orígenes permitidos:</strong> Especifique qué dominios pueden acceder a sus recursos utilizando el ajuste <code>CORS_ALLOW_ORIGIN</code>.</li>
<li><strong>Establezca los métodos permitidos:</strong> Defina qué métodos HTTP están permitidos para las solicitudes de origen cruzado con <code>CORS_ALLOW_METHODS</code>.</li>
<li><strong>Configure los encabezados permitidos:</strong> Especifique qué encabezados se pueden usar en las solicitudes con <code>CORS_ALLOW_HEADERS</code>.</li>
<li><strong>Controle las credenciales:</strong> Decida si las solicitudes de origen cruzado pueden incluir credenciales utilizando <code>CORS_ALLOW_CREDENTIALS</code>.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_7">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CORS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar CORS:</strong> Establezca en <code>yes</code> para habilitar el Intercambio de Recursos de Origen Cruzado.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_ORIGIN</code></td>
<td><code>self</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Orígenes Permitidos:</strong> Expresión regular PCRE que representa los orígenes permitidos; use <code>*</code> para cualquier origen, o <code>self</code> solo para el mismo origen.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_METHODS</code></td>
<td><code>GET, POST, OPTIONS</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Métodos Permitidos:</strong> Métodos HTTP que se pueden usar en solicitudes de origen cruzado.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_HEADERS</code></td>
<td><code>DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Encabezados Permitidos:</strong> Encabezados HTTP que se pueden usar en solicitudes de origen cruzado.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_CREDENTIALS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Permitir Credenciales:</strong> Establezca en <code>yes</code> para permitir credenciales (cookies, autenticación HTTP) en solicitudes CORS.</td>
</tr>
<tr>
<td><code>CORS_EXPOSE_HEADERS</code></td>
<td><code>Content-Length,Content-Range</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Encabezados Expuestos:</strong> Encabezados HTTP a los que los navegadores pueden acceder desde respuestas de origen cruzado.</td>
</tr>
<tr>
<td><code>CROSS_ORIGIN_OPENER_POLICY</code></td>
<td><code>same-origin</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cross-Origin-Opener-Policy:</strong> Controla la comunicación entre contextos de navegación.</td>
</tr>
<tr>
<td><code>CROSS_ORIGIN_EMBEDDER_POLICY</code></td>
<td><code>require-corp</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cross-Origin-Embedder-Policy:</strong> Controla si un documento puede cargar recursos de otros orígenes.</td>
</tr>
<tr>
<td><code>CROSS_ORIGIN_RESOURCE_POLICY</code></td>
<td><code>same-site</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cross-Origin-Resource-Policy:</strong> Controla qué sitios web pueden incrustar sus recursos.</td>
</tr>
<tr>
<td><code>CORS_MAX_AGE</code></td>
<td><code>86400</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Duración de la Caché de Preflight:</strong> Cuánto tiempo (en segundos) los navegadores deben almacenar en caché la respuesta de preflight.</td>
</tr>
<tr>
<td><code>CORS_DENY_REQUEST</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Denegar Orígenes No Autorizados:</strong> Cuando es <code>yes</code>, las solicitudes de orígenes no autorizados se deniegan con un código de error.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimizando las Solicitudes de Preflight</p>
</div>
<p>El ajuste <code>CORS_MAX_AGE</code> determina cuánto tiempo los navegadores almacenarán en caché los resultados de una solicitud de preflight. Establecer esto en un valor más alto (como el predeterminado de 86400 segundos/24 horas) reduce el número de solicitudes de preflight, mejorando el rendimiento para los recursos a los que se accede con frecuencia.</p>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de Seguridad</p>
</div>
<p>Tenga cuidado al establecer <code>CORS_ALLOW_ORIGIN</code> en <code>*</code> (todos los orígenes) o <code>CORS_ALLOW_CREDENTIALS</code> en <code>yes</code> porque estas configuraciones pueden introducir riesgos de seguridad si no se gestionan adecuadamente. Generalmente es más seguro enumerar explícitamente los orígenes de confianza y limitar los métodos y encabezados permitidos.</p>
<h3 id="es-features-configuraciones-de-ejemplo_8">Configuraciones de Ejemplo</h3>
<p>Aquí hay ejemplos de posibles valores para el ajuste <code>CORS_ALLOW_ORIGIN</code>, junto con su comportamiento:</p>
<ul>
<li><strong><code>*</code></strong>: Permite solicitudes de todos los orígenes.</li>
<li><strong><code>self</code></strong>: Permite automáticamente solicitudes del mismo origen que el <code>server_name</code> configurado.</li>
<li><strong><code>^https://www\.example\.com$</code></strong>: Permite solicitudes solo de <code>https://www.example.com</code>.</li>
<li><strong><code>^https://.+\.example\.com$</code></strong>: Permite solicitudes de cualquier subdominio que termine en <code>.example.com</code>.</li>
<li><strong><code>^https://(www\.example1\.com|www\.example2\.com)$</code></strong>: Permite solicitudes de <code>https://www.example1.com</code> o <code>https://www.example2.com</code>.</li>
<li><strong><code>^https?://www\.example\.com$</code></strong>: Permite solicitudes tanto de <code>https://www.example.com</code> como de <code>http://www.example.com</code>.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="23:5"><input checked="checked" id="es-features-__tabbed_23_1" name="es-features-__tabbed_23" type="radio" /><input id="es-features-__tabbed_23_2" name="es-features-__tabbed_23" type="radio" /><input id="es-features-__tabbed_23_3" name="es-features-__tabbed_23" type="radio" /><input id="es-features-__tabbed_23_4" name="es-features-__tabbed_23" type="radio" /><input id="es-features-__tabbed_23_5" name="es-features-__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_23_1">Configuración Básica</label><label for="es-features-__tabbed_23_2">Configuración de API Pública</label><label for="es-features-__tabbed_23_3">Múltiples Dominios de Confianza</label><label for="es-features-__tabbed_23_4">Comodín de Subdominio</label><label for="es-features-__tabbed_23_5">Múltiples Patrones de Dominio</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que permite solicitudes de origen cruzado desde el mismo dominio:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;self&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para una API pública que necesita ser accesible desde cualquier origen:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">X-API-Key&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para permitir múltiples dominios específicos con un único patrón de expresión regular PCRE:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^https://(app|api|dashboard)\\.example\\.com$&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">PUT,</span><span class="nv"> </span><span class="s">DELETE,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization,</span><span class="nv"> </span><span class="s">X-Requested-With&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_EXPOSE_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Length,</span><span class="nv"> </span><span class="s">Content-Range,</span><span class="nv"> </span><span class="s">X-RateLimit-Remaining&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que permite todos los subdominios de un dominio principal utilizando un patrón de expresión regular PCRE:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^https://.*\\.example\\.com$&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que permite solicitudes de múltiples patrones de dominio con alternancia:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^https://(.*\\.example\\.com|.*\\.trusted-partner\\.org|api\\.third-party\\.net)$&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">PUT,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization,</span><span class="nv"> </span><span class="s">X-Custom-Header&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-client-cache">Client cache</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento de Caché del Cliente optimiza el rendimiento del sitio web al controlar cómo los navegadores almacenan en caché el contenido estático. Reduce el uso de ancho de banda, disminuye la carga del servidor y mejora los tiempos de carga de la página al indicar a los navegadores que almacenen y reutilicen activos estáticos —como imágenes, archivos CSS y JavaScript— localmente en lugar de solicitarlos en cada visita a la página.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando está habilitado, BunkerWeb agrega encabezados <code>Cache-Control</code> a las respuestas para archivos estáticos.</li>
<li>Estos encabezados le dicen a los navegadores por cuánto tiempo deben almacenar el contenido en caché localmente.</li>
<li>Para los archivos con extensiones específicas (como imágenes, CSS, JavaScript), BunkerWeb aplica la política de almacenamiento en caché configurada.</li>
<li>El soporte opcional de ETag proporciona un mecanismo de validación adicional para determinar si el contenido en caché todavía está actualizado.</li>
<li>Cuando los visitantes regresan a su sitio, sus navegadores pueden usar los archivos almacenados en caché localmente en lugar de descargarlos nuevamente, lo que resulta en tiempos de carga de página más rápidos.</li>
</ol>
<h3 id="es-features-como-usar_8">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Caché del Cliente:</p>
<ol>
<li><strong>Habilite la función:</strong> La función de Caché del Cliente está deshabilitada por defecto; establezca la configuración <code>USE_CLIENT_CACHE</code> en <code>yes</code> para habilitarla.</li>
<li><strong>Configure las extensiones de archivo:</strong> Especifique qué tipos de archivo deben almacenarse en caché utilizando la configuración <code>CLIENT_CACHE_EXTENSIONS</code>.</li>
<li><strong>Establezca las directivas de control de caché:</strong> Personalice cómo los clientes deben almacenar el contenido en caché utilizando la configuración <code>CLIENT_CACHE_CONTROL</code>.</li>
<li><strong>Configure el soporte de ETag:</strong> Decida si habilitar los ETags para validar la frescura de la caché con la configuración <code>CLIENT_CACHE_ETAG</code>.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, los encabezados de caché se aplican automáticamente a las respuestas elegibles.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_8">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CLIENT_CACHE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Caché del Cliente:</strong> Establezca en <code>yes</code> para habilitar el almacenamiento en caché del lado del cliente de los archivos estáticos.</td>
</tr>
<tr>
<td><code>CLIENT_CACHE_EXTENSIONS</code></td>
<td><code>jpg                       | jpeg      | png      | bmp                                                                                                                                            | ico | svg | tif | css | js | otf | ttf | eot | woff | woff2</code></td>
<td>global</td>
<td>no</td>
<td><strong>Extensiones Cacheadas:</strong> Lista de extensiones de archivo (separadas por barras verticales) que deben ser almacenadas en caché por el cliente.</td>
</tr>
<tr>
<td><code>CLIENT_CACHE_CONTROL</code></td>
<td><code>public, max-age=15552000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Encabezado Cache-Control:</strong> Valor para el encabezado HTTP Cache-Control para controlar el comportamiento del almacenamiento en caché.</td>
</tr>
<tr>
<td><code>CLIENT_CACHE_ETAG</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar ETags:</strong> Establezca en <code>yes</code> para enviar el encabezado HTTP ETag para los recursos estáticos.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimizando los Ajustes de Caché</p>
</div>
<p>Para contenido que se actualiza con frecuencia, considere usar valores de <code>max-age</code> más cortos. Para contenido que cambia raramente (como bibliotecas de JavaScript versionadas o logotipos), use tiempos de caché más largos. El valor por defecto de 15552000 segundos (180 días) es apropiado para la mayoría de los activos estáticos.</p>
<div class="admonition info">
<p class="admonition-title">Comportamiento del Navegador</p>
</div>
<p>Diferentes navegadores implementan el almacenamiento en caché de manera ligeramente diferente, pero todos los navegadores modernos respetan las directivas estándar de <code>Cache-Control</code>. Los ETags proporcionan un mecanismo de validación adicional que ayuda a los navegadores a determinar si el contenido en caché sigue siendo válido.</p>
<h3 id="es-features-configuraciones-de-ejemplo_9">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="24:3"><input checked="checked" id="es-features-__tabbed_24_1" name="es-features-__tabbed_24" type="radio" /><input id="es-features-__tabbed_24_2" name="es-features-__tabbed_24" type="radio" /><input id="es-features-__tabbed_24_3" name="es-features-__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_24_1">Configuración Básica</label><label for="es-features-__tabbed_24_2">Almacenamiento en Caché Agresivo</label><label for="es-features-__tabbed_24_3">Estrategia de Contenido Mixto</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que habilita el almacenamiento en caché para activos estáticos comunes:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CLIENT_CACHE_EXTENSIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jpg|jpeg|png|gif|css|js|svg|woff|woff2&quot;</span>
<span class="nt">CLIENT_CACHE_CONTROL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;public,</span><span class="nv"> </span><span class="s">max-age=86400&quot;</span><span class="w">  </span><span class="c1"># 1 día</span>
<span class="nt">CLIENT_CACHE_ETAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración optimizada para un almacenamiento en caché máximo, adecuada para sitios con contenido estático que se actualiza con poca frecuencia:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CLIENT_CACHE_EXTENSIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jpg|jpeg|png|bmp|ico|svg|tif|gif|css|js|otf|ttf|eot|woff|woff2|pdf|xml|txt&quot;</span>
<span class="nt">CLIENT_CACHE_CONTROL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;public,</span><span class="nv"> </span><span class="s">max-age=31536000,</span><span class="nv"> </span><span class="s">immutable&quot;</span><span class="w">  </span><span class="c1"># 1 año</span>
<span class="nt">CLIENT_CACHE_ETAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para sitios con una mezcla de contenido actualizado con frecuencia y con poca frecuencia, considere usar el versionado de archivos en su aplicación y una configuración como esta:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CLIENT_CACHE_EXTENSIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jpg|jpeg|png|bmp|ico|svg|tif|gif|css|js|otf|ttf|eot|woff|woff2&quot;</span>
<span class="nt">CLIENT_CACHE_CONTROL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;public,</span><span class="nv"> </span><span class="s">max-age=604800&quot;</span><span class="w">  </span><span class="c1"># 1 semana</span>
<span class="nt">CLIENT_CACHE_ETAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-country">Country</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de País habilita la funcionalidad de bloqueo geográfico para su sitio web, permitiéndole restringir el acceso según la ubicación geográfica de sus visitantes. Esta función le ayuda a cumplir con las regulaciones regionales, prevenir actividades fraudulentas a menudo asociadas con regiones de alto riesgo e implementar restricciones de contenido basadas en límites geográficos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un visitante accede a su sitio web, BunkerWeb determina su país basándose en su dirección IP.</li>
<li>Su configuración especifica una lista blanca (países permitidos) o una lista negra (países bloqueados).</li>
<li>Si ha configurado una lista blanca, solo los visitantes de los países de esa lista tendrán acceso.</li>
<li>Si ha configurado una lista negra, se denegará el acceso a los visitantes de los países de esa lista.</li>
<li>El resultado se almacena en caché para mejorar el rendimiento de los visitantes recurrentes de la misma dirección IP.</li>
</ol>
<h3 id="es-features-como-usar_9">Cómo usar</h3>
<p>Siga estos pasos para configurar y utilizar la función de País:</p>
<ol>
<li><strong>Defina su estrategia:</strong> Decida si desea utilizar un enfoque de lista blanca (permitir solo países específicos) o un enfoque de lista negra (bloquear países específicos).</li>
<li><strong>Configure los códigos de país:</strong> Añada los códigos de país ISO 3166-1 alfa-2 (códigos de dos letras como US, GB, FR) a la configuración <code>WHITELIST_COUNTRY</code> o <code>BLACKLIST_COUNTRY</code>.</li>
<li><strong>Aplique la configuración:</strong> Una vez configuradas, las restricciones basadas en el país se aplicarán a todos los visitantes de su sitio.</li>
<li><strong>Supervise la eficacia:</strong> Consulte la <a href="#es-web-ui">interfaz de usuario web</a> para ver estadísticas sobre las solicitudes bloqueadas por país.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_9">Ajustes de configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WHITELIST_COUNTRY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista Blanca de Países:</strong> Lista de códigos de país (formato ISO 3166-1 alfa-2) separados por espacios. Solo se permiten estos países.</td>
</tr>
<tr>
<td><code>BLACKLIST_COUNTRY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista Negra de Países:</strong> Lista de códigos de país (formato ISO 3166-1 alfa-2) separados por espacios. Estos países están bloqueados.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Lista Blanca vs. Lista Negra</p>
</div>
<p>Elija el enfoque que mejor se adapte a sus necesidades:</p>
<pre><code>-   Use la lista blanca cuando quiera restringir el acceso a un pequeño número de países.
-   Use la lista negra cuando quiera bloquear el acceso desde regiones problemáticas específicas mientras permite a todos los demás.
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Regla de Precedencia</p>
</div>
<p>Si se configuran tanto la lista blanca como la lista negra, la lista blanca tiene prioridad. Esto significa que el sistema primero comprueba si un país está en la lista blanca; si no, se deniega el acceso independientemente de la configuración de la lista negra.</p>
<div class="admonition info">
<p class="admonition-title">Detección de País</p>
</div>
<p>BunkerWeb utiliza la <a href="https://db-ip.com/db/download/ip-to-country-lite">base de datos mmdb lite de db-ip</a> para determinar el país de origen basándose en las direcciones IP.</p>
<h3 id="es-features-configuraciones-de-ejemplo_10">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="25:4"><input checked="checked" id="es-features-__tabbed_25_1" name="es-features-__tabbed_25" type="radio" /><input id="es-features-__tabbed_25_2" name="es-features-__tabbed_25" type="radio" /><input id="es-features-__tabbed_25_3" name="es-features-__tabbed_25" type="radio" /><input id="es-features-__tabbed_25_4" name="es-features-__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_25_1">Solo Lista Blanca</label><label for="es-features-__tabbed_25_2">Solo Lista Negra</label><label for="es-features-__tabbed_25_3">Acceso Solo para la UE</label><label for="es-features-__tabbed_25_4">Bloqueo de Países de Alto Riesgo</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Permitir el acceso solo desde Estados Unidos, Canadá y el Reino Unido:</p>
<div class="highlight"><pre><span></span><code><span class="nt">WHITELIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;US</span><span class="nv"> </span><span class="s">CA</span><span class="nv"> </span><span class="s">GB&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Bloquear el acceso desde países específicos mientras se permite a todos los demás:</p>
<div class="highlight"><pre><span></span><code><span class="nt">BLACKLIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RU</span><span class="nv"> </span><span class="s">CN</span><span class="nv"> </span><span class="s">KP&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Permitir el acceso solo desde los estados miembros de la Unión Europea:</p>
<div class="highlight"><pre><span></span><code><span class="nt">WHITELIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;AT</span><span class="nv"> </span><span class="s">BE</span><span class="nv"> </span><span class="s">BG</span><span class="nv"> </span><span class="s">HR</span><span class="nv"> </span><span class="s">CY</span><span class="nv"> </span><span class="s">CZ</span><span class="nv"> </span><span class="s">DK</span><span class="nv"> </span><span class="s">EE</span><span class="nv"> </span><span class="s">FI</span><span class="nv"> </span><span class="s">FR</span><span class="nv"> </span><span class="s">DE</span><span class="nv"> </span><span class="s">GR</span><span class="nv"> </span><span class="s">HU</span><span class="nv"> </span><span class="s">IE</span><span class="nv"> </span><span class="s">IT</span><span class="nv"> </span><span class="s">LV</span><span class="nv"> </span><span class="s">LT</span><span class="nv"> </span><span class="s">LU</span><span class="nv"> </span><span class="s">MT</span><span class="nv"> </span><span class="s">NL</span><span class="nv"> </span><span class="s">PL</span><span class="nv"> </span><span class="s">PT</span><span class="nv"> </span><span class="s">RO</span><span class="nv"> </span><span class="s">SK</span><span class="nv"> </span><span class="s">SI</span><span class="nv"> </span><span class="s">ES</span><span class="nv"> </span><span class="s">SE&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Bloquear el acceso desde países a menudo asociados con ciertas ciberamenazas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">BLACKLIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RU</span><span class="nv"> </span><span class="s">CN</span><span class="nv"> </span><span class="s">KP</span><span class="nv"> </span><span class="s">IR</span><span class="nv"> </span><span class="s">SY&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-crowdsec">CrowdSec</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/crowdsec.svg" width="600" /></p>
</figure>
<p>El complemento CrowdSec integra BunkerWeb con el motor de seguridad CrowdSec, proporcionando una capa adicional de protección contra diversas ciberamenazas. Este complemento actúa como un bouncer de <a href="https://crowdsec.net/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">CrowdSec</a>, denegando solicitudes basadas en decisiones de la API de CrowdSec.</p>
<p>CrowdSec es un motor de seguridad moderno y de código abierto que detecta y bloquea direcciones IP maliciosas basándose en el análisis de comportamiento y la inteligencia colectiva de su comunidad. También puede configurar <a href="https://docs.crowdsec.net/docs/concepts?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs#scenarios">escenarios</a> para prohibir automáticamente direcciones IP basadas en comportamiento sospechoso, beneficiándose de una lista negra de origen colectivo.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>El motor de CrowdSec analiza los registros y detecta actividades sospechosas en su infraestructura.</li>
<li>Cuando se detecta una actividad maliciosa, CrowdSec crea una decisión para bloquear la dirección IP infractora.</li>
<li>BunkerWeb, actuando como un bouncer, consulta la API local de CrowdSec para obtener decisiones sobre las solicitudes entrantes.</li>
<li>Si la dirección IP de un cliente tiene una decisión de bloqueo activa, BunkerWeb deniega el acceso a los servicios protegidos.</li>
<li>Opcionalmente, el Componente de Seguridad de Aplicaciones puede realizar una inspección profunda de las solicitudes para una mayor seguridad.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Beneficios clave</p>
<ol>
<li><strong>Seguridad impulsada por la comunidad:</strong> Benefíciese de la inteligencia de amenazas compartida en toda la comunidad de usuarios de CrowdSec.</li>
<li><strong>Análisis de comportamiento:</strong> Detecte ataques sofisticados basados en patrones de comportamiento, no solo en firmas.</li>
<li><strong>Integración ligera:</strong> Impacto mínimo en el rendimiento de su instancia de BunkerWeb.</li>
<li><strong>Protección multinivel:</strong> Combine la defensa perimetral (bloqueo de IP) con la seguridad de aplicaciones para una protección en profundidad.</li>
</ol>
</div>
<h3 id="es-features-configuracion">Configuración</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="26:1"><input checked="checked" id="es-features-__tabbed_26_1" name="es-features-__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_26_1">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Archivo de adquisición</strong></p>
<pre><code>Necesitará ejecutar una instancia de CrowdSec y configurarla para analizar los registros de BunkerWeb. Dado que BunkerWeb se basa en NGINX, puede usar el valor `nginx` para el parámetro `type` en su archivo de adquisición (suponiendo que los registros de BunkerWeb se almacenan tal cual sin datos adicionales):

```yaml
filenames:
  - /var/log/bunkerweb.log
labels:
  type: nginx
```

**Componente de Seguridad de Aplicaciones (*opcional*)**

CrowdSec también proporciona un [Componente de Seguridad de Aplicaciones](https://docs.crowdsec.net/docs/appsec/intro?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs) que se puede utilizar para proteger su aplicación de ataques. Si desea utilizarlo, debe crear otro archivo de adquisición para el Componente AppSec:

```yaml
appsec_config: crowdsecurity/appsec-default
labels:
  type: appsec
listen_addr: 0.0.0.0:7422
source: appsec
```

**Syslog**

Para las integraciones basadas en contenedores, recomendamos redirigir los registros del contenedor de BunkerWeb a un servicio de syslog para que CrowdSec pueda acceder a ellos fácilmente. Aquí hay un ejemplo de configuración para syslog-ng que almacenará los registros sin procesar provenientes de BunkerWeb en un archivo local `/var/log/bunkerweb.log`:

```syslog
@version: 4.8

source s_net {
    udp(
        ip("0.0.0.0")
    );
};

template t_imp {
    template("$MSG\n");
    template_escape(no);
};

destination d_file {
    file("/var/log/bunkerweb.log" template(t_imp));
};

log {
    source(s_net);
    destination(d_file);
};
```

**Docker Compose**

Aquí está la plantilla de docker-compose que puede utilizar (no olvide actualizar la clave del bouncer):

```yaml
x-bw-env: &amp;bw-env
  # Usamos un ancla para evitar repetir la misma configuración para ambos servicios
  API_WHITELIST_IP: "127.0.0.0/8 10.20.30.0/24" # Asegúrese de establecer el rango de IP correcto para que el planificador pueda enviar la configuración a la instancia

services:
  bunkerweb:
    # Este es el nombre que se utilizará para identificar la instancia en el Planificador
    image: bunkerity/bunkerweb:1.6.5-rc3
    ports:
      - "80:8080/tcp"
      - "443:8443/tcp"
      - "443:8443/udp" # Para soporte de QUIC / HTTP3
    environment:
      &lt;&lt;: *bw-env # Usamos el ancla para evitar repetir la misma configuración para todos los servicios
    restart: "unless-stopped"
    networks:
      - bw-universe
      - bw-services
    logging:
      driver: syslog # Enviar registros a syslog
      options:
        syslog-address: "udp://10.20.30.254:514" # La dirección IP del servicio syslog

  bw-scheduler:
    image: bunkerity/bunkerweb-scheduler:1.6.5-rc3
    environment:
      &lt;&lt;: *bw-env
      BUNKERWEB_INSTANCES: "bunkerweb" # Asegúrese de establecer el nombre de instancia correcto
      DATABASE_URI: "mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db" # Recuerde establecer una contraseña más segura para la base de datos
      SERVER_NAME: ""
      MULTISITE: "yes"
      USE_CROWDSEC: "yes"
      CROWDSEC_API: "http://crowdsec:8080" # Esta es la dirección de la API del contenedor de CrowdSec en la misma red
      CROWDSEC_APPSEC_URL: "http://crowdsec:7422" # Comente si no desea usar el Componente AppSec
      CROWDSEC_API_KEY: "s3cr3tb0unc3rk3y" # Recuerde establecer una clave más segura para el bouncer
    volumes:
      - bw-storage:/data # Se utiliza para persistir la caché y otros datos como las copias de seguridad
    restart: "unless-stopped"
    networks:
      - bw-universe
      - bw-db

  bw-db:
    image: mariadb:11
    # Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes
    command: --max-allowed-packet=67108864
    environment:
      MYSQL_RANDOM_ROOT_PASSWORD: "yes"
      MYSQL_DATABASE: "db"
      MYSQL_USER: "bunkerweb"
      MYSQL_PASSWORD: "changeme" # Recuerde establecer una contraseña más segura para la base de datos
    volumes:
      - bw-data:/var/lib/mysql
    restart: "unless-stopped"
    networks:
      - bw-db

  crowdsec:
    image: crowdsecurity/crowdsec:v1.7.0 # Use la última versión pero siempre fije la versión para una mejor estabilidad/seguridad
    volumes:
      - cs-data:/var/lib/crowdsec/data # Para persistir los datos de CrowdSec
      - bw-logs:/var/log:ro # Los registros de BunkerWeb para que CrowdSec los analice
      - ./acquis.yaml:/etc/crowdsec/acquis.yaml # El archivo de adquisición para los registros de BunkerWeb
      - ./appsec.yaml:/etc/crowdsec/acquis.d/appsec.yaml # Comente si no desea usar el Componente AppSec
    environment:
      BOUNCER_KEY_bunkerweb: "s3cr3tb0unc3rk3y" # Recuerde establecer una clave más segura para el bouncer
      COLLECTIONS: "crowdsecurity/nginx crowdsecurity/appsec-virtual-patching crowdsecurity/appsec-generic-rules"
      #   COLLECTIONS: "crowdsecurity/nginx" # Si no desea usar el Componente AppSec, use esta línea en su lugar
    networks:
      - bw-universe

  syslog:
    image: balabit/syslog-ng:4.9.0
    cap_add:
      - NET_BIND_SERVICE  # Vincular a puertos bajos
      - NET_BROADCAST  # Enviar difusiones
      - NET_RAW  # Usar sockets sin procesar
      - DAC_READ_SEARCH  # Leer archivos omitiendo permisos
      - DAC_OVERRIDE  # Anular permisos de archivo
      - CHOWN  # Cambiar propietario
      - SYSLOG  # Escribir en registros del sistema
    volumes:
      - bw-logs:/var/log/bunkerweb # Este es el volumen utilizado para almacenar los registros
      - ./syslog-ng.conf:/etc/syslog-ng/syslog-ng.conf # Este es el archivo de configuración de syslog-ng
    networks:
        bw-universe:
          ipv4_address: 10.20.30.254

volumes:
  bw-data:
  bw-storage:
  bw-logs:
  cs-data:

networks:
  bw-universe:
    name: bw-universe
    ipam:
      driver: default
      config:
        - subnet: 10.20.30.0/24 # Asegúrese de establecer el rango de IP correcto para que el planificador pueda enviar la configuración a la instancia
  bw-services:
    name: bw-services
  bw-db:
    name: bw-db
```
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="27:2"><input checked="checked" id="es-features-__tabbed_27_1" name="es-features-__tabbed_27" type="radio" /><input id="es-features-__tabbed_27_2" name="es-features-__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_27_1">Linux</label><label for="es-features-__tabbed_27_2">Todo en uno</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Necesita instalar CrowdSec y configurarlo para analizar los registros de BunkerWeb. Siga la <a href="https://doc.crowdsec.net/docs/getting_started/install_crowdsec?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs#scenarios">documentación oficial</a>.</p>
<p>Para permitir que CrowdSec analice los registros de BunkerWeb, agregue las siguientes líneas a su archivo de adquisición ubicado en <code>/etc/crowdsec/acquis.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">filenames</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bunkerweb/access.log</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bunkerweb/error.log</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bunkerweb/modsec_audit.log</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</code></pre></div>
<p>Ahora, agregue su bouncer personalizado a la API de CrowdSec usando la herramienta <code>cscli</code>:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>cscli<span class="w"> </span>bouncers<span class="w"> </span>add<span class="w"> </span>crowdsec-bunkerweb-bouncer/v1.6
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Clave de API</p>
<p>Guarde la clave generada por el comando <code>cscli</code>; la necesitará más tarde.</p>
</div>
<p>Luego reinicie el servicio de CrowdSec:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>crowdsec
</code></pre></div>
<p><strong>Componente de Seguridad de Aplicaciones (<em>opcional</em>)</strong></p>
<p>Si desea usar el Componente AppSec, debe crear otro archivo de adquisición para él ubicado en <code>/etc/crowdsec/acquis.d/appsec.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">appsec_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crowdsecurity/appsec-default</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appsec</span>
<span class="nt">listen_addr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1:7422</span>
<span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appsec</span>
</code></pre></div>
<p>También necesitará instalar las colecciones del Componente AppSec:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>cscli<span class="w"> </span>collections<span class="w"> </span>install<span class="w"> </span>crowdsecurity/appsec-virtual-patching
sudo<span class="w"> </span>cscli<span class="w"> </span>collections<span class="w"> </span>install<span class="w"> </span>crowdsecurity/appsec-generic-rules
</code></pre></div>
<p>Finalmente, reinicie el servicio de CrowdSec:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>crowdsec
</code></pre></div>
<p><strong>Ajustes</strong></p>
<p>Configure el complemento agregando los siguientes ajustes a su archivo de configuración de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>USE_CROWDSEC=yes
CROWDSEC_API=http://127.0.0.1:8080
CROWDSEC_API_KEY=&lt;La clave proporcionada por cscli&gt;
# Comente si no desea usar el Componente AppSec
CROWDSEC_APPSEC_URL=http://127.0.0.1:7422
</code></pre></div>
<p>Finalmente, recargue el servicio de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La imagen Docker Todo en Uno (AIO) de BunkerWeb viene con CrowdSec totalmente integrado. No necesita configurar una instancia de CrowdSec separada ni configurar manualmente los archivos de adquisición para los registros de BunkerWeb cuando usa el agente interno de CrowdSec.</p>
<p>Consulte la <a href="#es-integrations-crowdsec-integration">documentación de integración de la Imagen Todo en Uno (AIO)</a>.</p>
</div>
</div>
</div>
<h3 id="es-features-ajustes-de-configuracion_10">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CROWDSEC</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar CrowdSec:</strong> Establezca en <code>yes</code> para habilitar el bouncer de CrowdSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_API</code></td>
<td><code>http://crowdsec:8080</code></td>
<td>global</td>
<td>no</td>
<td><strong>URL de la API de CrowdSec:</strong> La dirección del servicio de la API Local de CrowdSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_API_KEY</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Clave de API de CrowdSec:</strong> La clave de API para autenticarse con la API de CrowdSec, obtenida usando <code>cscli bouncers add</code>.</td>
</tr>
<tr>
<td><code>CROWDSEC_MODE</code></td>
<td><code>live</code></td>
<td>global</td>
<td>no</td>
<td><strong>Modo de Operación:</strong> <code>live</code> (consultar la API para cada solicitud) o <code>stream</code> (almacenar en caché periódicamente todas las decisiones).</td>
</tr>
<tr>
<td><code>CROWDSEC_ENABLE_INTERNAL</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tráfico Interno:</strong> Establezca en <code>yes</code> para verificar el tráfico interno contra las decisiones de CrowdSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_REQUEST_TIMEOUT</code></td>
<td><code>1000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de Espera de la Solicitud:</strong> Tiempo de espera en milisegundos para las solicitudes HTTP a la API Local de CrowdSec en modo <code>live</code>.</td>
</tr>
<tr>
<td><code>CROWDSEC_EXCLUDE_LOCATION</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Ubicaciones Excluidas:</strong> Lista de ubicaciones (URI) separadas por comas para excluir de las verificaciones de CrowdSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_CACHE_EXPIRATION</code></td>
<td><code>1</code></td>
<td>global</td>
<td>no</td>
<td><strong>Expiración de la Caché:</strong> El tiempo de expiración de la caché en segundos para las decisiones de IP en modo <code>live</code>.</td>
</tr>
<tr>
<td><code>CROWDSEC_UPDATE_FREQUENCY</code></td>
<td><code>10</code></td>
<td>global</td>
<td>no</td>
<td><strong>Frecuencia de Actualización:</strong> Con qué frecuencia (en segundos) obtener decisiones nuevas/expiradas de la API de CrowdSec en modo <code>stream</code>.</td>
</tr>
</tbody>
</table>
<h4 id="es-features-ajustes-del-componente-de-seguridad-de-aplicaciones">Ajustes del Componente de Seguridad de Aplicaciones</h4>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CROWDSEC_APPSEC_URL</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>URL de AppSec:</strong> La URL del Componente de Seguridad de Aplicaciones de CrowdSec. Dejar vacío para deshabilitar AppSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_FAILURE_ACTION</code></td>
<td><code>passthrough</code></td>
<td>global</td>
<td>no</td>
<td><strong>Acción en Caso de Falla:</strong> Acción a tomar cuando AppSec devuelve un error. Puede ser <code>passthrough</code> o <code>deny</code>.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_CONNECT_TIMEOUT</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de Espera de Conexión:</strong> El tiempo de espera en milisegundos para conectarse al Componente AppSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_SEND_TIMEOUT</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de Espera de Envío:</strong> El tiempo de espera en milisegundos para enviar datos al Componente AppSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_PROCESS_TIMEOUT</code></td>
<td><code>500</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de Espera de Procesamiento:</strong> El tiempo de espera en milisegundos para procesar la solicitud en el Componente AppSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_ALWAYS_SEND_TO_APPSEC</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Enviar Siempre:</strong> Establezca en <code>yes</code> para enviar siempre las solicitudes a AppSec, incluso si hay una decisión a nivel de IP.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_SSL_VERIFY</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Verificar SSL:</strong> Establezca en <code>yes</code> para verificar el certificado SSL del Componente AppSec.</td>
</tr>
</tbody>
</table>
<p>!!! info "Sobre los Modos de Operación" - <strong>Modo <code>live</code></strong> consulta la API de CrowdSec para cada solicitud entrante, proporcionando protección en tiempo real a costa de una mayor latencia. - <strong>Modo <code>stream</code></strong> descarga periódicamente todas las decisiones de la API de CrowdSec y las almacena en caché localmente, reduciendo la latencia con un ligero retraso en la aplicación de nuevas decisiones.</p>
<h3 id="es-features-configuraciones-de-ejemplo_11">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="28:2"><input checked="checked" id="es-features-__tabbed_28_1" name="es-features-__tabbed_28" type="radio" /><input id="es-features-__tabbed_28_2" name="es-features-__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_28_1">Configuración Básica</label><label for="es-features-__tabbed_28_2">Configuración Avanzada con AppSec</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Esta es una configuración simple para cuando CrowdSec se ejecuta en el mismo host:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CROWDSEC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CROWDSEC_API</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:8080&quot;</span>
<span class="nt">CROWDSEC_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tu-clave-de-api-aqui&quot;</span>
<span class="nt">CROWDSEC_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;live&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración más completa que incluye el Componente de Seguridad de Aplicaciones:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CROWDSEC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CROWDSEC_API</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:8080&quot;</span>
<span class="nt">CROWDSEC_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tu-clave-de-api-aqui&quot;</span>
<span class="nt">CROWDSEC_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span>
<span class="nt">CROWDSEC_UPDATE_FREQUENCY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30&quot;</span>
<span class="nt">CROWDSEC_EXCLUDE_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/health,/metrics&quot;</span>

<span class="c1"># Configuración de AppSec</span>
<span class="nt">CROWDSEC_APPSEC_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:7422&quot;</span>
<span class="nt">CROWDSEC_APPSEC_FAILURE_ACTION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;deny&quot;</span>
<span class="nt">CROWDSEC_ALWAYS_SEND_TO_APPSEC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CROWDSEC_APPSEC_SSL_VERIFY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-custom-ssl-certificate">Custom SSL certificate</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de certificado SSL personalizado le permite usar sus propios certificados SSL/TLS con BunkerWeb en lugar de los generados automáticamente. Esta función es particularmente útil si tiene certificados existentes de una Autoridad de Certificación (CA) de confianza, necesita usar certificados con configuraciones específicas o desea mantener una gestión de certificados consistente en toda su infraestructura.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Usted proporciona a BunkerWeb sus archivos de certificado y clave privada, ya sea especificando las rutas de los archivos o proporcionando los datos en formato PEM codificado en base64 o en texto plano.</li>
<li>BunkerWeb valida su certificado y clave para asegurarse de que estén formateados correctamente y sean utilizables.</li>
<li>Cuando se establece una conexión segura, BunkerWeb sirve su certificado personalizado en lugar del generado automáticamente.</li>
<li>BunkerWeb supervisa automáticamente la validez de su certificado y muestra advertencias si se acerca a su vencimiento.</li>
<li>Usted tiene control total sobre la gestión de certificados, lo que le permite usar certificados de cualquier emisor que prefiera.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Monitoreo Automático de Certificados</p>
</div>
<p>Cuando habilita SSL/TLS personalizado estableciendo <code>USE_CUSTOM_SSL</code> en <code>yes</code>, BunkerWeb monitorea automáticamente el certificado personalizado especificado en <code>CUSTOM_SSL_CERT</code>. Comprueba los cambios diariamente y recarga NGINX si se detecta alguna modificación, asegurando que el certificado más reciente esté siempre en uso.</p>
<h3 id="es-features-como-usar_10">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de certificado SSL personalizado:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_CUSTOM_SSL</code> en <code>yes</code> para habilitar el soporte de certificados personalizados.</li>
<li><strong>Elija un método:</strong> Decida si proporcionar los certificados a través de rutas de archivo o como datos codificados en base64/texto plano, y establezca la prioridad usando <code>CUSTOM_SSL_CERT_PRIORITY</code>.</li>
<li><strong>Proporcione los archivos de certificado:</strong> Si usa rutas de archivo, especifique las ubicaciones de sus archivos de certificado y clave privada.</li>
<li><strong>O proporcione los datos del certificado:</strong> Si usa datos, proporcione su certificado y clave como cadenas codificadas en base64 o en formato PEM de texto plano.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, BunkerWeb usa automáticamente sus certificados personalizados para todas las conexiones HTTPS.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Configuración en Modo Stream</p>
</div>
<p>Para el modo stream, debe configurar el ajuste <code>LISTEN_STREAM_PORT_SSL</code> para especificar el puerto de escucha SSL/TLS. Este paso es esencial para el correcto funcionamiento en modo stream.</p>
<h3 id="es-features-ajustes-de-configuracion_11">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CUSTOM_SSL</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar SSL personalizado:</strong> Establezca en <code>yes</code> para usar su propio certificado en lugar del generado automáticamente.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_CERT_PRIORITY</code></td>
<td><code>file</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Prioridad del Certificado:</strong> Elija si priorizar el certificado de la ruta del archivo o de los datos base64 (<code>file</code> o <code>data</code>).</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_CERT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ruta del Certificado:</strong> Ruta completa a su archivo de certificado SSL o paquete de certificados.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_KEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ruta de la Clave Privada:</strong> Ruta completa a su archivo de clave privada SSL.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_CERT_DATA</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Datos del Certificado:</strong> Su certificado codificado en formato base64 o como texto plano PEM.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_KEY_DATA</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Datos de la Clave Privada:</strong> Su clave privada codificada en formato base64 o como texto plano PEM.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de Seguridad</p>
</div>
<p>Cuando use certificados personalizados, asegúrese de que su clave privada esté debidamente protegida y tenga los permisos adecuados. Los archivos deben ser legibles por el programador de BunkerWeb.</p>
<div class="admonition tip">
<p class="admonition-title">Formato del Certificado</p>
</div>
<p>BunkerWeb espera los certificados en formato PEM. Si su certificado está en un formato diferente, es posible que necesite convertirlo primero.</p>
<div class="admonition info">
<p class="admonition-title">Cadenas de Certificados</p>
</div>
<p>Si su certificado incluye una cadena (intermediarios), debe proporcionar la cadena de certificados completa en el orden correcto, con su certificado primero, seguido de los certificados intermedios.</p>
<h3 id="es-features-configuraciones-de-ejemplo_12">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="29:4"><input checked="checked" id="es-features-__tabbed_29_1" name="es-features-__tabbed_29" type="radio" /><input id="es-features-__tabbed_29_2" name="es-features-__tabbed_29" type="radio" /><input id="es-features-__tabbed_29_3" name="es-features-__tabbed_29" type="radio" /><input id="es-features-__tabbed_29_4" name="es-features-__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_29_1">Usando Rutas de Archivo</label><label for="es-features-__tabbed_29_2">Usando Datos Base64</label><label for="es-features-__tabbed_29_3">Usando Datos PEM de Texto Plano</label><label for="es-features-__tabbed_29_4">Configuración de Respaldo</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración que usa archivos de certificado y clave en el disco:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file&quot;</span>
<span class="nt">CUSTOM_SSL_CERT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/ruta/a/su/certificado.pem&quot;</span>
<span class="nt">CUSTOM_SSL_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/ruta/a/su/clave-privada.pem&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración que usa datos de certificado y clave codificados en base64:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;data&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR...certificado</span><span class="nv"> </span><span class="s">codificado</span><span class="nv"> </span><span class="s">en</span><span class="nv"> </span><span class="s">base64...Cg==&quot;</span>
<span class="nt">CUSTOM_SSL_KEY_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSEV...clave</span><span class="nv"> </span><span class="s">codificada</span><span class="nv"> </span><span class="s">en</span><span class="nv"> </span><span class="s">base64...Cg==&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración que usa datos de certificado y clave en texto plano en formato PEM:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;data&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_DATA</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">-----BEGIN CERTIFICATE-----</span>
<span class="w">  </span><span class="no">MIIDdzCCAl+gAwIBAgIUJH...contenido del certificado...AAAA</span>
<span class="w">  </span><span class="no">-----END CERTIFICATE-----</span>
<span class="nt">CUSTOM_SSL_KEY_DATA</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">-----BEGIN PRIVATE KEY-----</span>
<span class="w">  </span><span class="no">MIIEvQIBADAN...contenido de la clave...AAAA</span>
<span class="w">  </span><span class="no">-----END PRIVATE KEY-----</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración que prioriza los archivos pero recurre a los datos base64 si los archivos no están disponibles:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file&quot;</span>
<span class="nt">CUSTOM_SSL_CERT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/ruta/a/su/certificado.pem&quot;</span>
<span class="nt">CUSTOM_SSL_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/ruta/a/su/clave-privada.pem&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR...certificado</span><span class="nv"> </span><span class="s">codificado</span><span class="nv"> </span><span class="s">en</span><span class="nv"> </span><span class="s">base64...Cg==&quot;</span>
<span class="nt">CUSTOM_SSL_KEY_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSEV...clave</span><span class="nv"> </span><span class="s">codificada</span><span class="nv"> </span><span class="s">en</span><span class="nv"> </span><span class="s">base64...Cg==&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-dnsbl">DNSBL</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento DNSBL (Domain Name System Blacklist) proporciona protección contra direcciones IP maliciosas conocidas al verificar las direcciones IP de los clientes contra servidores DNSBL externos. Esta función ayuda a proteger su sitio web contra el spam, las redes de bots y diversos tipos de ciberamenazas al aprovechar listas mantenidas por la comunidad de direcciones IP problemáticas.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un cliente se conecta a su sitio web, BunkerWeb consulta los servidores DNSBL que ha elegido utilizando el protocolo DNS.</li>
<li>La verificación se realiza enviando una consulta de DNS inversa a cada servidor DNSBL con la dirección IP del cliente.</li>
<li>Si algún servidor DNSBL confirma que la dirección IP del cliente está listada como maliciosa, BunkerWeb prohibirá automáticamente al cliente, evitando que amenazas potenciales lleguen a su aplicación.</li>
<li>Los resultados se almacenan en caché para mejorar el rendimiento de los visitantes recurrentes de la misma dirección IP.</li>
<li>Las búsquedas se realizan de manera eficiente utilizando consultas asíncronas para minimizar el impacto en los tiempos de carga de la página.</li>
</ol>
<h3 id="es-features-como-usar_11">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función DNSBL:</p>
<ol>
<li><strong>Habilite la función:</strong> La función DNSBL está deshabilitada de forma predeterminada. Establezca la configuración <code>USE_DNSBL</code> en <code>yes</code> para habilitarla.</li>
<li><strong>Configure los servidores DNSBL:</strong> Agregue los nombres de dominio de los servicios DNSBL que desea usar a la configuración <code>DNSBL_LIST</code>.</li>
<li><strong>Aplique la configuración:</strong> Una vez configurado, BunkerWeb verificará automáticamente las conexiones entrantes contra los servidores DNSBL especificados.</li>
<li><strong>Supervise la eficacia:</strong> Consulte la <a href="#es-web-ui">interfaz de usuario web</a> para ver las estadísticas de las solicitudes bloqueadas por las verificaciones de DNSBL.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_12">Ajustes de Configuración</h3>
<p><strong>General</strong></p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_DNSBL</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td>Habilitar DNSBL: establezca en <code>yes</code> para habilitar las verificaciones de DNSBL para las conexiones entrantes.</td>
</tr>
<tr>
<td><code>DNSBL_LIST</code></td>
<td><code>bl.blocklist.de sbl.spamhaus.org xbl.spamhaus.org</code></td>
<td>global</td>
<td>no</td>
<td>Servidores DNSBL: lista de dominios de servidores DNSBL para verificar, separados por espacios.</td>
</tr>
</tbody>
</table>
<p><strong>Listas de Omisión</strong></p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DNSBL_IGNORE_IP</code></td>
<td>``</td>
<td>multisite</td>
<td>yes</td>
<td>IPs/CIDRs separados por espacios para omitir las verificaciones de DNSBL (lista blanca).</td>
</tr>
<tr>
<td><code>DNSBL_IGNORE_IP_URLS</code></td>
<td>``</td>
<td>multisite</td>
<td>yes</td>
<td>URL separadas por espacios que proporcionan IPs/CIDRs para omitir. Admite los esquemas <code>http(s)://</code> y <code>file://</code>.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Elección de Servidores DNSBL</p>
</div>
<p>Elija proveedores de DNSBL de buena reputación para minimizar los falsos positivos. La lista predeterminada incluye servicios bien establecidos que son adecuados para la mayoría de los sitios web:</p>
<pre><code>-   **bl.blocklist.de:** Lista las IP que han sido detectadas atacando otros servidores.
-   **sbl.spamhaus.org:** Se centra en fuentes de spam y otras actividades maliciosas.
-   **xbl.spamhaus.org:** Apunta a sistemas infectados, como máquinas comprometidas o proxies abiertos.
</code></pre>
<div class="admonition info">
<p class="admonition-title">Cómo Funciona DNSBL</p>
</div>
<p>Los servidores DNSBL funcionan respondiendo a consultas DNS con formato especial. Cuando BunkerWeb verifica una dirección IP, invierte la IP y añade el nombre de dominio del DNSBL. Si la consulta DNS resultante devuelve una respuesta de "éxito", la IP se considera en la lista negra.</p>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de Rendimiento</p>
</div>
<p>Aunque BunkerWeb optimiza las búsquedas de DNSBL para el rendimiento, agregar un gran número de servidores DNSBL podría afectar potencialmente los tiempos de respuesta. Comience con unos pocos servidores DNSBL de buena reputación y supervise el rendimiento antes de agregar más.</p>
<h3 id="es-features-configuraciones-de-ejemplo_13">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="30:4"><input checked="checked" id="es-features-__tabbed_30_1" name="es-features-__tabbed_30" type="radio" /><input id="es-features-__tabbed_30_2" name="es-features-__tabbed_30" type="radio" /><input id="es-features-__tabbed_30_3" name="es-features-__tabbed_30" type="radio" /><input id="es-features-__tabbed_30_4" name="es-features-__tabbed_30" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_30_1">Configuración Básica</label><label for="es-features-__tabbed_30_2">Configuración Mínima</label><label for="es-features-__tabbed_30_3">Excluyendo IPs de Confianza</label><label for="es-features-__tabbed_30_4">Usando URL Remotas</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que utiliza los servidores DNSBL predeterminados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_DNSBL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">DNSBL_LIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bl.blocklist.de</span><span class="nv"> </span><span class="s">sbl.spamhaus.org</span><span class="nv"> </span><span class="s">xbl.spamhaus.org&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración mínima que se centra en los servicios DNSBL más fiables:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_DNSBL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">DNSBL_LIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;zen.spamhaus.org&quot;</span>
</code></pre></div>
<p>Esta configuración utiliza solo:</p>
<ul>
<li><strong>zen.spamhaus.org</strong>: La lista combinada de Spamhaus a menudo se considera suficiente como una solución independiente debido a su amplia cobertura y reputación de precisión. Combina las listas SBL, XBL y PBL en una sola consulta, lo que la hace eficiente y completa.</li>
</ul>
</div>
<div class="tabbed-block">
<p>Puede excluir clientes específicos de las verificaciones de DNSBL utilizando valores estáticos y/o archivos remotos:</p>
<ul>
<li><code>DNSBL_IGNORE_IP</code>: Agregue IPs y rangos CIDR separados por espacios. Ejemplo: <code>192.0.2.10 203.0.113.0/24 2001:db8::/32</code>.</li>
<li><code>DNSBL_IGNORE_IP_URLS</code>: Proporcione URL cuyo contenido liste una IP/CIDR por línea. Los comentarios que comienzan con <code>#</code> o <code>;</code> se ignoran. Las entradas duplicadas se eliminan.</li>
</ul>
<p>Cuando la IP de un cliente entrante coincide con la lista de omisión, BunkerWeb omite las búsquedas de DNSBL y almacena en caché el resultado como "ok" para solicitudes posteriores más rápidas.</p>
</div>
<div class="tabbed-block">
<p>El trabajo <code>dnsbl-download</code> descarga y almacena en caché las IPs a omitir cada hora:</p>
<ul>
<li>Protocolos: <code>https://</code>, <code>http://</code> y rutas locales <code>file://</code>.</li>
<li>La caché por URL con suma de verificación evita descargas redundantes (período de gracia de 1 hora).</li>
<li>Archivo combinado por servicio: <code>/var/cache/bunkerweb/dnsbl/&lt;service&gt;/IGNORE_IP.list</code>.</li>
<li>Se carga al inicio y se combina con <code>DNSBL_IGNORE_IP</code>.</li>
</ul>
</div>
</div>
</div>
<p>Ejemplo que combina fuentes estáticas y de URL:</p>
<pre><code>```yaml
USE_DNSBL: "yes"
DNSBL_LIST: "zen.spamhaus.org"
DNSBL_IGNORE_IP: "10.0.0.0/8 192.168.0.0/16 2001:db8::/32"
DNSBL_IGNORE_IP_URLS: "https://example.com/allow-cidrs.txt file:///etc/bunkerweb/dnsbl/ignore.txt"
```
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="31:1"><input checked="checked" id="es-features-__tabbed_31_1" name="es-features-__tabbed_31" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_31_1">Usando Archivos Locales</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Cargue las IPs a omitir desde archivos locales usando URL <code>file://</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_DNSBL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">DNSBL_LIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;zen.spamhaus.org&quot;</span>
<span class="nt">DNSBL_IGNORE_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///etc/bunkerweb/dnsbl/ignore.txt</span><span class="nv"> </span><span class="s">file:///opt/data/allow-cidrs.txt&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-database">Database</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de Base de Datos proporciona una integración robusta de base de datos para BunkerWeb al habilitar el almacenamiento y la gestión centralizados de datos de configuración, registros y otra información esencial.</p>
<p>Este componente principal admite múltiples motores de base de datos, incluidos SQLite, PostgreSQL, MySQL/MariaDB y Oracle, lo que le permite elegir la solución de base de datos que mejor se adapte a su entorno y requisitos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>BunkerWeb se conecta a su base de datos configurada utilizando el URI proporcionado en el formato SQLAlchemy.</li>
<li>Los datos críticos de configuración, la información en tiempo de ejecución y los registros de trabajos se almacenan de forma segura en la base de datos.</li>
<li>Los procesos de mantenimiento automático optimizan su base de datos al gestionar el crecimiento de los datos y limpiar los registros sobrantes.</li>
<li>Para escenarios de alta disponibilidad, puede configurar un URI de base de datos de solo lectura que sirva tanto como respaldo (failover) como método para descargar las operaciones de lectura.</li>
<li>Las operaciones de la base de datos se registran según el nivel de registro especificado, proporcionando una visibilidad adecuada de las interacciones con la base de datos.</li>
</ol>
<h3 id="es-features-como-usar_12">Cómo usar</h3>
<p>Siga estos pasos para configurar y utilizar la función de Base de Datos:</p>
<ol>
<li><strong>Elija un motor de base de datos:</strong> Seleccione entre SQLite (predeterminado), PostgreSQL, MySQL/MariaDB u Oracle según sus requisitos.</li>
<li><strong>Configure el URI de la base de datos:</strong> Establezca el <code>DATABASE_URI</code> para conectarse a su base de datos principal utilizando el formato SQLAlchemy.</li>
<li><strong>Base de datos de solo lectura opcional:</strong> Para configuraciones de alta disponibilidad, configure un <code>DATABASE_URI_READONLY</code> como respaldo o para operaciones de lectura.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_13">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DATABASE_URI</code></td>
<td><code>sqlite:////var/lib/bunkerweb/db.sqlite3</code></td>
<td>global</td>
<td>no</td>
<td><strong>URI de la Base de Datos:</strong> La cadena de conexión de la base de datos principal en formato SQLAlchemy.</td>
</tr>
<tr>
<td><code>DATABASE_URI_READONLY</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>URI de la Base de Datos de Solo Lectura:</strong> Base de datos opcional para operaciones de solo lectura o como respaldo si la base de datos principal está caída.</td>
</tr>
<tr>
<td><code>DATABASE_LOG_LEVEL</code></td>
<td><code>warning</code></td>
<td>global</td>
<td>no</td>
<td><strong>Nivel de Registro:</strong> El nivel de verbosidad para los registros de la base de datos. Opciones: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>warning</code> o <code>error</code>.</td>
</tr>
<tr>
<td><code>DATABASE_MAX_JOBS_RUNS</code></td>
<td><code>10000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Máximo de Ejecuciones de Trabajos:</strong> El número máximo de registros de ejecución de trabajos que se conservarán en la base de datos antes de la limpieza automática.</td>
</tr>
</tbody>
</table>
<p>!!! tip "Selección de Base de Datos" - <strong>SQLite</strong> (predeterminado): Ideal para implementaciones de un solo nodo o entornos de prueba debido a su simplicidad y naturaleza basada en archivos. - <strong>PostgreSQL</strong>: Recomendado para entornos de producción con múltiples instancias de BunkerWeb debido a su robustez y soporte de concurrencia. - <strong>MySQL/MariaDB</strong>: Una buena alternativa a PostgreSQL con capacidades similares de nivel de producción. - <strong>Oracle</strong>: Adecuado para entornos empresariales donde Oracle ya es la plataforma de base de datos estándar.</p>
<div class="admonition info">
<p class="admonition-title">Formato de URI de SQLAlchemy</p>
</div>
<p>El URI de la base de datos sigue el formato de SQLAlchemy:</p>
<pre><code>-   SQLite: `sqlite:////ruta/a/database.sqlite3`
-   PostgreSQL: `postgresql://usuario:contraseña@hostname:puerto/basededatos`
-   MySQL/MariaDB: `mysql://usuario:contraseña@hostname:puerto/basededatos` o `mariadb://usuario:contraseña@hostname:puerto/basededatos`
-   Oracle: `oracle://usuario:contraseña@hostname:puerto/basededatos`
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Mantenimiento de la Base de Datos</p>
</div>
<p>El complemento ejecuta automáticamente un trabajo diario que limpia las ejecuciones de trabajos sobrantes basándose en el ajuste <code>DATABASE_MAX_JOBS_RUNS</code>. Esto evita el crecimiento ilimitado de la base de datos mientras se mantiene un historial útil de las ejecuciones de trabajos.</p>
<h2 id="es-features-easy-resolve-pro">Easy Resolve <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Provides a simpler way to fix false positives in reports.</p>
<h2 id="es-features-errors">Errors</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento de Errores proporciona un manejo de errores personalizable para su sitio web, permitiéndole configurar cómo aparecen las respuestas de error HTTP a los usuarios. Esta característica le ayuda a presentar páginas de error amigables y con su marca que mejoran la experiencia del usuario durante escenarios de error, en lugar de mostrar las páginas de error predeterminadas del servidor, que pueden parecer técnicas y confusas para los visitantes.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un cliente encuentra un error HTTP (por ejemplo, 400, 404 o 500), BunkerWeb intercepta la respuesta de error.</li>
<li>En lugar de mostrar la página de error predeterminada, BunkerWeb muestra una página de error personalizada y diseñada profesionalmente.</li>
<li>Las páginas de error son totalmente personalizables a través de su configuración, permitiéndole especificar páginas personalizadas para códigos de error específicos. <strong>Los archivos de las páginas de error personalizadas deben colocarse en el directorio definido por el ajuste <code>ROOT_FOLDER</code> (consulte la documentación del complemento Varios).</strong><ul>
<li>Por defecto, <code>ROOT_FOLDER</code> es <code>/var/www/html/{server_name}</code> (donde <code>{server_name}</code> se reemplaza por el nombre real del servidor).</li>
<li>En el modo multisitio, cada sitio puede tener su propio <code>ROOT_FOLDER</code>, por lo que las páginas de error personalizadas deben colocarse en el directorio correspondiente para cada sitio.</li>
</ul>
</li>
<li>Las páginas de error predeterminadas proporcionan explicaciones claras, ayudando a los usuarios a entender qué salió mal y qué pueden hacer a continuación.</li>
</ol>
<h3 id="es-features-como-usar_13">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Errores:</p>
<ol>
<li><strong>Defina las páginas de error personalizadas:</strong> Especifique qué códigos de error HTTP deben usar páginas de error personalizadas utilizando el ajuste <code>ERRORS</code>. Los archivos de las páginas de error personalizadas deben estar ubicados en la carpeta especificada por el ajuste <code>ROOT_FOLDER</code> para el sitio. En el modo multisitio, esto significa que cada sitio/servidor puede tener su propia carpeta para las páginas de error personalizadas.</li>
<li><strong>Configure sus páginas de error:</strong> Para cada código de error, puede usar la página de error predeterminada de BunkerWeb o proporcionar su propia página HTML personalizada (colocada en el <code>ROOT_FOLDER</code> apropiado).</li>
<li><strong>Establezca los códigos de error interceptados:</strong> Seleccione qué códigos de error siempre deben ser manejados por BunkerWeb con el ajuste <code>INTERCEPTED_ERROR_CODES</code>.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, el manejo de errores ocurre automáticamente para todos los códigos de error especificados.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_14">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ERRORS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Páginas de Error Personalizadas:</strong> Asigne códigos de error específicos a archivos HTML personalizados usando el formato <code>CODIGO_DE_ERROR=/ruta/al/archivo.html</code>.</td>
</tr>
<tr>
<td><code>INTERCEPTED_ERROR_CODES</code></td>
<td><code>400 401 403 404 405 413 429 500 501 502 503 504</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Errores Interceptados:</strong> Lista de códigos de error HTTP que BunkerWeb debe manejar con su página de error predeterminada cuando no se especifica una página personalizada.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Diseño de la Página de Error</p>
</div>
<p>Las páginas de error predeterminadas de BunkerWeb están diseñadas para ser informativas, amigables y de apariencia profesional. Incluyen:</p>
<pre><code>-   Descripciones claras del error
-   Información sobre qué pudo haber causado el error
-   Acciones sugeridas para que los usuarios resuelvan el problema
-   Indicadores visuales que ayudan a los usuarios a comprender si el problema está del lado del cliente o del servidor
</code></pre>
<div class="admonition info">
<p class="admonition-title">Tipos de Error</p>
</div>
<p>Los códigos de error se clasifican por tipo:</p>
<pre><code>-   **Errores 4xx (del lado del cliente):** Indican problemas con la solicitud del cliente, como intentar acceder a páginas inexistentes o carecer de la autenticación adecuada.
-   **Errores 5xx (del lado del servidor):** Indican problemas con la capacidad del servidor para cumplir una solicitud válida, como errores internos del servidor o indisponibilidad temporal.
</code></pre>
<h3 id="es-features-configuraciones-de-ejemplo_14">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="32:3"><input checked="checked" id="es-features-__tabbed_32_1" name="es-features-__tabbed_32" type="radio" /><input id="es-features-__tabbed_32_2" name="es-features-__tabbed_32" type="radio" /><input id="es-features-__tabbed_32_3" name="es-features-__tabbed_32" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_32_1">Manejo de Errores Predeterminado</label><label for="es-features-__tabbed_32_2">Páginas de Error Personalizadas</label><label for="es-features-__tabbed_32_3">Manejo de Errores Selectivo</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Deje que BunkerWeb maneje los códigos de error comunes con sus páginas de error predeterminadas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INTERCEPTED_ERROR_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">413</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">500</span><span class="nv"> </span><span class="s">501</span><span class="nv"> </span><span class="s">502</span><span class="nv"> </span><span class="s">503</span><span class="nv"> </span><span class="s">504&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Use páginas de error personalizadas para códigos de error específicos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">ERRORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;404=/custom/404.html</span><span class="nv"> </span><span class="s">500=/custom/500.html&quot;</span>
<span class="nt">INTERCEPTED_ERROR_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">413</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">500</span><span class="nv"> </span><span class="s">501</span><span class="nv"> </span><span class="s">502</span><span class="nv"> </span><span class="s">503</span><span class="nv"> </span><span class="s">504&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Solo maneje códigos de error específicos con BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INTERCEPTED_ERROR_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;404</span><span class="nv"> </span><span class="s">500&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-greylist">Greylist</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento de Lista Gris proporciona un enfoque de seguridad flexible que permite el acceso de los visitantes mientras se mantienen las características de seguridad esenciales.</p>
<p>A diferencia de los enfoques tradicionales de <a href="#es-features-blacklist">lista negra</a>/<a href="#es-features-whitelist">lista blanca</a> —que bloquean o permiten completamente el acceso—, la lista gris crea un punto intermedio al conceder acceso a ciertos visitantes mientras los somete a controles de seguridad.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Usted define los criterios para que los visitantes sean incluidos en la lista gris (<em>direcciones IP, redes, DNS inverso, ASN, User-Agent o patrones de URI</em>).</li>
<li>Cuando un visitante coincide con cualquiera de estos criterios, se le concede acceso a su sitio mientras las demás características de seguridad permanecen activas.</li>
<li>Si un visitante no coincide con ningún criterio de la lista gris, se le deniega el acceso.</li>
<li>Los datos de la lista gris se pueden actualizar automáticamente desde fuentes externas de forma programada.</li>
</ol>
<h3 id="es-features-como-usar_14">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Lista Gris:</p>
<ol>
<li><strong>Habilite la función:</strong> La función de Lista Gris está desactivada por defecto. Establezca el ajuste <code>USE_GREYLIST</code> en <code>yes</code> para habilitarla.</li>
<li><strong>Configure las reglas de la lista gris:</strong> Defina qué IPs, redes, patrones de DNS inverso, ASNs, User-Agents o URIs deben incluirse en la lista gris.</li>
<li><strong>Añada fuentes externas:</strong> Opcionalmente, configure URLs para descargar y actualizar automáticamente los datos de la lista gris.</li>
<li><strong>Supervise el acceso:</strong> Revise la <a href="#es-web-ui">interfaz de usuario web</a> para ver qué visitantes están siendo permitidos o denegados.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Comportamiento del Control de Acceso</p>
</div>
<p>Cuando la función de lista gris está habilitada con el ajuste <code>USE_GREYLIST</code> establecido en <code>yes</code>:</p>
<pre><code>1.  **Visitantes en la lista gris:** Se les permite el acceso pero siguen estando sujetos a todos los controles de seguridad.
2.  **Visitantes no incluidos en la lista gris:** Se les deniega completamente el acceso.
</code></pre>
<div class="admonition info">
<p class="admonition-title">modo stream</p>
</div>
<p>Cuando se utiliza el modo stream, solo se realizan las comprobaciones de IP, DNS inverso y ASN.</p>
<h3 id="es-features-ajustes-de-configuracion_15">Ajustes de Configuración</h3>
<p><strong>General</strong></p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_GREYLIST</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Lista Gris:</strong> Establezca en <code>yes</code> para habilitar la lista gris.</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="33:1"><input checked="checked" id="es-features-__tabbed_33_1" name="es-features-__tabbed_33" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_33_1">Dirección IP</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Incluye en la lista gris a los visitantes según su dirección IP o red. Estos visitantes obtienen acceso pero siguen estando sujetos a los controles de seguridad.</p>
<pre><code>| Ajuste             | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                             |
| ------------------ | ----------------- | --------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------- |
| `GREYLIST_IP`      |                   | multisite | no       | **Lista Gris de IP:** Lista de direcciones IP o redes (en notación CIDR) para incluir en la lista gris, separadas por espacios.         |
| `GREYLIST_IP_URLS` |                   | multisite | no       | **URLs de Lista Gris de IP:** Lista de URLs que contienen direcciones IP o redes para incluir en la lista gris, separadas por espacios. |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="34:1"><input checked="checked" id="es-features-__tabbed_34_1" name="es-features-__tabbed_34" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_34_1">DNS Inverso</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Incluye en la lista gris a los visitantes según su nombre de dominio (en inverso). Útil para permitir el acceso condicional a visitantes de organizaciones o redes específicas.</p>
<pre><code>| Ajuste                 | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                               |
| ---------------------- | ----------------- | --------- | -------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| `GREYLIST_RDNS`        |                   | multisite | no       | **Lista Gris de rDNS:** Lista de sufijos de DNS inverso para incluir en la lista gris, separados por espacios.                            |
| `GREYLIST_RDNS_GLOBAL` | `yes`             | multisite | no       | **Solo rDNS Global:** Realiza comprobaciones de la lista gris de rDNS solo en direcciones IP globales cuando se establece en `yes`.       |
| `GREYLIST_RDNS_URLS`   |                   | multisite | no       | **URLs de Lista Gris de rDNS:** Lista de URLs que contienen sufijos de DNS inverso para incluir en la lista gris, separadas por espacios. |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="35:1"><input checked="checked" id="es-features-__tabbed_35_1" name="es-features-__tabbed_35" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_35_1">ASN</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Incluye en la lista gris a los visitantes de proveedores de red específicos utilizando Números de Sistema Autónomo. Los ASN identifican a qué proveedor u organización pertenece una IP.</p>
<pre><code>| Ajuste              | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                            |
| ------------------- | ----------------- | --------- | -------- | ---------------------------------------------------------------------------------------------------------------------- |
| `GREYLIST_ASN`      |                   | multisite | no       | **Lista Gris de ASN:** Lista de Números de Sistema Autónomo para incluir en la lista gris, separados por espacios.     |
| `GREYLIST_ASN_URLS` |                   | multisite | no       | **URLs de Lista Gris de ASN:** Lista de URLs que contienen ASNs para incluir en la lista gris, separadas por espacios. |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="36:1"><input checked="checked" id="es-features-__tabbed_36_1" name="es-features-__tabbed_36" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_36_1">User Agent</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Incluye en la lista gris a los visitantes según el navegador o la herramienta que dicen estar usando. Esto permite el acceso controlado para herramientas específicas mientras se mantienen los controles de seguridad.</p>
<pre><code>| Ajuste                     | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                                   |
| -------------------------- | ----------------- | --------- | -------- | --------------------------------------------------------------------------------------------------------------------------------------------- |
| `GREYLIST_USER_AGENT`      |                   | multisite | no       | **Lista Gris de User-Agent:** Lista de patrones de User-Agent (expresión regular PCRE) para incluir en la lista gris, separados por espacios. |
| `GREYLIST_USER_AGENT_URLS` |                   | multisite | no       | **URLs de Lista Gris de User-Agent:** Lista de URLs que contienen patrones de User-Agent para incluir en la lista gris.                       |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="37:1"><input checked="checked" id="es-features-__tabbed_37_1" name="es-features-__tabbed_37" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_37_1">URI</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Incluye en la lista gris las solicitudes a URLs específicas de su sitio. Esto permite el acceso condicional a ciertos puntos finales mientras se mantienen los controles de seguridad.</p>
<pre><code>| Ajuste              | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                       |
| ------------------- | ----------------- | --------- | -------- | --------------------------------------------------------------------------------------------------------------------------------- |
| `GREYLIST_URI`      |                   | multisite | no       | **Lista Gris de URI:** Lista de patrones de URI (expresión regular PCRE) para incluir en la lista gris, separados por espacios.   |
| `GREYLIST_URI_URLS` |                   | multisite | no       | **URLs de Lista Gris de URI:** Lista de URLs que contienen patrones de URI para incluir en la lista gris, separadas por espacios. |
</code></pre>
<div class="admonition info">
<p class="admonition-title">Soporte de Formato de URL</p>
</div>
<p>Todos los ajustes <code>*_URLS</code> admiten URLs HTTP/HTTPS así como rutas de archivos locales usando el prefijo <code>file:///</code>. Se admite la autenticación básica usando el formato <code>http://usuario:contraseña@url</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Actualizaciones Regulares</p>
</div>
<p>Las listas grises de las URLs se descargan y actualizan automáticamente cada hora para asegurar que su protección se mantenga actualizada con las últimas fuentes de confianza.</p>
<h3 id="es-features-configuraciones-de-ejemplo_15">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="38:4"><input checked="checked" id="es-features-__tabbed_38_1" name="es-features-__tabbed_38" type="radio" /><input id="es-features-__tabbed_38_2" name="es-features-__tabbed_38" type="radio" /><input id="es-features-__tabbed_38_3" name="es-features-__tabbed_38" type="radio" /><input id="es-features-__tabbed_38_4" name="es-features-__tabbed_38" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_38_1">Configuración Básica</label><label for="es-features-__tabbed_38_2">Configuración Avanzada</label><label for="es-features-__tabbed_38_3">Usando Archivos Locales</label><label for="es-features-__tabbed_38_4">Acceso Selectivo a la API</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que aplica la lista gris a la red interna y al rastreador de una empresa:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GREYLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">GREYLIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)CompanyCrawler(?:\b)&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración más completa con múltiples criterios de lista gris:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Activos de la empresa y rastreadores aprobados</span>
<span class="nt">GREYLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">203.0.113.0/24&quot;</span>
<span class="nt">GREYLIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.company.com</span><span class="nv"> </span><span class="s">.partner-company.org&quot;</span>
<span class="nt">GREYLIST_ASN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;12345</span><span class="nv"> </span><span class="s">67890&quot;</span><span class="w">  </span><span class="c1"># ASNs de la empresa y del socio</span>
<span class="nt">GREYLIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)GoodBot(?:\b)</span><span class="nv"> </span><span class="s">(?:\b)PartnerCrawler(?:\b)&quot;</span>
<span class="nt">GREYLIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/v1/&quot;</span>

<span class="c1"># Fuentes externas de confianza</span>
<span class="nt">GREYLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-networks.txt&quot;</span>
<span class="nt">GREYLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-crawlers.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración usando archivos locales para las listas grises:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GREYLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/ip-greylist.txt&quot;</span>
<span class="nt">GREYLIST_RDNS_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/rdns-greylist.txt&quot;</span>
<span class="nt">GREYLIST_ASN_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/asn-greylist.txt&quot;</span>
<span class="nt">GREYLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/user-agent-greylist.txt&quot;</span>
<span class="nt">GREYLIST_URI_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/uri-greylist.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración que permite el acceso a puntos finales específicos de la API:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GREYLIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/v1/public/</span><span class="nv"> </span><span class="s">^/api/v1/status&quot;</span>
<span class="nt">GREYLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;203.0.113.0/24&quot;</span><span class="w">  </span><span class="c1"># Red del socio externo</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-gzip">Gzip</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento GZIP mejora el rendimiento del sitio web al comprimir las respuestas HTTP utilizando el algoritmo GZIP. Esta función reduce el uso de ancho de banda y mejora los tiempos de carga de la página al comprimir el contenido web antes de que se envíe al navegador del cliente, lo que resulta en una entrega más rápida y una mejor experiencia de usuario.</p>
<h3 id="es-features-como-funciona">Cómo funciona</h3>
<ol>
<li>Cuando un cliente solicita contenido de su sitio web, BunkerWeb comprueba si el cliente admite la compresión GZIP.</li>
<li>Si es compatible, BunkerWeb comprime la respuesta utilizando el algoritmo GZIP en el nivel de compresión que haya configurado.</li>
<li>El contenido comprimido se envía al cliente con las cabeceras adecuadas que indican la compresión GZIP.</li>
<li>El navegador del cliente descomprime el contenido antes de mostrarlo.</li>
<li>Tanto el uso de ancho de banda como los tiempos de carga de la página se reducen, mejorando el rendimiento general del sitio y la experiencia del usuario.</li>
</ol>
<h3 id="es-features-como-usar_15">Cómo usar</h3>
<p>Siga estos pasos para configurar y utilizar la función de compresión GZIP:</p>
<ol>
<li><strong>Habilite la función:</strong> La función GZIP está desactivada por defecto. Habilítela estableciendo el ajuste <code>USE_GZIP</code> en <code>yes</code>.</li>
<li><strong>Configure los tipos MIME:</strong> Especifique qué tipos de contenido deben comprimirse utilizando el ajuste <code>GZIP_TYPES</code>.</li>
<li><strong>Establezca el tamaño mínimo:</strong> Defina el tamaño mínimo de respuesta requerido para la compresión con el ajuste <code>GZIP_MIN_LENGTH</code> para evitar comprimir archivos pequeños.</li>
<li><strong>Elija un nivel de compresión:</strong> Seleccione su equilibrio preferido entre velocidad y tasa de compresión utilizando el ajuste <code>GZIP_COMP_LEVEL</code>.</li>
<li><strong>Configure las solicitudes proxy:</strong> Especifique qué solicitudes proxy deben comprimirse utilizando el ajuste <code>GZIP_PROXIED</code>.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_16">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_GZIP</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar GZIP:</strong> Establezca en <code>yes</code> para habilitar la compresión GZIP.</td>
</tr>
<tr>
<td><code>GZIP_TYPES</code></td>
<td><code>application/atom+xml application/javascript application/json application/rss+xml application/vnd.ms-fontobject application/x-font-opentype application/x-font-truetype application/x-font-ttf application/x-javascript application/xhtml+xml application/xml font/eot font/opentype font/otf font/truetype image/svg+xml image/vnd.microsoft.icon image/x-icon image/x-win-bitmap text/css text/javascript text/plain text/xml</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tipos MIME:</strong> Lista de tipos de contenido que se comprimirán con GZIP.</td>
</tr>
<tr>
<td><code>GZIP_MIN_LENGTH</code></td>
<td><code>1000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tamaño Mínimo:</strong> El tamaño mínimo de respuesta (en bytes) para que se aplique la compresión GZIP.</td>
</tr>
<tr>
<td><code>GZIP_COMP_LEVEL</code></td>
<td><code>5</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Nivel de Compresión:</strong> Nivel de compresión de 1 (compresión mínima) a 9 (compresión máxima). Los valores más altos consumen más CPU.</td>
</tr>
<tr>
<td><code>GZIP_PROXIED</code></td>
<td><code>no-cache no-store private expired auth</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Solicitudes Proxy:</strong> Especifica qué solicitudes proxy deben comprimirse según las cabeceras de respuesta.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimizando el Nivel de Compresión</p>
</div>
<p>El nivel de compresión por defecto (5) ofrece un buen equilibrio entre la tasa de compresión y el uso de la CPU. Para contenido estático o cuando los recursos de la CPU del servidor son abundantes, considere aumentarlo a 7-9 para una compresión máxima. Para contenido dinámico o cuando los recursos de la CPU son limitados, es posible que desee utilizar 1-3 para una compresión más rápida con una reducción de tamaño razonable.</p>
<div class="admonition info">
<p class="admonition-title">Soporte de Navegadores</p>
</div>
<p>GZIP es compatible con todos los navegadores modernos y ha sido el método de compresión estándar para las respuestas HTTP durante muchos años, lo que garantiza una excelente compatibilidad en todos los dispositivos y navegadores.</p>
<div class="admonition warning">
<p class="admonition-title">Compresión vs. Uso de CPU</p>
</div>
<p>Aunque la compresión GZIP reduce el ancho de banda y mejora los tiempos de carga, los niveles de compresión más altos consumen más recursos de la CPU. Para sitios de alto tráfico, encuentre el equilibrio adecuado entre la eficiencia de la compresión y el rendimiento del servidor.</p>
<h3 id="es-features-configuraciones-de-ejemplo_16">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="39:4"><input checked="checked" id="es-features-__tabbed_39_1" name="es-features-__tabbed_39" type="radio" /><input id="es-features-__tabbed_39_2" name="es-features-__tabbed_39" type="radio" /><input id="es-features-__tabbed_39_3" name="es-features-__tabbed_39" type="radio" /><input id="es-features-__tabbed_39_4" name="es-features-__tabbed_39" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_39_1">Configuración Básica</label><label for="es-features-__tabbed_39_2">Compresión Máxima</label><label for="es-features-__tabbed_39_3">Rendimiento Equilibrado</label><label for="es-features-__tabbed_39_4">Enfoque en Contenido Proxy</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración estándar que habilita GZIP con los ajustes por defecto:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración optimizada para un ahorro máximo de compresión:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/atom+xml</span><span class="nv"> </span><span class="s">application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/rss+xml</span><span class="nv"> </span><span class="s">application/vnd.ms-fontobject</span><span class="nv"> </span><span class="s">application/x-font-opentype</span><span class="nv"> </span><span class="s">application/x-font-truetype</span><span class="nv"> </span><span class="s">application/x-font-ttf</span><span class="nv"> </span><span class="s">application/x-javascript</span><span class="nv"> </span><span class="s">application/xhtml+xml</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">font/eot</span><span class="nv"> </span><span class="s">font/opentype</span><span class="nv"> </span><span class="s">font/otf</span><span class="nv"> </span><span class="s">font/truetype</span><span class="nv"> </span><span class="s">image/svg+xml</span><span class="nv"> </span><span class="s">image/vnd.microsoft.icon</span><span class="nv"> </span><span class="s">image/x-icon</span><span class="nv"> </span><span class="s">image/x-win-bitmap</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9&quot;</span>
<span class="nt">GZIP_PROXIED</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;any&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que equilibra la tasa de compresión con el uso de la CPU:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">GZIP_PROXIED</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no-cache</span><span class="nv"> </span><span class="s">no-store</span><span class="nv"> </span><span class="s">private</span><span class="nv"> </span><span class="s">expired&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que se centra en manejar adecuadamente la compresión para el contenido proxy:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">GZIP_PROXIED</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;any&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-html-injection">HTML injection</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento de Inyección de HTML le permite agregar sin problemas código HTML personalizado a las páginas de su sitio web antes de las etiquetas de cierre <code>&lt;/body&gt;</code> o <code>&lt;/head&gt;</code>. Esta función es particularmente útil para agregar scripts de análisis, píxeles de seguimiento, JavaScript personalizado, estilos CSS u otras integraciones de terceros sin modificar el código fuente de su sitio web.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando se sirve una página de su sitio web, BunkerWeb examina la respuesta HTML.</li>
<li>Si ha configurado la inyección en el cuerpo (body), BunkerWeb inserta su código HTML personalizado justo antes de la etiqueta de cierre <code>&lt;/body&gt;</code>.</li>
<li>Si ha configurado la inyección en la cabecera (head), BunkerWeb inserta su código HTML personalizado justo antes de la etiqueta de cierre <code>&lt;/head&gt;</code>.</li>
<li>La inserción se realiza automáticamente para todas las páginas HTML servidas por su sitio web.</li>
<li>Esto le permite agregar scripts, estilos u otros elementos sin modificar el código de su aplicación.</li>
</ol>
<h3 id="es-features-como-usar_16">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Inyección de HTML:</p>
<ol>
<li><strong>Prepare su HTML personalizado:</strong> Decida qué código HTML desea inyectar en sus páginas.</li>
<li><strong>Elija las ubicaciones de inyección:</strong> Determine si necesita inyectar código en la sección <code>&lt;head&gt;</code>, en la sección <code>&lt;body&gt;</code>, o en ambas.</li>
<li><strong>Configure los ajustes:</strong> Agregue su HTML personalizado a los ajustes apropiados (<code>INJECT_HEAD</code> y/o <code>INJECT_BODY</code>).</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, el HTML se inyectará automáticamente en todas las páginas HTML servidas.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_17">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>INJECT_HEAD</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Código HTML de la Cabecera:</strong> El código HTML para inyectar antes de la etiqueta <code>&lt;/head&gt;</code>.</td>
</tr>
<tr>
<td><code>INJECT_BODY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Código HTML del Cuerpo:</strong> El código HTML para inyectar antes de la etiqueta <code>&lt;/body&gt;</code>.</td>
</tr>
</tbody>
</table>
<p>!!! tip "Mejores Prácticas" - Por razones de rendimiento, coloque los archivos de JavaScript al final del cuerpo para evitar el bloqueo del renderizado. - Coloque CSS y JavaScript crítico en la sección de la cabecera para evitar un "destello" de contenido sin estilo (FOUC). - Tenga cuidado con el contenido inyectado que podría potencialmente romper la funcionalidad de su sitio.</p>
<p>!!! info "Casos de Uso Comunes" - Agregar scripts de análisis (como Google Analytics, Matomo) - Integrar widgets de chat o herramientas de soporte al cliente - Incluir píxeles de seguimiento para campañas de marketing - Agregar estilos CSS personalizados o funcionalidad de JavaScript - Incluir bibliotecas de terceros sin modificar el código de su aplicación</p>
<h3 id="es-features-configuraciones-de-ejemplo_17">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="40:4"><input checked="checked" id="es-features-__tabbed_40_1" name="es-features-__tabbed_40" type="radio" /><input id="es-features-__tabbed_40_2" name="es-features-__tabbed_40" type="radio" /><input id="es-features-__tabbed_40_3" name="es-features-__tabbed_40" type="radio" /><input id="es-features-__tabbed_40_4" name="es-features-__tabbed_40" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_40_1">Google Analytics</label><label for="es-features-__tabbed_40_2">Estilos Personalizados</label><label for="es-features-__tabbed_40_3">Múltiples Integraciones</label><label for="es-features-__tabbed_40_4">Banner de Consentimiento de Cookies</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Agregar el seguimiento de Google Analytics a su sitio web:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;script</span><span class="nv"> </span><span class="s">async</span><span class="nv"> </span><span class="s">src=\&quot;https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX\&quot;&gt;&lt;/script&gt;&lt;script&gt;window.dataLayer</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">window.dataLayer</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">[];function</span><span class="nv"> </span><span class="s">gtag(){dataLayer.push(arguments);}gtag(&#39;js&#39;,</span><span class="nv"> </span><span class="s">new</span><span class="nv"> </span><span class="s">Date());gtag(&#39;config&#39;,</span><span class="nv"> </span><span class="s">&#39;G-XXXXXXXXXX&#39;);&lt;/script&gt;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Agregar estilos CSS personalizados a su sitio web:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;style&gt;body</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">font-family:</span><span class="nv"> </span><span class="s">&#39;Arial&#39;,</span><span class="nv"> </span><span class="s">sans-serif;</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">.custom-element</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">color:</span><span class="nv"> </span><span class="s">blue;</span><span class="nv"> </span><span class="s">}&lt;/style&gt;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Agregar tanto estilos personalizados como JavaScript:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;style&gt;body</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">font-family:</span><span class="nv"> </span><span class="s">&#39;Arial&#39;,</span><span class="nv"> </span><span class="s">sans-serif;</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">.notification-banner</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">background:</span><span class="nv"> </span><span class="s">#f8f9fa;</span><span class="nv"> </span><span class="s">padding:</span><span class="nv"> </span><span class="s">10px;</span><span class="nv"> </span><span class="s">text-align:</span><span class="nv"> </span><span class="s">center;</span><span class="nv"> </span><span class="s">}&lt;/style&gt;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;script</span><span class="nv"> </span><span class="s">src=\&quot;https://cdn.example.com/js/widget.js\&quot;&gt;&lt;/script&gt;&lt;script&gt;initializeWidget(&#39;your-api-key&#39;);&lt;/script&gt;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Agregar un banner simple de consentimiento de cookies:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;style&gt;.cookie-banner</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">position:</span><span class="nv"> </span><span class="s">fixed;</span><span class="nv"> </span><span class="s">bottom:</span><span class="nv"> </span><span class="s">0;</span><span class="nv"> </span><span class="s">left:</span><span class="nv"> </span><span class="s">0;</span><span class="nv"> </span><span class="s">right:</span><span class="nv"> </span><span class="s">0;</span><span class="nv"> </span><span class="s">background:</span><span class="nv"> </span><span class="s">#f1f1f1;</span><span class="nv"> </span><span class="s">padding:</span><span class="nv"> </span><span class="s">20px;</span><span class="nv"> </span><span class="s">text-align:</span><span class="nv"> </span><span class="s">center;</span><span class="nv"> </span><span class="s">z-index:</span><span class="nv"> </span><span class="s">1000;</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">.cookie-banner</span><span class="nv"> </span><span class="s">button</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">background:</span><span class="nv"> </span><span class="s">#4CAF50;</span><span class="nv"> </span><span class="s">border:</span><span class="nv"> </span><span class="s">none;</span><span class="nv"> </span><span class="s">color:</span><span class="nv"> </span><span class="s">white;</span><span class="nv"> </span><span class="s">padding:</span><span class="nv"> </span><span class="s">10px</span><span class="nv"> </span><span class="s">20px;</span><span class="nv"> </span><span class="s">cursor:</span><span class="nv"> </span><span class="s">pointer;</span><span class="nv"> </span><span class="s">}&lt;/style&gt;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;div</span><span class="nv"> </span><span class="s">id=\&quot;cookie-banner\&quot;</span><span class="nv"> </span><span class="s">class=\&quot;cookie-banner\&quot;&gt;Este</span><span class="nv"> </span><span class="s">sitio</span><span class="nv"> </span><span class="s">web</span><span class="nv"> </span><span class="s">utiliza</span><span class="nv"> </span><span class="s">cookies</span><span class="nv"> </span><span class="s">para</span><span class="nv"> </span><span class="s">garantizar</span><span class="nv"> </span><span class="s">que</span><span class="nv"> </span><span class="s">obtenga</span><span class="nv"> </span><span class="s">la</span><span class="nv"> </span><span class="s">mejor</span><span class="nv"> </span><span class="s">experiencia.</span><span class="nv"> </span><span class="s">&lt;button</span><span class="nv"> </span><span class="s">onclick=\&quot;acceptCookies()\&quot;&gt;Aceptar&lt;/button&gt;&lt;/div&gt;&lt;script&gt;function</span><span class="nv"> </span><span class="s">acceptCookies()</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">document.getElementById(&#39;cookie-banner&#39;).style.display</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">localStorage.setItem(&#39;cookies-accepted&#39;,</span><span class="nv"> </span><span class="s">&#39;true&#39;);</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">if(localStorage.getItem(&#39;cookies-accepted&#39;)</span><span class="nv"> </span><span class="s">===</span><span class="nv"> </span><span class="s">&#39;true&#39;)</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">document.getElementById(&#39;cookie-banner&#39;).style.display</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">}&lt;/script&gt;&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-headers">Headers</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Las cabeceras juegan un papel crucial en la seguridad HTTP. El complemento de Cabeceras proporciona una gestión robusta tanto de cabeceras HTTP estándar como personalizadas, mejorando la seguridad y la funcionalidad. Aplica dinámicamente medidas de seguridad, como <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Strict-Transport-Security">HSTS</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy">CSP</a> (incluido un modo de informe), y la inyección de cabeceras personalizadas, al tiempo que previene la fuga de información.</p>
<p><strong>Cómo funciona</strong></p>
<ol>
<li>Cuando un cliente solicita contenido de su sitio web, BunkerWeb procesa las cabeceras de la respuesta.</li>
<li>Se aplican las cabeceras de seguridad de acuerdo con su configuración.</li>
<li>Se pueden añadir cabeceras personalizadas para proporcionar información o funcionalidad adicional a los clientes.</li>
<li>Las cabeceras no deseadas que podrían revelar información del servidor se eliminan automáticamente.</li>
<li>Las cookies se modifican para incluir indicadores de seguridad apropiados según sus ajustes.</li>
<li>Las cabeceras de los servidores de origen (upstream) se pueden preservar selectivamente cuando sea necesario.</li>
</ol>
<h3 id="es-features-como-usar_17">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Cabeceras:</p>
<ol>
<li><strong>Configure las cabeceras de seguridad:</strong> Establezca valores para las cabeceras comunes.</li>
<li><strong>Añada cabeceras personalizadas:</strong> Defina cualquier cabecera personalizada usando el ajuste <code>CUSTOM_HEADER</code>.</li>
<li><strong>Elimine las cabeceras no deseadas:</strong> Use <code>REMOVE_HEADERS</code> para asegurarse de que se eliminen las cabeceras que podrían exponer detalles del servidor.</li>
<li><strong>Establezca la seguridad de las cookies:</strong> Habilite una seguridad robusta para las cookies configurando <code>COOKIE_FLAGS</code> y estableciendo <code>COOKIE_AUTO_SECURE_FLAG</code> en <code>yes</code> para que el indicador <code>Secure</code> se añada automáticamente en las conexiones HTTPS.</li>
<li><strong>Preserve las cabeceras de origen:</strong> Especifique qué cabeceras de origen conservar usando <code>KEEP_UPSTREAM_HEADERS</code>.</li>
<li><strong>Aproveche la aplicación condicional de cabeceras:</strong> Si desea probar políticas sin interrupciones, habilite el modo <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy-Report-Only">CSP Report-Only</a> a través de <code>CONTENT_SECURITY_POLICY_REPORT_ONLY</code>.</li>
</ol>
<h3 id="es-features-guia-de-configuracion">Guía de Configuración</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="41:1"><input checked="checked" id="es-features-__tabbed_41_1" name="es-features-__tabbed_41" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_41_1">Cabeceras de Seguridad</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Descripción General</strong></p>
<p>Las cabeceras de seguridad imponen una comunicación segura, restringen la carga de recursos y previenen ataques como el clickjacking y la inyección. Unas cabeceras configuradas correctamente crean una capa defensiva robusta para su sitio web.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios de las Cabeceras de Seguridad</p>
<ul>
<li><strong>HSTS:</strong> Asegura que todas las conexiones estén cifradas, protegiendo contra ataques de degradación de protocolo.</li>
<li><strong>CSP:</strong> Previene la ejecución de scripts maliciosos, reduciendo el riesgo de ataques XSS.</li>
<li><strong>X-Frame-Options:</strong> Bloquea los intentos de clickjacking controlando la incrustación de iframes.</li>
<li><strong>Referrer Policy:</strong> Limita la fuga de información sensible a través de las cabeceras de referencia.</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>STRICT_TRANSPORT_SECURITY</code></td>
<td><code>max-age=63072000; includeSubDomains; preload</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HSTS:</strong> Impone conexiones HTTPS seguras, reduciendo los riesgos de ataques de intermediario (man-in-the-middle).</td>
</tr>
<tr>
<td><code>CONTENT_SECURITY_POLICY</code></td>
<td><code>object-src 'none'; form-action 'self'; frame-ancestors 'self';</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>CSP:</strong> Restringe la carga de recursos a fuentes de confianza, mitigando los ataques de cross-site scripting e inyección de datos.</td>
</tr>
<tr>
<td><code>CONTENT_SECURITY_POLICY_REPORT_ONLY</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Modo de Informe CSP:</strong> Informa de las violaciones sin bloquear el contenido, ayudando a probar las políticas de seguridad mientras se capturan los registros.</td>
</tr>
<tr>
<td><code>X_FRAME_OPTIONS</code></td>
<td><code>SAMEORIGIN</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>X-Frame-Options:</strong> Previene el clickjacking controlando si su sitio puede ser enmarcado (framed).</td>
</tr>
<tr>
<td><code>X_CONTENT_TYPE_OPTIONS</code></td>
<td><code>nosniff</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>X-Content-Type-Options:</strong> Evita que los navegadores realicen "MIME-sniffing", protegiendo contra ataques de descarga no autorizada (drive-by download).</td>
</tr>
<tr>
<td><code>X_DNS_PREFETCH_CONTROL</code></td>
<td><code>off</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>X-DNS-Prefetch-Control:</strong> Regula la captación previa de DNS para reducir las solicitudes de red no intencionadas y mejorar la privacidad.</td>
</tr>
<tr>
<td><code>REFERRER_POLICY</code></td>
<td><code>strict-origin-when-cross-origin</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Política de Referencia:</strong> Controla la cantidad de información de referencia enviada, salvaguardando la privacidad del usuario.</td>
</tr>
<tr>
<td><code>PERMISSIONS_POLICY</code></td>
<td><code>accelerometer=(), ambient-light-sensor=(), attribution-reporting=(), autoplay=(), battery=(), ...</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Política de Permisos:</strong> Restringe el acceso a las funciones del navegador, reduciendo los posibles vectores de ataque.</td>
</tr>
<tr>
<td><code>KEEP_UPSTREAM_HEADERS</code></td>
<td><code>Content-Security-Policy Permissions-Policy X-Frame-Options</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Conservar Cabeceras:</strong> Preserva las cabeceras de origen seleccionadas, ayudando a la integración con sistemas heredados mientras se mantiene la seguridad.</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Mejores Prácticas"
    - Revise y actualice regularmente sus cabeceras de seguridad para alinearse con los estándares de seguridad en evolución.
    - Use herramientas como [Mozilla Observatory](https://observatory.mozilla.org/) para validar la configuración de sus cabeceras.
    - Pruebe el CSP en modo `Report-Only` antes de aplicarlo para evitar romper la funcionalidad.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="42:1"><input checked="checked" id="es-features-__tabbed_42_1" name="es-features-__tabbed_42" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_42_1">Configuración de Cookies</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Descripción General</strong></p>
<p>Una configuración adecuada de las cookies garantiza sesiones de usuario seguras al prevenir el secuestro, la fijación y el cross-site scripting. Las cookies seguras mantienen la integridad de la sesión sobre HTTPS y mejoran la protección general de los datos del usuario.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios de las Cookies Seguras</p>
<ul>
<li><strong>Indicador HttpOnly:</strong> Evita que los scripts del lado del cliente accedan a las cookies, mitigando los riesgos de XSS.</li>
<li><strong>Indicador SameSite:</strong> Reduce los ataques CSRF al restringir el uso de cookies entre diferentes orígenes.</li>
<li><strong>Indicador Secure:</strong> Asegura que las cookies se transmitan solo a través de conexiones HTTPS cifradas.</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>COOKIE_FLAGS</code></td>
<td><code>* HttpOnly SameSite=Lax</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Indicadores de Cookie:</strong> Añade automáticamente indicadores de seguridad como HttpOnly y SameSite, protegiendo las cookies del acceso de scripts del lado del cliente y de ataques CSRF.</td>
</tr>
<tr>
<td><code>COOKIE_AUTO_SECURE_FLAG</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Indicador Secure Automático:</strong> Asegura que las cookies solo se envíen a través de conexiones HTTPS seguras añadiendo automáticamente el indicador Secure.</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Mejores Prácticas"
    - Use `SameSite=Strict` para cookies sensibles para prevenir el acceso entre orígenes.
    - Audite regularmente la configuración de sus cookies para asegurar el cumplimiento con las regulaciones de seguridad y privacidad.
    - Evite establecer cookies sin el indicador `Secure` en entornos de producción.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="43:1"><input checked="checked" id="es-features-__tabbed_43_1" name="es-features-__tabbed_43" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_43_1">Cabeceras Personalizadas</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Descripción General</strong></p>
<p>Las cabeceras personalizadas le permiten añadir cabeceras HTTP específicas para cumplir con los requisitos de la aplicación o el rendimiento. Ofrecen flexibilidad pero deben configurarse con cuidado para evitar exponer detalles sensibles del servidor.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios de las Cabeceras Personalizadas</p>
<ul>
<li>Mejore la seguridad eliminando cabeceras innecesarias que puedan filtrar detalles del servidor.</li>
<li>Añada cabeceras específicas de la aplicación para mejorar la funcionalidad o la depuración.</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CUSTOM_HEADER</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Cabecera Personalizada:</strong> Proporciona un medio para añadir cabeceras definidas por el usuario en el formato <code>NombreCabecera: ValorCabecera</code> para mejoras especializadas de seguridad o rendimiento.</td>
</tr>
<tr>
<td><code>REMOVE_HEADERS</code></td>
<td><code>Server Expect-CT X-Powered-By X-AspNet-Version X-AspNetMvc-Version Public-Key-Pins</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Eliminar Cabeceras:</strong> Especifica las cabeceras a eliminar, disminuyendo la posibilidad de exponer detalles internos del servidor y vulnerabilidades conocidas.</td>
</tr>
</tbody>
</table>
<pre><code>!!! warning "Consideraciones de Seguridad"
    - Evite exponer información sensible a través de cabeceras personalizadas.
    - Revise y actualice regularmente las cabeceras personalizadas para alinearlas con los requisitos de su aplicación.

!!! tip "Mejores Prácticas"
    - Use `REMOVE_HEADERS` para eliminar cabeceras como `Server` y `X-Powered-By` para reducir los riesgos de "fingerprinting" (identificación del servidor).
    - Pruebe las cabeceras personalizadas en un entorno de preproducción (staging) antes de desplegarlas en producción.
</code></pre>
<h3 id="es-features-configuraciones-de-ejemplo_18">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="44:4"><input checked="checked" id="es-features-__tabbed_44_1" name="es-features-__tabbed_44" type="radio" /><input id="es-features-__tabbed_44_2" name="es-features-__tabbed_44" type="radio" /><input id="es-features-__tabbed_44_3" name="es-features-__tabbed_44" type="radio" /><input id="es-features-__tabbed_44_4" name="es-features-__tabbed_44" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_44_1">Cabeceras de Seguridad Básicas</label><label for="es-features-__tabbed_44_2">Seguridad de Cookies Mejorada</label><label for="es-features-__tabbed_44_3">Cabeceras Personalizadas para API</label><label for="es-features-__tabbed_44_4">Content Security Policy - Modo de Informe</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración estándar con cabeceras de seguridad esenciales:</p>
<div class="highlight"><pre><span></span><code><span class="nt">STRICT_TRANSPORT_SECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;max-age=63072000;</span><span class="nv"> </span><span class="s">includeSubDomains;</span><span class="nv"> </span><span class="s">preload&quot;</span>
<span class="nt">CONTENT_SECURITY_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">script-src</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">object-src</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">frame-ancestors</span><span class="nv"> </span><span class="s">&#39;self&#39;&quot;</span>
<span class="nt">X_FRAME_OPTIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SAMEORIGIN&quot;</span>
<span class="nt">X_CONTENT_TYPE_OPTIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;nosniff&quot;</span>
<span class="nt">REFERRER_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;strict-origin-when-cross-origin&quot;</span>
<span class="nt">REMOVE_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Server</span><span class="nv"> </span><span class="s">X-Powered-By</span><span class="nv"> </span><span class="s">X-AspNet-Version&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con ajustes robustos de seguridad para cookies:</p>
<div class="highlight"><pre><span></span><code><span class="nt">COOKIE_FLAGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*</span><span class="nv"> </span><span class="s">HttpOnly</span><span class="nv"> </span><span class="s">SameSite=Strict&quot;</span>
<span class="nt">COOKIE_FLAGS_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;session_cookie</span><span class="nv"> </span><span class="s">Secure</span><span class="nv"> </span><span class="s">HttpOnly</span><span class="nv"> </span><span class="s">SameSite=Strict&quot;</span>
<span class="nt">COOKIE_FLAGS_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;auth_cookie</span><span class="nv"> </span><span class="s">Secure</span><span class="nv"> </span><span class="s">HttpOnly</span><span class="nv"> </span><span class="s">SameSite=Strict</span><span class="nv"> </span><span class="s">Max-Age=3600&quot;</span>
<span class="nt">COOKIE_AUTO_SECURE_FLAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para un servicio de API con cabeceras personalizadas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">CUSTOM_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;API-Version:</span><span class="nv"> </span><span class="s">1.2.3&quot;</span>
<span class="nt">CUSTOM_HEADER_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Access-Control-Max-Age:</span><span class="nv"> </span><span class="s">86400&quot;</span>
<span class="nt">CONTENT_SECURITY_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">frame-ancestors</span><span class="nv"> </span><span class="s">&#39;none&#39;&quot;</span>
<span class="nt">REMOVE_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Server</span><span class="nv"> </span><span class="s">X-Powered-By</span><span class="nv"> </span><span class="s">X-AspNet-Version</span><span class="nv"> </span><span class="s">X-Runtime&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para probar CSP sin romper la funcionalidad:</p>
<div class="highlight"><pre><span></span><code><span class="nt">CONTENT_SECURITY_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">script-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">https://trusted-cdn.example.com;</span><span class="nv"> </span><span class="s">img-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">data:</span><span class="nv"> </span><span class="s">https://*.example.com;</span><span class="nv"> </span><span class="s">style-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">&#39;unsafe-inline&#39;</span><span class="nv"> </span><span class="s">https://trusted-cdn.example.com;</span><span class="nv"> </span><span class="s">connect-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">https://api.example.com;</span><span class="nv"> </span><span class="s">object-src</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">frame-ancestors</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">form-action</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">base-uri</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">report-uri</span><span class="nv"> </span><span class="s">https://example.com/csp-reports&quot;</span>
<span class="nt">CONTENT_SECURITY_POLICY_REPORT_ONLY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-lets-encrypt">Let's Encrypt</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de Let's Encrypt simplifica la gestión de certificados SSL/TLS al automatizar la creación, renovación y configuración de certificados gratuitos de Let's Encrypt. Esta función permite conexiones HTTPS seguras para sus sitios web sin la complejidad de la gestión manual de certificados, reduciendo tanto los costos como la sobrecarga administrativa.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando está habilitado, BunkerWeb detecta automáticamente los dominios configurados para su sitio web.</li>
<li>BunkerWeb solicita certificados SSL/TLS gratuitos a la autoridad de certificación de Let's Encrypt.</li>
<li>La propiedad del dominio se verifica mediante desafíos HTTP (demostrando que usted controla el sitio web) o desafíos DNS (demostrando que usted controla el DNS de su dominio).</li>
<li>Los certificados se instalan y configuran automáticamente para sus dominios.</li>
<li>BunkerWeb se encarga de las renovaciones de certificados en segundo plano antes de su vencimiento, garantizando la disponibilidad continua de HTTPS.</li>
<li>Todo el proceso está totalmente automatizado, requiriendo una intervención mínima después de la configuración inicial.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Requisitos previos</p>
</div>
<p>Para utilizar esta función, asegúrese de que los <strong>registros A</strong> de DNS adecuados estén configurados para cada dominio, apuntando a la(s) IP(s) pública(s) donde BunkerWeb es accesible. Sin una configuración de DNS correcta, el proceso de verificación del dominio fallará.</p>
<h3 id="es-features-como-usar_18">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Let's Encrypt:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>AUTO_LETS_ENCRYPT</code> en <code>yes</code> para habilitar la emisión y renovación automática de certificados.</li>
<li><strong>Proporcione un correo electrónico de contacto:</strong> Ingrese su dirección de correo electrónico utilizando el ajuste <code>EMAIL_LETS_ENCRYPT</code> para recibir notificaciones importantes sobre sus certificados.</li>
<li><strong>Elija el tipo de desafío:</strong> Seleccione la verificación <code>http</code> o <code>dns</code> con el ajuste <code>LETS_ENCRYPT_CHALLENGE</code>.</li>
<li><strong>Configure el proveedor de DNS:</strong> Si utiliza desafíos DNS, especifique su proveedor de DNS y sus credenciales.</li>
<li><strong>Seleccione el perfil del certificado:</strong> Elija su perfil de certificado preferido utilizando el ajuste <code>LETS_ENCRYPT_PROFILE</code> (classic, tlsserver o shortlived).</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, los certificados se emiten, instalan y renuevan automáticamente según sea necesario.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Perfiles de Certificado</p>
</div>
<p>Let's Encrypt proporciona diferentes perfiles de certificado para diferentes casos de uso: - <strong>classic</strong>: Certificados de propósito general con una validez de 90 días (predeterminado) - <strong>tlsserver</strong>: Optimizado para la autenticación de servidores TLS con una validez de 90 días y una carga útil más pequeña - <strong>shortlived</strong>: Seguridad mejorada con una validez de 7 días para entornos automatizados - <strong>custom</strong>: Si su servidor ACME admite un perfil diferente, configúrelo usando <code>LETS_ENCRYPT_CUSTOM_PROFILE</code>.</p>
<div class="admonition info">
<p class="admonition-title">Disponibilidad del Perfil</p>
</div>
<p>Tenga en cuenta que los perfiles <code>tlsserver</code> y <code>shortlived</code> pueden no estar disponibles en todos los entornos o con todos los clientes ACME en este momento. El perfil <code>classic</code> tiene la compatibilidad más amplia y se recomienda para la mayoría de los usuarios. Si un perfil seleccionado no está disponible, el sistema volverá automáticamente al perfil <code>classic</code>.</p>
<h3 id="es-features-ajustes-de-configuracion_18">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AUTO_LETS_ENCRYPT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Let's Encrypt:</strong> Establezca en <code>yes</code> para habilitar la emisión y renovación automática de certificados.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_PASSTHROUGH</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Pasar a través de Let's Encrypt:</strong> Establezca en <code>yes</code> para pasar las solicitudes de Let's Encrypt al servidor web. Esto es útil cuando BunkerWeb está detrás de otro proxy inverso que maneja SSL.</td>
</tr>
<tr>
<td><code>EMAIL_LETS_ENCRYPT</code></td>
<td><code>contact@{FIRST_SERVER}</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Correo electrónico de contacto:</strong> Dirección de correo electrónico que se utiliza para las notificaciones de Let's Encrypt y se incluye en los certificados.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_CHALLENGE</code></td>
<td><code>http</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tipo de desafío:</strong> Método utilizado para verificar la propiedad del dominio. Opciones: <code>http</code> o <code>dns</code>.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_DNS_PROVIDER</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Proveedor de DNS:</strong> Cuando se utilizan desafíos DNS, el proveedor de DNS a utilizar (por ejemplo, cloudflare, route53, digitalocean).</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_DNS_PROPAGATION</code></td>
<td><code>default</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Propagación de DNS:</strong> El tiempo de espera para la propagación de DNS en segundos. Si no se proporciona ningún valor, se utiliza el tiempo de propagación predeterminado del proveedor.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Elemento de credencial:</strong> Elementos de configuración para la autenticación del proveedor de DNS (por ejemplo, <code>cloudflare_api_token 123456</code>). Los valores pueden ser texto sin formato, codificados en base64 o un objeto JSON.</td>
</tr>
<tr>
<td><code>USE_LETS_ENCRYPT_WILDCARD</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificados comodín:</strong> Cuando se establece en <code>yes</code>, crea certificados comodín para todos los dominios. Solo disponible con desafíos DNS.</td>
</tr>
<tr>
<td><code>USE_LETS_ENCRYPT_STAGING</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Usar entorno de prueba:</strong> Cuando se establece en <code>yes</code>, utiliza el entorno de prueba de Let's Encrypt para realizar pruebas. El entorno de prueba tiene límites de velocidad más altos pero produce certificados que no son de confianza para los navegadores.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_CLEAR_OLD_CERTS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Limpiar certificados antiguos:</strong> Cuando se establece en <code>yes</code>, elimina los certificados antiguos que ya no son necesarios durante la renovación.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_PROFILE</code></td>
<td><code>classic</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Perfil de certificado:</strong> Seleccione el perfil de certificado a utilizar. Opciones: <code>classic</code> (propósito general), <code>tlsserver</code> (optimizado para servidores TLS) o <code>shortlived</code> (certificados de 7 días).</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_CUSTOM_PROFILE</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Perfil de certificado personalizado:</strong> Ingrese un perfil de certificado personalizado si su servidor ACME admite perfiles no estándar. Esto anula <code>LETS_ENCRYPT_PROFILE</code> si está configurado.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_MAX_RETRIES</code></td>
<td><code>3</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Máximo de reintentos:</strong> Número de veces que se reintentará la generación de certificados en caso de fallo. Establezca en <code>0</code> para deshabilitar los reintentos. Útil para manejar problemas de red temporales o límites de velocidad de la API.</td>
</tr>
</tbody>
</table>
<p>!!! info "Información y comportamiento" - El ajuste <code>LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</code> es un ajuste múltiple y se puede utilizar para establecer varios elementos para el proveedor de DNS. Los elementos se guardarán como un archivo de caché, y Certbot leerá las credenciales de él. - Si no se proporciona ningún ajuste <code>LETS_ENCRYPT_DNS_PROPAGATION</code>, se utiliza el tiempo de propagación predeterminado del proveedor. - La automatización completa de Let's Encrypt utilizando el desafío <code>http</code> funciona en modo de flujo (stream) siempre que abra el puerto <code>80/tcp</code> desde el exterior. Utilice el ajuste <code>LISTEN_STREAM_PORT_SSL</code> para elegir su puerto de escucha SSL/TLS. - Si <code>LETS_ENCRYPT_PASSTHROUGH</code> se establece en <code>yes</code>, BunkerWeb no manejará las solicitudes de desafío ACME por sí mismo, sino que las pasará al servidor web de backend. Esto es útil en escenarios donde BunkerWeb actúa como un proxy inverso frente a otro servidor que está configurado para manejar los desafíos de Let's Encrypt.</p>
<div class="admonition tip">
<p class="admonition-title">Desafíos HTTP vs. DNS</p>
</div>
<p><strong>Los desafíos HTTP</strong> son más fáciles de configurar y funcionan bien para la mayoría de los sitios web:</p>
<pre><code>- Requiere que su sitio web sea accesible públicamente en el puerto 80
- Configurado automáticamente por BunkerWeb
- No se puede utilizar para certificados comodín

**Los desafíos DNS** ofrecen más flexibilidad y son necesarios para los certificados comodín:

- Funciona incluso cuando su sitio web no es accesible públicamente
- Requiere credenciales de la API del proveedor de DNS
- Requerido para certificados comodín (por ejemplo, *.example.com)
- Útil cuando el puerto 80 está bloqueado o no está disponible
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Certificados comodín</p>
</div>
<p>Los certificados comodín solo están disponibles con desafíos DNS. Si desea utilizarlos, debe establecer el ajuste <code>USE_LETS_ENCRYPT_WILDCARD</code> en <code>yes</code> y configurar correctamente las credenciales de su proveedor de DNS.</p>
<div class="admonition warning">
<p class="admonition-title">Límites de velocidad</p>
</div>
<p>Let's Encrypt impone límites de velocidad en la emisión de certificados. Al probar las configuraciones, utilice el entorno de prueba estableciendo <code>USE_LETS_ENCRYPT_STAGING</code> en <code>yes</code> para evitar alcanzar los límites de velocidad de producción. Los certificados de prueba no son de confianza para los navegadores, pero son útiles para validar su configuración.</p>
<h3 id="es-features-proveedores-de-dns-compatibles">Proveedores de DNS compatibles</h3>
<p>El complemento de Let's Encrypt admite una amplia gama de proveedores de DNS para los desafíos de DNS. Cada proveedor requiere credenciales específicas que deben proporcionarse utilizando el ajuste <code>LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</code>.</p>
<table>
<thead>
<tr>
<th>Proveedor</th>
<th>Descripción</th>
<th>Ajustes obligatorios</th>
<th>Ajustes opcionales</th>
<th>Documentación</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>bunny</code></td>
<td>bunny.net</td>
<td><code>api_key</code></td>
<td></td>
<td><a href="https://github.com/mwt/certbot-dns-bunny/blob/main/README.rst">Documentación</a></td>
</tr>
<tr>
<td><code>cloudflare</code></td>
<td>Cloudflare</td>
<td>ya sea <code>api_token</code><br>o <code>email</code> y <code>api_key</code></td>
<td></td>
<td><a href="https://certbot-dns-cloudflare.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>desec</code></td>
<td>deSEC</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://github.com/desec-io/certbot-dns-desec/blob/main/README.md">Documentación</a></td>
</tr>
<tr>
<td><code>digitalocean</code></td>
<td>DigitalOcean</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://certbot-dns-digitalocean.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>domainoffensive</code></td>
<td>Domain-Offensive</td>
<td><code>api_token</code></td>
<td></td>
<td><a href="https://github.com/domainoffensive/certbot-dns-domainoffensive/blob/master/README.md">Documentación</a></td>
</tr>
<tr>
<td><code>dnsimple</code></td>
<td>DNSimple</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://certbot-dns-dnsimple.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>dnsmadeeasy</code></td>
<td>DNS Made Easy</td>
<td><code>api_key</code><br><code>secret_key</code></td>
<td></td>
<td><a href="https://certbot-dns-dnsmadeeasy.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>dynu</code></td>
<td>Dynu</td>
<td><code>auth_token</code></td>
<td></td>
<td><a href="https://github.com/bikram990/certbot-dns-dynu/blob/main/README.md">Documentación</a></td>
</tr>
<tr>
<td><code>gehirn</code></td>
<td>Gehirn DNS</td>
<td><code>api_token</code><br><code>api_secret</code></td>
<td></td>
<td><a href="https://certbot-dns-gehirn.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>google</code></td>
<td>Google Cloud</td>
<td><code>project_id</code><br><code>private_key_id</code><br><code>private_key</code><br><code>client_email</code><br><code>client_id</code><br><code>client_x509_cert_url</code></td>
<td><code>type</code> (predeterminado: <code>service_account</code>)<br><code>auth_uri</code> (predeterminado: <code>https://accounts.google.com/o/oauth2/auth</code>)<br><code>token_uri</code> (predeterminado: <code>https://accounts.google.com/o/oauth2/token</code>)<br><code>auth_provider_x509_cert_url</code> (predeterminado: <code>https://www.googleapis.com/oauth2/v1/certs</code>)</td>
<td><a href="https://certbot-dns-google.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>infomaniak</code></td>
<td>Infomaniak</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://github.com/infomaniak/certbot-dns-infomaniak/blob/main/README.rst">Documentación</a></td>
</tr>
<tr>
<td><code>ionos</code></td>
<td>IONOS</td>
<td><code>prefix</code><br><code>secret</code></td>
<td><code>endpoint</code> (predeterminado: <code>https://api.hosting.ionos.com</code>)</td>
<td><a href="https://github.com/helgeerbe/certbot-dns-ionos/blob/master/README.md">Documentación</a></td>
</tr>
<tr>
<td><code>linode</code></td>
<td>Linode</td>
<td><code>key</code></td>
<td></td>
<td><a href="https://certbot-dns-linode.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>luadns</code></td>
<td>LuaDNS</td>
<td><code>email</code><br><code>token</code></td>
<td></td>
<td><a href="https://certbot-dns-luadns.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>njalla</code></td>
<td>Njalla</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://github.com/chaptergy/certbot-dns-njalla/blob/main/README.md">Documentación</a></td>
</tr>
<tr>
<td><code>nsone</code></td>
<td>NS1</td>
<td><code>api_key</code></td>
<td></td>
<td><a href="https://certbot-dns-nsone.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>ovh</code></td>
<td>OVH</td>
<td><code>application_key</code><br><code>application_secret</code><br><code>consumer_key</code></td>
<td><code>endpoint</code> (predeterminado: <code>ovh-eu</code>)</td>
<td><a href="https://certbot-dns-ovh.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>rfc2136</code></td>
<td>RFC 2136</td>
<td><code>server</code><br><code>name</code><br><code>secret</code></td>
<td><code>port</code> (predeterminado: <code>53</code>)<br><code>algorithm</code> (predeterminado: <code>HMAC-SHA512</code>)<br><code>sign_query</code> (predeterminado: <code>false</code>)</td>
<td><a href="https://certbot-dns-rfc2136.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>route53</code></td>
<td>Amazon Route 53</td>
<td><code>access_key_id</code><br><code>secret_access_key</code></td>
<td></td>
<td><a href="https://certbot-dns-route53.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>sakuracloud</code></td>
<td>Sakura Cloud</td>
<td><code>api_token</code><br><code>api_secret</code></td>
<td></td>
<td><a href="https://certbot-dns-sakuracloud.readthedocs.io/en/stable/">Documentación</a></td>
</tr>
<tr>
<td><code>scaleway</code></td>
<td>Scaleway</td>
<td><code>application_token</code></td>
<td></td>
<td><a href="https://github.com/vanonox/certbot-dns-scaleway/blob/main/README.rst">Documentación</a></td>
</tr>
</tbody>
</table>
<h3 id="es-features-configuraciones-de-ejemplo_19">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="45:6"><input checked="checked" id="es-features-__tabbed_45_1" name="es-features-__tabbed_45" type="radio" /><input id="es-features-__tabbed_45_2" name="es-features-__tabbed_45" type="radio" /><input id="es-features-__tabbed_45_3" name="es-features-__tabbed_45" type="radio" /><input id="es-features-__tabbed_45_4" name="es-features-__tabbed_45" type="radio" /><input id="es-features-__tabbed_45_5" name="es-features-__tabbed_45" type="radio" /><input id="es-features-__tabbed_45_6" name="es-features-__tabbed_45" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_45_1">Desafío HTTP Básico</label><label for="es-features-__tabbed_45_2">DNS de Cloudflare con Comodín</label><label for="es-features-__tabbed_45_3">Configuración de AWS Route53</label><label for="es-features-__tabbed_45_4">Pruebas con el Entorno de Prueba y Reintentos</label><label for="es-features-__tabbed_45_5">DigitalOcean con Tiempo de Propagación Personalizado</label><label for="es-features-__tabbed_45_6">DNS de Google Cloud</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Configuración simple que utiliza desafíos HTTP para un solo dominio:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para certificados comodín utilizando el DNS de Cloudflare:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cloudflare&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;api_token</span><span class="nv"> </span><span class="s">SU_TOKEN_DE_API&quot;</span>
<span class="nt">USE_LETS_ENCRYPT_WILDCARD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que utiliza Amazon Route53 para los desafíos de DNS:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;route53&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;aws_access_key_id</span><span class="nv"> </span><span class="s">SU_CLAVE_DE_ACCESO&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;aws_secret_access_key</span><span class="nv"> </span><span class="s">SU_CLAVE_SECRETA&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para probar la configuración con el entorno de prueba y ajustes de reintento mejorados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
<span class="nt">USE_LETS_ENCRYPT_STAGING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LETS_ENCRYPT_MAX_RETRIES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que utiliza el DNS de DigitalOcean con un tiempo de espera de propagación más largo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;digitalocean&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;token</span><span class="nv"> </span><span class="s">SU_TOKEN_DE_API&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROPAGATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;120&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que utiliza el DNS de Google Cloud con credenciales de cuenta de servicio:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;google&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;project_id</span><span class="nv"> </span><span class="s">su-id-de-proyecto&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;private_key_id</span><span class="nv"> </span><span class="s">su-id-de-clave-privada&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;private_key</span><span class="nv"> </span><span class="s">su-clave-privada&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_4</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;client_email</span><span class="nv"> </span><span class="s">su-correo-de-cuenta-de-servicio&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_5</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;client_id</span><span class="nv"> </span><span class="s">su-id-de-cliente&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_6</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;client_x509_cert_url</span><span class="nv"> </span><span class="s">su-url-de-certificado&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-limit">Limit</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento de Límite en BunkerWeb proporciona capacidades robustas para aplicar políticas de limitación en su sitio web, asegurando un uso justo y protegiendo sus recursos del abuso, ataques de denegación de servicio y consumo excesivo de recursos. Estas políticas incluyen:</p>
<ul>
<li><strong>Número de conexiones por dirección IP</strong> (soporte para STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" />)</li>
<li><strong>Número de solicitudes por dirección IP y URL dentro de un período de tiempo específico</strong> (soporte para STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" />)</li>
</ul>
<h3 id="es-features-como-funciona_1">Cómo funciona</h3>
<ol>
<li><strong>Limitación de Tasa de Solicitudes:</strong> Rastrea el número de solicitudes de cada dirección IP del cliente a URL específicas. Si un cliente excede el límite de tasa configurado, las solicitudes posteriores son denegadas temporalmente.</li>
<li><strong>Limitación de Conexiones:</strong> Monitorea y restringe el número de conexiones concurrentes de cada dirección IP del cliente. Se pueden aplicar diferentes límites de conexión según el protocolo utilizado (HTTP/1, HTTP/2, HTTP/3 o stream).</li>
<li>En ambos casos, los clientes que exceden los límites definidos reciben un código de estado HTTP <strong>"429 - Demasiadas Solicitudes"</strong>, lo que ayuda a prevenir la sobrecarga del servidor.</li>
</ol>
<h3 id="es-features-pasos-para-usar">Pasos para usar</h3>
<ol>
<li><strong>Habilitar la Limitación de Tasa de Solicitudes:</strong> Use <code>USE_LIMIT_REQ</code> para habilitar la limitación de tasa de solicitudes y defina patrones de URL junto con sus correspondientes límites de tasa.</li>
<li><strong>Habilitar la Limitación de Conexiones:</strong> Use <code>USE_LIMIT_CONN</code> para habilitar la limitación de conexiones y establezca el número máximo de conexiones concurrentes para diferentes protocolos.</li>
<li><strong>Aplicar Control Granular:</strong> Cree múltiples reglas de límite de tasa para diferentes URL para proporcionar diferentes niveles de protección en su sitio.</li>
<li><strong>Monitorear la Efectividad:</strong> Use la <a href="#es-web-ui">interfaz de usuario web</a> para ver estadísticas sobre las solicitudes y conexiones limitadas.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_19">Ajustes de Configuración</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="46:2"><input checked="checked" id="es-features-__tabbed_46_1" name="es-features-__tabbed_46" type="radio" /><input id="es-features-__tabbed_46_2" name="es-features-__tabbed_46" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_46_1">Limitación de Tasa de Solicitudes</label><label for="es-features-__tabbed_46_2">Limitación de Conexiones</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_LIMIT_REQ</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Limitación de Solicitudes:</strong> Establezca en <code>yes</code> para habilitar la función de limitación de tasa de solicitudes.</td>
</tr>
<tr>
<td><code>LIMIT_REQ_URL</code></td>
<td><code>/</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Patrón de URL:</strong> Patrón de URL (expresión regular PCRE) al que se aplicará el límite de tasa; use <code>/</code> para aplicar a todas las solicitudes.</td>
</tr>
<tr>
<td><code>LIMIT_REQ_RATE</code></td>
<td><code>2r/s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Límite de Tasa:</strong> Tasa máxima de solicitudes en el formato <code>Nr/t</code>, donde N es el número de solicitudes y t es la unidad de tiempo: s (segundo), m (minuto), h (hora) o d (día).</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Formato de Limitación de Tasa</p>
<p>El formato del límite de tasa se especifica como <code>Nr/t</code> donde:</p>
<ul>
<li><code>N</code> es el número de solicitudes permitidas</li>
<li><code>r</code> es una 'r' literal (para 'solicitudes')</li>
<li><code>/</code> es una barra literal</li>
<li><code>t</code> es la unidad de tiempo: <code>s</code> (segundo), <code>m</code> (minuto), <code>h</code> (hora) o <code>d</code> (día)</li>
</ul>
<p>Por ejemplo, <code>5r/m</code> significa que se permiten 5 solicitudes por minuto desde cada dirección IP.</p>
</div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_LIMIT_CONN</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Limitación de Conexiones:</strong> Establezca en <code>yes</code> para habilitar la función de limitación de conexiones.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_HTTP1</code></td>
<td><code>10</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Conexiones HTTP/1.X:</strong> Número máximo de conexiones HTTP/1.X concurrentes por dirección IP.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_HTTP2</code></td>
<td><code>100</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Flujos HTTP/2:</strong> Número máximo de flujos HTTP/2 concurrentes por dirección IP.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_HTTP3</code></td>
<td><code>100</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Flujos HTTP/3:</strong> Número máximo de flujos HTTP/3 concurrentes por dirección IP.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_STREAM</code></td>
<td><code>10</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Conexiones de Flujo:</strong> Número máximo de conexiones de flujo concurrentes por dirección IP.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<p>!!! info "Limitación de Conexiones vs. Solicitudes" - <strong>La limitación de conexiones</strong> restringe el número de conexiones simultáneas que una sola dirección IP puede mantener. - <strong>La limitación de tasa de solicitudes</strong> restringe el número de solicitudes que una dirección IP puede hacer dentro de un período de tiempo definido.</p>
<pre><code>El uso de ambos métodos proporciona una protección completa contra varios tipos de abuso.
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Estableciendo Límites Apropiados</p>
</div>
<p>Establecer límites demasiado restrictivos puede afectar a los usuarios legítimos, especialmente para HTTP/2 y HTTP/3, donde los navegadores a menudo usan múltiples flujos. Los valores predeterminados están equilibrados para la mayoría de los casos de uso, pero considere ajustarlos según las necesidades de su aplicación y el comportamiento del usuario.</p>
<h3 id="es-features-configuraciones-de-ejemplo_20">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="47:4"><input checked="checked" id="es-features-__tabbed_47_1" name="es-features-__tabbed_47" type="radio" /><input id="es-features-__tabbed_47_2" name="es-features-__tabbed_47" type="radio" /><input id="es-features-__tabbed_47_3" name="es-features-__tabbed_47" type="radio" /><input id="es-features-__tabbed_47_4" name="es-features-__tabbed_47" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_47_1">Protección Básica</label><label for="es-features-__tabbed_47_2">Protegiendo Puntos Finales Específicos</label><label for="es-features-__tabbed_47_3">Configuración para un Sitio de Alto Tráfico</label><label for="es-features-__tabbed_47_4">Configuración para un Servidor API</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que utiliza los ajustes predeterminados para proteger todo su sitio:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2r/s&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con diferentes límites de tasa para varios puntos finales:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Regla predeterminada para todas las solicitudes</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10r/s&quot;</span>

<span class="c1"># Límite más estricto para la página de inicio de sesión</span>
<span class="nt">LIMIT_REQ_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/login&quot;</span>
<span class="nt">LIMIT_REQ_RATE_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1r/s&quot;</span>

<span class="c1"># Límite más estricto para la API</span>
<span class="nt">LIMIT_REQ_URL_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/&quot;</span>
<span class="nt">LIMIT_REQ_RATE_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5r/s&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración ajustada para sitios de alto tráfico con límites más permisivos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Límite general</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30r/s&quot;</span>

<span class="c1"># Protección del área de administración</span>
<span class="nt">LIMIT_REQ_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/admin/&quot;</span>
<span class="nt">LIMIT_REQ_RATE_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5r/s&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;50&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;200&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;200&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración optimizada para un servidor API con límites de tasa expresados en solicitudes por minuto:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Puntos finales de la API pública</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/public/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;120r/m&quot;</span>

<span class="c1"># Puntos finales de la API privada</span>
<span class="nt">LIMIT_REQ_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/private/&quot;</span>
<span class="nt">LIMIT_REQ_RATE_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300r/m&quot;</span>

<span class="c1"># Punto final de autenticación</span>
<span class="nt">LIMIT_REQ_URL_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/auth&quot;</span>
<span class="nt">LIMIT_REQ_RATE_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10r/m&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-load-balancer-pro">Load Balancer <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Provides load balancing feature to group of upstreams with optional healthchecks.</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_DICT_SIZE</code></td>
<td><code>10m</code></td>
<td>global</td>
<td>no</td>
<td>Shared dict size (datastore for all healthchecks).</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_NAME</code></td>
<td></td>
<td>global</td>
<td>sí</td>
<td>Name of the upstream (used in REVERSE_PROXY_HOST).</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_SERVERS</code></td>
<td></td>
<td>global</td>
<td>sí</td>
<td>List of servers/IPs in the server group.</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_MODE</code></td>
<td><code>round-robin</code></td>
<td>global</td>
<td>sí</td>
<td>Load balancing mode (round-robin or sticky).</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_STICKY_METHOD</code></td>
<td><code>ip</code></td>
<td>global</td>
<td>sí</td>
<td>Sticky session method (ip or cookie).</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_RESOLVE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>sí</td>
<td>Dynamically resolve upstream hostnames.</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_KEEPALIVE_TIMEOUT</code></td>
<td><code>60s</code></td>
<td>global</td>
<td>sí</td>
<td>Keepalive timeout for upstream connections.</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_KEEPALIVE_TIME</code></td>
<td><code>1h</code></td>
<td>global</td>
<td>sí</td>
<td>Keepalive time for upstream connections.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_URL</code></td>
<td><code>/status</code></td>
<td>global</td>
<td>sí</td>
<td>The healthcheck URL.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_INTERVAL</code></td>
<td><code>2000</code></td>
<td>global</td>
<td>sí</td>
<td>Healthcheck interval in milliseconds.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_TIMEOUT</code></td>
<td><code>1000</code></td>
<td>global</td>
<td>sí</td>
<td>Healthcheck timeout in milliseconds.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_FALL</code></td>
<td><code>3</code></td>
<td>global</td>
<td>sí</td>
<td>Number of failed healthchecks before marking the server as down.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_RISE</code></td>
<td><code>1</code></td>
<td>global</td>
<td>sí</td>
<td>Number of successful healthchecks before marking the server as up.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_VALID_STATUSES</code></td>
<td><code>200</code></td>
<td>global</td>
<td>sí</td>
<td>HTTP status considered valid in healthchecks.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_CONCURRENCY</code></td>
<td><code>10</code></td>
<td>global</td>
<td>sí</td>
<td>Maximum number of concurrent healthchecks.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_TYPE</code></td>
<td><code>http</code></td>
<td>global</td>
<td>sí</td>
<td>Type of healthcheck (http or https).</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_SSL_VERIFY</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>sí</td>
<td>Verify SSL certificate in healthchecks.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_HOST</code></td>
<td></td>
<td>global</td>
<td>sí</td>
<td>Host header for healthchecks (useful for HTTPS).</td>
</tr>
</tbody>
</table>
<h2 id="es-features-metrics">Metrics</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento de Métricas proporciona capacidades completas de monitoreo y recolección de datos para su instancia de BunkerWeb. Esta función le permite rastrear varios indicadores de rendimiento, eventos de seguridad y estadísticas del sistema, brindándole información valiosa sobre el comportamiento y la salud de sus sitios web y servicios protegidos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>BunkerWeb recopila métricas clave durante el procesamiento de solicitudes y respuestas.</li>
<li>Estas métricas incluyen contadores de solicitudes bloqueadas, mediciones de rendimiento y varias estadísticas relacionadas con la seguridad.</li>
<li>Los datos se almacenan de manera eficiente en la memoria, con límites configurables para evitar el uso excesivo de recursos.</li>
<li>Para configuraciones de múltiples instancias, se puede usar Redis para centralizar y agregar datos de métricas.</li>
<li>Las métricas recopiladas se pueden acceder a través de la API o visualizarse en la <a href="#es-web-ui">interfaz de usuario web</a>.</li>
<li>Esta información le ayuda a identificar amenazas de seguridad, solucionar problemas y optimizar su configuración.</li>
</ol>
<h3 id="es-features-implementacion-tecnica">Implementación Técnica</h3>
<p>El complemento de métricas funciona mediante:</p>
<ul>
<li>El uso de diccionarios compartidos en NGINX, donde <code>metrics_datastore</code> se utiliza para HTTP y <code>metrics_datastore_stream</code> para el tráfico TCP/UDP</li>
<li>El aprovechamiento de una caché LRU para un almacenamiento eficiente en memoria</li>
<li>La sincronización periódica de datos entre los trabajadores (workers) mediante temporizadores</li>
<li>El almacenamiento de información detallada sobre las solicitudes bloqueadas, incluida la dirección IP del cliente, el país, la marca de tiempo, los detalles de la solicitud y el motivo del bloqueo</li>
<li>El soporte para métricas específicas de complementos a través de una interfaz común de recolección de métricas</li>
<li>La provisión de puntos finales de API para consultar las métricas recopiladas</li>
</ul>
<h3 id="es-features-como-usar_19">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Métricas:</p>
<ol>
<li><strong>Habilite la función:</strong> La recolección de métricas está habilitada por defecto. Puede controlar esto con el ajuste <code>USE_METRICS</code>.</li>
<li><strong>Configure la asignación de memoria:</strong> Establezca la cantidad de memoria a asignar para el almacenamiento de métricas utilizando el ajuste <code>METRICS_MEMORY_SIZE</code>.</li>
<li><strong>Establezca los límites de almacenamiento:</strong> Defina cuántas solicitudes bloqueadas almacenar por trabajador y en Redis con los ajustes respectivos.</li>
<li><strong>Acceda a los datos:</strong> Vea las métricas recopiladas a través de la <a href="#es-web-ui">interfaz de usuario web</a> o los puntos finales de la API.</li>
<li><strong>Analice la información:</strong> Use los datos recopilados para identificar patrones, detectar problemas de seguridad y optimizar su configuración.</li>
</ol>
<h3 id="es-features-metricas-recopiladas">Métricas Recopiladas</h3>
<p>El complemento de métricas recopila la siguiente información:</p>
<ol>
<li>
<p><strong>Solicitudes Bloqueadas</strong>: Para cada solicitud bloqueada, se almacenan los siguientes datos:</p>
<ul>
<li>ID de la solicitud y marca de tiempo</li>
<li>Dirección IP del cliente y país (cuando esté disponible)</li>
<li>Método HTTP y URL</li>
<li>Código de estado HTTP</li>
<li>Agente de usuario</li>
<li>Motivo del bloqueo y modo de seguridad</li>
<li>Nombre del servidor</li>
<li>Datos adicionales relacionados con el motivo del bloqueo</li>
</ul>
</li>
<li>
<p><strong>Contadores de Complementos</strong>: Varios contadores específicos de complementos que rastrean actividades y eventos.</p>
</li>
</ol>
<h3 id="es-features-acceso-a-la-api">Acceso a la API</h3>
<p>Se puede acceder a los datos de las métricas a través de los puntos finales de la API interna de BunkerWeb:</p>
<ul>
<li><strong>Punto final</strong>: <code>/metrics/{filtro}</code></li>
<li><strong>Método</strong>: GET</li>
<li><strong>Descripción</strong>: Recupera los datos de las métricas según el filtro especificado</li>
<li><strong>Formato de respuesta</strong>: Objeto JSON que contiene las métricas solicitadas</li>
</ul>
<p>Por ejemplo, <code>/metrics/requests</code> devuelve información sobre las solicitudes bloqueadas.</p>
<div class="admonition info">
<p class="admonition-title">Configuración del Acceso a la API</p>
</div>
<p>Para acceder a las métricas a través de la API, debe asegurarse de que:</p>
<pre><code>1.  La función de API esté habilitada con `USE_API: "yes"` (habilitada por defecto)
2.  Su IP de cliente esté incluida en el ajuste `API_WHITELIST_IP` (el valor predeterminado es `127.0.0.0/8`)
3.  Esté accediendo a la API en el puerto configurado (el valor predeterminado es `5000` a través del ajuste `API_HTTP_PORT`)
4.  Esté utilizando el valor correcto de `API_SERVER_NAME` en el encabezado Host (el valor predeterminado es `bwapi`)
5.  Si `API_TOKEN` está configurado, incluya `Authorization: Bearer &lt;token&gt;` en los encabezados de la solicitud.

Solicitudes típicas:

Sin token (cuando `API_TOKEN` no está configurado):
```bash
curl -H "Host: bwapi" \
     http://su-instancia-de-bunkerweb:5000/metrics/requests
```

Con token (cuando `API_TOKEN` está configurado):
```bash
curl -H "Host: bwapi" \
     -H "Authorization: Bearer $API_TOKEN" \
     http://su-instancia-de-bunkerweb:5000/metrics/requests
```

Si ha personalizado el `API_SERVER_NAME` a algo diferente del valor predeterminado `bwapi`, use ese valor en el encabezado Host en su lugar.

Para entornos de producción seguros, restrinja el acceso a la API a IPs de confianza y habilite `API_TOKEN`.
</code></pre>
<h3 id="es-features-ajustes-de-configuracion_20">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_METRICS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Métricas:</strong> Establezca en <code>yes</code> para habilitar la recolección y recuperación de métricas.</td>
</tr>
<tr>
<td><code>METRICS_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tamaño de la Memoria:</strong> Tamaño del almacenamiento interno para las métricas (p. ej., <code>16m</code>, <code>32m</code>).</td>
</tr>
<tr>
<td><code>METRICS_MAX_BLOCKED_REQUESTS</code></td>
<td><code>1000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Máximo de Solicitudes Bloqueadas:</strong> Número máximo de solicitudes bloqueadas para almacenar por trabajador.</td>
</tr>
<tr>
<td><code>METRICS_MAX_BLOCKED_REQUESTS_REDIS</code></td>
<td><code>100000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Máximo de Solicitudes Bloqueadas en Redis:</strong> Número máximo de solicitudes bloqueadas para almacenar en Redis.</td>
</tr>
<tr>
<td><code>METRICS_SAVE_TO_REDIS</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Guardar Métricas en Redis:</strong> Establezca en <code>yes</code> para guardar las métricas (contadores y tablas) en Redis para la agregación en todo el clúster.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Dimensionamiento de la Asignación de Memoria</p>
</div>
<p>El ajuste <code>METRICS_MEMORY_SIZE</code> debe ajustarse en función de su volumen de tráfico y el número de instancias. Para sitios de alto tráfico, considere aumentar este valor para garantizar que todas las métricas se capturen sin pérdida de datos.</p>
<div class="admonition info">
<p class="admonition-title">Integración con Redis</p>
</div>
<p>Cuando BunkerWeb está configurado para usar <a href="#es-features-redis">Redis</a>, el complemento de métricas sincronizará automáticamente los datos de las solicitudes bloqueadas con el servidor Redis. Esto proporciona una vista centralizada de los eventos de seguridad en múltiples instancias de BunkerWeb.</p>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de Rendimiento</p>
</div>
<p>Establecer valores muy altos para <code>METRICS_MAX_BLOCKED_REQUESTS</code> o <code>METRICS_MAX_BLOCKED_REQUESTS_REDIS</code> puede aumentar el uso de la memoria. Supervise los recursos de su sistema y ajuste estos valores según sus necesidades reales y los recursos disponibles.</p>
<div class="admonition note">
<p class="admonition-title">Almacenamiento Específico del Trabajador</p>
</div>
<p>Cada trabajador de NGINX mantiene sus propias métricas en la memoria. Al acceder a las métricas a través de la API, los datos de todos los trabajadores se agregan automáticamente para proporcionar una vista completa.</p>
<h3 id="es-features-configuraciones-de-ejemplo_21">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="48:4"><input checked="checked" id="es-features-__tabbed_48_1" name="es-features-__tabbed_48" type="radio" /><input id="es-features-__tabbed_48_2" name="es-features-__tabbed_48" type="radio" /><input id="es-features-__tabbed_48_3" name="es-features-__tabbed_48" type="radio" /><input id="es-features-__tabbed_48_4" name="es-features-__tabbed_48" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_48_1">Configuración Básica</label><label for="es-features-__tabbed_48_2">Entorno de Bajos Recursos</label><label for="es-features-__tabbed_48_3">Entorno de Alto Tráfico</label><label for="es-features-__tabbed_48_4">Métricas Deshabilitadas</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Configuración predeterminada adecuada para la mayoría de las implementaciones:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">METRICS_MEMORY_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16m&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100000&quot;</span>
<span class="nt">METRICS_SAVE_TO_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración optimizada para entornos con recursos limitados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">METRICS_MEMORY_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;8m&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10000&quot;</span>
<span class="nt">METRICS_SAVE_TO_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para sitios web de alto tráfico que necesitan rastrear más eventos de seguridad:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">METRICS_MEMORY_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;64m&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5000&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500000&quot;</span>
<span class="nt">METRICS_SAVE_TO_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con la recolección de métricas deshabilitada:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-migration-pro">Migration <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>Migration of BunkerWeb configuration between instances made easy via the web UI</p>
<h2 id="es-features-miscellaneous">Miscellaneous</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento Varios proporciona <strong>ajustes básicos esenciales</strong> que ayudan a mantener la seguridad y la funcionalidad de su sitio web. Este componente principal ofrece controles integrales para:</p>
<ul>
<li><strong>Comportamiento del servidor</strong> - Configure cómo responde su servidor a diversas solicitudes</li>
<li><strong>Ajustes HTTP</strong> - Gestione métodos, tamaños de solicitud y opciones de protocolo</li>
<li><strong>Gestión de archivos</strong> - Controle la entrega de archivos estáticos y optimice la entrega</li>
<li><strong>Soporte de protocolos</strong> - Habilite protocolos HTTP modernos para un mejor rendimiento</li>
<li><strong>Configuraciones del sistema</strong> - Amplíe la funcionalidad y mejore la seguridad</li>
</ul>
<p>Ya sea que necesite restringir los métodos HTTP, gestionar los tamaños de las solicitudes, optimizar el almacenamiento en caché de archivos o controlar cómo responde su servidor a diversas solicitudes, este complemento le brinda las herramientas para <strong>afinar el comportamiento de su servicio web</strong> mientras optimiza tanto el rendimiento como la seguridad.</p>
<h3 id="es-features-caracteristicas-clave">Características Clave</h3>
<table>
<thead>
<tr>
<th>Categoría de Característica</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Control de Métodos HTTP</strong></td>
<td>Defina qué métodos HTTP son aceptables para su aplicación</td>
</tr>
<tr>
<td><strong>Protección del Servidor Predeterminado</strong></td>
<td>Prevenga el acceso no autorizado a través de discrepancias de nombre de host y exija SNI para conexiones seguras</td>
</tr>
<tr>
<td><strong>Gestión del Tamaño de la Solicitud</strong></td>
<td>Establezca límites para los cuerpos de las solicitudes de los clientes y las cargas de archivos</td>
</tr>
<tr>
<td><strong>Entrega de Archivos Estáticos</strong></td>
<td>Configure y optimice la entrega de contenido estático desde carpetas raíz personalizadas</td>
</tr>
<tr>
<td><strong>Almacenamiento en Caché de Archivos</strong></td>
<td>Mejore el rendimiento a través de mecanismos avanzados de almacenamiento en caché de descriptores de archivos con ajustes personalizables</td>
</tr>
<tr>
<td><strong>Soporte de Protocolos</strong></td>
<td>Configure opciones de protocolos HTTP modernos (HTTP2/HTTP3) y ajustes de puerto Alt-Svc</td>
</tr>
<tr>
<td><strong>Informes Anónimos</strong></td>
<td>Informes de estadísticas de uso opcionales para ayudar a mejorar BunkerWeb</td>
</tr>
<tr>
<td><strong>Soporte de Complementos Externos</strong></td>
<td>Amplíe la funcionalidad integrando complementos externos a través de URL</td>
</tr>
<tr>
<td><strong>Control de Estado HTTP</strong></td>
<td>Configure cómo responde su servidor al denegar solicitudes (incluida la terminación de la conexión)</td>
</tr>
</tbody>
</table>
<h3 id="es-features-guia-de-configuracion_1">Guía de Configuración</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="49:1"><input checked="checked" id="es-features-__tabbed_49_1" name="es-features-__tabbed_49" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_49_1">Seguridad del Servidor Predeterminado</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Controles del Servidor Predeterminado</strong></p>
<p>En HTTP, el encabezado <code>Host</code> especifica el servidor de destino, pero puede estar ausente o ser desconocido, a menudo debido a que los bots buscan vulnerabilidades.</p>
<p>Para bloquear tales solicitudes:</p>
<ul>
<li>Establezca <code>DISABLE_DEFAULT_SERVER</code> en <code>yes</code> para denegar silenciosamente tales solicitudes utilizando el <a href="https://http.dev/444">código de estado <code>444</code> de NGINX</a>.</li>
<li>Para una seguridad más estricta, habilite <code>DISABLE_DEFAULT_SERVER_STRICT_SNI</code> para rechazar las conexiones SSL/TLS sin un SNI válido.</li>
</ul>
<div class="admonition success">
<p class="admonition-title">Beneficios de Seguridad</p>
<ul>
<li>Bloquea la manipulación del encabezado Host y el escaneo de hosts virtuales</li>
<li>Mitiga los riesgos de contrabando de solicitudes HTTP</li>
<li>Elimina el servidor predeterminado como un vector de ataque</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DISABLE_DEFAULT_SERVER</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Servidor Predeterminado:</strong> Establezca en <code>yes</code> para deshabilitar el servidor predeterminado cuando ningún nombre de host coincida con la solicitud.</td>
</tr>
<tr>
<td><code>DISABLE_DEFAULT_SERVER_STRICT_SNI</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>SNI Estricto:</strong> Cuando se establece en <code>yes</code>, requiere SNI para las conexiones HTTPS y rechaza las conexiones sin un SNI válido.</td>
</tr>
</tbody>
</table>
<pre><code>!!! warning "Aplicación de SNI"
    Habilitar la validación estricta de SNI proporciona una seguridad más fuerte, pero puede causar problemas si BunkerWeb está detrás de un proxy inverso que reenvía las solicitudes HTTPS sin preservar la información de SNI. Pruebe a fondo antes de habilitarlo en entornos de producción.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="50:1"><input checked="checked" id="es-features-__tabbed_50_1" name="es-features-__tabbed_50" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_50_1">Estado HTTP de Denegación</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Control de Estado HTTP</strong></p>
<p>El primer paso para manejar el acceso denegado del cliente es definir la acción apropiada. Esto se puede configurar usando el ajuste <code>DENY_HTTP_STATUS</code>. Cuando BunkerWeb deniega una solicitud, puede controlar su respuesta usando este ajuste. Por defecto, devuelve un estado <code>403 Prohibido</code>, mostrando una página web o contenido personalizado al cliente.</p>
<p>Alternativamente, establecerlo en <code>444</code> cierra la conexión inmediatamente sin enviar ninguna respuesta. Este <a href="https://http.dev/444">código de estado no estándar</a>, específico de NGINX, es útil para descartar silenciosamente las solicitudes no deseadas.</p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DENY_HTTP_STATUS</code></td>
<td><code>403</code></td>
<td>global</td>
<td>no</td>
<td><strong>Estado HTTP de Denegación:</strong> Código de estado HTTP a enviar cuando se deniega la solicitud (403 o 444). El código 444 cierra la conexión.</td>
</tr>
</tbody>
</table>
<pre><code>!!! warning "Consideraciones del Código de Estado 444"
    Dado que los clientes no reciben retroalimentación, la solución de problemas puede ser más desafiante. Se recomienda establecer `444` solo si ha abordado a fondo los falsos positivos, tiene experiencia con BunkerWeb y requiere un mayor nivel de seguridad.

!!! info "Modo stream"
    En **modo stream**, este ajuste siempre se aplica como `444`, lo que significa que la conexión se cerrará, independientemente del valor configurado.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="51:1"><input checked="checked" id="es-features-__tabbed_51_1" name="es-features-__tabbed_51" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_51_1">Métodos HTTP</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Control de Métodos HTTP</strong></p>
<p>Restringir los métodos HTTP solo a los requeridos por su aplicación es una medida de seguridad fundamental que se adhiere al principio de privilegio mínimo. Al definir explícitamente los métodos HTTP aceptables, puede minimizar el riesgo de explotación a través de métodos no utilizados o peligrosos.</p>
<p>Esta característica se configura utilizando el ajuste <code>ALLOWED_METHODS</code>, donde los métodos se enumeran y se separan por un <code>|</code> (predeterminado: <code>GET|POST|HEAD</code>). Si un cliente intenta utilizar un método no listado, el servidor responderá con un estado <strong>405 - Método No Permitido</strong>.</p>
<p>Para la mayoría de los sitios web, el predeterminado <code>GET|POST|HEAD</code> es suficiente. Si su aplicación utiliza API RESTful, es posible que deba incluir métodos como <code>PUT</code> y <code>DELETE</code>.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios de Seguridad</p>
<ul>
<li>Previene la explotación de métodos HTTP no utilizados o innecesarios</li>
<li>Reduce la superficie de ataque al deshabilitar métodos potencialmente dañinos</li>
<li>Bloquea las técnicas de enumeración de métodos HTTP utilizadas por los atacantes</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALLOWED_METHODS</code></td>
<td><code>GET              | POST     | HEAD</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Métodos HTTP:</strong> Lista de métodos HTTP permitidos, separados por caracteres de barra vertical.</td>
</tr>
</tbody>
</table>
<pre><code>!!! abstract "CORS y Solicitudes de Pre-vuelo"
    Si su aplicación admite [Intercambio de Recursos de Origen Cruzado (CORS)](#cors), debe incluir el método `OPTIONS` en el ajuste `ALLOWED_METHODS` para manejar las solicitudes de pre-vuelo. Esto garantiza la funcionalidad adecuada para los navegadores que realizan solicitudes de origen cruzado.

!!! danger "Consideraciones de Seguridad"
    -   **Evite habilitar `TRACE` o `CONNECT`:** Estos métodos rara vez se necesitan y pueden introducir riesgos de seguridad significativos, como habilitar el Rastreo entre Sitios (XST) o ataques de túnel.
    -   **Revise regularmente los métodos permitidos:** Audite periódicamente el ajuste `ALLOWED_METHODS` para asegurarse de que se alinee con los requisitos actuales de su aplicación.
    -   **Pruebe a fondo antes de la implementación:** Los cambios en las restricciones de los métodos HTTP pueden afectar la funcionalidad de la aplicación. Valide su configuración en un entorno de preproducción antes de aplicarla a la producción.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="52:1"><input checked="checked" id="es-features-__tabbed_52_1" name="es-features-__tabbed_52" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_52_1">Límites de Tamaño de Solicitud</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Límites de Tamaño de Solicitud</strong></p>
<p>El tamaño máximo del cuerpo de la solicitud se puede controlar utilizando el ajuste <code>MAX_CLIENT_SIZE</code> (predeterminado: <code>10m</code>). Los valores aceptados siguen la sintaxis descrita <a href="https://nginx.org/en/docs/syntax.html">aquí</a>.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios de Seguridad</p>
<ul>
<li>Protege contra ataques de denegación de servicio causados por tamaños de carga útil excesivos</li>
<li>Mitiga las vulnerabilidades de desbordamiento de búfer</li>
<li>Previene los ataques de carga de archivos</li>
<li>Reduce el riesgo de agotamiento de los recursos del servidor</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>MAX_CLIENT_SIZE</code></td>
<td><code>10m</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tamaño Máximo de Solicitud:</strong> El tamaño máximo permitido para los cuerpos de las solicitudes de los clientes (por ejemplo, cargas de archivos).</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Mejores Prácticas de Configuración del Tamaño de la Solicitud"
    Si necesita permitir un cuerpo de solicitud de tamaño ilimitado, puede establecer el valor de `MAX_CLIENT_SIZE` en `0`. Sin embargo, esto **no se recomienda** debido a los posibles riesgos de seguridad y rendimiento.

    **Mejores Prácticas:**

    -   Siempre configure `MAX_CLIENT_SIZE` al valor más pequeño que cumpla con los requisitos legítimos de su aplicación.
    -   Revise y ajuste regularmente este ajuste para alinearlo con las necesidades cambiantes de su aplicación.
    -   Evite establecer `0` a menos que sea absolutamente necesario, ya que puede exponer su servidor a ataques de denegación de servicio y agotamiento de recursos.

    Al gestionar cuidadosamente este ajuste, puede garantizar una seguridad y un rendimiento óptimos para su aplicación.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="53:1"><input checked="checked" id="es-features-__tabbed_53_1" name="es-features-__tabbed_53" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_53_1">Soporte de Protocolo</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Ajustes del Protocolo HTTP</strong></p>
<p>Los protocolos HTTP modernos como HTTP/2 y HTTP/3 mejoran el rendimiento y la seguridad. BunkerWeb permite una fácil configuración de estos protocolos.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios de Seguridad y Rendimiento</p>
<ul>
<li><strong>Ventajas de Seguridad:</strong> Los protocolos modernos como HTTP/2 y HTTP/3 imponen TLS/HTTPS por defecto, reducen la susceptibilidad a ciertos ataques y mejoran la privacidad a través de encabezados cifrados (HTTP/3).</li>
<li><strong>Beneficios de Rendimiento:</strong> Características como la multiplexación, la compresión de encabezados, el empuje del servidor y la transferencia de datos binarios mejoran la velocidad y la eficiencia.</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LISTEN_HTTP</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Escucha HTTP:</strong> Responda a las solicitudes HTTP (inseguras) cuando se establezca en <code>yes</code>.</td>
</tr>
<tr>
<td><code>HTTP2</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP2:</strong> Soporte para el protocolo HTTP2 cuando HTTPS está habilitado.</td>
</tr>
<tr>
<td><code>HTTP3</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP3:</strong> Soporte para el protocolo HTTP3 cuando HTTPS está habilitado.</td>
</tr>
<tr>
<td><code>HTTP3_ALT_SVC_PORT</code></td>
<td><code>443</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Puerto Alt-Svc de HTTP3:</strong> Puerto a utilizar en el encabezado Alt-Svc para HTTP3.</td>
</tr>
</tbody>
</table>
<pre><code>!!! example "Sobre HTTP/3"
    HTTP/3, la última versión del Protocolo de Transferencia de Hipertexto, utiliza QUIC sobre UDP en lugar de TCP, abordando problemas como el bloqueo de cabeza de línea para conexiones más rápidas y fiables.

    NGINX introdujo soporte experimental para HTTP/3 y QUIC a partir de la versión 1.25.0. Sin embargo, esta característica todavía es experimental y se recomienda precaución para su uso en producción. Para más detalles, consulte la [documentación oficial de NGINX](https://nginx.org/en/docs/quic.html).

    Se recomienda realizar pruebas exhaustivas antes de habilitar HTTP/3 en entornos de producción.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="54:1"><input checked="checked" id="es-features-__tabbed_54_1" name="es-features-__tabbed_54" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_54_1">Entrega de Archivos Estáticos</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Configuración de Entrega de Archivos</strong></p>
<p>BunkerWeb puede servir archivos estáticos directamente o actuar como un proxy inverso a un servidor de aplicaciones. Por defecto, los archivos se sirven desde <code>/var/www/html/{server_name}</code>.</p>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SERVE_FILES</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Servir Archivos:</strong> Cuando se establece en <code>yes</code>, BunkerWeb servirá archivos estáticos desde la carpeta raíz configurada.</td>
</tr>
<tr>
<td><code>ROOT_FOLDER</code></td>
<td><code>/var/www/html/{server_name}</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Carpeta Raíz:</strong> El directorio desde el cual servir archivos estáticos. Vacío significa usar la ubicación predeterminada.</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Mejores Prácticas para la Entrega de Archivos Estáticos"
    -   **Servicio Directo:** Habilite el servicio de archivos (`SERVE_FILES=yes`) cuando BunkerWeb sea responsable de servir los archivos estáticos directamente.
    -   **Proxy Inverso:** Si BunkerWeb actúa como un proxy inverso, **desactive el servicio de archivos** (`SERVE_FILES=no`) para reducir la superficie de ataque y evitar exponer directorios innecesarios.
    -   **Permisos:** Asegúrese de tener los permisos de archivo y las configuraciones de ruta adecuados para evitar el acceso no autorizado.
    -   **Seguridad:** Evite exponer directorios o archivos sensibles a través de configuraciones incorrectas.

    Al gestionar cuidadosamente la entrega de archivos estáticos, puede optimizar el rendimiento mientras mantiene un entorno seguro.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="55:1"><input checked="checked" id="es-features-__tabbed_55_1" name="es-features-__tabbed_55" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_55_1">Ajustes del Sistema</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Gestión de Complementos y del Sistema</strong></p>
<p>Estos ajustes gestionan la interacción de BunkerWeb con sistemas externos y contribuyen a mejorar el producto a través de estadísticas de uso anónimas opcionales.</p>
<p><strong>Informes Anónimos</strong></p>
<p>Los informes anónimos proporcionan al equipo de BunkerWeb información sobre cómo se está utilizando el software. Esto ayuda a identificar áreas de mejora y a priorizar el desarrollo de características. Los informes son estrictamente estadísticos y no incluyen ninguna información sensible o de identificación personal. Cubren:</p>
<ul>
<li>Características habilitadas</li>
<li>Patrones de configuración generales</li>
</ul>
<p>Puede deshabilitar esta característica si lo desea estableciendo <code>SEND_ANONYMOUS_REPORT</code> en <code>no</code>.</p>
<p><strong>Complementos Externos</strong></p>
<p>Los complementos externos le permiten ampliar la funcionalidad de BunkerWeb integrando módulos de terceros. Esto permite una personalización adicional y casos de uso avanzados.</p>
<div class="admonition danger">
<p class="admonition-title">Seguridad de los Complementos Externos</p>
<p><strong>Los complementos externos pueden introducir riesgos de seguridad si no se examinan adecuadamente.</strong> Siga estas mejores prácticas para minimizar las amenazas potenciales:</p>
<ul>
<li>Solo use complementos de fuentes de confianza.</li>
<li>Verifique la integridad del complemento utilizando sumas de verificación cuando estén disponibles.</li>
<li>Revise y actualice regularmente los complementos para garantizar la seguridad y la compatibilidad.</li>
</ul>
<p>Para más detalles, consulte la <a href="#es-plugins">documentación de Complementos</a>.</p>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SEND_ANONYMOUS_REPORT</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Informes Anónimos:</strong> Envíe informes de uso anónimos a los mantenedores de BunkerWeb.</td>
</tr>
<tr>
<td><code>EXTERNAL_PLUGIN_URLS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Complementos Externos:</strong> URL para descargar complementos externos (separados por espacios).</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="56:1"><input checked="checked" id="es-features-__tabbed_56_1" name="es-features-__tabbed_56" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_56_1">Almacenamiento en Caché de Archivos</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Optimización del Almacenamiento en Caché de Archivos</strong></p>
<p>La caché de archivos abiertos mejora el rendimiento al almacenar descriptores de archivos y metadatos en la memoria, reduciendo la necesidad de operaciones repetidas del sistema de archivos.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios del Almacenamiento en Caché de Archivos</p>
<ul>
<li><strong>Rendimiento:</strong> Reduce la E/S del sistema de archivos, disminuye la latencia y reduce el uso de la CPU para las operaciones de archivos.</li>
<li><strong>Seguridad:</strong> Mitiga los ataques de tiempo al almacenar en caché las respuestas de error y reduce el impacto de los ataques DoS dirigidos al sistema de archivos.</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_OPEN_FILE_CACHE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Caché:</strong> Habilite el almacenamiento en caché de descriptores de archivos y metadatos para mejorar el rendimiento.</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE</code></td>
<td><code>max=1000 inactive=20s</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Configuración de Caché:</strong> Configure la caché de archivos abiertos (por ejemplo, entradas máximas y tiempo de espera de inactividad).</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE_ERRORS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Errores de Caché:</strong> Almacene en caché los errores de búsqueda de descriptores de archivos, así como las búsquedas exitosas.</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE_MIN_USES</code></td>
<td><code>2</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Usos Mínimos:</strong> Número mínimo de accesos durante el período de inactividad para que un archivo permanezca en caché.</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE_VALID</code></td>
<td><code>30s</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Validez de la Caché:</strong> Tiempo después del cual los elementos en caché se revalidan.</td>
</tr>
</tbody>
</table>
<pre><code>**Guía de Configuración**

Para habilitar y configurar el almacenamiento en caché de archivos:
1.  Establezca `USE_OPEN_FILE_CACHE` en `yes` para activar la característica.
2.  Ajuste los parámetros de `OPEN_FILE_CACHE` para definir el número máximo de entradas en caché y su tiempo de espera de inactividad.
3.  Use `OPEN_FILE_CACHE_ERRORS` para almacenar en caché tanto las búsquedas exitosas como las fallidas, reduciendo las operaciones repetidas del sistema de archivos.
4.  Establezca `OPEN_FILE_CACHE_MIN_USES` para especificar el número mínimo de accesos requeridos para que un archivo permanezca en caché.
5.  Defina el período de validez de la caché con `OPEN_FILE_CACHE_VALID` para controlar con qué frecuencia se revalidan los elementos en caché.

!!! tip "Mejores Prácticas"
    -   Habilite el almacenamiento en caché de archivos para sitios web con muchos archivos estáticos para mejorar el rendimiento.
    -   Revise y ajuste regularmente la configuración de la caché para equilibrar el rendimiento y el uso de recursos.
    -   En entornos dinámicos donde los archivos cambian con frecuencia, considere reducir el período de validez de la caché o deshabilitar la característica para garantizar la frescura del contenido.
</code></pre>
<h3 id="es-features-configuraciones-de-ejemplo_22">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="57:7"><input checked="checked" id="es-features-__tabbed_57_1" name="es-features-__tabbed_57" type="radio" /><input id="es-features-__tabbed_57_2" name="es-features-__tabbed_57" type="radio" /><input id="es-features-__tabbed_57_3" name="es-features-__tabbed_57" type="radio" /><input id="es-features-__tabbed_57_4" name="es-features-__tabbed_57" type="radio" /><input id="es-features-__tabbed_57_5" name="es-features-__tabbed_57" type="radio" /><input id="es-features-__tabbed_57_6" name="es-features-__tabbed_57" type="radio" /><input id="es-features-__tabbed_57_7" name="es-features-__tabbed_57" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_57_1">Seguridad del Servidor Predeterminado</label><label for="es-features-__tabbed_57_2">Estado HTTP de Denegación</label><label for="es-features-__tabbed_57_3">Métodos HTTP</label><label for="es-features-__tabbed_57_4">Límites de Tamaño de Solicitud</label><label for="es-features-__tabbed_57_5">Soporte de Protocolo</label><label for="es-features-__tabbed_57_6">Entrega de Archivos Estáticos</label><label for="es-features-__tabbed_57_7">Almacenamiento en Caché de Archivos</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Configuración de ejemplo para deshabilitar el servidor predeterminado y aplicar un SNI estricto:</p>
<div class="highlight"><pre><span></span><code><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">DISABLE_DEFAULT_SERVER_STRICT_SNI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para descartar silenciosamente las solicitudes no deseadas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">DENY_HTTP_STATUS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;444&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para restringir los métodos HTTP solo a los requeridos por una API RESTful:</p>
<div class="highlight"><pre><span></span><code><span class="nt">ALLOWED_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET|POST|PUT|DELETE&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para limitar el tamaño máximo del cuerpo de la solicitud:</p>
<div class="highlight"><pre><span></span><code><span class="nt">MAX_CLIENT_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5m&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar HTTP/2 y HTTP/3 con un puerto Alt-Svc personalizado:</p>
<div class="highlight"><pre><span></span><code><span class="nt">HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">HTTP3_ALT_SVC_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;443&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para servir archivos estáticos desde una carpeta raíz personalizada:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SERVE_FILES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">ROOT_FOLDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/custom-folder&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración de ejemplo para habilitar y optimizar el almacenamiento en caché de archivos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_OPEN_FILE_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">OPEN_FILE_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;max=2000</span><span class="nv"> </span><span class="s">inactive=30s&quot;</span>
<span class="nt">OPEN_FILE_CACHE_ERRORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">OPEN_FILE_CACHE_MIN_USES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">OPEN_FILE_CACHE_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60s&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-modsecurity">ModSecurity</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento ModSecurity integra el potente Firewall de Aplicaciones Web (WAF) <a href="https://modsecurity.org">ModSecurity</a> en BunkerWeb. Esta integración ofrece una protección robusta contra una amplia gama de ataques web al aprovechar el <a href="https://coreruleset.org">OWASP Core Rule Set (CRS)</a> para detectar y bloquear amenazas como la inyección de SQL, el cross-site scripting (XSS), la inclusión de archivos locales y más.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando se recibe una solicitud, ModSecurity la evalúa con el conjunto de reglas activo.</li>
<li>El OWASP Core Rule Set inspecciona las cabeceras, las cookies, los parámetros de la URL y el contenido del cuerpo.</li>
<li>Cada violación detectada contribuye a una puntuación de anomalía general.</li>
<li>Si esta puntuación excede el umbral configurado, la solicitud se bloquea.</li>
<li>Se crean registros detallados para ayudar a diagnosticar qué reglas se activaron y por qué.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Beneficios clave</p>
<ol>
<li><strong>Protección estándar de la industria:</strong> Utiliza el firewall de código abierto ModSecurity, ampliamente utilizado.</li>
<li><strong>OWASP Core Rule Set:</strong> Emplea reglas mantenidas por la comunidad que cubren el OWASP Top Ten y más.</li>
<li><strong>Niveles de seguridad configurables:</strong> Ajuste los niveles de paranoia para equilibrar la seguridad con los posibles falsos positivos.</li>
<li><strong>Registro detallado:</strong> Proporciona registros de auditoría exhaustivos para el análisis de ataques.</li>
<li><strong>Soporte de complementos:</strong> Amplíe la protección con complementos CRS opcionales adaptados a sus aplicaciones.</li>
</ol>
</div>
<h3 id="es-features-como-usar_20">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar ModSecurity:</p>
<ol>
<li><strong>Habilite la función:</strong> ModSecurity está habilitado por defecto. Esto se puede controlar usando el ajuste <code>USE_MODSECURITY</code>.</li>
<li><strong>Seleccione una versión de CRS:</strong> Elija una versión del OWASP Core Rule Set (v3, v4 o nightly).</li>
<li><strong>Añada complementos:</strong> Opcionalmente, active los complementos de CRS para mejorar la cobertura de las reglas.</li>
<li><strong>Supervise y ajuste:</strong> Utilice los registros y la <a href="#es-web-ui">interfaz de usuario web</a> para identificar falsos positivos y ajustar la configuración.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_21">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_MODSECURITY</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar ModSecurity:</strong> Active la protección del Firewall de Aplicaciones Web ModSecurity.</td>
</tr>
<tr>
<td><code>USE_MODSECURITY_CRS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Usar Core Rule Set:</strong> Habilite el OWASP Core Rule Set para ModSecurity.</td>
</tr>
<tr>
<td><code>MODSECURITY_CRS_VERSION</code></td>
<td><code>4</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Versión de CRS:</strong> La versión del OWASP Core Rule Set a utilizar. Opciones: <code>3</code>, <code>4</code> o <code>nightly</code>.</td>
</tr>
<tr>
<td><code>MODSECURITY_SEC_RULE_ENGINE</code></td>
<td><code>On</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Motor de Reglas:</strong> Controle si se aplican las reglas. Opciones: <code>On</code>, <code>DetectionOnly</code> u <code>Off</code>.</td>
</tr>
<tr>
<td><code>MODSECURITY_SEC_AUDIT_ENGINE</code></td>
<td><code>RelevantOnly</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Motor de Auditoría:</strong> Controle cómo funciona el registro de auditoría. Opciones: <code>On</code>, <code>Off</code> o <code>RelevantOnly</code>.</td>
</tr>
<tr>
<td><code>MODSECURITY_SEC_AUDIT_LOG_PARTS</code></td>
<td><code>ABIJDEFHZ</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Partes del Registro de Auditoría:</strong> Qué partes de las solicitudes/respuestas incluir en los registros de auditoría.</td>
</tr>
<tr>
<td><code>MODSECURITY_REQ_BODY_NO_FILES_LIMIT</code></td>
<td><code>131072</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Límite del Cuerpo de la Solicitud (Sin Archivos):</strong> Tamaño máximo para los cuerpos de las solicitudes sin carga de archivos. Acepta bytes simples o sufijos legibles por humanos (<code>k</code>, <code>m</code>, <code>g</code>), por ejemplo, <code>131072</code>, <code>256k</code>, <code>1m</code>, <code>2g</code>.</td>
</tr>
<tr>
<td><code>USE_MODSECURITY_CRS_PLUGINS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Complementos de CRS:</strong> Habilite conjuntos de reglas de complementos adicionales para el Core Rule Set.</td>
</tr>
<tr>
<td><code>MODSECURITY_CRS_PLUGINS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Lista de Complementos de CRS:</strong> Lista de complementos separados por espacios para descargar e instalar (<code>nombre-plugin[/etiqueta]</code> o URL).</td>
</tr>
<tr>
<td><code>USE_MODSECURITY_GLOBAL_CRS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>CRS Global:</strong> Cuando está habilitado, aplica las reglas de CRS globalmente a nivel HTTP en lugar de por servidor.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">ModSecurity y el OWASP Core Rule Set</p>
</div>
<p><strong>Recomendamos encarecidamente mantener habilitados tanto ModSecurity como el OWASP Core Rule Set (CRS)</strong> para proporcionar una protección robusta contra las vulnerabilidades web comunes. Aunque pueden ocurrir falsos positivos ocasionales, se pueden resolver con un poco de esfuerzo ajustando las reglas o utilizando exclusiones predefinidas.</p>
<pre><code>El equipo de CRS mantiene activamente una lista de exclusiones para aplicaciones populares como WordPress, Nextcloud, Drupal y Cpanel, lo que facilita la integración sin afectar la funcionalidad. Los beneficios de seguridad superan con creces el mínimo esfuerzo de configuración necesario para solucionar los falsos positivos.
</code></pre>
<h3 id="es-features-versiones-de-crs-disponibles">Versiones de CRS Disponibles</h3>
<p>Seleccione una versión de CRS que se ajuste mejor a sus necesidades de seguridad:</p>
<ul>
<li><strong><code>3</code></strong>: Estable <a href="https://github.com/coreruleset/coreruleset/releases/tag/v3.3.7">v3.3.7</a>.</li>
<li><strong><code>4</code></strong>: Estable <a href="https://github.com/coreruleset/coreruleset/releases/tag/v4.18.0">v4.18.0</a> (<strong>predeterminada</strong>).</li>
<li><strong><code>nightly</code></strong>: <a href="https://github.com/coreruleset/coreruleset/releases/tag/nightly">Compilación nocturna</a> que ofrece las últimas actualizaciones de reglas.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Compilación Nocturna</p>
</div>
<p>La <strong>compilación nocturna</strong> contiene las reglas más actualizadas, ofreciendo las últimas protecciones contra amenazas emergentes. Sin embargo, dado que se actualiza diariamente y puede incluir cambios experimentales o no probados, se recomienda utilizar primero la compilación nocturna en un <strong>entorno de preproducción</strong> antes de implementarla en producción.</p>
<div class="admonition tip">
<p class="admonition-title">Niveles de Paranoia</p>
</div>
<p>El OWASP Core Rule Set utiliza "niveles de paranoia" (PL) para controlar la rigurosidad de las reglas:</p>
<pre><code>-   **PL1 (predeterminado):** Protección básica con mínimos falsos positivos
-   **PL2:** Seguridad más estricta con una coincidencia de patrones más rigurosa
-   **PL3:** Seguridad mejorada con una validación más estricta
-   **PL4:** Máxima seguridad con reglas muy estrictas (puede causar muchos falsos positivos)

Puede establecer el nivel de paranoia agregando un archivo de configuración personalizado en `/etc/bunkerweb/configs/modsec-crs/`.
</code></pre>
<h3 id="es-features-configuraciones-personalizadas">Configuraciones Personalizadas</h3>
<p>El ajuste de ModSecurity y el OWASP Core Rule Set (CRS) se puede lograr a través de configuraciones personalizadas. Estas configuraciones le permiten personalizar el comportamiento en etapas específicas del procesamiento de las reglas de seguridad:</p>
<ul>
<li><strong><code>modsec-crs</code></strong>: Se aplica <strong>antes</strong> de que se cargue el OWASP Core Rule Set.</li>
<li><strong><code>modsec</code></strong>: Se aplica <strong>después</strong> de que se haya cargado el OWASP Core Rule Set. También se utiliza si el CRS no se carga en absoluto.</li>
<li><strong><code>crs-plugins-before</code></strong>: Se aplica <strong>antes</strong> de que se carguen los complementos de CRS.</li>
<li><strong><code>crs-plugins-after</code></strong>: Se aplica <strong>después</strong> de que se hayan cargado los complementos de CRS.</li>
</ul>
<p>Esta estructura proporciona flexibilidad, permitiéndole ajustar la configuración de ModSecurity y CRS para adaptarse a las necesidades específicas de su aplicación mientras mantiene un flujo de configuración claro.</p>
<h4 id="es-features-agregar-exclusiones-de-crs-con-modsec-crs">Agregar Exclusiones de CRS con <code>modsec-crs</code></h4>
<p>Puede usar una configuración personalizada de tipo <code>modsec-crs</code> para agregar exclusiones para casos de uso específicos, como habilitar exclusiones predefinidas para WordPress:</p>
<div class="highlight"><pre><span></span><code>SecAction \
 &quot;id:900130,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.crs_exclusions_wordpress=1&quot;
</code></pre></div>
<p>En este ejemplo:</p>
<ul>
<li>La acción se ejecuta en la <strong>Fase 1</strong> (temprano en el ciclo de vida de la solicitud).</li>
<li>Habilita las exclusiones de CRS específicas de WordPress estableciendo la variable <code>tx.crs_exclusions_wordpress</code>.</li>
</ul>
<h4 id="es-features-actualizar-las-reglas-de-crs-con-modsec">Actualizar las Reglas de CRS con <code>modsec</code></h4>
<p>Para ajustar las reglas de CRS cargadas, puede usar una configuración personalizada de tipo <code>modsec</code>. Por ejemplo, puede eliminar reglas o etiquetas específicas para ciertas rutas de solicitud:</p>
<div class="highlight"><pre><span></span><code>SecRule REQUEST_FILENAME &quot;/wp-admin/admin-ajax.php&quot; &quot;id:1,ctl:ruleRemoveByTag=attack-xss,ctl:ruleRemoveByTag=attack-rce&quot;
SecRule REQUEST_FILENAME &quot;/wp-admin/options.php&quot; &quot;id:2,ctl:ruleRemoveByTag=attack-xss&quot;
SecRule REQUEST_FILENAME &quot;^/wp-json/yoast&quot; &quot;id:3,ctl:ruleRemoveById=930120&quot;
</code></pre></div>
<p>En este ejemplo:</p>
<ul>
<li><strong>Regla 1</strong>: Elimina las reglas etiquetadas como <code>attack-xss</code> y <code>attack-rce</code> para las solicitudes a <code>/wp-admin/admin-ajax.php</code>.</li>
<li><strong>Regla 2</strong>: Elimina las reglas etiquetadas como <code>attack-xss</code> para las solicitudes a <code>/wp-admin/options.php</code>.</li>
<li><strong>Regla 3</strong>: Elimina una regla específica (ID <code>930120</code>) para las solicitudes que coinciden con <code>/wp-json/yoast</code>.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Orden de ejecución</p>
</div>
<p>El orden de ejecución de ModSecurity en BunkerWeb es el siguiente, asegurando una progresión clara y lógica de la aplicación de reglas:</p>
<pre><code>1.  **Configuración de OWASP CRS**: Configuración base para el OWASP Core Rule Set.
2.  **Configuración de Complementos Personalizados (`crs-plugins-before`)**: Ajustes específicos de los complementos, aplicados antes de cualquier regla de CRS.
3.  **Reglas de Complementos Personalizados (Antes de las Reglas de CRS) (`crs-plugins-before`)**: Reglas personalizadas para los complementos ejecutadas antes de las reglas de CRS.
4.  **Configuración de Complementos Descargados**: Configuración para los complementos descargados externamente.
5.  **Reglas de Complementos Descargados (Antes de las Reglas de CRS)**: Reglas para los complementos descargados ejecutadas antes de las reglas de CRS.
6.  **Reglas de CRS Personalizadas (`modsec-crs`)**: Reglas definidas por el usuario aplicadas antes de cargar las reglas de CRS.
7.  **Reglas de OWASP CRS**: El conjunto principal de reglas de seguridad proporcionado por OWASP.
8.  **Reglas de Complementos Personalizados (Después de las Reglas de CRS) (`crs-plugins-after`)**: Reglas de complementos personalizadas ejecutadas después de las reglas de CRS.
9.  **Reglas de Complementos Descargados (Después de las Reglas de CRS)**: Reglas para los complementos descargados ejecutadas después de las reglas de CRS.
10. **Reglas Personalizadas (`modsec`)**: Reglas definidas por el usuario aplicadas después de todas las reglas de CRS y de los complementos.

**Notas Clave**:

-   Las personalizaciones **pre-CRS** (`crs-plugins-before`, `modsec-crs`) le permiten definir excepciones o reglas preparatorias antes de que se carguen las reglas principales de CRS.
-   Las personalizaciones **post-CRS** (`crs-plugins-after`, `modsec`) son ideales para anular o ampliar las reglas después de que se hayan aplicado las reglas de CRS y de los complementos.
-   Esta estructura proporciona la máxima flexibilidad, permitiendo un control preciso sobre la ejecución y personalización de las reglas mientras se mantiene una sólida línea de base de seguridad.
</code></pre>
<h3 id="es-features-complementos-de-owasp-crs">Complementos de OWASP CRS</h3>
<p>El OWASP Core Rule Set también admite una gama de <strong>complementos</strong> diseñados para ampliar su funcionalidad y mejorar la compatibilidad con aplicaciones o entornos específicos. Estos complementos pueden ayudar a ajustar el CRS para su uso con plataformas populares como WordPress, Nextcloud y Drupal, o incluso con configuraciones personalizadas. Para obtener más información y una lista de los complementos disponibles, consulte el <a href="https://github.com/coreruleset/plugin-registry">registro de complementos de OWASP CRS</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Descarga de complementos</p>
</div>
<p>El ajuste <code>MODSECURITY_CRS_PLUGINS</code> le permite descargar e instalar complementos para ampliar la funcionalidad del OWASP Core Rule Set (CRS). Este ajuste acepta una lista de nombres de complementos con etiquetas o URL opcionales, lo que facilita la integración de funciones de seguridad adicionales adaptadas a sus necesidades específicas.</p>
<pre><code>Aquí hay una lista no exhaustiva de valores aceptados para el ajuste `MODSECURITY_CRS_PLUGINS`:

*   `fake-bot` - Descargar la última versión del complemento.
*   `wordpress-rule-exclusions/v1.0.0` - Descargar la versión 1.0.0 del complemento.
*   `https://github.com/coreruleset/dos-protection-plugin-modsecurity/archive/refs/heads/main.zip` - Descargar el complemento directamente desde la URL.
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Falsos Positivos</p>
</div>
<p>Una configuración de seguridad más alta puede bloquear el tráfico legítimo. Comience con la configuración predeterminada y supervise los registros antes de aumentar los niveles de seguridad. Esté preparado para agregar reglas de exclusión para las necesidades específicas de su aplicación.</p>
<h3 id="es-features-configuraciones-de-ejemplo_23">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="58:6"><input checked="checked" id="es-features-__tabbed_58_1" name="es-features-__tabbed_58" type="radio" /><input id="es-features-__tabbed_58_2" name="es-features-__tabbed_58" type="radio" /><input id="es-features-__tabbed_58_3" name="es-features-__tabbed_58" type="radio" /><input id="es-features-__tabbed_58_4" name="es-features-__tabbed_58" type="radio" /><input id="es-features-__tabbed_58_5" name="es-features-__tabbed_58" type="radio" /><input id="es-features-__tabbed_58_6" name="es-features-__tabbed_58" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_58_1">Configuración Básica</label><label for="es-features-__tabbed_58_2">Modo de Solo Detección</label><label for="es-features-__tabbed_58_3">Configuración Avanzada con Complementos</label><label for="es-features-__tabbed_58_4">Configuración Heredada</label><label for="es-features-__tabbed_58_5">ModSecurity Global</label><label for="es-features-__tabbed_58_6">Compilación Nocturna con Complementos Personalizados</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración estándar con ModSecurity y CRS v4 habilitados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para monitorear amenazas potenciales sin bloquear:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DetectionOnly&quot;</span>
<span class="nt">MODSECURITY_SEC_AUDIT_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
<span class="nt">MODSECURITY_SEC_AUDIT_LOG_PARTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ABIJDEFHZ&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con CRS v4 y complementos habilitados para protección adicional:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
<span class="nt">USE_MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;wordpress-rule-exclusions</span><span class="nv"> </span><span class="s">fake-bot&quot;</span>
<span class="nt">MODSECURITY_REQ_BODY_NO_FILES_LIMIT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;262144&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que utiliza CRS v3 para compatibilidad con configuraciones más antiguas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que aplica ModSecurity globalmente a todas las conexiones HTTP:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">USE_MODSECURITY_GLOBAL_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que utiliza la compilación nocturna de CRS con complementos personalizados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;nightly&quot;</span>
<span class="nt">USE_MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;wordpress-rule-exclusions/v1.0.0</span><span class="nv"> </span><span class="s">https://github.com/coreruleset/dos-protection-plugin-modsecurity/archive/refs/heads/main.zip&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Valores de tamaño legibles por humanos</p>
</div>
<p>Para los ajustes de tamaño como <code>MODSECURITY_REQ_BODY_NO_FILES_LIMIT</code>, se admiten los sufijos <code>k</code>, <code>m</code> y <code>g</code> (sin distinción entre mayúsculas y minúsculas) y representan kibibytes, mebibytes y gibibytes (múltiplos de 1024). Ejemplos: <code>256k</code> = 262144, <code>1m</code> = 1048576, <code>2g</code> = 2147483648.</p>
<h2 id="es-features-monitoring-pro">Monitoring <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>BunkerWeb monitoring pro system. This plugin is a prerequisite for some other plugins.</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_MONITORING</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td>Enable monitoring of BunkerWeb.</td>
</tr>
<tr>
<td><code>MONITORING_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Size of the dict to store monitoring metrics.</td>
</tr>
<tr>
<td><code>MONITORING_IGNORE_URLS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>List of URLs to ignore when monitoring separated with spaces (e.g. /health)</td>
</tr>
</tbody>
</table>
<h2 id="es-features-php">PHP</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento PHP proporciona una integración perfecta con PHP-FPM para BunkerWeb, lo que permite el procesamiento dinámico de PHP para sus sitios web. Esta característica es compatible tanto con instancias locales de PHP-FPM que se ejecutan en la misma máquina como con servidores remotos de PHP-FPM, lo que le brinda flexibilidad en la forma en que configura su entorno PHP.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un cliente solicita un archivo PHP de su sitio web, BunkerWeb enruta la solicitud a la instancia de PHP-FPM configurada.</li>
<li>Para PHP-FPM local, BunkerWeb se comunica con el intérprete de PHP a través de un archivo de socket de Unix.</li>
<li>Para PHP-FPM remoto, BunkerWeb reenvía las solicitudes al host y puerto especificados utilizando el protocolo FastCGI.</li>
<li>PHP-FPM procesa el script y devuelve el contenido generado a BunkerWeb, que luego lo entrega al cliente.</li>
<li>La reescritura de URL se configura automáticamente para admitir los marcos de trabajo y aplicaciones PHP comunes que utilizan "URL amigables".</li>
</ol>
<h3 id="es-features-como-usar_21">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función PHP:</p>
<ol>
<li><strong>Elija su configuración de PHP-FPM:</strong> Decida si utilizará una instancia de PHP-FPM local o remota.</li>
<li><strong>Configure la conexión:</strong> Para PHP local, especifique la ruta del socket; para PHP remoto, proporcione el nombre de host y el puerto.</li>
<li><strong>Establezca la raíz del documento:</strong> Configure la carpeta raíz que contiene sus archivos PHP utilizando la configuración de ruta adecuada.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, BunkerWeb enruta automáticamente las solicitudes de PHP a su instancia de PHP-FPM.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_22">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REMOTE_PHP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Host PHP Remoto:</strong> Nombre de host de la instancia remota de PHP-FPM. Deje en blanco para usar PHP local.</td>
</tr>
<tr>
<td><code>REMOTE_PHP_PATH</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ruta Remota:</strong> Carpeta raíz que contiene los archivos en la instancia remota de PHP-FPM.</td>
</tr>
<tr>
<td><code>REMOTE_PHP_PORT</code></td>
<td><code>9000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Puerto Remoto:</strong> Puerto de la instancia remota de PHP-FPM.</td>
</tr>
<tr>
<td><code>LOCAL_PHP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Socket PHP Local:</strong> Ruta al archivo de socket de PHP-FPM. Deje en blanco para usar una instancia remota de PHP-FPM.</td>
</tr>
<tr>
<td><code>LOCAL_PHP_PATH</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ruta Local:</strong> Carpeta raíz que contiene los archivos en la instancia local de PHP-FPM.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">PHP-FPM Local vs. Remoto</p>
</div>
<p>Elija la configuración que mejor se adapte a su infraestructura:</p>
<pre><code>-   **PHP-FPM local** ofrece un mejor rendimiento debido a la comunicación basada en sockets y es ideal cuando PHP se ejecuta en la misma máquina que BunkerWeb.
-   **PHP-FPM remoto** proporciona más flexibilidad y escalabilidad al permitir que el procesamiento de PHP se realice en servidores separados.
</code></pre>
<div class="admonition warning">
<p class="admonition-title">Configuración de la Ruta</p>
</div>
<p>La <code>REMOTE_PHP_PATH</code> o <code>LOCAL_PHP_PATH</code> debe coincidir con la ruta real del sistema de archivos donde se almacenan sus archivos PHP; de lo contrario, se producirá un error de "Archivo no encontrado".</p>
<div class="admonition info">
<p class="admonition-title">Reescritura de URL</p>
</div>
<p>El complemento PHP configura automáticamente la reescritura de URL para admitir aplicaciones PHP modernas. Las solicitudes de archivos inexistentes se dirigirán a <code>index.php</code> con el URI de la solicitud original disponible como parámetro de consulta.</p>
<h3 id="es-features-configuraciones-de-ejemplo_24">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="59:4"><input checked="checked" id="es-features-__tabbed_59_1" name="es-features-__tabbed_59" type="radio" /><input id="es-features-__tabbed_59_2" name="es-features-__tabbed_59" type="radio" /><input id="es-features-__tabbed_59_3" name="es-features-__tabbed_59" type="radio" /><input id="es-features-__tabbed_59_4" name="es-features-__tabbed_59" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_59_1">Configuración de PHP-FPM Local</label><label for="es-features-__tabbed_59_2">Configuración de PHP-FPM Remoto</label><label for="es-features-__tabbed_59_3">Configuración de Puerto Personalizado</label><label for="es-features-__tabbed_59_4">Configuración de WordPress</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Configuración para usar una instancia de PHP-FPM local:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LOCAL_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/run/php/php8.1-fpm.sock&quot;</span>
<span class="nt">LOCAL_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para usar una instancia de PHP-FPM remota:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;php-server.example.com&quot;</span>
<span class="nt">REMOTE_PHP_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9000&quot;</span>
<span class="nt">REMOTE_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para usar PHP-FPM en un puerto no estándar:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;php-server.example.com&quot;</span>
<span class="nt">REMOTE_PHP_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9001&quot;</span>
<span class="nt">REMOTE_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración optimizada para WordPress:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LOCAL_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/run/php/php8.1-fpm.sock&quot;</span>
<span class="nt">LOCAL_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html/wordpress&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-pro">Pro</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento Pro agrupa características avanzadas y mejoras para implementaciones empresariales de BunkerWeb. Desbloquea capacidades adicionales, complementos premium y funcionalidades extendidas que complementan la plataforma principal de BunkerWeb. Ofrece seguridad, rendimiento y opciones de gestión mejoradas para implementaciones de nivel empresarial.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Con una clave de licencia Pro válida, BunkerWeb se conecta al servidor de la API Pro para validar su suscripción.</li>
<li>Una vez autenticado, el complemento descarga e instala automáticamente los complementos y extensiones exclusivos de Pro.</li>
<li>Su estado Pro se verifica periódicamente para garantizar el acceso continuo a las funciones premium.</li>
<li>Los complementos premium se integran sin problemas con su configuración existente de BunkerWeb.</li>
<li>Todas las funciones Pro funcionan en armonía con el núcleo de código abierto, mejorando en lugar de reemplazar la funcionalidad.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Beneficios clave</p>
<ol>
<li><strong>Extensiones Premium:</strong> Acceso a complementos y características exclusivas no disponibles en la edición comunitaria.</li>
<li><strong>Rendimiento Mejorado:</strong> Configuraciones optimizadas y mecanismos de almacenamiento en caché avanzados.</li>
<li><strong>Soporte Empresarial:</strong> Asistencia prioritaria y canales de soporte dedicados.</li>
<li><strong>Integración Perfecta:</strong> Las características Pro funcionan junto con las características comunitarias sin conflictos de configuración.</li>
<li><strong>Actualizaciones Automáticas:</strong> Los complementos premium se descargan y se mantienen actualizados automáticamente.</li>
</ol>
</div>
<h3 id="es-features-como-usar_22">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar las características Pro:</p>
<ol>
<li><strong>Obtenga una clave de licencia:</strong> Compre una licencia Pro en el <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a>.</li>
<li><strong>Configure su clave de licencia:</strong> Use el ajuste <code>PRO_LICENSE_KEY</code> para configurar su licencia.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado con una licencia válida, los complementos Pro se descargan y activan automáticamente.</li>
<li><strong>Supervise su estado Pro:</strong> Verifique los indicadores de salud en la <a href="#es-web-ui">interfaz de usuario web</a> para confirmar el estado de su suscripción Pro.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_23">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PRO_LICENSE_KEY</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Clave de Licencia Pro:</strong> Su clave de licencia de BunkerWeb Pro para la autenticación.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Gestión de Licencias</p>
</div>
<p>Su licencia Pro está vinculada a su entorno de implementación específico. Si necesita transferir su licencia o tiene preguntas sobre su suscripción, póngase en contacto con el soporte a través del <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a>.</p>
<div class="admonition info">
<p class="admonition-title">Características Pro</p>
</div>
<p>Las características Pro específicas disponibles pueden evolucionar con el tiempo a medida que se agregan nuevas capacidades. El complemento Pro se encarga automáticamente de la instalación y configuración de todas las características disponibles.</p>
<div class="admonition warning">
<p class="admonition-title">Requisitos de Red</p>
</div>
<p>El complemento Pro requiere acceso a Internet de salida para conectarse a la API de BunkerWeb para la verificación de la licencia y para descargar los complementos premium. Asegúrese de que su firewall permita conexiones a <code>api.bunkerweb.io</code> en el puerto 443 (HTTPS).</p>
<h3 id="es-features-preguntas-frecuentes">Preguntas Frecuentes</h3>
<p><strong>P: ¿Qué sucede si mi licencia Pro expira?</strong></p>
<p>R: Si su licencia Pro expira, se desactivará el acceso a las características y complementos premium. Sin embargo, su instalación de BunkerWeb seguirá funcionando con todas las características de la edición comunitaria intactas. Para recuperar el acceso a las características Pro, simplemente renueve su licencia.</p>
<p><strong>P: ¿Las características Pro interrumpirán mi configuración existente?</strong></p>
<p>R: No, las características Pro están diseñadas para integrarse sin problemas con su configuración actual de BunkerWeb. Mejoran la funcionalidad sin alterar ni interferir con su configuración existente, garantizando una experiencia fluida y confiable.</p>
<p><strong>P: ¿Puedo probar las características Pro antes de comprometerme a una compra?</strong></p>
<p>R: ¡Absolutamente! BunkerWeb ofrece dos planes Pro para satisfacer sus necesidades:</p>
<ul>
<li><strong>BunkerWeb PRO Standard:</strong> Acceso completo a las características Pro sin soporte técnico.</li>
<li><strong>BunkerWeb PRO Enterprise:</strong> Acceso completo a las características Pro con soporte técnico dedicado.</li>
</ul>
<p>Puede explorar las características Pro con una prueba gratuita de 1 mes utilizando el código de promoción <code>freetrial</code>. Visite el <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a> para activar su prueba y obtener más información sobre las opciones de precios flexibles basadas en el número de servicios protegidos por BunkerWeb PRO.</p>
<h2 id="es-features-prometheus-exporter-pro">Prometheus exporter <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Prometheus exporter for BunkerWeb internal metrics.</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_PROMETHEUS_EXPORTER</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable the Prometheus export.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_IP</code></td>
<td><code>0.0.0.0</code></td>
<td>global</td>
<td>no</td>
<td>Listening IP of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_PORT</code></td>
<td><code>9113</code></td>
<td>global</td>
<td>no</td>
<td>Listening port of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_URL</code></td>
<td><code>/metrics</code></td>
<td>global</td>
<td>no</td>
<td>HTTP URL of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_ALLOW_IP</code></td>
<td><code>127.0.0.0/8 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16</code></td>
<td>global</td>
<td>no</td>
<td>List of IP/networks allowed to contact the Prometheus exporter endpoint.</td>
</tr>
</tbody>
</table>
<h2 id="es-features-real-ip">Real IP</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento de IP Real asegura que BunkerWeb identifique correctamente la dirección IP del cliente incluso cuando se encuentra detrás de proxies. Esto es esencial para aplicar correctamente las reglas de seguridad, la limitación de velocidad y el registro; sin él, todas las solicitudes parecerían provenir de la IP de su proxy en lugar de la IP real del cliente.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando está habilitado, BunkerWeb examina las solicitudes entrantes en busca de encabezados específicos (como <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/X-Forwarded-For"><code>X-Forwarded-For</code></a>) que contienen la dirección IP original del cliente.</li>
<li>BunkerWeb comprueba si la IP entrante está en su lista de proxies de confianza (<code>REAL_IP_FROM</code>), asegurando que solo los proxies legítimos puedan pasar las IP de los clientes.</li>
<li>La IP original del cliente se extrae del encabezado especificado (<code>REAL_IP_HEADER</code>) y se utiliza para todas las evaluaciones de seguridad y el registro.</li>
<li>Para las cadenas de IP recursivas, BunkerWeb puede rastrear a través de múltiples saltos de proxy para determinar la IP del cliente de origen.</li>
<li>Además, se puede habilitar el soporte para el <a href="https://netnut.io/what-is-proxy-protocol-and-how-does-it-work/">protocolo PROXY</a> para recibir las IP de los clientes directamente de proxies compatibles como <a href="https://www.haproxy.org/">HAProxy</a>.</li>
<li>Las listas de IP de proxies de confianza se pueden descargar y actualizar automáticamente desde fuentes externas a través de URL.</li>
</ol>
<h3 id="es-features-como-usar_23">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de IP Real:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_REAL_IP</code> en <code>yes</code> para habilitar la detección de la IP real.</li>
<li><strong>Defina los proxies de confianza:</strong> Enumere las direcciones IP o redes de sus proxies de confianza utilizando el ajuste <code>REAL_IP_FROM</code>.</li>
<li><strong>Especifique el encabezado:</strong> Configure qué encabezado contiene la IP real utilizando el ajuste <code>REAL_IP_HEADER</code>.</li>
<li><strong>Configure la recursividad:</strong> Decida si desea rastrear las cadenas de IP de forma recursiva con el ajuste <code>REAL_IP_RECURSIVE</code>.</li>
<li><strong>Fuentes de URL opcionales:</strong> Configure las descargas automáticas de listas de proxies de confianza con <code>REAL_IP_FROM_URLS</code>.</li>
<li><strong>Protocolo PROXY:</strong> Para la comunicación directa con el proxy, habilítelo con <code>USE_PROXY_PROTOCOL</code> si su upstream lo admite.</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">Advertencia sobre el Protocolo PROXY</p>
</div>
<p>Habilitar <code>USE_PROXY_PROTOCOL</code> sin configurar correctamente su proxy upstream para enviar los encabezados del protocolo PROXY <strong>romperá su aplicación</strong>. Solo habilite este ajuste si está seguro de que su proxy upstream está configurado correctamente para enviar la información del protocolo PROXY. Si su proxy no está enviando los encabezados del protocolo PROXY, todas las conexiones a BunkerWeb fallarán con errores de protocolo.</p>
<h3 id="es-features-ajustes-de-configuracion_24">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REAL_IP</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar IP Real:</strong> Establezca en <code>yes</code> para habilitar la obtención de la IP real del cliente desde los encabezados o el protocolo PROXY.</td>
</tr>
<tr>
<td><code>REAL_IP_FROM</code></td>
<td><code>192.168.0.0/16 172.16.0.0/12 10.0.0.0/8</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Proxies de Confianza:</strong> Lista de direcciones IP o redes de confianza desde donde provienen las solicitudes de proxy, separadas por espacios.</td>
</tr>
<tr>
<td><code>REAL_IP_HEADER</code></td>
<td><code>X-Forwarded-For</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Encabezado de IP Real:</strong> Encabezado HTTP que contiene la IP real o el valor especial <code>proxy_protocol</code> para el protocolo PROXY.</td>
</tr>
<tr>
<td><code>REAL_IP_RECURSIVE</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Búsqueda Recursiva:</strong> Cuando se establece en <code>yes</code>, realiza una búsqueda recursiva en el encabezado que contiene múltiples direcciones IP.</td>
</tr>
<tr>
<td><code>REAL_IP_FROM_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URL de la Lista de IP:</strong> URL que contienen las IP/redes de los proxies de confianza para descargar, separadas por espacios. Admite URL de tipo <code>file://</code>.</td>
</tr>
<tr>
<td><code>USE_PROXY_PROTOCOL</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Protocolo PROXY:</strong> Establezca en <code>yes</code> para habilitar el soporte del protocolo PROXY para la comunicación directa de proxy a BunkerWeb.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Redes de Proveedores de la Nube</p>
</div>
<p>Si está utilizando un proveedor de la nube como AWS, GCP o Azure, considere agregar los rangos de IP de sus balanceadores de carga a su ajuste <code>REAL_IP_FROM</code> para garantizar la correcta identificación de la IP del cliente.</p>
<div class="admonition danger">
<p class="admonition-title">Consideraciones de Seguridad</p>
</div>
<p>Solo incluya las IP de los proxies de confianza en su configuración. Agregar fuentes no confiables podría permitir ataques de suplantación de IP, donde los actores maliciosos podrían falsificar la IP del cliente manipulando los encabezados.</p>
<div class="admonition info">
<p class="admonition-title">Múltiples Direcciones IP</p>
</div>
<p>Cuando <code>REAL_IP_RECURSIVE</code> está habilitado y un encabezado contiene múltiples IP (p. ej., <code>X-Forwarded-For: cliente, proxy1, proxy2</code>), BunkerWeb identificará como la IP del cliente la IP más a la izquierda que no esté en su lista de proxies de confianza.</p>
<h3 id="es-features-configuraciones-de-ejemplo_25">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="60:6"><input checked="checked" id="es-features-__tabbed_60_1" name="es-features-__tabbed_60" type="radio" /><input id="es-features-__tabbed_60_2" name="es-features-__tabbed_60" type="radio" /><input id="es-features-__tabbed_60_3" name="es-features-__tabbed_60" type="radio" /><input id="es-features-__tabbed_60_4" name="es-features-__tabbed_60" type="radio" /><input id="es-features-__tabbed_60_5" name="es-features-__tabbed_60" type="radio" /><input id="es-features-__tabbed_60_6" name="es-features-__tabbed_60" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_60_1">Configuración Básica</label><label for="es-features-__tabbed_60_2">Balanceador de Carga en la Nube</label><label for="es-features-__tabbed_60_3">Protocolo PROXY</label><label for="es-features-__tabbed_60_4">Múltiples Fuentes de Proxy con URL</label><label for="es-features-__tabbed_60_5">Configuración de CDN</label><label for="es-features-__tabbed_60_6">Detrás de Cloudflare</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple para un sitio detrás de un proxy inverso:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">10.0.0.5&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para un sitio detrás de un balanceador de carga en la nube:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.0.0/16</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración utilizando el protocolo PROXY con un balanceador de carga compatible:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración avanzada con listas de IP de proxy actualizadas automáticamente:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.0.0/16</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Real-IP&quot;</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/proxy-ips.txt</span><span class="nv"> </span><span class="s">file:///etc/bunkerweb/custom-proxies.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para un sitio web detrás de una CDN:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.0.0/16</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">REAL_IP_FROM_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://cdn-provider.com/ip-ranges.txt&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CF-Connecting-IP&quot;</span><span class="w">  </span><span class="c1"># Ejemplo para Cloudflare</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span><span class="w">  </span><span class="c1"># No es necesario con encabezados de una sola IP</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para un sitio web detrás de Cloudflare:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># Solo confiamos en las IPs de Cloudflare</span>
<span class="nt">REAL_IP_FROM_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://www.cloudflare.com/ips-v4/</span><span class="nv"> </span><span class="s">https://www.cloudflare.com/ips-v6/&quot;</span><span class="w"> </span><span class="c1"># Descargar las IPs de Cloudflare automáticamente</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CF-Connecting-IP&quot;</span><span class="w">  </span><span class="c1"># Encabezado de Cloudflare para la IP del cliente</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-redirect">Redirect</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El complemento de Redirección proporciona capacidades de redirección HTTP simples y eficientes para sus sitios web protegidos por BunkerWeb. Esta función le permite redirigir fácilmente a los visitantes de una URL a otra, admitiendo tanto redirecciones de dominio completo, redirecciones de ruta específicas como redirecciones que preservan la ruta.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un visitante accede a su sitio web, BunkerWeb verifica si hay una redirección configurada.</li>
<li>Si está habilitado, BunkerWeb redirige al visitante a la URL de destino especificada.</li>
<li>Puede configurar si desea preservar la ruta de la solicitud original (agregándola automáticamente a la URL de destino) o redirigir a la URL de destino exacta.</li>
<li>El código de estado HTTP utilizado para la redirección se puede personalizar entre redirecciones permanentes (301) y temporales (302).</li>
<li>Esta funcionalidad es ideal para migraciones de dominio, establecer dominios canónicos o redirigir URL obsoletas.</li>
</ol>
<h3 id="es-features-como-usar_24">Cómo usar</h3>
<p>Siga estos pasos para configurar y utilizar la función de Redirección:</p>
<ol>
<li><strong>Establezca la ruta de origen:</strong> Configure la ruta desde la que se redirigirá utilizando el ajuste <code>REDIRECT_FROM</code> (por ejemplo, <code>/</code>, <code>/old-page</code>).</li>
<li><strong>Establezca la URL de destino:</strong> Configure la URL de destino a la que se redirigirá a los visitantes utilizando el ajuste <code>REDIRECT_TO</code>.</li>
<li><strong>Elija el tipo de redirección:</strong> Decida si desea preservar la ruta de la solicitud original con el ajuste <code>REDIRECT_TO_REQUEST_URI</code>.</li>
<li><strong>Seleccione el código de estado:</strong> Establezca el código de estado HTTP apropiado con el ajuste <code>REDIRECT_TO_STATUS_CODE</code> para indicar una redirección permanente o temporal.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, todas las solicitudes al sitio se redirigirán automáticamente según su configuración.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_25">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REDIRECT_FROM</code></td>
<td><code>/</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Ruta desde la que redirigir:</strong> La ruta que se redirigirá.</td>
</tr>
<tr>
<td><code>REDIRECT_TO</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>URL de destino:</strong> La URL de destino a la que se redirigirá a los visitantes. Deje en blanco para deshabilitar la redirección.</td>
</tr>
<tr>
<td><code>REDIRECT_TO_REQUEST_URI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Preservar ruta:</strong> Cuando se establece en <code>yes</code>, agrega el URI de la solicitud original a la URL de destino.</td>
</tr>
<tr>
<td><code>REDIRECT_TO_STATUS_CODE</code></td>
<td><code>301</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Código de estado HTTP:</strong> El código de estado HTTP a utilizar para la redirección. Opciones: <code>301</code> (permanente) o <code>302</code> (temporal).</td>
</tr>
</tbody>
</table>
<p>!!! tip "Elegir el Código de Estado Correcto" - Use <code>301</code> (Movido Permanentemente) cuando la redirección es permanente, como para migraciones de dominio o para establecer URL canónicas. Esto ayuda a los motores de búsqueda a actualizar sus índices. - Use <code>302</code> (Encontrado/Redirección Temporal) cuando la redirección es temporal o si desea reutilizar la URL original en el futuro.</p>
<div class="admonition info">
<p class="admonition-title">Preservación de la Ruta</p>
</div>
<p>Cuando <code>REDIRECT_TO_REQUEST_URI</code> se establece en <code>yes</code>, BunkerWeb preserva la ruta de la solicitud original. Por ejemplo, si un usuario visita <code>https://dominio-antiguo.com/blog/post-1</code> y ha configurado una redirección a <code>https://dominio-nuevo.com</code>, será redirigido a <code>https://dominio-nuevo.com/blog/post-1</code>.</p>
<h3 id="es-features-configuraciones-de-ejemplo_26">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="61:5"><input checked="checked" id="es-features-__tabbed_61_1" name="es-features-__tabbed_61" type="radio" /><input id="es-features-__tabbed_61_2" name="es-features-__tabbed_61" type="radio" /><input id="es-features-__tabbed_61_3" name="es-features-__tabbed_61" type="radio" /><input id="es-features-__tabbed_61_4" name="es-features-__tabbed_61" type="radio" /><input id="es-features-__tabbed_61_5" name="es-features-__tabbed_61" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_61_1">Redirección de Múltiples Rutas</label><label for="es-features-__tabbed_61_2">Redirección de Dominio Simple</label><label for="es-features-__tabbed_61_3">Redirección con Preservación de Ruta</label><label for="es-features-__tabbed_61_4">Redirección Temporal</label><label for="es-features-__tabbed_61_5">Consolidación de Subdominios</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración que redirige múltiples rutas a diferentes destinos:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Redirigir /blog a un nuevo dominio de blog</span>
<span class="nt">REDIRECT_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/blog/&quot;</span>
<span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://blog.example.com/&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>

<span class="c1"># Redirigir /shop a otro dominio</span>
<span class="nt">REDIRECT_FROM_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/shop/&quot;</span>
<span class="nt">REDIRECT_TO_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://shop.example.com/&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>

<span class="c1"># Redirigir el resto del sitio</span>
<span class="nt">REDIRECT_FROM_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">REDIRECT_TO_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://new-domain.com&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración que redirige a todos los visitantes a un nuevo dominio:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://new-domain.com&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración que redirige a los visitantes a un nuevo dominio mientras preserva la ruta solicitada:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://new-domain.com&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración para una redirección temporal a un sitio de mantenimiento:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://maintenance.example.com&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;302&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración para redirigir un subdominio a una ruta específica en el dominio principal:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/support&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-redis">Redis</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento Redis integra <a href="https://redis.io/">Redis</a> o <a href="https://valkey.io/">Valkey</a> en BunkerWeb para el almacenamiento en caché y la recuperación rápida de datos. Esta función es esencial para implementar BunkerWeb en entornos de alta disponibilidad donde los datos de sesión, las métricas y otra información compartida deben ser accesibles a través de múltiples nodos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando está habilitado, BunkerWeb establece una conexión con su servidor Redis o Valkey configurado.</li>
<li>Los datos críticos como la información de la sesión, las métricas y los datos relacionados con la seguridad se almacenan en Redis/Valkey.</li>
<li>Múltiples instancias de BunkerWeb pueden compartir estos datos, lo que permite la agrupación en clúster y el equilibrio de carga sin problemas.</li>
<li>El complemento admite varias opciones de implementación de Redis/Valkey, incluidos servidores independientes, autenticación con contraseña, cifrado SSL/TLS y Redis Sentinel para alta disponibilidad.</li>
<li>La reconexión automática y los tiempos de espera configurables garantizan la solidez en los entornos de producción.</li>
</ol>
<h3 id="es-features-como-usar_25">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar el complemento de Redis:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_REDIS</code> en <code>yes</code> para habilitar la integración de Redis/Valkey.</li>
<li><strong>Configure los detalles de la conexión:</strong> Especifique el nombre de host/dirección IP y el puerto de su servidor Redis/Valkey.</li>
<li><strong>Establezca las opciones de seguridad:</strong> Configure las credenciales de autenticación si su servidor Redis/Valkey las requiere.</li>
<li><strong>Configure las opciones avanzadas:</strong> Establezca la selección de la base de datos, las opciones de SSL y los tiempos de espera según sea necesario.</li>
<li><strong>Para alta disponibilidad,</strong> configure los ajustes de Sentinel si está utilizando Redis Sentinel.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_26">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REDIS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Habilitar Redis:</strong> Establezca en <code>yes</code> para habilitar la integración de Redis/Valkey para el modo de clúster.</td>
</tr>
<tr>
<td><code>REDIS_HOST</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Servidor Redis/Valkey:</strong> Dirección IP o nombre de host del servidor Redis/Valkey.</td>
</tr>
<tr>
<td><code>REDIS_PORT</code></td>
<td><code>6379</code></td>
<td>global</td>
<td>no</td>
<td><strong>Puerto Redis/Valkey:</strong> Número de puerto del servidor Redis/Valkey.</td>
</tr>
<tr>
<td><code>REDIS_DATABASE</code></td>
<td><code>0</code></td>
<td>global</td>
<td>no</td>
<td><strong>Base de datos Redis/Valkey:</strong> Número de base de datos a utilizar en el servidor Redis/Valkey (0-15).</td>
</tr>
<tr>
<td><code>REDIS_SSL</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>SSL de Redis/Valkey:</strong> Establezca en <code>yes</code> para habilitar el cifrado SSL/TLS para la conexión de Redis/Valkey.</td>
</tr>
<tr>
<td><code>REDIS_SSL_VERIFY</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Verificación SSL de Redis/Valkey:</strong> Establezca en <code>yes</code> para verificar el certificado SSL del servidor Redis/Valkey.</td>
</tr>
<tr>
<td><code>REDIS_TIMEOUT</code></td>
<td><code>5</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de espera de Redis/Valkey:</strong> Tiempo de espera de la conexión en segundos para las operaciones de Redis/Valkey.</td>
</tr>
<tr>
<td><code>REDIS_USERNAME</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Nombre de usuario de Redis/Valkey:</strong> Nombre de usuario para la autenticación de Redis/Valkey (Redis 6.0+).</td>
</tr>
<tr>
<td><code>REDIS_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Contraseña de Redis/Valkey:</strong> Contraseña para la autenticación de Redis/Valkey.</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_HOSTS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Hosts de Sentinel:</strong> Lista de hosts de Redis Sentinel separados por espacios (nombredehost:puerto).</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_USERNAME</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Nombre de usuario de Sentinel:</strong> Nombre de usuario para la autenticación de Redis Sentinel.</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Contraseña de Sentinel:</strong> Contraseña para la autenticación de Redis Sentinel.</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_MASTER</code></td>
<td><code>mymaster</code></td>
<td>global</td>
<td>no</td>
<td><strong>Maestro de Sentinel:</strong> Nombre del maestro en la configuración de Redis Sentinel.</td>
</tr>
<tr>
<td><code>REDIS_KEEPALIVE_IDLE</code></td>
<td><code>300</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de inactividad de keepalive:</strong> Tiempo (en segundos) entre las sondas TCP keepalive para conexiones inactivas.</td>
</tr>
<tr>
<td><code>REDIS_KEEPALIVE_POOL</code></td>
<td><code>3</code></td>
<td>global</td>
<td>no</td>
<td><strong>Grupo de keepalive:</strong> Número máximo de conexiones de Redis/Valkey mantenidas en el grupo.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Alta Disponibilidad con Redis Sentinel</p>
</div>
<p>Para entornos de producción que requieren alta disponibilidad, configure los ajustes de Redis Sentinel. Esto proporciona capacidades de conmutación por error automática si el servidor Redis principal deja de estar disponible.</p>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de Seguridad</p>
</div>
<p>Cuando utilice Redis en producción:</p>
<pre><code>-   Establezca siempre contraseñas seguras tanto para la autenticación de Redis como de Sentinel
-   Considere habilitar el cifrado SSL/TLS para las conexiones de Redis
-   Asegúrese de que su servidor Redis no esté expuesto a la Internet pública
-   Restrinja el acceso al puerto de Redis mediante cortafuegos o segmentación de red
</code></pre>
<div class="admonition info">
<p class="admonition-title">Requisitos del Clúster</p>
</div>
<p>Al implementar BunkerWeb en un clúster:</p>
<pre><code>-   Todas las instancias de BunkerWeb deben conectarse al mismo servidor Redis o Valkey o al clúster de Sentinel
-   Configure el mismo número de base de datos en todas las instancias
-   Asegúrese de que haya conectividad de red entre todas las instancias de BunkerWeb y los servidores Redis/Valkey
</code></pre>
<h3 id="es-features-configuraciones-de-ejemplo_27">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="62:4"><input checked="checked" id="es-features-__tabbed_62_1" name="es-features-__tabbed_62" type="radio" /><input id="es-features-__tabbed_62_2" name="es-features-__tabbed_62" type="radio" /><input id="es-features-__tabbed_62_3" name="es-features-__tabbed_62" type="radio" /><input id="es-features-__tabbed_62_4" name="es-features-__tabbed_62" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_62_1">Configuración Básica</label><label for="es-features-__tabbed_62_2">Configuración Segura</label><label for="es-features-__tabbed_62_3">Configuración de Redis Sentinel</label><label for="es-features-__tabbed_62_4">Ajuste Avanzado</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple para conectarse a un servidor Redis o Valkey en la máquina local:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span>
<span class="nt">REDIS_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6379&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con autenticación por contraseña y SSL habilitado:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis.example.com&quot;</span>
<span class="nt">REDIS_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6379&quot;</span>
<span class="nt">REDIS_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-strong-password&quot;</span>
<span class="nt">REDIS_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_SSL_VERIFY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para alta disponibilidad utilizando Redis Sentinel:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_SENTINEL_HOSTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sentinel1:26379</span><span class="nv"> </span><span class="s">sentinel2:26379</span><span class="nv"> </span><span class="s">sentinel3:26379&quot;</span>
<span class="nt">REDIS_SENTINEL_MASTER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mymaster&quot;</span>
<span class="nt">REDIS_SENTINEL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sentinel-password&quot;</span>
<span class="nt">REDIS_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis-password&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con parámetros de conexión avanzados para la optimización del rendimiento:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis.example.com&quot;</span>
<span class="nt">REDIS_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6379&quot;</span>
<span class="nt">REDIS_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-strong-password&quot;</span>
<span class="nt">REDIS_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">REDIS_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">REDIS_KEEPALIVE_IDLE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">REDIS_KEEPALIVE_POOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="es-features-mejores-practicas-de-redis">Mejores Prácticas de Redis</h3>
<p>Cuando utilice Redis o Valkey con BunkerWeb, considere estas mejores prácticas para garantizar un rendimiento, seguridad y fiabilidad óptimos:</p>
<h4 id="es-features-gestion-de-la-memoria">Gestión de la Memoria</h4>
<ul>
<li><strong>Supervise el uso de la memoria:</strong> Configure Redis con los ajustes <code>maxmemory</code> apropiados para evitar errores de falta de memoria</li>
<li><strong>Establezca una política de desalojo:</strong> Utilice <code>maxmemory-policy</code> (p. ej., <code>volatile-lru</code> o <code>allkeys-lru</code>) apropiada para su caso de uso</li>
<li><strong>Evite claves grandes:</strong> Asegúrese de que las claves individuales de Redis se mantengan en un tamaño razonable para evitar la degradación del rendimiento</li>
</ul>
<h4 id="es-features-persistencia-de-datos">Persistencia de Datos</h4>
<ul>
<li><strong>Habilite las instantáneas RDB:</strong> Configure instantáneas periódicas para la persistencia de datos sin un impacto significativo en el rendimiento</li>
<li><strong>Considere AOF:</strong> Para datos críticos, habilite la persistencia AOF (Append-Only File) con una política de <code>fsync</code> apropiada</li>
<li><strong>Estrategia de copia de seguridad:</strong> Implemente copias de seguridad regulares de Redis como parte de su plan de recuperación de desastres</li>
</ul>
<h4 id="es-features-optimizacion-del-rendimiento">Optimización del Rendimiento</h4>
<ul>
<li><strong>Agrupación de conexiones:</strong> BunkerWeb ya implementa esto, pero asegúrese de que otras aplicaciones sigan esta práctica</li>
<li><strong>Canalización:</strong> Cuando sea posible, utilice la canalización para operaciones masivas para reducir la sobrecarga de la red</li>
<li><strong>Evite operaciones costosas:</strong> Tenga cuidado con comandos como <code>KEYS</code> en entornos de producción</li>
<li><strong>Compare su carga de trabajo:</strong> Utilice <code>redis-benchmark</code> para probar sus patrones de carga de trabajo específicos</li>
</ul>
<h3 id="es-features-recursos-adicionales">Recursos Adicionales</h3>
<ul>
<li><a href="https://redis.io/documentation">Documentación de Redis</a></li>
<li><a href="https://redis.io/topics/security">Guía de Seguridad de Redis</a></li>
<li><a href="https://redis.io/topics/sentinel">Alta Disponibilidad de Redis</a></li>
<li><a href="https://redis.io/topics/persistence">Persistencia de Redis</a></li>
</ul>
<h2 id="es-features-reporting-pro">Reporting <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Regular reporting of important data from BunkerWeb (global, attacks, bans, requests, reasons, AS...). Monitoring pro plugin needed to work.</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REPORTING_SMTP</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable sending the report via email.</td>
</tr>
<tr>
<td><code>USE_REPORTING_WEBHOOK</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable sending the report via webhook.</td>
</tr>
<tr>
<td><code>REPORTING_SCHEDULE</code></td>
<td><code>weekly</code></td>
<td>global</td>
<td>no</td>
<td>The frequency at which reports are sent.</td>
</tr>
<tr>
<td><code>REPORTING_WEBHOOK_URLS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>List of webhook URLs to receive the report in Markdown (separated by spaces).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_EMAILS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>List of email addresses to receive the report in HTML format (separated by spaces).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_HOST</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The host server used for SMTP sending.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_PORT</code></td>
<td><code>465</code></td>
<td>global</td>
<td>no</td>
<td>The port used for SMTP. Please note that there are different standards depending on the type of connection (SSL = 465, TLS = 587).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_EMAIL</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The email address used as the sender. Note that 2FA must be disabled for this email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_USER</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The user authentication value for sending via the from email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The password authentication value for sending via the from email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SSL</code></td>
<td><code>SSL</code></td>
<td>global</td>
<td>no</td>
<td>Determine whether or not to use a secure connection for SMTP.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SUBJECT</code></td>
<td><code>BunkerWeb Report</code></td>
<td>global</td>
<td>no</td>
<td>The subject line of the email.</td>
</tr>
</tbody>
</table>
<h2 id="es-features-reverse-proxy">Reverse proxy</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento de Proxy Inverso proporciona capacidades de proxy sin interrupciones para BunkerWeb, lo que le permite enrutar solicitudes a servidores y servicios de backend. Esta función permite que BunkerWeb actúe como un frontend seguro para sus aplicaciones al tiempo que proporciona beneficios adicionales como la terminación de SSL y el filtrado de seguridad.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un cliente envía una solicitud a BunkerWeb, el complemento de Proxy Inverso reenvía la solicitud a su servidor de backend configurado.</li>
<li>BunkerWeb agrega encabezados de seguridad, aplica reglas de WAF y realiza otras verificaciones de seguridad antes de pasar las solicitudes a su aplicación.</li>
<li>El servidor de backend procesa la solicitud y devuelve una respuesta a BunkerWeb.</li>
<li>BunkerWeb aplica medidas de seguridad adicionales a la respuesta antes de enviarla de vuelta al cliente.</li>
<li>El complemento admite el proxy de flujo tanto HTTP como TCP/UDP, lo que permite una amplia gama de aplicaciones, incluidos WebSockets y otros protocolos no HTTP.</li>
</ol>
<h3 id="es-features-como-usar_26">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Proxy Inverso:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_REVERSE_PROXY</code> en <code>yes</code> para habilitar la funcionalidad de proxy inverso.</li>
<li><strong>Configure sus servidores de backend:</strong> Especifique los servidores upstream utilizando el ajuste <code>REVERSE_PROXY_HOST</code>.</li>
<li><strong>Ajuste la configuración del proxy:</strong> Afine el comportamiento con ajustes opcionales para tiempos de espera, tamaños de búfer y otros parámetros.</li>
<li><strong>Configure las opciones específicas del protocolo:</strong> Para WebSockets o requisitos HTTP especiales, ajuste la configuración correspondiente.</li>
<li><strong>Configure el almacenamiento en caché (opcional):</strong> Habilite y configure el almacenamiento en caché del proxy para mejorar el rendimiento del contenido al que se accede con frecuencia.</li>
</ol>
<h3 id="es-features-guia-de-configuracion_2">Guía de Configuración</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="63:1"><input checked="checked" id="es-features-__tabbed_63_1" name="es-features-__tabbed_63" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_63_1">Configuración Básica</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Ajustes Principales</strong></p>
<p>Los ajustes de configuración esenciales habilitan y controlan la funcionalidad básica de la función de proxy inverso.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios del Proxy Inverso</p>
<ul>
<li><strong>Mejora de la Seguridad:</strong> Todo el tráfico pasa a través de las capas de seguridad de BunkerWeb antes de llegar a sus aplicaciones</li>
<li><strong>Terminación SSL:</strong> Administre los certificados SSL/TLS de forma centralizada mientras que los servicios de backend pueden usar conexiones no cifradas</li>
<li><strong>Manejo de Protocolos:</strong> Soporte para HTTP, HTTPS, WebSockets y otros protocolos</li>
<li><strong>Interceptación de Errores:</strong> Personalice las páginas de error para una experiencia de usuario consistente</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REVERSE_PROXY</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Proxy Inverso:</strong> Establezca en <code>yes</code> para habilitar la funcionalidad de proxy inverso.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_HOST</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Host de Backend:</strong> URL completa del recurso al que se hace proxy (proxy_pass).</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_URL</code></td>
<td><code>/</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>URL de Ubicación:</strong> Ruta que se enviará al servidor de backend.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_BUFFERING</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Almacenamiento en Búfer de Respuesta:</strong> Habilite o deshabilite el almacenamiento en búfer de las respuestas del recurso al que se hace proxy.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_KEEPALIVE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Keep-Alive:</strong> Habilite o deshabilite las conexiones keepalive con el recurso al que se hace proxy.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_CUSTOM_HOST</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Host Personalizado:</strong> Anule el encabezado Host enviado al servidor upstream.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_INTERCEPT_ERRORS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Interceptar Errores:</strong> Si se deben interceptar y reescribir las respuestas de error del backend.</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Mejores Prácticas"
    - Siempre especifique la URL completa en `REVERSE_PROXY_HOST`, incluido el protocolo (http:// o https://)
    - Use `REVERSE_PROXY_INTERCEPT_ERRORS` para proporcionar páginas de error consistentes en todos sus servicios
    - Al configurar múltiples backends, use el formato de sufijo numerado (por ejemplo, `REVERSE_PROXY_HOST_2`, `REVERSE_PROXY_URL_2`)
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="64:1"><input checked="checked" id="es-features-__tabbed_64_1" name="es-features-__tabbed_64" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_64_1">Ajustes de Conexión</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Configuración de Conexión y Tiempo de Espera</strong></p>
<p>Estos ajustes controlan el comportamiento de la conexión, el almacenamiento en búfer y los valores de tiempo de espera para las conexiones con proxy.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios</p>
<ul>
<li><strong>Rendimiento Optimizado:</strong> Ajuste los tamaños de los búferes y la configuración de la conexión según las necesidades de su aplicación</li>
<li><strong>Gestión de Recursos:</strong> Controle el uso de la memoria mediante configuraciones de búfer adecuadas</li>
<li><strong>Fiabilidad:</strong> Configure los tiempos de espera adecuados para manejar conexiones lentas o problemas de backend</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_CONNECT_TIMEOUT</code></td>
<td><code>60s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Tiempo de Espera de Conexión:</strong> Tiempo máximo para establecer una conexión con el servidor de backend.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_READ_TIMEOUT</code></td>
<td><code>60s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Tiempo de Espera de Lectura:</strong> Tiempo máximo entre las transmisiones de dos paquetes sucesivos desde el servidor de backend.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_SEND_TIMEOUT</code></td>
<td><code>60s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Tiempo de Espera de Envío:</strong> Tiempo máximo entre las transmisiones de dos paquetes sucesivos al servidor de backend.</td>
</tr>
<tr>
<td><code>PROXY_BUFFERS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Búferes:</strong> Número y tamaño de los búferes para leer la respuesta del servidor de backend.</td>
</tr>
<tr>
<td><code>PROXY_BUFFER_SIZE</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tamaño del Búfer:</strong> Tamaño del búfer para leer la primera parte de la respuesta del servidor de backend.</td>
</tr>
<tr>
<td><code>PROXY_BUSY_BUFFERS_SIZE</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tamaño de los Búferes Ocupados:</strong> Tamaño de los búferes que pueden estar ocupados enviando la respuesta al cliente.</td>
</tr>
</tbody>
</table>
<pre><code>!!! warning "Consideraciones sobre el Tiempo de Espera"
    - Establecer tiempos de espera demasiado bajos puede hacer que se terminen las conexiones legítimas pero lentas
    - Establecer tiempos de espera demasiado altos puede dejar las conexiones abiertas innecesariamente, lo que podría agotar los recursos
    - Para las aplicaciones WebSocket, aumente significativamente los tiempos de espera de lectura y envío (se recomienda 300s o más)
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="65:1"><input checked="checked" id="es-features-__tabbed_65_1" name="es-features-__tabbed_65" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_65_1">Configuración SSL/TLS</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Ajustes SSL/TLS para Conexiones de Backend</strong></p>
<p>Estos ajustes controlan cómo BunkerWeb establece conexiones seguras con los servidores de backend.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios</p>
<ul>
<li><strong>Cifrado de Extremo a Extremo:</strong> Mantenga las conexiones cifradas desde el cliente hasta el backend</li>
<li><strong>Validación de Certificados:</strong> Controle cómo se validan los certificados del servidor de backend</li>
<li><strong>Soporte SNI:</strong> Especifique la Indicación del Nombre del Servidor para los backends que alojan múltiples sitios</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_SSL_SNI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>SSL SNI:</strong> Habilite o deshabilite el envío de SNI (Indicación del Nombre del Servidor) al upstream.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_SSL_SNI_NAME</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Nombre de SSL SNI:</strong> Establece el nombre de host de SNI que se enviará al upstream cuando SSL SNI esté habilitado.</td>
</tr>
</tbody>
</table>
<pre><code>!!! info "SNI Explicado"
    La Indicación del Nombre del Servidor (SNI) es una extensión de TLS que permite a un cliente especificar el nombre de host al que intenta conectarse durante el proceso de handshake. Esto permite a los servidores presentar múltiples certificados en la misma dirección IP y puerto, lo que permite que múltiples sitios web seguros (HTTPS) se sirvan desde una única dirección IP sin requerir que todos esos sitios usen el mismo certificado.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="66:1"><input checked="checked" id="es-features-__tabbed_66_1" name="es-features-__tabbed_66" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_66_1">Soporte de Protocolo</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Configuración Específica del Protocolo</strong></p>
<p>Configure el manejo especial de protocolos, particularmente para WebSockets y otros protocolos no HTTP.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios</p>
<ul>
<li><strong>Flexibilidad de Protocolo:</strong> El soporte para WebSockets permite aplicaciones en tiempo real</li>
<li><strong>Aplicaciones Web Modernas:</strong> Habilite características interactivas que requieren comunicación bidireccional</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_WS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Soporte de WebSocket:</strong> Habilite el protocolo WebSocket en el recurso.</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Configuración de WebSocket"
    - Al habilitar WebSockets con `REVERSE_PROXY_WS: "yes"`, considere aumentar los valores de tiempo de espera
    - Las conexiones WebSocket permanecen abiertas más tiempo que las conexiones HTTP típicas
    - Para las aplicaciones WebSocket, una configuración recomendada es:
      ```yaml
      REVERSE_PROXY_WS: "yes"
      REVERSE_PROXY_READ_TIMEOUT: "300s"
      REVERSE_PROXY_SEND_TIMEOUT: "300s"
      ```
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="67:1"><input checked="checked" id="es-features-__tabbed_67_1" name="es-features-__tabbed_67" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_67_1">Gestión de Encabezados</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Configuración de Encabezados HTTP</strong></p>
<p>Controle qué encabezados se envían a los servidores de backend y a los clientes, lo que le permite agregar, modificar o preservar los encabezados HTTP.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios</p>
<ul>
<li><strong>Control de la Información:</strong> Administre con precisión qué información se comparte entre los clientes y los backends</li>
<li><strong>Mejora de la Seguridad:</strong> Agregue encabezados relacionados con la seguridad o elimine los encabezados que podrían filtrar información sensible</li>
<li><strong>Soporte de Integración:</strong> Proporcione los encabezados necesarios para la autenticación y el correcto funcionamiento del backend</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_HEADERS</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Encabezados Personalizados:</strong> Encabezados HTTP para enviar al backend separados por punto y coma.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_HIDE_HEADERS</code></td>
<td><code>Upgrade</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Ocultar Encabezados:</strong> Encabezados HTTP para ocultar a los clientes cuando se reciben del backend.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_HEADERS_CLIENT</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Encabezados del Cliente:</strong> Encabezados HTTP para enviar al cliente separados por punto y coma.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_UNDERSCORES_IN_HEADERS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Guiones Bajos en los Encabezados:</strong> Habilite o deshabilite la directiva <code>underscores_in_headers</code>.</td>
</tr>
</tbody>
</table>
<pre><code>!!! warning "Consideraciones de Seguridad"
    Al usar la función de proxy inverso, tenga cuidado con los encabezados que reenvía a sus aplicaciones de backend. Ciertos encabezados pueden exponer información sensible sobre su infraestructura o eludir los controles de seguridad.

!!! example "Ejemplos de Formato de Encabezado"
    Encabezados personalizados para los servidores de backend:
    ```
    REVERSE_PROXY_HEADERS: "X-Real-IP $remote_addr;X-Forwarded-For $proxy_add_x_forwarded_for;X-Forwarded-Proto $scheme"
    ```

    Encabezados personalizados para los clientes:
    ```
    REVERSE_PROXY_HEADERS_CLIENT: "X-Powered-By BunkerWeb;X-Frame-Options SAMEORIGIN"
    ```
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="68:1"><input checked="checked" id="es-features-__tabbed_68_1" name="es-features-__tabbed_68" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_68_1">Autenticación</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Configuración de Autenticación Externa</strong></p>
<p>Integre con sistemas de autenticación externos para centralizar la lógica de autorización en sus aplicaciones.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios</p>
<ul>
<li><strong>Autenticación Centralizada:</strong> Implemente un único punto de autenticación para múltiples aplicaciones</li>
<li><strong>Seguridad Consistente:</strong> Aplique políticas de autenticación uniformes en diferentes servicios</li>
<li><strong>Control Mejorado:</strong> Reenvíe los detalles de la autenticación a las aplicaciones de backend a través de encabezados o variables</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_AUTH_REQUEST</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Solicitud de Autenticación:</strong> Habilite la autenticación mediante un proveedor externo.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_AUTH_REQUEST_SIGNIN_URL</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>URL de Inicio de Sesión:</strong> Redirija a los clientes a la URL de inicio de sesión cuando falle la autenticación.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_AUTH_REQUEST_SET</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Conjunto de Solicitudes de Autenticación:</strong> Variables a establecer desde el proveedor de autenticación.</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Integración de Autenticación"
    - La función de solicitud de autenticación permite la implementación de microservicios de autenticación centralizados
    - Su servicio de autenticación debe devolver un código de estado 200 para una autenticación exitosa o 401/403 para fallas
    - Use la directiva `auth_request_set` para extraer y reenviar información del servicio de autenticación
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="69:1"><input checked="checked" id="es-features-__tabbed_69_1" name="es-features-__tabbed_69" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_69_1">Configuración Avanzada</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Opciones de Configuración Adicionales</strong></p>
<p>Estos ajustes proporcionan una mayor personalización del comportamiento del proxy inverso para escenarios especializados.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios</p>
<ul>
<li><strong>Personalización:</strong> Incluya fragmentos de configuración adicionales para requisitos complejos</li>
<li><strong>Optimización del Rendimiento:</strong> Afine el manejo de solicitudes para casos de uso específicos</li>
<li><strong>Flexibilidad:</strong> Adáptese a los requisitos únicos de la aplicación con configuraciones especializadas</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_INCLUDES</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Configuraciones Adicionales:</strong> Incluya configuraciones adicionales en el bloque de ubicación.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_PASS_REQUEST_BODY</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Pasar el Cuerpo de la Solicitud:</strong> Habilite o deshabilite el paso del cuerpo de la solicitud.</td>
</tr>
</tbody>
</table>
<pre><code>!!! warning "Consideraciones de Seguridad"
    Tenga cuidado al incluir fragmentos de configuración personalizados, ya que pueden anular la configuración de seguridad de BunkerWeb o introducir vulnerabilidades si no se configuran correctamente.
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="70:1"><input checked="checked" id="es-features-__tabbed_70_1" name="es-features-__tabbed_70" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_70_1">Configuración de Caché</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Ajustes de Almacenamiento en Caché de Respuestas</strong></p>
<p>Mejore el rendimiento almacenando en caché las respuestas de los servidores de backend, reduciendo la carga y mejorando los tiempos de respuesta.</p>
<div class="admonition success">
<p class="admonition-title">Beneficios</p>
<ul>
<li><strong>Rendimiento:</strong> Reduzca la carga en los servidores de backend sirviendo contenido en caché</li>
<li><strong>Latencia Reducida:</strong> Tiempos de respuesta más rápidos para el contenido solicitado con frecuencia</li>
<li><strong>Ahorro de Ancho de Banda:</strong> Minimice el tráfico de la red interna almacenando en caché las respuestas</li>
<li><strong>Personalización:</strong> Configure exactamente qué, cuándo y cómo se almacena en caché el contenido</li>
</ul>
</div>
</div>
</div>
</div>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_PROXY_CACHE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Caché:</strong> Establezca en <code>yes</code> para habilitar el almacenamiento en caché de las respuestas del backend.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_PATH_LEVELS</code></td>
<td><code>1:2</code></td>
<td>global</td>
<td>no</td>
<td><strong>Niveles de Ruta de Caché:</strong> Cómo estructurar la jerarquía del directorio de caché.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_PATH_ZONE_SIZE</code></td>
<td><code>10m</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tamaño de la Zona de Caché:</strong> Tamaño de la zona de memoria compartida utilizada para los metadatos de la caché.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_PATH_PARAMS</code></td>
<td><code>max_size=100m</code></td>
<td>global</td>
<td>no</td>
<td><strong>Parámetros de la Ruta de Caché:</strong> Parámetros adicionales para la ruta de la caché.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_METHODS</code></td>
<td><code>GET HEAD</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Métodos de Caché:</strong> Métodos HTTP que se pueden almacenar en caché.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_MIN_USES</code></td>
<td><code>2</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Usos Mínimos de Caché:</strong> Número mínimo de solicitudes antes de que una respuesta se almacene en caché.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_KEY</code></td>
<td><code>$scheme$host$request_uri</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Clave de Caché:</strong> La clave utilizada para identificar de forma única una respuesta en caché.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_VALID</code></td>
<td><code>200=24h 301=1h 302=24h</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Validez de la Caché:</strong> Cuánto tiempo almacenar en caché los códigos de respuesta específicos.</td>
</tr>
<tr>
<td><code>PROXY_NO_CACHE</code></td>
<td><code>$http_pragma $http_authorization</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Sin Caché:</strong> Condiciones para no almacenar en caché las respuestas aunque normalmente sean almacenables en caché.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_BYPASS</code></td>
<td><code>0</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Omitir Caché:</strong> Condiciones bajo las cuales omitir la caché.</td>
</tr>
</tbody>
</table>
<pre><code>!!! tip "Mejores Prácticas de Almacenamiento en Caché"
    - Almacene en caché solo el contenido que no cambia con frecuencia o no es personalizado
    - Use duraciones de caché apropiadas según el tipo de contenido (los activos estáticos se pueden almacenar en caché por más tiempo)
    - Configure `PROXY_NO_CACHE` para evitar almacenar en caché contenido sensible o personalizado
    - Supervise las tasas de aciertos de la caché y ajuste la configuración en consecuencia
</code></pre>
<div class="admonition danger">
<p class="admonition-title">Usuarios de Docker Compose - Variables de NGINX</p>
</div>
<p>Al usar Docker Compose con variables de NGINX en sus configuraciones, debe escapar el signo de dólar (<code>$</code>) usando signos de dólar dobles (<code>$$</code>). Esto se aplica a todos los ajustes que contienen variables de NGINX como <code>$remote_addr</code>, <code>$proxy_add_x_forwarded_for</code>, etc.</p>
<pre><code>Sin este escape, Docker Compose intentará sustituir estas variables por variables de entorno, que normalmente no existen, lo que dará como resultado valores vacíos en su configuración de NGINX.
</code></pre>
<h3 id="es-features-configuraciones-de-ejemplo_28">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="71:6"><input checked="checked" id="es-features-__tabbed_71_1" name="es-features-__tabbed_71" type="radio" /><input id="es-features-__tabbed_71_2" name="es-features-__tabbed_71" type="radio" /><input id="es-features-__tabbed_71_3" name="es-features-__tabbed_71" type="radio" /><input id="es-features-__tabbed_71_4" name="es-features-__tabbed_71" type="radio" /><input id="es-features-__tabbed_71_5" name="es-features-__tabbed_71" type="radio" /><input id="es-features-__tabbed_71_6" name="es-features-__tabbed_71" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_71_1">Proxy HTTP Básico</label><label for="es-features-__tabbed_71_2">Aplicación WebSocket</label><label for="es-features-__tabbed_71_3">Múltiples Ubicaciones</label><label for="es-features-__tabbed_71_4">Configuración de Caché</label><label for="es-features-__tabbed_71_5">Gestión Avanzada de Encabezados</label><label for="es-features-__tabbed_71_6">Integración de Autenticación</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple para hacer proxy de las solicitudes HTTP a un servidor de aplicaciones de backend:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">REVERSE_PROXY_CONNECT_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10s&quot;</span>
<span class="nt">REVERSE_PROXY_SEND_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60s&quot;</span>
<span class="nt">REVERSE_PROXY_READ_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60s&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración optimizada para una aplicación WebSocket con tiempos de espera más largos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://websocket-app:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">REVERSE_PROXY_WS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_CONNECT_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10s&quot;</span>
<span class="nt">REVERSE_PROXY_SEND_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300s&quot;</span>
<span class="nt">REVERSE_PROXY_READ_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300s&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para enrutar diferentes rutas a diferentes servicios de backend:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Backend de la API</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://api-server:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api/&quot;</span>

<span class="c1"># Backend de Administración</span>
<span class="nt">REVERSE_PROXY_HOST_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://admin-server:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/admin/&quot;</span>

<span class="c1"># Aplicación Frontend</span>
<span class="nt">REVERSE_PROXY_HOST_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://frontend:3000&quot;</span>
<span class="nt">REVERSE_PROXY_URL_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con el almacenamiento en caché del proxy habilitado para un mejor rendimiento:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">USE_PROXY_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">PROXY_CACHE_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;200=24h</span><span class="nv"> </span><span class="s">301=1h</span><span class="nv"> </span><span class="s">302=24h&quot;</span>
<span class="nt">PROXY_CACHE_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET</span><span class="nv"> </span><span class="s">HEAD&quot;</span>
<span class="nt">PROXY_NO_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;$http_authorization&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con manipulación de encabezados personalizados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>

<span class="c1"># Encabezados personalizados para el backend</span>
<span class="nt">REVERSE_PROXY_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Real-IP</span><span class="nv"> </span><span class="s">$remote_addr;X-Forwarded-For</span><span class="nv"> </span><span class="s">$proxy_add_x_forwarded_for;X-Forwarded-Proto</span><span class="nv"> </span><span class="s">$scheme&quot;</span>

<span class="c1"># Encabezados personalizados para el cliente</span>
<span class="nt">REVERSE_PROXY_HEADERS_CLIENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Powered-By</span><span class="nv"> </span><span class="s">BunkerWeb;X-Frame-Options</span><span class="nv"> </span><span class="s">SAMEORIGIN&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con autenticación externa:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>

<span class="c1"># Configuración de autenticación</span>
<span class="nt">REVERSE_PROXY_AUTH_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/auth&quot;</span>
<span class="nt">REVERSE_PROXY_AUTH_REQUEST_SIGNIN_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://login.example.com&quot;</span>
<span class="nt">REVERSE_PROXY_AUTH_REQUEST_SET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;$auth_user</span><span class="nv"> </span><span class="s">$upstream_http_x_user;$auth_role</span><span class="nv"> </span><span class="s">$upstream_http_x_role&quot;</span>

<span class="c1"># Backend del servicio de autenticación</span>
<span class="nt">REVERSE_PROXY_HOST_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://auth-service:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/auth&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-reverse-scan">Reverse scan</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de Escaneo Inverso protege de manera robusta contra los intentos de evasión de proxy al escanear los puertos de los clientes para detectar si están ejecutando servidores proxy u otros servicios de red. Esta función ayuda a identificar y bloquear posibles amenazas de clientes que puedan estar intentando ocultar su verdadera identidad u origen, mejorando así la postura de seguridad de su sitio web.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un cliente se conecta a su servidor, BunkerWeb intenta escanear puertos específicos en la dirección IP del cliente.</li>
<li>El complemento comprueba si alguno de los puertos de proxy comunes (como 80, 443, 8080, etc.) está abierto en el lado del cliente.</li>
<li>Si se detectan puertos abiertos, lo que indica que el cliente puede estar ejecutando un servidor proxy, se deniega la conexión.</li>
<li>Esto agrega una capa adicional de seguridad contra herramientas automatizadas, bots y usuarios maliciosos que intentan enmascarar su identidad.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Beneficios clave</p>
<ol>
<li><strong>Seguridad Mejorada:</strong> Identifica a los clientes que potencialmente ejecutan servidores proxy que podrían ser utilizados con fines maliciosos.</li>
<li><strong>Detección de Proxy:</strong> Ayuda a detectar y bloquear a los clientes que intentan ocultar su verdadera identidad.</li>
<li><strong>Ajustes Configurables:</strong> Personalice qué puertos escanear según sus requisitos de seguridad específicos.</li>
<li><strong>Optimizado para el Rendimiento:</strong> Escaneo inteligente con tiempos de espera configurables para minimizar el impacto en los usuarios legítimos.</li>
<li><strong>Integración Perfecta:</strong> Funciona de forma transparente con sus capas de seguridad existentes.</li>
</ol>
</div>
<h3 id="es-features-como-usar_27">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Escaneo Inverso:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_REVERSE_SCAN</code> en <code>yes</code> para habilitar el escaneo de puertos del cliente.</li>
<li><strong>Configure los puertos a escanear:</strong> Personalice el ajuste <code>REVERSE_SCAN_PORTS</code> para especificar qué puertos del cliente deben ser verificados.</li>
<li><strong>Establezca el tiempo de espera del escaneo:</strong> Ajuste el <code>REVERSE_SCAN_TIMEOUT</code> para equilibrar un escaneo exhaustivo con el rendimiento.</li>
<li><strong>Supervise la actividad de escaneo:</strong> Verifique los registros y la <a href="#es-web-ui">interfaz de usuario web</a> para revisar los resultados del escaneo y los posibles incidentes de seguridad.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_27">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REVERSE_SCAN</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Escaneo Inverso:</strong> Establezca en <code>yes</code> para habilitar el escaneo de los puertos de los clientes.</td>
</tr>
<tr>
<td><code>REVERSE_SCAN_PORTS</code></td>
<td><code>22 80 443 3128 8000 8080</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Puertos a Escanear:</strong> Lista de puertos separados por espacios para verificar en el lado del cliente.</td>
</tr>
<tr>
<td><code>REVERSE_SCAN_TIMEOUT</code></td>
<td><code>500</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Tiempo de Espera del Escaneo:</strong> Tiempo máximo en milisegundos permitido para escanear un puerto.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de Rendimiento</p>
</div>
<p>Escanear múltiples puertos puede agregar latencia a las conexiones de los clientes. Use un valor de tiempo de espera apropiado y limite el número de puertos escaneados para mantener un buen rendimiento.</p>
<div class="admonition info">
<p class="admonition-title">Puertos de Proxy Comunes</p>
</div>
<p>La configuración predeterminada incluye puertos comunes utilizados por los servidores proxy (80, 443, 8080, 3128) y SSH (22). Es posible que desee personalizar esta lista según su modelo de amenaza.</p>
<h3 id="es-features-configuraciones-de-ejemplo_29">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="72:4"><input checked="checked" id="es-features-__tabbed_72_1" name="es-features-__tabbed_72" type="radio" /><input id="es-features-__tabbed_72_2" name="es-features-__tabbed_72" type="radio" /><input id="es-features-__tabbed_72_3" name="es-features-__tabbed_72" type="radio" /><input id="es-features-__tabbed_72_4" name="es-features-__tabbed_72" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_72_1">Configuración Básica</label><label for="es-features-__tabbed_72_2">Escaneo Exhaustivo</label><label for="es-features-__tabbed_72_3">Configuración Optimizada para el Rendimiento</label><label for="es-features-__tabbed_72_4">Configuración de Alta Seguridad</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple para habilitar el escaneo de puertos del cliente:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">8080&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración más completa que verifica puertos adicionales:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;22</span><span class="nv"> </span><span class="s">80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">3128</span><span class="nv"> </span><span class="s">8080</span><span class="nv"> </span><span class="s">8000</span><span class="nv"> </span><span class="s">8888</span><span class="nv"> </span><span class="s">1080</span><span class="nv"> </span><span class="s">3333</span><span class="nv"> </span><span class="s">8081&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración ajustada para un mejor rendimiento al verificar menos puertos con un tiempo de espera más bajo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;250&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">8080&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración enfocada en la máxima seguridad con un escaneo extendido:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1500&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;22</span><span class="nv"> </span><span class="s">25</span><span class="nv"> </span><span class="s">80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">1080</span><span class="nv"> </span><span class="s">3128</span><span class="nv"> </span><span class="s">3333</span><span class="nv"> </span><span class="s">4444</span><span class="nv"> </span><span class="s">5555</span><span class="nv"> </span><span class="s">6588</span><span class="nv"> </span><span class="s">6666</span><span class="nv"> </span><span class="s">7777</span><span class="nv"> </span><span class="s">8000</span><span class="nv"> </span><span class="s">8080</span><span class="nv"> </span><span class="s">8081</span><span class="nv"> </span><span class="s">8800</span><span class="nv"> </span><span class="s">8888</span><span class="nv"> </span><span class="s">9999&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-robotstxt">Robots.txt</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento Robots.txt gestiona el archivo <a href="https://www.robotstxt.org/">robots.txt</a> para su sitio web. Este archivo indica a los rastreadores web y robots qué partes de su sitio pueden o no pueden acceder.</p>
<p><strong>Cómo funciona:</strong></p>
<p>Cuando está habilitado, BunkerWeb genera dinámicamente el archivo <code>/robots.txt</code> en la raíz de su sitio web. Las reglas dentro de este archivo se agregan de múltiples fuentes en el siguiente orden:</p>
<ol>
<li><strong>API de DarkVisitors:</strong> Si se proporciona <code>ROBOTSTXT_DARKVISITORS_TOKEN</code>, las reglas se obtienen de la API de <a href="https://darkvisitors.com/">DarkVisitors</a>, lo que permite el bloqueo dinámico de bots maliciosos y rastreadores de IA según los tipos de agentes configurados y los agentes de usuario no permitidos.</li>
<li><strong>Listas de la Comunidad:</strong> Se incluyen reglas de listas <code>robots.txt</code> predefinidas y mantenidas por la comunidad (especificadas por <code>ROBOTSTXT_COMMUNITY_LISTS</code>).</li>
<li><strong>URL personalizadas:</strong> Las reglas se obtienen de las URL proporcionadas por el usuario (especificadas por <code>ROBOTSTXT_URLS</code>).</li>
<li><strong>Reglas manuales:</strong> Se agregan las reglas definidas directamente a través de las variables de entorno <code>ROBOTSTXT_RULE</code>.</li>
</ol>
<p>Todas las reglas de estas fuentes se combinan. Después de la agregación, se aplican <code>ROBOTSTXT_IGNORE_RULE</code> para filtrar cualquier regla no deseada utilizando patrones de expresiones regulares PCRE. Finalmente, si no queda ninguna regla después de todo este proceso, se aplica automáticamente una regla predeterminada <code>User-agent: *</code> y <code>Disallow: /</code> para garantizar un nivel básico de protección. Las URL de mapa de sitio opcionales (especificadas por <code>ROBOTSTXT_SITEMAP</code>) también se incluyen en la salida final de <code>robots.txt</code>.</p>
<h3 id="es-features-evasion-dinamica-de-bots-con-la-api-de-darkvisitors">Evasión Dinámica de Bots con la API de DarkVisitors</h3>
<p><a href="https://darkvisitors.com/">DarkVisitors</a> es un servicio que proporciona un archivo <code>robots.txt</code> dinámico para ayudar a bloquear bots maliciosos conocidos y rastreadores de IA. Al integrarse con DarkVisitors, BunkerWeb puede obtener y servir automáticamente un <code>robots.txt</code> actualizado que ayuda a proteger su sitio del tráfico automatizado no deseado.</p>
<p>Para habilitar esto, debe registrarse en <a href="https://darkvisitors.com/docs/robots-txt">darkvisitors.com</a> y obtener un token de portador (bearer token).</p>
<h3 id="es-features-como-usar_28">Cómo usar</h3>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_ROBOTSTXT</code> en <code>yes</code>.</li>
<li><strong>Configure las reglas:</strong> Elija uno o más métodos para definir sus reglas de <code>robots.txt</code>:<ul>
<li><strong>API de DarkVisitors:</strong> Proporcione <code>ROBOTSTXT_DARKVISITORS_TOKEN</code> y, opcionalmente, <code>ROBOTSTXT_DARKVISITORS_AGENT_TYPES</code> y <code>ROBOTSTXT_DARKVISITORS_DISALLOW</code>.</li>
<li><strong>Listas de la Comunidad:</strong> Especifique <code>ROBOTSTXT_COMMUNITY_LISTS</code> (IDs separados por espacios).</li>
<li><strong>URL personalizadas:</strong> Proporcione <code>ROBOTSTXT_URLS</code> (URLs separadas por espacios).</li>
<li><strong>Reglas manuales:</strong> Use <code>ROBOTSTXT_RULE</code> para reglas individuales (se pueden especificar múltiples reglas con <code>ROBOTSTXT_RULE_N</code>).</li>
</ul>
</li>
<li><strong>Filtre las reglas (opcional):</strong> Use <code>ROBOTSTXT_IGNORE_RULE_N</code> para excluir reglas específicas por patrón de expresión regular.</li>
<li><strong>Agregue mapas de sitio (opcional):</strong> Use <code>ROBOTSTXT_SITEMAP_N</code> para las URL de los mapas de sitio.</li>
<li><strong>Obtenga el archivo robots.txt generado:</strong> Una vez que BunkerWeb esté funcionando con los ajustes anteriores, puede acceder al archivo <code>robots.txt</code> generado dinámicamente haciendo una solicitud HTTP GET a <code>http(s)://su-dominio.com/robots.txt</code>.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_28">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ROBOTSTXT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>No</td>
<td>Habilita o deshabilita la función <code>robots.txt</code>.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_DARKVISITORS_TOKEN</code></td>
<td></td>
<td>multisite</td>
<td>No</td>
<td>Token de portador para la API de DarkVisitors.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_DARKVISITORS_AGENT_TYPES</code></td>
<td></td>
<td>multisite</td>
<td>No</td>
<td>Lista de tipos de agentes separados por comas (por ejemplo, <code>AI Data Scraper</code>) para incluir desde DarkVisitors.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_DARKVISITORS_DISALLOW</code></td>
<td><code>/</code></td>
<td>multisite</td>
<td>No</td>
<td>Una cadena que especifica qué URL no están permitidas. Este valor se enviará como el campo de no permitir al contactar con la API de DarkVisitors.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_COMMUNITY_LISTS</code></td>
<td></td>
<td>multisite</td>
<td>No</td>
<td>Lista separada por espacios de IDs de conjuntos de reglas mantenidos por la comunidad para incluir.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_URLS</code></td>
<td></td>
<td>multisite</td>
<td>No</td>
<td>Lista separada por espacios de URL para obtener reglas adicionales de <code>robots.txt</code>. Admite <code>file://</code> y autenticación básica (<code>http://user:pass@url</code>).</td>
</tr>
<tr>
<td><code>ROBOTSTXT_RULE</code></td>
<td></td>
<td>multisite</td>
<td>Sí</td>
<td>Una sola regla para <code>robots.txt</code>.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_HEADER</code></td>
<td></td>
<td>multisite</td>
<td>Sí</td>
<td>Encabezado para el archivo <code>robots.txt</code> (antes de las reglas). Puede estar codificado en Base64.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_FOOTER</code></td>
<td></td>
<td>multisite</td>
<td>Sí</td>
<td>Pie de página para el archivo <code>robots.txt</code> (después de las reglas). Puede estar codificado en Base64.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_IGNORE_RULE</code></td>
<td></td>
<td>multisite</td>
<td>Sí</td>
<td>Un único patrón de expresión regular PCRE para ignorar reglas.</td>
</tr>
<tr>
<td><code>ROBOTSTXT_SITEMAP</code></td>
<td></td>
<td>multisite</td>
<td>Sí</td>
<td>Una única URL de mapa de sitio.</td>
</tr>
</tbody>
</table>
<h3 id="es-features-configuraciones-de-ejemplo_30">Configuraciones de Ejemplo</h3>
<p><strong>Reglas Manuales Básicas</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ROBOTSTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">ROBOTSTXT_RULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;User-agent:</span><span class="nv"> </span><span class="s">*&quot;</span>
<span class="nt">ROBOTSTXT_RULE_1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Disallow:</span><span class="nv"> </span><span class="s">/private&quot;</span>
<span class="nt">ROBOTSTXT_SITEMAP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/sitemap.xml&quot;</span>
</code></pre></div>
<p><strong>Usando Fuentes Dinámicas (DarkVisitors y Lista de la Comunidad)</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ROBOTSTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">ROBOTSTXT_DARKVISITORS_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;su-token-de-darkvisitors-aqui&quot;</span>
<span class="nt">ROBOTSTXT_DARKVISITORS_AGENT_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;AI</span><span class="nv"> </span><span class="s">Data</span><span class="nv"> </span><span class="s">Scraper&quot;</span>
<span class="nt">ROBOTSTXT_COMMUNITY_LISTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;robots-disallowed&quot;</span>
<span class="nt">ROBOTSTXT_IGNORE_RULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;User-agent:</span><span class="nv"> </span><span class="s">Googlebot-Image&quot;</span>
</code></pre></div>
<p><strong>Configuración Combinada</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ROBOTSTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">ROBOTSTXT_DARKVISITORS_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;su-token-de-darkvisitors-aqui&quot;</span>
<span class="nt">ROBOTSTXT_COMMUNITY_LISTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ai-robots-txt&quot;</span>
<span class="nt">ROBOTSTXT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/my-custom-rules.txt&quot;</span>
<span class="nt">ROBOTSTXT_RULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;User-agent:</span><span class="nv"> </span><span class="s">MyOwnBot&quot;</span>
<span class="nt">ROBOTSTXT_RULE_1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Disallow:</span><span class="nv"> </span><span class="s">/admin&quot;</span>
<span class="nt">ROBOTSTXT_IGNORE_RULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;User-agent:</span><span class="nv"> </span><span class="s">Googlebot-Image&quot;</span>
<span class="nt">ROBOTSTXT_SITEMAP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/sitemap.xml&quot;</span>
</code></pre></div>
<p><strong>Con Encabezado y Pie de Página</strong></p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ROBOTSTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">ROBOTSTXT_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#</span><span class="nv"> </span><span class="s">Este</span><span class="nv"> </span><span class="s">es</span><span class="nv"> </span><span class="s">un</span><span class="nv"> </span><span class="s">encabezado</span><span class="nv"> </span><span class="s">personalizado&quot;</span>
<span class="nt">ROBOTSTXT_RULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;User-agent:</span><span class="nv"> </span><span class="s">*&quot;</span>
<span class="nt">ROBOTSTXT_RULE_1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Disallow:</span><span class="nv"> </span><span class="s">/private&quot;</span>
<span class="nt">ROBOTSTXT_FOOTER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;#</span><span class="nv"> </span><span class="s">Este</span><span class="nv"> </span><span class="s">es</span><span class="nv"> </span><span class="s">un</span><span class="nv"> </span><span class="s">pie</span><span class="nv"> </span><span class="s">de</span><span class="nv"> </span><span class="s">página</span><span class="nv"> </span><span class="s">personalizado&quot;</span>
<span class="nt">ROBOTSTXT_SITEMAP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/sitemap.xml&quot;</span>
</code></pre></div>
<hr />
<p>Para más información, consulte la <a href="https://www.robotstxt.org/robotstxt.html">documentación de robots.txt</a>.</p>
<h2 id="es-features-ssl">SSL</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento SSL proporciona capacidades robustas de cifrado SSL/TLS para sus sitios web protegidos por BunkerWeb. Este componente principal permite conexiones HTTPS seguras al configurar y optimizar protocolos criptográficos, cifrados y ajustes de seguridad relacionados para proteger los datos en tránsito entre los clientes y sus servicios web.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un cliente inicia una conexión HTTPS a su sitio web, BunkerWeb gestiona el handshake SSL/TLS utilizando su configuración.</li>
<li>El complemento impone protocolos de cifrado modernos y conjuntos de cifrado sólidos, al tiempo que deshabilita las opciones vulnerables conocidas.</li>
<li>Los parámetros de sesión SSL optimizados mejoran el rendimiento de la conexión sin sacrificar la seguridad.</li>
<li>La presentación de certificados se configura de acuerdo con las mejores prácticas para garantizar la compatibilidad y la seguridad.</li>
</ol>
<p>!!! success "Beneficios de Seguridad" - <strong>Protección de Datos:</strong> Cifra los datos en tránsito, previniendo la interceptación y los ataques de intermediario (man-in-the-middle). - <strong>Autenticación:</strong> Verifica la identidad de su servidor a los clientes. - <strong>Integridad:</strong> Asegura que los datos no han sido manipulados durante la transmisión. - <strong>Estándares Modernos:</strong> Configurado para cumplir con las mejores prácticas y los estándares de seguridad de la industria.</p>
<h3 id="es-features-como-usar_29">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función SSL:</p>
<ol>
<li><strong>Configure los protocolos:</strong> Elija qué versiones de protocolo SSL/TLS admitir utilizando el ajuste <code>SSL_PROTOCOLS</code>.</li>
<li><strong>Seleccione los conjuntos de cifrado:</strong> Especifique la fuerza del cifrado utilizando el ajuste <code>SSL_CIPHERS_LEVEL</code> o proporcione cifrados personalizados con <code>SSL_CIPHERS_CUSTOM</code>.</li>
<li><strong>Configure la redirección de HTTP a HTTPS:</strong> Configure la redirección automática utilizando los ajustes <code>AUTO_REDIRECT_HTTP_TO_HTTPS</code> o <code>REDIRECT_HTTP_TO_HTTPS</code>.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_29">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REDIRECT_HTTP_TO_HTTPS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Redirigir HTTP a HTTPS:</strong> Cuando se establece en <code>yes</code>, todas las solicitudes HTTP se redirigen a HTTPS.</td>
</tr>
<tr>
<td><code>AUTO_REDIRECT_HTTP_TO_HTTPS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Redirección Automática de HTTP a HTTPS:</strong> Cuando se establece en <code>yes</code>, redirige automáticamente de HTTP a HTTPS si se detecta HTTPS.</td>
</tr>
<tr>
<td><code>SSL_PROTOCOLS</code></td>
<td><code>TLSv1.2 TLSv1.3</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Protocolos SSL:</strong> Lista de protocolos SSL/TLS a admitir, separados por espacios.</td>
</tr>
<tr>
<td><code>SSL_CIPHERS_LEVEL</code></td>
<td><code>modern</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Nivel de Cifrados SSL:</strong> Nivel de seguridad preestablecido para los conjuntos de cifrado (<code>modern</code>, <code>intermediate</code> o <code>old</code>).</td>
</tr>
<tr>
<td><code>SSL_CIPHERS_CUSTOM</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cifrados SSL Personalizados:</strong> Lista de conjuntos de cifrado separados por dos puntos para usar en las conexiones SSL/TLS (sobrescribe el nivel).</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Pruebas de SSL Labs</p>
</div>
<p>Después de configurar sus ajustes de SSL, utilice la <a href="https://www.ssllabs.com/ssltest/">Prueba de Servidor de SSL Labs de Qualys</a> para verificar su configuración y buscar posibles problemas de seguridad. Una configuración de SSL adecuada de BunkerWeb debería obtener una calificación A+.</p>
<div class="admonition warning">
<p class="admonition-title">Selección de Protocolo</p>
</div>
<p>El soporte para protocolos más antiguos como SSLv3, TLSv1.0 y TLSv1.1 está deshabilitado intencionadamente por defecto debido a vulnerabilidades conocidas. Solo habilite estos protocolos si es absolutamente necesario para admitir clientes heredados y comprende las implicaciones de seguridad de hacerlo.</p>
<h3 id="es-features-configuraciones-de-ejemplo_31">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="73:4"><input checked="checked" id="es-features-__tabbed_73_1" name="es-features-__tabbed_73" type="radio" /><input id="es-features-__tabbed_73_2" name="es-features-__tabbed_73" type="radio" /><input id="es-features-__tabbed_73_3" name="es-features-__tabbed_73" type="radio" /><input id="es-features-__tabbed_73_4" name="es-features-__tabbed_73" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_73_1">Seguridad Moderna (Predeterminada)</label><label for="es-features-__tabbed_73_2">Máxima Seguridad</label><label for="es-features-__tabbed_73_3">Compatibilidad Heredada</label><label for="es-features-__tabbed_73_4">Cifrados Personalizados</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>La configuración predeterminada que proporciona una seguridad sólida mientras mantiene la compatibilidad con los navegadores modernos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.2</span><span class="nv"> </span><span class="s">TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;modern&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración enfocada en la máxima seguridad, potencialmente con compatibilidad reducida para clientes más antiguos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;modern&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con mayor compatibilidad para clientes más antiguos (úsela solo si es necesario):</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.2</span><span class="nv"> </span><span class="s">TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;old&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración que utiliza una especificación de cifrado personalizada:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.2</span><span class="nv"> </span><span class="s">TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_CUSTOM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-securitytxt">Security.txt</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento Security.txt implementa el estándar <a href="https://securitytxt.org/">Security.txt</a> (<a href="https://www.rfc-editor.org/rfc/rfc9116">RFC 9116</a>) para su sitio web. Esta función ayuda a los investigadores de seguridad a acceder a sus políticas de seguridad y proporciona una forma estandarizada para que informen sobre las vulnerabilidades de seguridad que descubran en sus sistemas.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando está habilitado, BunkerWeb crea un archivo <code>/.well-known/security.txt</code> en la raíz de su sitio web.</li>
<li>Este archivo contiene información sobre sus políticas de seguridad, contactos y otros detalles relevantes.</li>
<li>Los investigadores de seguridad y las herramientas automatizadas pueden encontrar fácilmente este archivo en la ubicación estándar.</li>
<li>El contenido se configura mediante ajustes simples que le permiten especificar información de contacto, claves de cifrado, políticas y agradecimientos.</li>
<li>BunkerWeb formatea automáticamente el archivo de acuerdo con la RFC 9116.</li>
</ol>
<h3 id="es-features-como-usar_30">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función Security.txt:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>USE_SECURITYTXT</code> en <code>yes</code> para habilitar el archivo security.txt.</li>
<li><strong>Configure la información de contacto:</strong> Especifique al menos un método de contacto utilizando el ajuste <code>SECURITYTXT_CONTACT</code>.</li>
<li><strong>Establezca información adicional:</strong> Configure campos opcionales como la fecha de vencimiento, el cifrado, los agradecimientos y las URL de las políticas.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, BunkerWeb creará y servirá automáticamente el archivo security.txt en la ubicación estándar.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_30">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_SECURITYTXT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Security.txt:</strong> Establezca en <code>yes</code> para habilitar el archivo security.txt.</td>
</tr>
<tr>
<td><code>SECURITYTXT_URI</code></td>
<td><code>/.well-known/security.txt</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI de Security.txt:</strong> Indica la URI donde estará accesible el archivo security.txt.</td>
</tr>
<tr>
<td><code>SECURITYTXT_CONTACT</code></td>
<td></td>
<td>multisite</td>
<td>sí</td>
<td><strong>Información de contacto:</strong> Cómo pueden contactarlo los investigadores de seguridad (p. ej., <code>mailto:security@example.com</code>).</td>
</tr>
<tr>
<td><code>SECURITYTXT_EXPIRES</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Fecha de vencimiento:</strong> Cuándo debe considerarse que este archivo security.txt ha expirado (formato ISO 8601).</td>
</tr>
<tr>
<td><code>SECURITYTXT_ENCRYPTION</code></td>
<td></td>
<td>multisite</td>
<td>sí</td>
<td><strong>Cifrado:</strong> URL que apunta a las claves de cifrado que se utilizarán para la comunicación segura.</td>
</tr>
<tr>
<td><code>SECURITYTXT_ACKNOWLEDGEMENTS</code></td>
<td></td>
<td>multisite</td>
<td>sí</td>
<td><strong>Agradecimientos:</strong> URL donde se reconoce a los investigadores de seguridad por sus informes.</td>
</tr>
<tr>
<td><code>SECURITYTXT_POLICY</code></td>
<td></td>
<td>multisite</td>
<td>sí</td>
<td><strong>Política de seguridad:</strong> URL que apunta a la política de seguridad que describe cómo informar vulnerabilidades.</td>
</tr>
<tr>
<td><code>SECURITYTXT_HIRING</code></td>
<td></td>
<td>multisite</td>
<td>sí</td>
<td><strong>Empleos de seguridad:</strong> URL que apunta a las ofertas de trabajo relacionadas con la seguridad.</td>
</tr>
<tr>
<td><code>SECURITYTXT_CANONICAL</code></td>
<td></td>
<td>multisite</td>
<td>sí</td>
<td><strong>URL canónica:</strong> La(s) URI(s) canónica(s) para este archivo security.txt.</td>
</tr>
<tr>
<td><code>SECURITYTXT_PREFERRED_LANG</code></td>
<td><code>en</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Idioma(s) preferido(s):</strong> El(los) idioma(s) utilizado(s) en las comunicaciones. Especificado como un código de idioma ISO 639-1.</td>
</tr>
<tr>
<td><code>SECURITYTXT_CSAF</code></td>
<td></td>
<td>multisite</td>
<td>sí</td>
<td><strong>CSAF:</strong> Enlace al <code>provider-metadata.json</code> de su proveedor de Common Security Advisory Framework.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Se requiere fecha de vencimiento</p>
</div>
<p>Según la RFC 9116, el campo <code>Expires</code> es obligatorio. Si no proporciona un valor para <code>SECURITYTXT_EXPIRES</code>, BunkerWeb establece automáticamente la fecha de vencimiento en un año a partir de la fecha actual.</p>
<div class="admonition info">
<p class="admonition-title">La información de contacto es esencial</p>
</div>
<p>El campo <code>Contact</code> es la parte más importante del archivo security.txt. Debe proporcionar al menos una forma para que los investigadores de seguridad se pongan en contacto con usted. Puede ser una dirección de correo electrónico, un formulario web, un número de teléfono o cualquier otro método que funcione para su organización.</p>
<div class="admonition warning">
<p class="admonition-title">Las URL deben usar HTTPS</p>
</div>
<p>Según la RFC 9116, todas las URL del archivo security.txt (excepto los enlaces <code>mailto:</code> y <code>tel:</code>) DEBEN usar HTTPS. BunkerWeb convertirá automáticamente las URL que no sean HTTPS a HTTPS para garantizar el cumplimiento de la norma.</p>
<h3 id="es-features-configuraciones-de-ejemplo_32">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="74:3"><input checked="checked" id="es-features-__tabbed_74_1" name="es-features-__tabbed_74" type="radio" /><input id="es-features-__tabbed_74_2" name="es-features-__tabbed_74" type="radio" /><input id="es-features-__tabbed_74_3" name="es-features-__tabbed_74" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_74_1">Configuración Básica</label><label for="es-features-__tabbed_74_2">Configuración Completa</label><label for="es-features-__tabbed_74_3">Configuración de Múltiples Contactos</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración mínima con solo información de contacto:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_SECURITYTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SECURITYTXT_CONTACT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mailto:security@example.com&quot;</span>
<span class="nt">SECURITYTXT_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-policy&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración más completa con todos los campos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_SECURITYTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SECURITYTXT_CONTACT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mailto:security@example.com&quot;</span>
<span class="nt">SECURITYTXT_CONTACT_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-contact-form&quot;</span>
<span class="nt">SECURITYTXT_EXPIRES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2023-12-31T23:59:59+00:00&quot;</span>
<span class="nt">SECURITYTXT_ENCRYPTION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/pgp-key.txt&quot;</span>
<span class="nt">SECURITYTXT_ACKNOWLEDGEMENTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/hall-of-fame&quot;</span>
<span class="nt">SECURITYTXT_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-policy&quot;</span>
<span class="nt">SECURITYTXT_HIRING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/jobs/security&quot;</span>
<span class="nt">SECURITYTXT_CANONICAL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/.well-known/security.txt&quot;</span>
<span class="nt">SECURITYTXT_PREFERRED_LANG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;en&quot;</span>
<span class="nt">SECURITYTXT_CSAF</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/provider-metadata.json&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con múltiples métodos de contacto:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_SECURITYTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SECURITYTXT_CONTACT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mailto:security@example.com&quot;</span>
<span class="nt">SECURITYTXT_CONTACT_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tel:+1-201-555-0123&quot;</span>
<span class="nt">SECURITYTXT_CONTACT_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-form&quot;</span>
<span class="nt">SECURITYTXT_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-policy&quot;</span>
<span class="nt">SECURITYTXT_EXPIRES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2024-06-30T23:59:59+00:00&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-self-signed-certificate">Self-signed certificate</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de Certificado Autofirmado genera y gestiona automáticamente certificados SSL/TLS directamente dentro de BunkerWeb, lo que permite conexiones HTTPS seguras sin necesidad de una autoridad de certificación externa. Esta función es particularmente útil en entornos de desarrollo, redes internas o siempre que necesite implementar HTTPS rápidamente sin configurar certificados externos.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando está habilitado, BunkerWeb genera automáticamente un certificado SSL/TLS autofirmado para sus dominios configurados.</li>
<li>El certificado incluye todos los nombres de servidor definidos en su configuración, lo que garantiza una validación SSL adecuada para cada dominio.</li>
<li>Los certificados se almacenan de forma segura y se utilizan para cifrar todo el tráfico HTTPS a sus sitios web.</li>
<li>El certificado se renueva automáticamente antes de su vencimiento, lo que garantiza la disponibilidad continua de HTTPS.</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Advertencias de Seguridad del Navegador</p>
</div>
<p>Los navegadores mostrarán advertencias de seguridad cuando los usuarios visiten sitios que utilizan certificados autofirmados, ya que estos certificados no están validados por una autoridad de certificación de confianza. Para entornos de producción, considere usar <a href="#es-features-lets-encrypt">Let's Encrypt</a> en su lugar.</p>
<h3 id="es-features-como-usar_31">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Certificado Autofirmado:</p>
<ol>
<li><strong>Habilite la función:</strong> Establezca el ajuste <code>GENERATE_SELF_SIGNED_SSL</code> en <code>yes</code> para habilitar la generación de certificados autofirmados.</li>
<li><strong>Elija el algoritmo criptográfico:</strong> Seleccione su algoritmo preferido utilizando el ajuste <code>SELF_SIGNED_SSL_ALGORITHM</code>.</li>
<li><strong>Configure el período de validez:</strong> Opcionalmente, establezca cuánto tiempo debe ser válido el certificado utilizando el ajuste <code>SELF_SIGNED_SSL_EXPIRY</code>.</li>
<li><strong>Establezca el sujeto del certificado:</strong> Configure el sujeto del certificado utilizando el ajuste <code>SELF_SIGNED_SSL_SUBJ</code>.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, los certificados se generan y aplican automáticamente a sus dominios.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Configuración en Modo Stream</p>
</div>
<p>Para el modo stream, configure el ajuste <code>LISTEN_STREAM_PORT_SSL</code> para especificar el puerto de escucha SSL/TLS. Este paso es esencial para el correcto funcionamiento en modo stream.</p>
<h3 id="es-features-ajustes-de-configuracion_31">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GENERATE_SELF_SIGNED_SSL</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar autofirmado:</strong> Establezca en <code>yes</code> para habilitar la generación automática de certificados autofirmados.</td>
</tr>
<tr>
<td><code>SELF_SIGNED_SSL_ALGORITHM</code></td>
<td><code>ec-prime256v1</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Algoritmo del certificado:</strong> Algoritmo utilizado para la generación de certificados: <code>ec-prime256v1</code>, <code>ec-secp384r1</code>, <code>rsa-2048</code> o <code>rsa-4096</code>.</td>
</tr>
<tr>
<td><code>SELF_SIGNED_SSL_EXPIRY</code></td>
<td><code>365</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Validez del certificado:</strong> Número de días que el certificado autofirmado debe ser válido (predeterminado: 1 año).</td>
</tr>
<tr>
<td><code>SELF_SIGNED_SSL_SUBJ</code></td>
<td><code>/CN=www.example.com/</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Sujeto del certificado:</strong> Campo de sujeto para el certificado que identifica el dominio.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Entornos de Desarrollo</p>
</div>
<p>Los certificados autofirmados son ideales para entornos de desarrollo y prueba donde se necesita HTTPS pero no se requieren certificados de confianza para los navegadores públicos.</p>
<div class="admonition info">
<p class="admonition-title">Información del Certificado</p>
</div>
<p>Los certificados autofirmados generados utilizan el algoritmo especificado (por defecto, criptografía de curva elíptica con la curva prime256v1) e incluyen el sujeto configurado, lo que garantiza la funcionalidad adecuada para sus dominios.</p>
<h3 id="es-features-configuraciones-de-ejemplo_33">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="75:3"><input checked="checked" id="es-features-__tabbed_75_1" name="es-features-__tabbed_75" type="radio" /><input id="es-features-__tabbed_75_2" name="es-features-__tabbed_75" type="radio" /><input id="es-features-__tabbed_75_3" name="es-features-__tabbed_75" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_75_1">Configuración Básica</label><label for="es-features-__tabbed_75_2">Certificados de Corta Duración</label><label for="es-features-__tabbed_75_3">Pruebas con Certificados RSA</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que utiliza certificados autofirmados con los ajustes predeterminados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">GENERATE_SELF_SIGNED_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SELF_SIGNED_SSL_ALGORITHM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ec-prime256v1&quot;</span>
<span class="nt">SELF_SIGNED_SSL_EXPIRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;365&quot;</span>
<span class="nt">SELF_SIGNED_SSL_SUBJ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/CN=mysite.local/&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con certificados que expiran con más frecuencia (útil para probar regularmente los procesos de renovación de certificados):</p>
<div class="highlight"><pre><span></span><code><span class="nt">GENERATE_SELF_SIGNED_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SELF_SIGNED_SSL_ALGORITHM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ec-prime256v1&quot;</span>
<span class="nt">SELF_SIGNED_SSL_EXPIRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;90&quot;</span>
<span class="nt">SELF_SIGNED_SSL_SUBJ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/CN=dev.example.com/&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para un entorno de prueba donde un dominio utiliza certificados RSA autofirmados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test.example.com&quot;</span>
<span class="nt">GENERATE_SELF_SIGNED_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SELF_SIGNED_SSL_ALGORITHM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rsa-4096&quot;</span>
<span class="nt">SELF_SIGNED_SSL_EXPIRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;365&quot;</span>
<span class="nt">SELF_SIGNED_SSL_SUBJ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/CN=test.example.com/&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-sessions">Sessions</h2>
<p>Compatibilidad con STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El complemento de Sesiones proporciona una gestión robusta de sesiones HTTP para BunkerWeb, lo que permite un seguimiento seguro y confiable de las sesiones de usuario entre solicitudes. Esta característica principal es esencial para mantener el estado del usuario, la persistencia de la autenticación y admitir otras funciones que requieren continuidad de la identidad, como la protección <a href="#es-features-antibot">anti-bot</a> y los sistemas de autenticación de usuarios.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Cuando un usuario interactúa por primera vez con su sitio web, BunkerWeb crea un identificador de sesión único.</li>
<li>Este identificador se almacena de forma segura en una cookie en el navegador del usuario.</li>
<li>En solicitudes posteriores, BunkerWeb recupera el identificador de sesión de la cookie y lo utiliza para acceder a los datos de la sesión del usuario.</li>
<li>Los datos de la sesión se pueden almacenar localmente o en <a href="#es-features-redis">Redis</a> para entornos distribuidos con múltiples instancias de BunkerWeb.</li>
<li>Las sesiones se gestionan automáticamente con tiempos de espera configurables, lo que garantiza la seguridad y la facilidad de uso.</li>
<li>La seguridad criptográfica de las sesiones se garantiza mediante una clave secreta que se utiliza para firmar las cookies de sesión.</li>
</ol>
<h3 id="es-features-como-usar_32">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Sesiones:</p>
<ol>
<li><strong>Configure la seguridad de la sesión:</strong> Establezca un <code>SESSIONS_SECRET</code> fuerte y único para garantizar que las cookies de sesión no puedan ser falsificadas. (El valor predeterminado es "random", lo que hace que BunkerWeb genere una clave secreta aleatoria).</li>
<li><strong>Elija un nombre de sesión:</strong> Opcionalmente, personalice el <code>SESSIONS_NAME</code> para definir cómo se llamará su cookie de sesión en el navegador. (El valor predeterminado es "random", lo que hace que BunkerWeb genere un nombre aleatorio).</li>
<li><strong>Establezca los tiempos de espera de la sesión:</strong> Configure cuánto tiempo permanecen válidas las sesiones con los ajustes de tiempo de espera (<code>SESSIONS_IDLING_TIMEOUT</code>, <code>SESSIONS_ROLLING_TIMEOUT</code>, <code>SESSIONS_ABSOLUTE_TIMEOUT</code>).</li>
<li><strong>Configure la integración con Redis:</strong> Para entornos distribuidos, establezca <code>USE_REDIS</code> en "yes" y configure su <a href="#es-features-redis">conexión Redis</a> para compartir los datos de la sesión entre múltiples nodos de BunkerWeb.</li>
<li><strong>Deje que BunkerWeb se encargue del resto:</strong> Una vez configurado, la gestión de sesiones se realiza automáticamente para su sitio web.</li>
</ol>
<h3 id="es-features-ajustes-de-configuracion_32">Ajustes de Configuración</h3>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SESSIONS_SECRET</code></td>
<td><code>random</code></td>
<td>global</td>
<td>no</td>
<td><strong>Secreto de sesión:</strong> Clave criptográfica utilizada para firmar las cookies de sesión. Debe ser una cadena fuerte y aleatoria única para su sitio.</td>
</tr>
<tr>
<td><code>SESSIONS_NAME</code></td>
<td><code>random</code></td>
<td>global</td>
<td>no</td>
<td><strong>Nombre de la cookie:</strong> El nombre de la cookie que almacenará el identificador de sesión.</td>
</tr>
<tr>
<td><code>SESSIONS_IDLING_TIMEOUT</code></td>
<td><code>1800</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de espera por inactividad:</strong> Tiempo máximo (en segundos) de inactividad antes de que la sesión se invalide.</td>
</tr>
<tr>
<td><code>SESSIONS_ROLLING_TIMEOUT</code></td>
<td><code>3600</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de espera renovable:</strong> Tiempo máximo (en segundos) antes de que una sesión deba renovarse.</td>
</tr>
<tr>
<td><code>SESSIONS_ABSOLUTE_TIMEOUT</code></td>
<td><code>86400</code></td>
<td>global</td>
<td>no</td>
<td><strong>Tiempo de espera absoluto:</strong> Tiempo máximo (en segundos) antes de que una sesión se destruya independientemente de la actividad.</td>
</tr>
<tr>
<td><code>SESSIONS_CHECK_IP</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Comprobar IP:</strong> Cuando se establece en <code>yes</code>, destruye la sesión si la dirección IP del cliente cambia.</td>
</tr>
<tr>
<td><code>SESSIONS_CHECK_USER_AGENT</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Comprobar User-Agent:</strong> Cuando se establece en <code>yes</code>, destruye la sesión si el User-Agent del cliente cambia.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de Seguridad</p>
</div>
<p>El ajuste <code>SESSIONS_SECRET</code> es fundamental para la seguridad. En entornos de producción:</p>
<pre><code>1. Use un valor fuerte y aleatorio (al menos 32 caracteres)
2. Mantenga este valor confidencial
3. Use el mismo valor en todas las instancias de BunkerWeb en un clúster
4. Considere usar variables de entorno o gestión de secretos para evitar almacenar esto en texto plano
</code></pre>
<div class="admonition tip">
<p class="admonition-title">Entornos en Clúster</p>
</div>
<p>Si está ejecutando múltiples instancias de BunkerWeb detrás de un balanceador de carga:</p>
<pre><code>1. Establezca `USE_REDIS` en `yes` y configure su conexión Redis
2. Asegúrese de que todas las instancias usen exactamente el mismo `SESSIONS_SECRET` y `SESSIONS_NAME`
3. Esto garantiza que los usuarios mantengan su sesión independientemente de qué instancia de BunkerWeb maneje sus solicitudes
</code></pre>
<h3 id="es-features-configuraciones-de-ejemplo_34">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="76:4"><input checked="checked" id="es-features-__tabbed_76_1" name="es-features-__tabbed_76" type="radio" /><input id="es-features-__tabbed_76_2" name="es-features-__tabbed_76" type="radio" /><input id="es-features-__tabbed_76_3" name="es-features-__tabbed_76" type="radio" /><input id="es-features-__tabbed_76_4" name="es-features-__tabbed_76" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_76_1">Configuración Básica</label><label for="es-features-__tabbed_76_2">Seguridad Mejorada</label><label for="es-features-__tabbed_76_3">Entorno en Clúster con Redis</label><label for="es-features-__tabbed_76_4">Sesiones de Larga Duración</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple para una única instancia de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;su-clave-secreta-fuerte-y-aleatoria-aqui&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sesiondemicliente&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1800&quot;</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración con ajustes de seguridad aumentados:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;su-clave-secreta-muy-fuerte-y-aleatoria-aqui&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sesionsegura&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;900&quot;</span><span class="w">  </span><span class="c1"># 15 minutos</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1800&quot;</span><span class="w">  </span><span class="c1"># 30 minutos</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;43200&quot;</span><span class="w">  </span><span class="c1"># 12 horas</span>
<span class="nt">SESSIONS_CHECK_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SESSIONS_CHECK_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para múltiples instancias de BunkerWeb que comparten datos de sesión:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;su-clave-secreta-fuerte-y-aleatoria-aqui&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sesiondelcluster&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1800&quot;</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="c1"># Asegúrese de que la conexión a Redis esté configurada correctamente</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración para aplicaciones que requieren persistencia de sesión extendida:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;su-clave-secreta-fuerte-y-aleatoria-aqui&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sesionpersistente&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span><span class="w">  </span><span class="c1"># 1 día</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;172800&quot;</span><span class="w">  </span><span class="c1"># 2 días</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;604800&quot;</span><span class="w">  </span><span class="c1"># 7 días</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-features-ui">UI</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Integrate easily the BunkerWeb UI.</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_UI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td>Use UI</td>
</tr>
<tr>
<td><code>UI_HOST</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>Address of the web UI used for initial setup</td>
</tr>
</tbody>
</table>
<h2 id="es-features-user-manager-pro">User Manager <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>Compatibilidad con STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Add the possibility to manage users on the web interface</p>
<table>
<thead>
<tr>
<th>Parámetro</th>
<th>Valor predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USERS_REQUIRE_2FA</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Require two-factor authentication for all users</td>
</tr>
</tbody>
</table>
<h2 id="es-features-whitelist">Whitelist</h2>
<p>Compatibilidad con STREAM <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>El complemento de Lista Blanca le permite definir una lista de direcciones IP de confianza que omiten otros filtros de seguridad.
Para bloquear clientes no deseados, consulte el <a href="#es-features-blacklist">complemento de Lista Negra</a>.</p>
<p>El complemento de Lista Blanca proporciona un enfoque integral para permitir explícitamente el acceso a su sitio web basándose en diversos atributos del cliente. Esta característica proporciona un mecanismo de seguridad: a los visitantes que coinciden con criterios específicos se les concede acceso inmediato, mientras que todos los demás deben pasar por los controles de seguridad habituales.</p>
<p><strong>Cómo funciona:</strong></p>
<ol>
<li>Usted define los criterios para los visitantes que deben estar en la "lista blanca" (<em>direcciones IP, redes, DNS inverso, ASN, User-Agent o patrones de URI</em>).</li>
<li>Cuando un visitante intenta acceder a su sitio, BunkerWeb comprueba si coincide con alguno de estos criterios de la lista blanca.</li>
<li>Si un visitante coincide con alguna regla de la lista blanca (y no coincide con ninguna regla de omisión), se le concede acceso a su sitio y <strong>omite todos los demás controles de seguridad</strong>.</li>
<li>Si un visitante no coincide con ningún criterio de la lista blanca, procede a través de todos los controles de seguridad normales como de costumbre.</li>
<li>Las listas blancas se pueden actualizar automáticamente desde fuentes externas de forma programada.</li>
</ol>
<h3 id="es-features-como-usar_33">Cómo usar</h3>
<p>Siga estos pasos para configurar y usar la función de Lista Blanca:</p>
<ol>
<li><strong>Habilite la función:</strong> La función de Lista Blanca está deshabilitada por defecto. Establezca el ajuste <code>USE_WHITELIST</code> en <code>yes</code> para habilitarla.</li>
<li><strong>Configure las reglas de permiso:</strong> Defina qué IP, redes, patrones de DNS inverso, ASN, User-Agents o URI deben estar en la lista blanca.</li>
<li><strong>Configure las reglas de omisión:</strong> Especifique cualquier excepción que deba omitir las comprobaciones de la lista blanca.</li>
<li><strong>Añada fuentes externas:</strong> Configure URL para descargar y actualizar automáticamente los datos de la lista blanca.</li>
<li><strong>Supervise el acceso:</strong> Consulte la <a href="#es-web-ui">interfaz de usuario web</a> para ver qué visitantes están siendo permitidos o denegados.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">modo stream</p>
</div>
<p>Cuando se utiliza el modo stream, solo se realizan las comprobaciones de IP, DNS inverso y ASN.</p>
<h3 id="es-features-ajustes-de-configuracion_33">Ajustes de Configuración</h3>
<p><strong>General</strong></p>
<table>
<thead>
<tr>
<th>Ajuste</th>
<th>Valor por defecto</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_WHITELIST</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Habilitar Lista Blanca:</strong> Establezca en <code>yes</code> para habilitar la función de lista blanca.</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="77:1"><input checked="checked" id="es-features-__tabbed_77_1" name="es-features-__tabbed_77" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_77_1">Dirección IP</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Pone en la lista blanca a los visitantes según su dirección IP o red. Estos visitantes omitirán todos los controles de seguridad.</p>
<pre><code>| Ajuste                     | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                               |
| -------------------------- | ----------------- | --------- | -------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| `WHITELIST_IP`             |                   | multisite | no       | **Lista Blanca de IP:** Lista de direcciones IP o redes (notación CIDR) para permitir, separadas por espacios.                            |
| `WHITELIST_IGNORE_IP`      |                   | multisite | no       | **Lista de Omisión de IP:** Lista de direcciones IP o redes que deben omitir las comprobaciones de la lista blanca de IP.                 |
| `WHITELIST_IP_URLS`        |                   | multisite | no       | **URL de Lista Blanca de IP:** Lista de URL que contienen direcciones IP o redes para incluir en la lista blanca, separadas por espacios. |
| `WHITELIST_IGNORE_IP_URLS` |                   | multisite | no       | **URL de Lista de Omisión de IP:** Lista de URL que contienen direcciones IP o redes para ignorar.                                        |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="78:1"><input checked="checked" id="es-features-__tabbed_78_1" name="es-features-__tabbed_78" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_78_1">DNS Inverso</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Pone en la lista blanca a los visitantes según su nombre de dominio (en inverso). Esto es útil para permitir el acceso a visitantes de organizaciones o redes específicas por su dominio.</p>
<pre><code>| Ajuste                       | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                                 |
| ---------------------------- | ----------------- | --------- | -------- | ------------------------------------------------------------------------------------------------------------------------------------------- |
| `WHITELIST_RDNS`             |                   | multisite | no       | **Lista Blanca de rDNS:** Lista de sufijos de DNS inverso para permitir, separados por espacios.                                            |
| `WHITELIST_RDNS_GLOBAL`      | `yes`             | multisite | no       | **Solo rDNS Global:** Realiza comprobaciones de la lista blanca de rDNS solo en direcciones IP globales cuando se establece en `yes`.       |
| `WHITELIST_IGNORE_RDNS`      |                   | multisite | no       | **Lista de Omisión de rDNS:** Lista de sufijos de DNS inverso que deben omitir las comprobaciones de la lista blanca de rDNS.               |
| `WHITELIST_RDNS_URLS`        |                   | multisite | no       | **URL de Lista Blanca de rDNS:** Lista de URL que contienen sufijos de DNS inverso para incluir en la lista blanca, separadas por espacios. |
| `WHITELIST_IGNORE_RDNS_URLS` |                   | multisite | no       | **URL de Lista de Omisión de rDNS:** Lista de URL que contienen sufijos de DNS inverso para ignorar.                                        |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="79:1"><input checked="checked" id="es-features-__tabbed_79_1" name="es-features-__tabbed_79" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_79_1">ASN</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Pone en la lista blanca a los visitantes de proveedores de red específicos utilizando Números de Sistema Autónomo. Los ASN identifican a qué proveedor u organización pertenece una IP.</p>
<pre><code>| Ajuste                      | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                             |
| --------------------------- | ----------------- | --------- | -------- | ----------------------------------------------------------------------------------------------------------------------- |
| `WHITELIST_ASN`             |                   | multisite | no       | **Lista Blanca de ASN:** Lista de Números de Sistema Autónomo para permitir, separados por espacios.                    |
| `WHITELIST_IGNORE_ASN`      |                   | multisite | no       | **Lista de Omisión de ASN:** Lista de ASN que deben omitir las comprobaciones de la lista blanca de ASN.                |
| `WHITELIST_ASN_URLS`        |                   | multisite | no       | **URL de Lista Blanca de ASN:** Lista de URL que contienen ASN para incluir en la lista blanca, separados por espacios. |
| `WHITELIST_IGNORE_ASN_URLS` |                   | multisite | no       | **URL de Lista de Omisión de ASN:** Lista de URL que contienen ASN para ignorar.                                        |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="80:1"><input checked="checked" id="es-features-__tabbed_80_1" name="es-features-__tabbed_80" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_80_1">User Agent</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Pone en la lista blanca a los visitantes según el navegador o la herramienta que dicen estar usando. Esto es efectivo para permitir el acceso a herramientas o servicios conocidos específicos.</p>
<pre><code>| Ajuste                             | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                               |
| ---------------------------------- | ----------------- | --------- | -------- | ----------------------------------------------------------------------------------------------------------------------------------------- |
| `WHITELIST_USER_AGENT`             |                   | multisite | no       | **Lista Blanca de User-Agent:** Lista de patrones de User-Agent (expresión regular PCRE) para permitir, separados por espacios.           |
| `WHITELIST_IGNORE_USER_AGENT`      |                   | multisite | no       | **Lista de Omisión de User-Agent:** Lista de patrones de User-Agent que deben omitir las comprobaciones de la lista blanca de User-Agent. |
| `WHITELIST_USER_AGENT_URLS`        |                   | multisite | no       | **URL de Lista Blanca de User-Agent:** Lista de URL que contienen patrones de User-Agent para incluir en la lista blanca.                 |
| `WHITELIST_IGNORE_USER_AGENT_URLS` |                   | multisite | no       | **URL de Lista de Omisión de User-Agent:** Lista de URL que contienen patrones de User-Agent para ignorar.                                |
</code></pre>
<div class="tabbed-set tabbed-alternate" data-tabs="81:1"><input checked="checked" id="es-features-__tabbed_81_1" name="es-features-__tabbed_81" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_81_1">URI</label></div>
<div class="tabbed-content">
<div class="tabbed-block"></div>
</div>
</div>
<p><strong>Qué hace esto:</strong> Pone en la lista blanca las solicitudes a URL específicas de su sitio. Esto es útil para permitir el acceso a puntos finales específicos independientemente de otros factores.</p>
<pre><code>| Ajuste                      | Valor por defecto | Contexto  | Múltiple | Descripción                                                                                                                         |
| --------------------------- | ----------------- | --------- | -------- | ----------------------------------------------------------------------------------------------------------------------------------- |
| `WHITELIST_URI`             |                   | multisite | no       | **Lista Blanca de URI:** Lista de patrones de URI (expresión regular PCRE) para permitir, separados por espacios.                   |
| `WHITELIST_IGNORE_URI`      |                   | multisite | no       | **Lista de Omisión de URI:** Lista de patrones de URI que deben omitir las comprobaciones de la lista blanca de URI.                |
| `WHITELIST_URI_URLS`        |                   | multisite | no       | **URL de Lista Blanca de URI:** Lista de URL que contienen patrones de URI para incluir en la lista blanca, separados por espacios. |
| `WHITELIST_IGNORE_URI_URLS` |                   | multisite | no       | **URL de Lista de Omisión de URI:** Lista de URL que contienen patrones de URI para ignorar.                                        |
</code></pre>
<div class="admonition info">
<p class="admonition-title">Soporte de Formato de URL</p>
</div>
<p>Todos los ajustes <code>*_URLS</code> admiten URL HTTP/HTTPS así como rutas de archivos locales usando el prefijo <code>file:///</code>. Se admite la autenticación básica usando el formato <code>http://usuario:contraseña@url</code>.</p>
<div class="admonition tip">
<p class="admonition-title">Actualizaciones Regulares</p>
</div>
<p>Las listas blancas de las URL se descargan y actualizan automáticamente cada hora para asegurar que su protección se mantenga actualizada con las últimas fuentes de confianza.</p>
<div class="admonition warning">
<p class="admonition-title">Omisión de Seguridad</p>
</div>
<p>Los visitantes en la lista blanca <strong>omitirán por completo todos los demás controles de seguridad</strong> en BunkerWeb, incluidas las reglas del WAF, la limitación de velocidad, la detección de bots maliciosos y cualquier otro mecanismo de seguridad. Use la lista blanca solo para fuentes de confianza en las que esté absolutamente seguro.</p>
<h3 id="es-features-configuraciones-de-ejemplo_35">Configuraciones de Ejemplo</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="82:5"><input checked="checked" id="es-features-__tabbed_82_1" name="es-features-__tabbed_82" type="radio" /><input id="es-features-__tabbed_82_2" name="es-features-__tabbed_82" type="radio" /><input id="es-features-__tabbed_82_3" name="es-features-__tabbed_82" type="radio" /><input id="es-features-__tabbed_82_4" name="es-features-__tabbed_82" type="radio" /><input id="es-features-__tabbed_82_5" name="es-features-__tabbed_82" type="radio" /><div class="tabbed-labels"><label for="es-features-__tabbed_82_1">Acceso Básico de la Organización</label><label for="es-features-__tabbed_82_2">Configuración Avanzada</label><label for="es-features-__tabbed_82_3">Usando Archivos Locales</label><label for="es-features-__tabbed_82_4">Patrón de Acceso a la API</label><label for="es-features-__tabbed_82_5">Rastreadores Conocidos</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Una configuración simple que pone en la lista blanca las IP de la oficina de la empresa:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">10.0.0.0/8</span><span class="nv"> </span><span class="s">203.0.113.42&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración más completa con múltiples criterios de lista blanca:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Activos de la empresa y de socios de confianza</span>
<span class="nt">WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">203.0.113.0/24&quot;</span>
<span class="nt">WHITELIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.company.com</span><span class="nv"> </span><span class="s">.partner-company.org&quot;</span>
<span class="nt">WHITELIST_ASN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;12345</span><span class="nv"> </span><span class="s">67890&quot;</span><span class="w">  </span><span class="c1"># ASN de la empresa y del socio</span>
<span class="nt">WHITELIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)CompanyBot(?:\b)</span><span class="nv"> </span><span class="s">(?:\b)PartnerCrawler(?:\b)&quot;</span>

<span class="c1"># Fuentes externas de confianza</span>
<span class="nt">WHITELIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-networks.txt&quot;</span>
<span class="nt">WHITELIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-crawlers.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuración usando archivos locales para las listas blancas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">WHITELIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/ip-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_RDNS_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/rdns-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_ASN_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/asn-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/user-agent-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_URI_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///ruta/a/uri-whitelist.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración enfocada en permitir el acceso solo a puntos finales específicos de la API:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">WHITELIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/v1/public/</span><span class="nv"> </span><span class="s">^/api/v1/status&quot;</span>
<span class="nt">WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24&quot;</span><span class="w">  </span><span class="c1"># Red interna para todos los puntos finales</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Una configuración que pone en la lista blanca a los rastreadores comunes de motores de búsqueda y redes sociales:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Verificación con DNS inverso para mayor seguridad</span>
<span class="nt">WHITELIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.googlebot.com</span><span class="nv"> </span><span class="s">.search.msn.com</span><span class="nv"> </span><span class="s">.crawl.yahoo.net</span><span class="nv"> </span><span class="s">.yandex.com</span><span class="nv"> </span><span class="s">.baidu.com</span><span class="nv"> </span><span class="s">.facebook.com&quot;</span>
<span class="nt">WHITELIST_RDNS_GLOBAL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w">  </span><span class="c1"># Solo verificar IP globales</span>
</code></pre></div>
<p>Esta configuración permite que los rastreadores legítimos indexen su sitio sin estar sujetos a la limitación de velocidad u otras medidas de seguridad que podrían bloquearlos. Las comprobaciones de DNS inverso ayudan a verificar que los rastreadores provienen realmente de las empresas que dicen ser.</p>
</div>
</div>
</div></section><section class="print-page" id="es-advanced" heading-number="6"><h1 id="es-advanced-usos-avanzados">Usos avanzados</h1>
<p>Muchos ejemplos de casos de uso del mundo real están disponibles en la carpeta <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/examples">examples</a> del repositorio de GitHub.</p>
<p>También proporcionamos numerosos boilerplates, como archivos YAML para diversas integraciones y tipos de bases de datos. Estos están disponibles en la carpeta <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">misc/integrations</a>.</p>
<p>Esta sección solo se enfoca en usos avanzados y ajustes de seguridad, consulta la <a href="#es-features">sección de características</a> de la documentación para ver todas las configuraciones disponibles.</p>
<h2 id="es-advanced-casos-de-uso">Casos de uso</h2>
<div class="admonition tip">
<p class="admonition-title">Pruebas</p>
<p>Para realizar pruebas rápidas cuando el modo multisitio está habilitado (y si no tienes las entradas DNS adecuadas configuradas para los dominios) puedes usar curl con la cabecera HTTP Host de tu elección:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: app1.example.com&quot;</span><span class="w"> </span>http://ip-o-fqdn-del-servidor
</code></pre></div></p>
<p>Si estás usando HTTPS, necesitarás jugar con SNI:
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: app1.example.com&quot;</span><span class="w"> </span>--resolve<span class="w"> </span>example.com:443:ip-del-servidor<span class="w"> </span>https://example.com
</code></pre></div></p>
</div>
<h3 id="es-advanced-detras-de-un-balanceador-de-carga-o-proxy-inverso">Detrás de un balanceador de carga o proxy inverso</h3>
<div class="admonition info">
<p class="admonition-title">IP real</p>
<p>Cuando BunkerWeb está a su vez detrás de un balanceador de carga o un proxy inverso, necesitas configurarlo para que pueda obtener la dirección IP real de los clientes. <strong>Si no lo haces, las características de seguridad bloquearán la dirección IP del balanceador de carga o del proxy inverso en lugar de la del cliente</strong>.</p>
</div>
<p>BunkerWeb admite dos métodos para recuperar la dirección IP real del cliente:</p>
<ul>
<li>Usando el <code>protocolo PROXY</code></li>
<li>Usando una cabecera HTTP como <code>X-Forwarded-For</code></li>
</ul>
<p>Se pueden usar las siguientes configuraciones:</p>
<ul>
<li><code>USE_REAL_IP</code>: habilitar/deshabilitar la recuperación de la IP real</li>
<li><code>USE_PROXY_PROTOCOL</code>: habilitar/deshabilitar el soporte del protocolo PROXY.</li>
<li><code>REAL_IP_FROM</code>: lista de direcciones IP/red de confianza permitidas para enviarnos la "IP real"</li>
<li><code>REAL_IP_HEADER</code>: la cabecera HTTP que contiene la IP real o el valor especial <code>proxy_protocol</code> cuando se usa el protocolo PROXY</li>
</ul>
<p>Encontrarás más configuraciones sobre la IP real en la <a href="#es-features-real-ip">sección de características</a> de la documentación.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="es-advanced-__tabbed_1_1" name="es-advanced-__tabbed_1" type="radio" /><input id="es-advanced-__tabbed_1_2" name="es-advanced-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_1_1">Cabecera HTTP</label><label for="es-advanced-__tabbed_1_2">Protocolo Proxy</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Asumiremos lo siguiente con respecto a los balanceadores de carga o proxies inversos (necesitarás actualizar la configuración dependiendo de tu configuración):</p>
<ul>
<li>Usan la cabecera <code>X-Forwarded-For</code> para establecer la IP real</li>
<li>Tienen IPs en las redes <code>1.2.3.0/24</code> y <code>100.64.0.0/10</code></li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:7"><input checked="checked" id="es-advanced-__tabbed_2_1" name="es-advanced-__tabbed_2" type="radio" /><input id="es-advanced-__tabbed_2_2" name="es-advanced-__tabbed_2" type="radio" /><input id="es-advanced-__tabbed_2_3" name="es-advanced-__tabbed_2" type="radio" /><input id="es-advanced-__tabbed_2_4" name="es-advanced-__tabbed_2" type="radio" /><input id="es-advanced-__tabbed_2_5" name="es-advanced-__tabbed_2" type="radio" /><input id="es-advanced-__tabbed_2_6" name="es-advanced-__tabbed_2" type="radio" /><input id="es-advanced-__tabbed_2_7" name="es-advanced-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_2_1">Interfaz de usuario web</label><label for="es-advanced-__tabbed_2_2">Linux</label><label for="es-advanced-__tabbed_2_3">Todo en uno</label><label for="es-advanced-__tabbed_2_4">Docker</label><label for="es-advanced-__tabbed_2_5">Docker autoconf</label><label for="es-advanced-__tabbed_2_6">Kubernetes</label><label for="es-advanced-__tabbed_2_7">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navega a la página de <strong>Configuración Global</strong>, selecciona el plugin <strong>Real IP</strong> y completa las siguientes configuraciones:</p>
<p><figure markdown><img align="center" alt="Configuración de IP real (cabecera) usando la interfaz de usuario web" src="../assets/img/advanced-proxy1.png" /><figcaption>Configuración de IP real (cabecera) usando la interfaz de usuario web</figcaption></figure></p>
<p>Ten en cuenta que se recomienda reiniciar BunkerWeb cuando cambies la configuración relacionada con la IP real.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración al archivo <code>/etc/bunkerweb/variables.env</code>:</p>
<div class="highlight"><pre><span></span><code>...
USE_REAL_IP=yes
REAL_IP_FROM=1.2.3.0/24 100.64.0.0/16
REAL_IP_HEADER=X-Forwarded-For
...
</code></pre></div>
<p>Ten en cuenta que se recomienda emitir un reinicio en lugar de una recarga al configurar ajustes relacionados con la IP real:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno al ejecutar el contenedor Todo en uno:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_REAL_IP</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_FROM</span><span class="o">=</span><span class="s2">&quot;1.2.3.0/24 100.64.0.0/10&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_HEADER</span><span class="o">=</span><span class="s2">&quot;X-Forwarded-For&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno de los contenedores de BunkerWeb y del programador:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno de los contenedores de BunkerWeb y del programador:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno de los pods de BunkerWeb y del programador.</p>
<p>Aquí está la parte correspondiente de tu archivo <code>values.yaml</code> que puedes usar:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Puedes encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Necesitarás agregar la configuración a las variables de entorno de los servicios de BunkerWeb y del programador:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Ten en cuenta que si tu servicio ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Lee con atención</p>
<p>Solo usa el protocolo PROXY si estás seguro de que tu balanceador de carga o proxy inverso lo está enviando. <strong>Si lo habilitas y no se está usando, obtendrás errores</strong>.</p>
</div>
<p>Asumiremos lo siguiente con respecto a los balanceadores de carga o proxies inversos (necesitarás actualizar la configuración dependiendo de tu configuración):</p>
<ul>
<li>Usan el <code>protocolo PROXY</code> v1 o v2 para establecer la IP real</li>
<li>Tienen IPs en las redes <code>1.2.3.0/24</code> y <code>100.64.0.0/10</code></li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="3:7"><input checked="checked" id="es-advanced-__tabbed_3_1" name="es-advanced-__tabbed_3" type="radio" /><input id="es-advanced-__tabbed_3_2" name="es-advanced-__tabbed_3" type="radio" /><input id="es-advanced-__tabbed_3_3" name="es-advanced-__tabbed_3" type="radio" /><input id="es-advanced-__tabbed_3_4" name="es-advanced-__tabbed_3" type="radio" /><input id="es-advanced-__tabbed_3_5" name="es-advanced-__tabbed_3" type="radio" /><input id="es-advanced-__tabbed_3_6" name="es-advanced-__tabbed_3" type="radio" /><input id="es-advanced-__tabbed_3_7" name="es-advanced-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_3_1">Interfaz de usuario web</label><label for="es-advanced-__tabbed_3_2">Linux</label><label for="es-advanced-__tabbed_3_3">Todo en uno</label><label for="es-advanced-__tabbed_3_4">Docker</label><label for="es-advanced-__tabbed_3_5">Docker autoconf</label><label for="es-advanced-__tabbed_3_6">Kubernetes</label><label for="es-advanced-__tabbed_3_7">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navega a la página de <strong>Configuración Global</strong>, selecciona el plugin <strong>Real IP</strong> y completa las siguientes configuraciones:</p>
<p><figure markdown><img align="center" alt="Configuración de IP real (protocolo PROXY) usando la interfaz de usuario web" src="../assets/img/advanced-proxy2.png" /><figcaption>Configuración de IP real (protocolo PROXY) usando la interfaz de usuario web</figcaption></figure></p>
<p>Ten en cuenta que se recomienda reiniciar BunkerWeb cuando cambies la configuración relacionada con la IP real.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración al archivo <code>/etc/bunkerweb/variables.env</code>:</p>
<div class="highlight"><pre><span></span><code>...
USE_REAL_IP=yes
USE_PROXY_PROTOCOL=yes
REAL_IP_FROM=1.2.3.0/24 100.64.0.0/16
REAL_IP_HEADER=proxy_protocol
...
</code></pre></div>
<p>Ten en cuenta que se recomienda emitir un reinicio en lugar de una recarga al configurar ajustes relacionados con los protocolos proxy:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno al ejecutar el contenedor Todo en uno:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_REAL_IP</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_PROXY_PROTOCOL</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_FROM</span><span class="o">=</span><span class="s2">&quot;1.2.3.0/24 100.64.0.0/10&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_HEADER</span><span class="o">=</span><span class="s2">&quot;X-Forwarded-For&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno de los contenedores de BunkerWeb y del programador:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno de los contenedores de BunkerWeb y del programador:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno de los pods de BunkerWeb y del programador.</p>
<p>Aquí está la parte correspondiente de tu archivo <code>values.yaml</code> que puedes usar:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_PROXY_PROTOCOL</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_PROXY_PROTOCOL</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Puedes encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Necesitarás agregar la configuración a las variables de entorno de los servicios de BunkerWeb y del programador.</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Ten en cuenta que si tu servicio ya está creado, necesitarás eliminarlo y recrearlo para que se actualicen las nuevas variables de entorno.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<h3 id="es-advanced-usando-mecanismos-de-resolucion-dns-personalizados">Usando mecanismos de resolución DNS personalizados</h3>
<p>La configuración de NGINX de BunkerWeb se puede personalizar para usar diferentes resolutores de DNS según tus necesidades. Esto puede ser particularmente útil en varios escenarios:</p>
<ol>
<li>Para respetar las entradas en tu archivo local <code>/etc/hosts</code></li>
<li>Cuando necesitas usar servidores DNS personalizados para ciertos dominios</li>
<li>Para integrarse con soluciones locales de caché de DNS</li>
</ol>
<h4 id="es-advanced-usando-systemd-resolved">Usando systemd-resolved</h4>
<p>Muchos sistemas Linux modernos usan <code>systemd-resolved</code> para la resolución de DNS. Si quieres que BunkerWeb respete el contenido de tu archivo <code>/etc/hosts</code> y use el mecanismo de resolución de DNS del sistema, puedes configurarlo para que use el servicio DNS local de systemd-resolved.</p>
<p>Para verificar que systemd-resolved se está ejecutando en tu sistema, puedes usar:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>systemd-resolved
</code></pre></div>
<p>Para habilitar systemd-resolved como tu resolutor de DNS en BunkerWeb, establece la configuración <code>DNS_RESOLVERS</code> a <code>127.0.0.53</code>, que es la dirección de escucha predeterminada para systemd-resolved:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="es-advanced-__tabbed_4_1" name="es-advanced-__tabbed_4" type="radio" /><input id="es-advanced-__tabbed_4_2" name="es-advanced-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_4_1">Interfaz de usuario web</label><label for="es-advanced-__tabbed_4_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navega a la página de <strong>Configuración Global</strong> y establece los resolutores de DNS en <code>127.0.0.53</code></p>
<p><figure markdown><img align="center" alt="Configuración de resolutores de DNS usando la interfaz de usuario web" src="../assets/img/advanced-dns-resolvers.png" /><figcaption>Configuración de resolutores de DNS usando la interfaz de usuario web</figcaption></figure></p>
</div>
<div class="tabbed-block">
<p>Necesitarás modificar el archivo <code>/etc/bunkerweb/variables.env</code>:</p>
<div class="highlight"><pre><span></span><code>...
DNS_RESOLVERS=127.0.0.53
...
</code></pre></div>
<p>Después de hacer este cambio, recarga el Programador para aplicar la configuración:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
</div>
</div>
<h4 id="es-advanced-usando-dnsmasq">Usando dnsmasq</h4>
<p><a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">dnsmasq</a> es un servidor ligero de DNS, DHCP y TFTP que se usa comúnmente para el almacenamiento en caché y la personalización de DNS local. Es particularmente útil cuando necesitas más control sobre tu resolución de DNS del que proporciona systemd-resolved.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="es-advanced-__tabbed_5_1" name="es-advanced-__tabbed_5" type="radio" /><input id="es-advanced-__tabbed_5_2" name="es-advanced-__tabbed_5" type="radio" /><input id="es-advanced-__tabbed_5_3" name="es-advanced-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_5_1">Linux</label><label for="es-advanced-__tabbed_5_2">Todo en uno</label><label for="es-advanced-__tabbed_5_3">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Primero, instala y configura dnsmasq en tu sistema Linux:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="es-advanced-__tabbed_6_1" name="es-advanced-__tabbed_6" type="radio" /><input id="es-advanced-__tabbed_6_2" name="es-advanced-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_6_1">Debian/Ubuntu</label><label for="es-advanced-__tabbed_6_2">RHEL/Fedora</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Instalar dnsmasq</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>dnsmasq

<span class="c1"># Configurar dnsmasq para escuchar solo en localhost</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;listen-address=127.0.0.1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;bind-interfaces&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Agregar entradas DNS personalizadas si es necesario</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;address=/custom.example.com/192.168.1.10&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Reiniciar dnsmasq</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>dnsmasq
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>dnsmasq
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Instalar dnsmasq</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>dnsmasq

<span class="c1"># Configurar dnsmasq para escuchar solo en localhost</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;listen-address=127.0.0.1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;bind-interfaces&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Agregar entradas DNS personalizadas si es necesario</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;address=/custom.example.com/192.168.1.10&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Reiniciar dnsmasq</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>dnsmasq
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>dnsmasq
</code></pre></div>
</div>
</div>
</div>
<p>Luego configura BunkerWeb para que use dnsmasq estableciendo <code>DNS_RESOLVERS</code> en <code>127.0.0.1</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="es-advanced-__tabbed_7_1" name="es-advanced-__tabbed_7" type="radio" /><input id="es-advanced-__tabbed_7_2" name="es-advanced-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_7_1">Interfaz de usuario web</label><label for="es-advanced-__tabbed_7_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navega a la página de <strong>Configuración Global</strong>, selecciona el plugin <strong>NGINX</strong> y establece los resolutores de DNS en <code>127.0.0.1</code>.</p>
<p><figure markdown><img align="center" alt="Configuración de resolutores de DNS usando la interfaz de usuario web" src="../assets/img/advanced-dns-resolvers2.png" /><figcaption>Configuración de resolutores de DNS usando la interfaz de usuario web</figcaption></figure></p>
</div>
<div class="tabbed-block">
<p>Necesitarás modificar el archivo <code>/etc/bunkerweb/variables.env</code>:</p>
<div class="highlight"><pre><span></span><code>...
DNS_RESOLVERS=127.0.0.1
...
</code></pre></div>
<p>Después de hacer este cambio, recarga el Programador:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<p>Cuando uses el contenedor Todo en uno, ejecuta dnsmasq en un contenedor separado y configura BunkerWeb para usarlo:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Crear una red personalizada para la comunicación DNS</span>
docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>bw-dns

<span class="c1"># Ejecutar el contenedor dnsmasq usando dockurr/dnsmasq con Quad9 DNS</span>
<span class="c1"># Quad9 proporciona resolución de DNS centrada en la seguridad con bloqueo de malware</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>dnsmasq<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="w"> </span>bw-dns<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">DNS1</span><span class="o">=</span><span class="s2">&quot;9.9.9.9&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">DNS2</span><span class="o">=</span><span class="s2">&quot;149.112.112.112&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">53</span>:53/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">53</span>:53/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cap-add<span class="o">=</span>NET_ADMIN<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--restart<span class="o">=</span>always<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>dockurr/dnsmasq

<span class="c1"># Ejecutar BunkerWeb Todo en uno con el resolutor de DNS dnsmasq</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="w"> </span>bw-dns<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">DNS_RESOLVERS</span><span class="o">=</span><span class="s2">&quot;dnsmasq&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Agrega un servicio dnsmasq a tu archivo docker-compose y configura BunkerWeb para usarlo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dnsmasq</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dockurr/dnsmasq</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dnsmasq</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Usando los servidores DNS de Quad9 para mayor seguridad y privacidad</span>
<span class="w">      </span><span class="c1"># Primario: 9.9.9.9 (Quad9 con bloqueo de malware)</span>
<span class="w">      </span><span class="c1"># Secundario: 149.112.112.112 (Servidor de respaldo de Quad9)</span>
<span class="w">      </span><span class="nt">DNS1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9.9.9.9&quot;</span>
<span class="w">      </span><span class="nt">DNS2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;149.112.112.112&quot;</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53:53/udp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53:53/tcp</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_ADMIN</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>

<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DNS_RESOLVERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dnsmasq&quot;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DNS_RESOLVERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dnsmasq&quot;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ...redes existentes...</span>
<span class="w">  </span><span class="nt">bw-dns</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="es-advanced-configuraciones-personalizadas">Configuraciones personalizadas</h3>
<p>Para personalizar y añadir configuraciones personalizadas a BunkerWeb, puedes aprovechar su base NGINX. Las configuraciones personalizadas de NGINX se pueden añadir en diferentes contextos de NGINX, incluidas las configuraciones para el Firewall de Aplicaciones Web (WAF) ModSecurity, que es un componente central de BunkerWeb. Se pueden encontrar más detalles sobre las configuraciones de ModSecurity <a href="#es-features-custom-configurations">aquí</a>.</p>
<p>Estos son los tipos de configuraciones personalizadas disponibles:</p>
<ul>
<li><strong>http</strong>: Configuraciones a nivel HTTP de NGINX.</li>
<li><strong>server-http</strong>: Configuraciones a nivel HTTP/Servidor de NGINX.</li>
<li><strong>default-server-http</strong>: Configuraciones a nivel de Servidor de NGINX, específicamente para el "servidor predeterminado" cuando el nombre del cliente proporcionado no coincide con ningún nombre de servidor en <code>SERVER_NAME</code>.</li>
<li><strong>modsec-crs</strong>: Configuraciones aplicadas antes de que se cargue el Core Rule Set de OWASP.</li>
<li><strong>modsec</strong>: Configuraciones aplicadas después de que se cargue el Core Rule Set de OWASP, o se utilizan cuando el Core Rule Set no está cargado.</li>
<li><strong>crs-plugins-before</strong>: Configuraciones para los plugins CRS, aplicadas antes de que se carguen los plugins CRS.</li>
<li><strong>crs-plugins-after</strong>: Configuraciones para los plugins CRS, aplicadas después de que se carguen los plugins CRS.</li>
<li><strong>stream</strong>: Configuraciones a nivel de Stream de NGINX.</li>
<li><strong>server-stream</strong>: Configuraciones a nivel de Stream/Servidor de NGINX.</li>
</ul>
<p>Las configuraciones personalizadas se pueden aplicar globalmente o específicamente para un servidor en particular, dependiendo del contexto aplicable y de si el <a href="#es-concepts-multisite-mode">modo multisitio</a> está habilitado.</p>
<p>El método para aplicar configuraciones personalizadas depende de la integración que se esté utilizando. Sin embargo, el proceso subyacente implica añadir archivos con el sufijo <code>.conf</code> a carpetas específicas. Para aplicar una configuración personalizada para un servidor específico, el archivo debe colocarse en una subcarpeta con el nombre del servidor principal.</p>
<p>Algunas integraciones proporcionan formas más convenientes de aplicar configuraciones, como el uso de <a href="https://docs.docker.com/engine/swarm/configs/">Configs</a> en Docker Swarm o <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a> en Kubernetes. Estas opciones ofrecen enfoques más sencillos para gestionar y aplicar configuraciones.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:7"><input checked="checked" id="es-advanced-__tabbed_8_1" name="es-advanced-__tabbed_8" type="radio" /><input id="es-advanced-__tabbed_8_2" name="es-advanced-__tabbed_8" type="radio" /><input id="es-advanced-__tabbed_8_3" name="es-advanced-__tabbed_8" type="radio" /><input id="es-advanced-__tabbed_8_4" name="es-advanced-__tabbed_8" type="radio" /><input id="es-advanced-__tabbed_8_5" name="es-advanced-__tabbed_8" type="radio" /><input id="es-advanced-__tabbed_8_6" name="es-advanced-__tabbed_8" type="radio" /><input id="es-advanced-__tabbed_8_7" name="es-advanced-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_8_1">Interfaz de usuario web</label><label for="es-advanced-__tabbed_8_2">Linux</label><label for="es-advanced-__tabbed_8_3">Todo en uno</label><label for="es-advanced-__tabbed_8_4">Docker</label><label for="es-advanced-__tabbed_8_5">Docker autoconf</label><label for="es-advanced-__tabbed_8_6">Kubernetes</label><label for="es-advanced-__tabbed_8_7">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navega a la página de <strong>Configuraciones</strong>, haz clic en <strong>Crear nueva configuración personalizada</strong>, luego puedes elegir si es global o específica para un servicio, el tipo de configuración y el nombre de la configuración:</p>
<p><figure markdown><img align="center" alt="Configuraciones personalizadas usando la interfaz de usuario web" src="../assets/img/advanced-config.png" /><figcaption>Configuraciones personalizadas usando la interfaz de usuario web</figcaption></figure></p>
<p>No olvides hacer clic en el botón <code>💾 Guardar</code>.</p>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-linux">integración de Linux</a>, las configuraciones personalizadas deben escribirse en la carpeta <code>/etc/bunkerweb/configs</code>.</p>
<p>Aquí hay un ejemplo para server-http/hello-world.conf:</p>
<div class="highlight"><pre><span></span><code><span class="k">location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/plain&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">ngx.say(&#39;world&#39;)</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>
<p>Debido a que BunkerWeb se ejecuta como un usuario sin privilegios (nginx:nginx), necesitarás editar los permisos:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:nginx<span class="w"> </span>/etc/bunkerweb/configs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>/etc/bunkerweb/configs
</code></pre></div>
<p>Ahora verifiquemos el estado del Programador:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>Si ya se está ejecutando, podemos recargarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>De lo contrario, tendremos que iniciarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-all-in-one-aio-image">imagen Todo en uno</a>, tienes dos opciones para añadir configuraciones personalizadas:</p>
<ul>
<li>Usar configuraciones específicas <code>*_CUSTOM_CONF_*</code> como variables de entorno al ejecutar el contenedor (recomendado).</li>
<li>Escribir archivos <code>.conf</code> en el directorio <code>/data/configs/</code> dentro del volumen montado en <code>/data</code>.</li>
</ul>
<p><strong>Usando configuraciones (Variables de Entorno)</strong></p>
<p>Las configuraciones a usar deben seguir el patrón <code>&lt;SITE&gt;_CUSTOM_CONF_&lt;TYPE&gt;_&lt;NAME&gt;</code>:</p>
<ul>
<li><code>&lt;SITE&gt;</code> : Nombre del servidor principal opcional si el modo multisitio está habilitado y la configuración debe aplicarse a un servicio específico.</li>
<li><code>&lt;TYPE&gt;</code> : El tipo de configuración, los valores aceptados son <code>HTTP</code>, <code>DEFAULT_SERVER_HTTP</code>, <code>SERVER_HTTP</code>, <code>MODSEC</code>, <code>MODSEC_CRS</code>, <code>CRS_PLUGINS_BEFORE</code>, <code>CRS_PLUGINS_AFTER</code>, <code>STREAM</code> y <code>SERVER_STREAM</code>.</li>
<li><code>&lt;NAME&gt;</code> : El nombre de la configuración sin el sufijo <code>.conf</code>.</li>
</ul>
<p>Aquí hay un ejemplo de prueba al ejecutar el contenedor Todo en uno:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="s2">&quot;CUSTOM_CONF_SERVER_HTTP_hello-world=location /hello { \</span>
<span class="s2">        default_type &#39;text/plain&#39;; \</span>
<span class="s2">        content_by_lua_block { \</span>
<span class="s2">          ngx.say(&#39;world&#39;); \</span>
<span class="s2">        } \</span>
<span class="s2">      }&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se apliquen las nuevas variables de entorno.</p>
<p><strong>Usando archivos</strong></p>
<p>Lo primero que hay que hacer es crear las carpetas:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/configs/server-http
</code></pre></div>
<p>Ahora puedes escribir tus configuraciones:</p>
<div class="highlight"><pre><span></span><code><span class="k">echo</span><span class="w"> </span><span class="s">&quot;location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/plain&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">ngx.say(&#39;world&#39;)</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&gt;</span><span class="w"> </span><span class="s">./bw-data/configs/server-http/hello-world.conf</span>
</code></pre></div>
<p>Debido a que el programador se ejecuta como un usuario sin privilegios con UID y GID 101, necesitarás editar los permisos:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Al iniciar el contenedor del programador, necesitarás montar la carpeta en /data:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>./bw-data:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-docker">integración de Docker</a>, tienes dos opciones para añadir configuraciones personalizadas:</p>
<ul>
<li>Usar configuraciones específicas <code>*_CUSTOM_CONF_*</code> como variables de entorno (recomendado)</li>
<li>Escribir archivos .conf en el volumen montado en /data del programador</li>
</ul>
<p><strong>Usando configuraciones</strong></p>
<p>Las configuraciones a usar deben seguir el patrón <code>&lt;SITE&gt;_CUSTOM_CONF_&lt;TYPE&gt;_&lt;NAME&gt;</code>:</p>
<ul>
<li><code>&lt;SITE&gt;</code>: nombre del servidor principal opcional si el modo multisitio está habilitado y la configuración debe aplicarse a un servicio específico</li>
<li><code>&lt;TYPE&gt;</code>: el tipo de configuración, los valores aceptados son <code>HTTP</code>, <code>DEFAULT_SERVER_HTTP</code>, <code>SERVER_HTTP</code>, <code>MODSEC</code>, <code>MODSEC_CRS</code>, <code>CRS_PLUGINS_BEFORE</code>, <code>CRS_PLUGINS_AFTER</code>, <code>STREAM</code> y <code>SERVER_STREAM</code></li>
<li><code>&lt;NAME&gt;</code>: el nombre de la configuración sin el sufijo .conf</li>
</ul>
<p>Aquí hay un ejemplo de prueba usando un archivo docker-compose:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">CUSTOM_CONF_SERVER_HTTP_hello-world=</span>
<span class="w">      </span><span class="no">location /hello {</span>
<span class="w">        </span><span class="no">default_type &#39;text/plain&#39;;</span>
<span class="w">        </span><span class="no">content_by_lua_block {</span>
<span class="w">          </span><span class="no">ngx.say(&#39;world&#39;)</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">      </span><span class="no">}</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p><strong>Usando archivos</strong></p>
<p>Lo primero que hay que hacer es crear las carpetas:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/configs/server-http
</code></pre></div>
<p>Ahora puedes escribir tus configuraciones:</p>
<div class="highlight"><pre><span></span><code><span class="k">echo</span><span class="w"> </span><span class="s">&quot;location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/plain&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">ngx.say(&#39;world&#39;)</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&gt;</span><span class="w"> </span><span class="s">./bw-data/configs/server-http/hello-world.conf</span>
</code></pre></div>
<p>Debido a que el programador se ejecuta como un usuario sin privilegios con UID y GID 101, necesitarás editar los permisos:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Al iniciar el contenedor del programador, necesitarás montar la carpeta en /data:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-docker-autoconf">integración de autoconfiguración de Docker</a>, tienes dos opciones para añadir configuraciones personalizadas:</p>
<ul>
<li>Usar configuraciones específicas <code>*_CUSTOM_CONF_*</code> como etiquetas (más fácil)</li>
<li>Escribir archivos .conf en el volumen montado en /data del programador</li>
</ul>
<p><strong>Usando etiquetas</strong></p>
<div class="admonition warning">
<p class="admonition-title">Limitaciones al usar etiquetas</p>
<p>Cuando usas etiquetas con la integración de autoconfiguración de Docker, solo puedes aplicar configuraciones personalizadas para el servicio web correspondiente. No es posible aplicar configuraciones <strong>http</strong>, <strong>default-server-http</strong>, <strong>stream</strong> o cualquier configuración global (como <strong>server-http</strong> o <strong>server-stream</strong> para todos los servicios): necesitarás montar archivos para ese propósito.</p>
</div>
<p>Las etiquetas a usar deben seguir el patrón <code>bunkerweb.CUSTOM_CONF_&lt;TYPE&gt;_&lt;NAME&gt;</code>:</p>
<ul>
<li><code>&lt;TYPE&gt;</code>: el tipo de configuración, los valores aceptados son <code>SERVER_HTTP</code>, <code>MODSEC</code>, <code>MODSEC_CRS</code>, <code>CRS_PLUGINS_BEFORE</code>, <code>CRS_PLUGINS_AFTER</code> y <code>SERVER_STREAM</code></li>
<li><code>&lt;NAME&gt;</code>: el nombre de la configuración sin el sufijo .conf</li>
</ul>
<p>Aquí hay un ejemplo de prueba usando un archivo docker-compose:</p>
<div class="highlight"><pre><span></span><code><span class="nt">myapp</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">bunkerweb.CUSTOM_CONF_SERVER_HTTP_hello-world=</span>
<span class="w">      </span><span class="no">location /hello {</span>
<span class="w">        </span><span class="no">default_type &#39;text/plain&#39;;</span>
<span class="w">        </span><span class="no">content_by_lua_block {</span>
<span class="w">            </span><span class="no">ngx.say(&#39;world&#39;)</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">      </span><span class="no">}</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p><strong>Usando archivos</strong></p>
<p>Lo primero que hay que hacer es crear las carpetas:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/configs/server-http
</code></pre></div>
<p>Ahora puedes escribir tus configuraciones:</p>
<div class="highlight"><pre><span></span><code><span class="k">echo</span><span class="w"> </span><span class="s">&quot;location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/plain&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">ngx.say(&#39;world&#39;)</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span><span class="s">&quot;</span><span class="w"> </span><span class="s">&gt;</span><span class="w"> </span><span class="s">./bw-data/configs/server-http/hello-world.conf</span>
</code></pre></div>
<p>Debido a que el programador se ejecuta como un usuario sin privilegios con UID y GID 101, necesitarás editar los permisos:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Al iniciar el contenedor del programador, necesitarás montar la carpeta en /data:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-kubernetes">integración de Kubernetes</a>, las configuraciones personalizadas se gestionan mediante <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>.</p>
<p>Para mantenerlo simple, ni siquiera necesitas usar el ConfigMap con un Pod (por ejemplo, como variable de entorno o volumen): el Pod de autoconfiguración está escuchando eventos de ConfigMap y actualizará las configuraciones personalizadas cuando sea necesario.</p>
<p>Al crear un ConfigMap, necesitarás añadir etiquetas especiales:</p>
<ul>
<li><strong>bunkerweb.io/CONFIG_TYPE</strong>: debe establecerse a un tipo de configuración personalizada válido (http, server-http, default-server-http, modsec, modsec-crs, crs-plugins-before, crs-plugins-after, stream o server-stream)</li>
<li><strong>bunkerweb.io/CONFIG_SITE</strong>: establece un nombre de servidor para aplicar la configuración a ese servidor específico (opcional, se aplicará globalmente si no se establece)</li>
</ul>
<p>Aquí está el ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cfg-bunkerweb-all-server-http</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/CONFIG_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;server-http&quot;</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myconf</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">location /hello {</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">default_type &#39;text/plain&#39;;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">content_by_lua_block {</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">ngx.say(&#39;world&#39;)</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">}</span>
<span class="w">  </span><span class="err">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Configuración extra personalizada</p>
<p>Desde la versión <code>1.6.0</code>, puedes añadir/sobrescribir configuraciones usando la anotación <code>bunkerweb.io/CONFIG_TYPE=settings</code>. Aquí hay un ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cfg-bunkerweb-extra-settings</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/CONFIG_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;settings&quot;</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;captcha&quot;</span><span class="w"> </span><span class="c1"># configuración multisitio que se aplicará a todos los servicios que no la sobrescriban</span>
<span class="w">  </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># configuración global que se aplicará globalmente</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Puedes encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Cuando se utiliza la <a href="#es-integrations-swarm">integración de Swarm</a>, las configuraciones personalizadas se gestionan mediante <a href="https://docs.docker.com/engine/swarm/configs/">Docker Configs</a>.</p>
<p>Para mantenerlo simple, ni siquiera necesitas adjuntar la Configuración a un servicio: el servicio de autoconfiguración está escuchando los eventos de Configuración y actualizará las configuraciones personalizadas cuando sea necesario.</p>
<p>Al crear una Configuración, necesitarás añadir etiquetas especiales:</p>
<ul>
<li><strong>bunkerweb.CONFIG_TYPE</strong>: debe establecerse a un tipo de configuración personalizada válido (http, server-http, default-server-http, modsec, modsec-crs, crs-plugins-before, crs-plugins-after, stream o server-stream)</li>
<li><strong>bunkerweb.CONFIG_SITE</strong>: establece un nombre de servidor para aplicar la configuración a ese servidor específico (opcional, se aplicará globalmente si no se establece)</li>
</ul>
<p>Aquí está el ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="k">echo</span><span class="w"> </span><span class="s">&quot;location</span><span class="w"> </span><span class="s">/hello</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/plain&#39;</span><span class="p">;</span>
<span class="w">  </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="kn">ngx.say(&#39;world&#39;)</span>
<span class="w">  </span><span class="err">}</span>
<span class="err">}</span><span class="s">&quot;</span><span class="w"> </span><span class="s">|</span><span class="w"> </span><span class="s">docker</span><span class="w"> </span><span class="s">config</span><span class="w"> </span><span class="s">create</span><span class="w"> </span><span class="s">-l</span><span class="w"> </span><span class="s">bunkerweb.CONFIG_TYPE=server-http</span><span class="w"> </span><span class="s">my-config</span><span class="w"> </span><span class="s">-</span>
</code></pre></div>
<p>No hay mecanismo de actualización: la alternativa es eliminar una configuración existente usando <code>docker config rm</code> y luego recrearla.</p>
</div>
</div>
</div>
<h3 id="es-advanced-ejecutando-muchos-servicios-en-produccion">Ejecutando muchos servicios en producción</h3>
<h4 id="es-advanced-crs-global">CRS Global</h4>
<div class="admonition warning">
<p class="admonition-title">Plugins CRS</p>
<p>Cuando el CRS se carga globalmente, <strong>los plugins CRS no son compatibles</strong>. Si necesitas usarlos, tendrás que cargar el CRS por servicio.</p>
</div>
<p>Si usas BunkerWeb en producción con un gran número de servicios y habilitas la <strong>característica de ModSecurity globalmente</strong> con las reglas CRS, el tiempo requerido para cargar las configuraciones de BunkerWeb puede volverse demasiado largo, resultando potencialmente en un tiempo de espera agotado.</p>
<p>La solución es cargar las reglas CRS globalmente en lugar de por servicio. Este comportamiento no está habilitado por defecto por razones de compatibilidad con versiones anteriores y porque tiene un inconveniente: si habilitas la carga global de reglas CRS, <strong>ya no será posible definir reglas modsec-crs</strong> (ejecutadas antes de las reglas CRS) por servicio. Sin embargo, esta limitación puede ser superada escribiendo reglas de exclusión globales <code>modsec-crs</code> como esta:</p>
<div class="highlight"><pre><span></span><code>SecRule REQUEST_FILENAME &quot;@rx ^/somewhere$&quot; &quot;nolog,phase:4,allow,id:1010,chain&quot;
SecRule REQUEST_HEADERS:Host &quot;@rx ^app1\.example\.com$&quot; &quot;nolog&quot;
</code></pre></div>
<p>Puedes habilitar la carga global de CRS estableciendo <code>USE_MODSECURITY_GLOBAL_CRS</code> en <code>yes</code>.</p>
<h4 id="es-advanced-ajustar-max_allowed_packet-para-mariadbmysql">Ajustar max_allowed_packet para MariaDB/MySQL</h4>
<p>Parece que el valor predeterminado para el parámetro <code>max_allowed_packet</code> en los servidores de bases de datos MariaDB y MySQL no es suficiente cuando se utiliza BunkerWeb con un gran número de servicios.</p>
<p>Si encuentras errores como este, especialmente en el programador:</p>
<div class="highlight"><pre><span></span><code>[Warning] Aborted connection 5 to db: &#39;db&#39; user: &#39;bunkerweb&#39; host: &#39;172.20.0.4&#39; (Got a packet bigger than &#39;max_allowed_packet&#39; bytes)
</code></pre></div>
<p>Necesitarás aumentar el <code>max_allowed_packet</code> en tu servidor de base de datos.</p>
<h3 id="es-advanced-persistencia-de-bloqueos-e-informes">Persistencia de bloqueos e informes</h3>
<p>Por defecto, BunkerWeb almacena los bloqueos e informes en un almacén de datos Lua local. Aunque es simple y eficiente, esta configuración significa que los datos se pierden cuando se reinicia la instancia. Para asegurar que los bloqueos e informes persistan a través de los reinicios, puedes configurar BunkerWeb para que utilice un servidor remoto <a href="https://redis.io/">Redis</a> o <a href="https://valkey.io/">Valkey</a>.</p>
<p><strong>¿Por qué usar Redis/Valkey?</strong></p>
<p>Redis y Valkey son potentes almacenes de datos en memoria comúnmente utilizados como bases de datos, cachés y agentes de mensajes. Son altamente escalables y soportan una variedad de estructuras de datos, incluyendo:</p>
<ul>
<li><strong>Strings</strong>: Pares básicos de clave-valor.</li>
<li><strong>Hashes</strong>: Pares de campo-valor dentro de una sola clave.</li>
<li><strong>Lists</strong>: Colecciones ordenadas de cadenas.</li>
<li><strong>Sets</strong>: Colecciones no ordenadas de cadenas únicas.</li>
<li><strong>Sorted Sets</strong>: Colecciones ordenadas con puntuaciones.</li>
</ul>
<p>Al aprovechar Redis o Valkey, BunkerWeb puede almacenar persistentemente bloqueos, informes y datos de caché, asegurando durabilidad y escalabilidad.</p>
<p><strong>Habilitando el soporte de Redis/Valkey</strong></p>
<p>Para habilitar el soporte de Redis o Valkey, configura los siguientes ajustes en tu archivo de configuración de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code># Habilitar el soporte de Redis/Valkey
USE_REDIS=yes

# Nombre de host o dirección IP del servidor Redis/Valkey
REDIS_HOST=&lt;hostname&gt;

# Número de puerto del servidor Redis/Valkey (predeterminado: 6379)
REDIS_PORT=6379

# Número de base de datos de Redis/Valkey (predeterminado: 0)
REDIS_DATABASE=0
</code></pre></div>
<ul>
<li><strong><code>USE_REDIS</code></strong>: Establécelo en <code>yes</code> para habilitar la integración con Redis/Valkey.</li>
<li><strong><code>REDIS_HOST</code></strong>: Especifica el nombre de host o la dirección IP del servidor Redis/Valkey.</li>
<li><strong><code>REDIS_PORT</code></strong>: Especifica el número de puerto para el servidor Redis/Valkey. El valor predeterminado es <code>6379</code>.</li>
<li><strong><code>REDIS_DATABASE</code></strong>: Especifica el número de la base de datos de Redis/Valkey a utilizar. El valor predeterminado es <code>0</code>.</li>
</ul>
<p>Si necesitas configuraciones más avanzadas, como autenticación, soporte SSL/TLS o modo Sentinel, consulta la <a href="#es-features-redis">documentación de configuración del plugin de Redis</a> para obtener una guía detallada.</p>
<h3 id="es-advanced-proteger-aplicaciones-udptcp">Proteger aplicaciones UDP/TCP</h3>
<div class="admonition example">
<p class="admonition-title">Característica experimental</p>
<p>Esta característica no está lista para producción. Siéntete libre de probarla y reportarnos cualquier error usando los <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a> en el repositorio de GitHub.</p>
</div>
<p>BunkerWeb ofrece la capacidad de funcionar como un <strong>proxy inverso genérico UDP/TCP</strong>, permitiéndote proteger cualquier aplicación basada en red que opere al menos en la capa 4 del modelo OSI. En lugar de utilizar el módulo HTTP "clásico", BunkerWeb aprovecha el <a href="https://nginx.org/en/docs/stream/ngx_stream_core_module.html">módulo stream</a> de NGINX.</p>
<p>Es importante tener en cuenta que <strong>no todas las configuraciones y características de seguridad están disponibles cuando se utiliza el módulo stream</strong>. Puedes encontrar información adicional sobre esto en las secciones de <a href="#es-features">características</a> de la documentación.</p>
<p>Configurar un proxy inverso básico es bastante similar a la configuración HTTP, ya que implica usar las mismas configuraciones: <code>USE_REVERSE_PROXY=yes</code> y <code>REVERSE_PROXY_HOST=myapp:9000</code>. Incluso cuando BunkerWeb está posicionado detrás de un Balanceador de Carga, las configuraciones siguen siendo las mismas (siendo el <strong>protocolo PROXY</strong> la opción soportada por razones evidentes).</p>
<p>Además de eso, se utilizan las siguientes configuraciones específicas:</p>
<ul>
<li><code>SERVER_TYPE=stream</code>: activa el modo <code>stream</code> (UDP/TCP genérico) en lugar del <code>http</code> (que es el predeterminado)</li>
<li><code>LISTEN_STREAM_PORT=4242</code>: el puerto de escucha "plano" (sin SSL/TLS) en el que BunkerWeb escuchará</li>
<li><code>LISTEN_STREAM_PORT_SSL=4343</code>: el puerto de escucha "ssl/tls" en el que BunkerWeb escuchará</li>
<li><code>USE_UDP=no</code>: escucha y reenvía paquetes UDP en lugar de TCP</li>
</ul>
<p>Para obtener una lista completa de las configuraciones relacionadas con el modo <code>stream</code>, consulta la sección de <a href="#es-features">características</a> de la documentación.</p>
<div class="admonition tip">
<p class="admonition-title">múltiples puertos de escucha</p>
<p>Desde la versión <code>1.6.0</code>, BunkerWeb soporta múltiples puertos de escucha para el modo <code>stream</code>. Puedes especificarlos usando las configuraciones <code>LISTEN_STREAM_PORT</code> y <code>LISTEN_STREAM_PORT_SSL</code>.</p>
<p>Aquí hay un ejemplo:</p>
<div class="highlight"><pre><span></span><code>...
LISTEN_STREAM_PORT=4242
LISTEN_STREAM_PORT_SSL=4343
LISTEN_STREAM_PORT_1=4244
LISTEN_STREAM_PORT_SSL_1=4344
...
</code></pre></div>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="9:6"><input checked="checked" id="es-advanced-__tabbed_9_1" name="es-advanced-__tabbed_9" type="radio" /><input id="es-advanced-__tabbed_9_2" name="es-advanced-__tabbed_9" type="radio" /><input id="es-advanced-__tabbed_9_3" name="es-advanced-__tabbed_9" type="radio" /><input id="es-advanced-__tabbed_9_4" name="es-advanced-__tabbed_9" type="radio" /><input id="es-advanced-__tabbed_9_5" name="es-advanced-__tabbed_9" type="radio" /><input id="es-advanced-__tabbed_9_6" name="es-advanced-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_9_1">Todo en uno</label><label for="es-advanced-__tabbed_9_2">Docker</label><label for="es-advanced-__tabbed_9_3">Docker autoconf</label><label for="es-advanced-__tabbed_9_4">Kubernetes</label><label for="es-advanced-__tabbed_9_5">Linux</label><label for="es-advanced-__tabbed_9_6">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Necesitarás agregar la configuración a las variables de entorno al ejecutar el contenedor Todo en uno. También necesitarás exponer los puertos de stream.</p>
<p>Este ejemplo configura BunkerWeb para hacer proxy de dos aplicaciones basadas en stream, <code>app1.example.com</code> y <code>app2.example.com</code>.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVER_NAME</span><span class="o">=</span><span class="s2">&quot;app1.example.com app2.example.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">MULTISITE</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_REVERSE_PROXY</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVER_TYPE</span><span class="o">=</span><span class="s2">&quot;stream&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app1.example.com_REVERSE_PROXY_HOST<span class="o">=</span><span class="s2">&quot;myapp1:9000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app1.example.com_LISTEN_STREAM_PORT<span class="o">=</span><span class="s2">&quot;10000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app2.example.com_REVERSE_PROXY_HOST<span class="o">=</span><span class="s2">&quot;myapp2:9000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app2.example.com_LISTEN_STREAM_PORT<span class="o">=</span><span class="s2">&quot;20000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">10000</span>:10000/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">20000</span>:20000/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se apliquen las nuevas variables de entorno.</p>
<p>Tus aplicaciones (<code>myapp1</code>, <code>myapp2</code>) deberían estar ejecutándose en contenedores separados (o ser accesibles de otra manera) y sus nombres de host/IPs (p. ej., <code>myapp1</code>, <code>myapp2</code> usados en <code>_REVERSE_PROXY_HOST</code>) deben ser resolvibles y alcanzables desde el contenedor <code>bunkerweb-aio</code>. Esto típicamente implica conectarlos a una red Docker compartida.</p>
<div class="admonition note">
<p class="admonition-title">Desactivar el servicio de la interfaz de usuario</p>
<p>Se recomienda desactivar el servicio de la interfaz de usuario (p. ej., estableciendo <code>SERVICE_UI=no</code> como una variable de entorno) ya que la interfaz de usuario web no es compatible con <code>SERVER_TYPE=stream</code>.</p>
</div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la integración con Docker, la forma más fácil de proteger las aplicaciones de red existentes es agregar los servicios a la red <code>bw-services</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir la misma configuración para todos los servicios</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">  </span><span class="c1"># Token de API opcional para llamadas de API autenticadas</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080&quot;</span><span class="w"> </span><span class="c1"># Mantenlo si quieres usar la automatización de Let&#39;s Encrypt al usar el tipo de desafío http</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10000:10000&quot;</span><span class="w"> </span><span class="c1"># app1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;20000:20000&quot;</span><span class="w"> </span><span class="c1"># app2</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Esta configuración es obligatoria para especificar la instancia de BunkerWeb</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;app1.example.com</span><span class="nv"> </span><span class="s">app2.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Se aplicará a todos los servicios</span>
<span class="w">      </span><span class="nt">SERVER_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span><span class="w"> </span><span class="c1"># Se aplicará a todos los servicios</span>
<span class="w">      </span><span class="nt">app1.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp1:9000&quot;</span>
<span class="w">      </span><span class="nt">app1.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10000&quot;</span>
<span class="w">      </span><span class="nt">app2.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp2:9000&quot;</span>
<span class="w">      </span><span class="nt">app2.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20000&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Esto se usa para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Antes de ejecutar el stack de <a href="#es-integrations-docker-autoconf">integración Docker autoconf</a> en tu máquina, necesitarás editar los puertos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080&quot;</span><span class="w"> </span><span class="c1"># Mantenlo si quieres usar la automatización de Let&#39;s Encrypt cuando usas el tipo de desafío http</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10000:10000&quot;</span><span class="w"> </span><span class="c1"># app1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;20000:20000&quot;</span><span class="w"> </span><span class="c1"># app2</span>
<span class="nn">...</span>
</code></pre></div>
<p>Una vez que el stack esté en ejecución, puedes conectar tus aplicaciones existentes a la red <code>bw-services</code> y configurar BunkerWeb con etiquetas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp1:9000&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=10000&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp2:9000&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=20000&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition example">
<p class="admonition-title">Característica experimental</p>
<p>Por el momento, los <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingresses</a> no soportan el modo <code>stream</code>. <strong>Lo que estamos haciendo aquí es una solución alternativa para que funcione.</strong></p>
<p>Siéntete libre de probarlo y reportarnos cualquier error usando los <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a> en el repositorio de GitHub.</p>
</div>
<p>Antes de ejecutar el stack de la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en tu máquina, necesitarás abrir los puertos en tu balanceador de carga:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span><span class="w"> </span><span class="c1"># Mantenlo si quieres usar la automatización de Let&#39;s Encrypt cuando usas el tipo de desafío http</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
</code></pre></div>
<p>Una vez que el stack esté en ejecución, puedes crear tus recursos de ingress:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/SERVER_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span><span class="w"> </span><span class="c1"># Se aplicará a todos los servicios</span>
<span class="w">    </span><span class="nt">bunkerweb.io/app1.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10000&quot;</span>
<span class="w">    </span><span class="nt">bunkerweb.io/app2.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20000&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span><span class="w"> </span><span class="c1"># Esto no se usa en modo stream pero es obligatorio</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app1</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span><span class="w"> </span><span class="c1"># Esto no se usa en modo stream pero es obligatorio</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app2</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app2</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración al archivo <code>/etc/bunkerweb/variables.env</code>:</p>
<div class="highlight"><pre><span></span><code>...
SERVER_NAME=app1.example.com app2.example.com
MULTISITE=yes
USE_REVERSE_PROXY=yes
SERVER_TYPE=stream
app1.example.com_REVERSE_PROXY_HOST=myapp1.domain.or.ip:9000
app1.example.com_LISTEN_STREAM_PORT=10000
app2.example.com_REVERSE_PROXY_HOST=myapp2.domain.or.ip:9000
app2.example.com_LISTEN_STREAM_PORT=20000
...
</code></pre></div>
<p>Ahora verifiquemos el estado del Programador:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>Si ya se está ejecutando, podemos recargarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>De lo contrario, tendremos que iniciarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Puedes encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Antes de ejecutar el stack de <a href="#es-integrations-swarm">integración de Swarm</a> en tu máquina, necesitarás editar los puertos:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Mantenlo si quieres usar la automatización de Let&#39;s Encrypt cuando usas el tipo de desafío http</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="c1"># app1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="c1"># app2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="nn">...</span>
</code></pre></div>
<p>Una vez que el stack esté en ejecución, puedes conectar tus aplicaciones existentes a la red <code>bw-services</code> y configurar BunkerWeb con etiquetas:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>

<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp1:9000&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=10000&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp2:9000&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=20000&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="es-advanced-php">PHP</h3>
<div class="admonition example">
<p class="admonition-title">Característica experimental</p>
<p>Por el momento, el soporte de PHP con BunkerWeb todavía está en beta y te recomendamos que utilices una arquitectura de proxy inverso si puedes. Por cierto, PHP no es compatible en absoluto con algunas integraciones como Kubernetes.</p>
</div>
<p>BunkerWeb soporta PHP usando instancias externas o remotas de <a href="https://www.php.net/manual/en/install.fpm.php">PHP-FPM</a>. Asumiremos que ya estás familiarizado con la gestión de este tipo de servicios.</p>
<p>Se pueden usar las siguientes configuraciones:</p>
<ul>
<li><code>REMOTE_PHP</code>: Nombre de host de la instancia remota de PHP-FPM.</li>
<li><code>REMOTE_PHP_PATH</code>: Carpeta raíz que contiene los archivos en la instancia remota de PHP-FPM.</li>
<li><code>REMOTE_PHP_PORT</code>: Puerto de la instancia remota de PHP-FPM (<em>el predeterminado es 9000</em>).</li>
<li><code>LOCAL_PHP</code>: Ruta al archivo de socket local de la instancia de PHP-FPM.</li>
<li><code>LOCAL_PHP_PATH</code>: Carpeta raíz que contiene los archivos en la instancia local de PHP-FPM.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="10:6"><input checked="checked" id="es-advanced-__tabbed_10_1" name="es-advanced-__tabbed_10" type="radio" /><input id="es-advanced-__tabbed_10_2" name="es-advanced-__tabbed_10" type="radio" /><input id="es-advanced-__tabbed_10_3" name="es-advanced-__tabbed_10" type="radio" /><input id="es-advanced-__tabbed_10_4" name="es-advanced-__tabbed_10" type="radio" /><input id="es-advanced-__tabbed_10_5" name="es-advanced-__tabbed_10" type="radio" /><input id="es-advanced-__tabbed_10_6" name="es-advanced-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_10_1">Todo en uno</label><label for="es-advanced-__tabbed_10_2">Docker</label><label for="es-advanced-__tabbed_10_3">Docker autoconf</label><label for="es-advanced-__tabbed_10_4">Kubernetes</label><label for="es-advanced-__tabbed_10_5">Linux</label><label for="es-advanced-__tabbed_10_6">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-all-in-one-aio-image">imagen Todo en uno</a>, para soportar aplicaciones PHP, necesitarás:</p>
<ul>
<li>Montar tus archivos PHP en la carpeta <code>/var/www/html</code> de BunkerWeb.</li>
<li>Configurar un contenedor PHP-FPM para tu aplicación y montar la carpeta que contiene los archivos PHP.</li>
<li>Usar las configuraciones específicas <code>REMOTE_PHP</code> y <code>REMOTE_PHP_PATH</code> como variables de entorno al ejecutar BunkerWeb.</li>
</ul>
<p>Si habilitas el <a href="#es-concepts-multisite-mode">modo multisitio</a>, necesitarás crear directorios separados para cada una de tus aplicaciones. Cada subdirectorio debe nombrarse usando el primer valor de <code>SERVER_NAME</code>. Aquí hay un ejemplo de prueba:</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
└── app2.example.com
    └── index.php

2 directorios, 2 archivos
</code></pre></div>
<p>Asumiremos que tus aplicaciones PHP están ubicadas en una carpeta llamada <code>www</code>. Ten en cuenta que necesitarás corregir los permisos para que BunkerWeb (UID/GID 101) pueda al menos leer archivos y listar carpetas, y que PHP-FPM (UID/GID 33 si usas la imagen <code>php:fpm</code>) sea el propietario de los archivos y carpetas:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>./www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>Ahora puedes ejecutar BunkerWeb, configurarlo para tu aplicación PHP y también ejecutar las aplicaciones PHP. Necesitarás crear una red Docker personalizada para permitir que BunkerWeb se comunique con tus contenedores PHP-FPM.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Crear una red personalizada</span>
docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>php-network

<span class="c1"># Ejecutar contenedores PHP-FPM</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>myapp1-php<span class="w"> </span>--network<span class="w"> </span>php-network<span class="w"> </span>-v<span class="w"> </span>./www/app1.example.com:/app<span class="w"> </span>php:fpm
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>myapp2-php<span class="w"> </span>--network<span class="w"> </span>php-network<span class="w"> </span>-v<span class="w"> </span>./www/app2.example.com:/app<span class="w"> </span>php:fpm

<span class="c1"># Ejecutar BunkerWeb Todo en uno</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="w"> </span>php-network<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>./www:/var/www/html<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVER_NAME</span><span class="o">=</span><span class="s2">&quot;app1.example.com app2.example.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">MULTISITE</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REMOTE_PHP_PATH</span><span class="o">=</span><span class="s2">&quot;/app&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app1.example.com_REMOTE_PHP<span class="o">=</span><span class="s2">&quot;myapp1-php&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app2.example.com_REMOTE_PHP<span class="o">=</span><span class="s2">&quot;myapp2-php&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>Ten en cuenta que si tu contenedor ya está creado, necesitarás eliminarlo y recrearlo para que se apliquen las nuevas variables de entorno.</p>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-docker">integración de Docker</a>, para admitir aplicaciones PHP, necesitarás:</p>
<ul>
<li>Montar tus archivos PHP en la carpeta <code>/var/www/html</code> de BunkerWeb</li>
<li>Configurar un contenedor PHP-FPM para tu aplicación y montar la carpeta que contiene los archivos PHP</li>
<li>Usar las configuraciones específicas <code>REMOTE_PHP</code> y <code>REMOTE_PHP_PATH</code> como variables de entorno al iniciar BunkerWeb</li>
</ul>
<p>Si habilitas el <a href="#es-concepts-multisite-mode">modo multisitio</a>, necesitarás crear directorios separados para cada una de tus aplicaciones. Cada subdirectorio debe nombrarse utilizando el primer valor de <code>SERVER_NAME</code>. Aquí hay un ejemplo de prueba:</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directorios, 3 archivos
</code></pre></div>
<p>Asumiremos que tus aplicaciones PHP están ubicadas en una carpeta llamada <code>www</code>. Ten en cuenta que necesitarás arreglar los permisos para que BunkerWeb (UID/GID 101) pueda al menos leer archivos y listar carpetas y PHP-FPM (UID/GID 33 si usas la imagen <code>php:fpm</code>) sea el propietario de los archivos y carpetas:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>./www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>Ahora puedes ejecutar BunkerWeb, configurarlo para tu aplicación PHP y también ejecutar las aplicaciones PHP:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir la misma configuración para todos los servicios</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www:/var/www/html</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Esta configuración es obligatoria para especificar la instancia de BunkerWeb</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;app1.example.com</span><span class="nv"> </span><span class="s">app2.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REMOTE_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/app&quot;</span><span class="w"> </span><span class="c1"># Se aplicará a todos los servicios gracias a la configuración MULTISITE</span>
<span class="w">      </span><span class="nt">app1.example.com_REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp1&quot;</span>
<span class="w">      </span><span class="nt">app2.example.com_REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp2&quot;</span>
<span class="w">      </span><span class="nt">app3.example.com_REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp3&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Esto se usa para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app1.example.com:/app</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app2.example.com:/app</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">myapp3</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app3.example.com:/app</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Modo multisitio habilitado</p>
<p>La integración de <a href="#es-integrations-docker-autoconf">Docker autoconf</a> implica el uso del modo multisitio: proteger una aplicación PHP es lo mismo que proteger varias.</p>
</div>
<p>Cuando se utiliza la <a href="#es-integrations-docker-autoconf">integración de Docker autoconf</a>, para admitir aplicaciones PHP, necesitarás:</p>
<ul>
<li>Montar tus archivos PHP en la carpeta <code>/var/www/html</code> de BunkerWeb</li>
<li>Configurar contenedores PHP-FPM para tus aplicaciones y montar la carpeta que contiene las aplicaciones PHP</li>
<li>Usar las configuraciones específicas <code>REMOTE_PHP</code> y <code>REMOTE_PHP_PATH</code> como etiquetas para tu contenedor PHP-FPM</li>
</ul>
<p>Dado que la autoconfiguración de Docker implica el uso del <a href="#es-concepts-multisite-mode">modo multisitio</a>, necesitarás crear directorios separados para cada una de tus aplicaciones. Cada subdirectorio debe tener el nombre del primer valor de <code>SERVER_NAME</code>. Aquí hay un ejemplo de prueba:</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directorios, 3 archivos
</code></pre></div>
<p>Una vez creadas las carpetas, copia tus archivos y corrige los permisos para que BunkerWeb (UID/GID 101) pueda al menos leer archivos y listar carpetas, y PHP-FPM (UID/GID 33 si usas la imagen <code>php:fpm</code>) sea el propietario de los archivos y carpetas:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>./www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>Cuando inicies el stack de autoconfiguración de BunkerWeb, monta la carpeta <code>www</code> en <code>/var/www/html</code> para el contenedor del <strong>Scheduler</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># Usamos un ancla para evitar repetir la misma configuración para todos los servicios</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www:/var/www/html</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># No necesitamos especificar la instancia de BunkerWeb aquí, ya que son detectadas automáticamente por el servicio de autoconfiguración</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># El nombre del servidor se llenará con las etiquetas de los servicios</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Configuración obligatoria para la autoconfiguración</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># El socket de Docker</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
</code></pre></div>
<p>Ahora puedes crear tus contenedores PHP-FPM, montar las subcarpetas correctas y usar etiquetas para configurar BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app1.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp1</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app2.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp2</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp2&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp3</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app3.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp3</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app3.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp3&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">PHP no es compatible con Kubernetes</p>
<p>La integración de Kubernetes permite la configuración a través de <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingress</a> y el controlador de BunkerWeb solo admite aplicaciones HTTP por el momento.</p>
</div>
</div>
<div class="tabbed-block">
<p>Asumiremos que ya tienes el stack de <a href="#es-integrations-linux">integración de Linux</a> funcionando en tu máquina.</p>
<p>Por defecto, BunkerWeb buscará archivos web dentro de la carpeta <code>/var/www/html</code>. Puedes usarla para almacenar tus aplicaciones PHP. Ten en cuenta que necesitarás configurar tu servicio PHP-FPM para obtener o establecer el usuario/grupo de los procesos en ejecución y el archivo de socket UNIX utilizado para comunicarse con BunkerWeb.</p>
<p>En primer lugar, deberás asegurarte de que tu instancia de PHP-FPM pueda acceder a los archivos dentro de la carpeta <code>/var/www/html</code> y también de que BunkerWeb pueda acceder al archivo de socket UNIX para comunicarse con PHP-FPM. Recomendamos establecer un usuario diferente como <code>www-data</code> para el servicio PHP-FPM y dar al grupo nginx acceso al archivo de socket UNIX. Aquí está la configuración correspondiente de PHP-FPM:</p>
<div class="highlight"><pre><span></span><code><span class="na">...</span>
<span class="k">[www]</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">www-data</span>
<span class="na">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">www-data</span>
<span class="na">listen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/run/php/php-fpm.sock</span>
<span class="na">listen.owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">www-data</span>
<span class="na">listen.group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">nginx</span>
<span class="na">listen.mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0660</span>
<span class="na">...</span>
</code></pre></div>
<p>No olvides reiniciar tu servicio PHP-FPM:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>php-fpm
</code></pre></div>
<p>Si habilitas el <a href="#es-concepts-multisite-mode">modo multisitio</a>, necesitarás crear directorios separados para cada una de tus aplicaciones. Cada subdirectorio debe nombrarse utilizando el primer valor de <code>SERVER_NAME</code>. Aquí hay un ejemplo de prueba:</p>
<div class="highlight"><pre><span></span><code>/var/www/html
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directorios, 3 archivos
</code></pre></div>
<p>Ten en cuenta que necesitarás arreglar los permisos para que BunkerWeb (grupo <code>nginx</code>) pueda al menos leer archivos y listar carpetas, y PHP-FPM (usuario <code>www-data</code>, pero podría ser diferente dependiendo de tu sistema) sea el propietario de los archivos y carpetas:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>www-data:nginx<span class="w"> </span>/var/www/html<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/var/www/html<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/var/www/html<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>Ahora puedes editar el archivo <code>/etc/bunkerweb/variable.env</code>:</p>
<div class="highlight"><pre><span></span><code>HTTP_PORT=80
HTTPS_PORT=443
DNS_RESOLVERS=9.9.9.9 8.8.8.8 8.8.4.4
API_LISTEN_IP=127.0.0.1
MULTISITE=yes
SERVER_NAME=app1.example.com app2.example.com app3.example.com
app1.example.com_LOCAL_PHP=/run/php/php-fpm.sock
app1.example.com_LOCAL_PHP_PATH=/var/www/html/app1.example.com
app2.example.com_LOCAL_PHP=/run/php/php-fpm.sock
app2.example.com_LOCAL_PHP_PATH=/var/www/html/app2.example.com
app3.example.com_LOCAL_PHP=/run/php/php-fpm.sock
app3.example.com_LOCAL_PHP_PATH=/var/www/html/app3.example.com
</code></pre></div>
<p>Ahora verifiquemos el estado del Programador:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>Si ya se están ejecutando, podemos recargarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>De lo contrario, tendremos que iniciarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Se puede encontrar más información en la <a href="#es-integrations-swarm">documentación de integración de Swarm</a>.</strong></p>
</div>
<div class="admonition info">
<p class="admonition-title">Modo multisitio habilitado</p>
<p>La integración <a href="#es-integrations-docker-autoconf">Swarm</a> implica el uso del modo multisitio: proteger una aplicación PHP es lo mismo que proteger varias.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Volumen compartido</p>
<p>Usar PHP con la integración de Docker Swarm necesita un volumen compartido entre todas las instancias de BunkerWeb y PHP-FPM, lo cual no se cubre en esta documentación.</p>
</div>
<p>Cuando se usa la integración <a href="#es-integrations-swarm">Swarm</a>, para admitir aplicaciones PHP, necesitarás:</p>
<ul>
<li>Montar tus archivos PHP en la carpeta <code>/var/www/html</code> de BunkerWeb</li>
<li>Configurar contenedores PHP-FPM para tus aplicaciones y montar la carpeta que contiene las aplicaciones PHP</li>
<li>Usar las configuraciones específicas <code>REMOTE_PHP</code> y <code>REMOTE_PHP_PATH</code> como etiquetas para tu contenedor PHP-FPM</li>
</ul>
<p>Dado que la integración de Swarm implica el uso del <a href="#es-concepts-multisite-mode">modo multisitio</a>, necesitarás crear directorios separados para cada una de tus aplicaciones. Cada subdirectorio debe tener el nombre del primer valor de <code>SERVER_NAME</code>. Aquí hay un ejemplo de prueba:</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directorios, 3 archivos
</code></pre></div>
<p>Como ejemplo, consideraremos que tienes una carpeta compartida montada en tus nodos de trabajo en el punto final <code>/shared</code>.</p>
<p>Una vez creadas las carpetas, copia tus archivos y corrige los permisos para que BunkerWeb (UID/GID 101) pueda al menos leer archivos y listar carpetas, y PHP-FPM (UID/GID 33 si usas la imagen <code>php:fpm</code>) sea el propietario de los archivos y carpetas:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>/shared/www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/shared/www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/shared/www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>Cuando inicies el stack de BunkerWeb, monta la carpeta <code>/shared/www</code> en <code>/var/www/html</code> para el contenedor del <strong>Scheduler</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/shared/www:/var/www/html</span>
<span class="nn">...</span>
</code></pre></div>
<p>Ahora puedes crear tus servicios PHP-FPM, montar las subcarpetas correctas y usar etiquetas para configurar BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app1.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp1</span>
<span class="w">      </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">          </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp1&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app2.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp2</span>
<span class="w">      </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">          </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp2&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp3</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app3.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp3</span>
<span class="w">      </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">          </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app3.example.com&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp3&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="es-advanced-ipv6">IPv6</h3>
<div class="admonition example">
<p class="admonition-title">Característica experimental</p>
<p>Esta característica no está lista para producción. Siéntete libre de probarla y reportarnos cualquier error usando los <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a> en el repositorio de GitHub.</p>
</div>
<p>Por defecto, BunkerWeb solo escuchará en direcciones IPv4 y no usará IPv6 para las comunicaciones de red. Si quieres habilitar el soporte de IPv6, necesitas establecer <code>USE_IPV6=yes</code>. Ten en cuenta que la configuración de IPv6 de tu red y entorno está fuera del alcance de esta documentación.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="es-advanced-__tabbed_11_1" name="es-advanced-__tabbed_11" type="radio" /><input id="es-advanced-__tabbed_11_2" name="es-advanced-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_11_1">Docker / Autoconf / Swarm</label><label for="es-advanced-__tabbed_11_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>En primer lugar, necesitarás configurar tu demonio de Docker para habilitar el soporte de IPv6 para los contenedores y usar ip6tables si es necesario. Aquí hay una configuración de ejemplo para tu archivo <code>/etc/docker/daemon.json</code>:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;experimental&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ipv6&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ip6tables&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;fixed-cidr-v6&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fd00:dead:beef::/48&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>Ahora puedes reiniciar el servicio de Docker para aplicar los cambios:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>docker
</code></pre></div>
<p>Una vez que Docker esté configurado para soportar IPv6, puedes agregar la configuración <code>USE_IPV6</code> y configurar la red <code>bw-services</code> para IPv6:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">USE_IPv6</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="nn">...</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">enable_ipv6</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fd00:13:37::/48</span>
<span class="w">          </span><span class="nt">gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fd00:13:37::1</span>

<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Necesitarás agregar la configuración al archivo <code>/etc/bunkerweb/variables.env</code>:</p>
<div class="highlight"><pre><span></span><code>...
USE_IPV6=yes
...
</code></pre></div>
<p>Verifiquemos el estado de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb
</code></pre></div>
<p>Si ya se está ejecutando, podemos reiniciarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb
</code></pre></div>
<p>De lo contrario, tendremos que iniciarlo:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-advanced-ajuste-de-seguridad">Ajuste de seguridad</h2>
<p>BunkerWeb ofrece muchas características de seguridad que puedes configurar con <a href="#es-features">características</a>. Aunque los valores predeterminados de las configuraciones aseguran una "seguridad por defecto" mínima, te recomendamos encarecidamente que los ajustes. Al hacerlo, podrás asegurar el nivel de seguridad de tu elección y también gestionar los falsos positivos.</p>
<div class="admonition tip">
<p class="admonition-title">Otras características</p>
<p>Esta sección solo se enfoca en el ajuste de seguridad, consulta la sección de <a href="#es-features">características</a> de la documentación para otras configuraciones.</p>
</div>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/core-order.svg" />
  </p>
<figcaption>Descripción general y orden de los plugins de seguridad principales</figcaption>
</figure>
<h2 id="es-advanced-integracion-con-la-consola-de-crowdsec">Integración con la Consola de CrowdSec</h2>
<p>Si aún no estás familiarizado con la integración de la Consola de CrowdSec, <a href="https://www.crowdsec.net/?utm_campaign=bunkerweb&amp;utm_source=doc">CrowdSec</a> aprovecha la inteligencia de la comunidad para combatir las amenazas cibernéticas. Piénsalo como el "Waze de la ciberseguridad"—cuando un servidor es atacado, otros sistemas en todo el mundo son alertados y protegidos de los mismos atacantes. Puedes aprender más sobre ello <a href="https://www.crowdsec.net/about?utm_campaign=bunkerweb&amp;utm_source=blog">aquí</a>.</p>
<p><strong>¡Felicidades, tu instancia de BunkerWeb ahora está inscrita en tu Consola de CrowdSec!</strong></p>
<p>Consejo profesional: Al ver tus alertas, haz clic en la opción "columnas" y marca la casilla "contexto" para acceder a los datos específicos de BunkerWeb.</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/crowdity4.png" />
  </p>
<figcaption>Datos de BunkerWeb mostrados en la columna de contexto</figcaption>
</figure>
<h2 id="es-advanced-monitoreo-y-reportes">Monitoreo y reportes</h2>
<h4 id="es-advanced-monitoreo-pro">Monitoreo <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>Soporte STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El plugin de monitoreo te permite recolectar y recuperar métricas sobre BunkerWeb. Al habilitarlo, tu(s) instancia(s) comenzará(n) a recolectar varios datos relacionados con ataques, solicitudes y rendimiento. Luego puedes recuperarlos llamando al punto final de la API <code>/monitoring</code> de forma regular o usando otros plugins como el exportador de Prometheus.</p>
<p><strong>Lista de características</strong></p>
<ul>
<li>Habilitar la recolección de varias métricas de BunkerWeb</li>
<li>Recuperar métricas de la API</li>
<li>Usar en combinación con otros plugins (p. ej. exportador de Prometheus)</li>
<li>Página de interfaz de usuario dedicada para monitorear tu(s) instancia(s)</li>
</ul>
<p><strong>Lista de configuraciones</strong></p>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_MONITORING</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td>Habilitar el monitoreo de BunkerWeb.</td>
</tr>
<tr>
<td><code>MONITORING_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Tamaño del diccionario para almacenar métricas de monitoreo.</td>
</tr>
</tbody>
</table>
<h4 id="es-advanced-exportador-de-prometheus-pro">Exportador de Prometheus <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>Soporte STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El plugin exportador de Prometheus agrega un <a href="https://prometheus.io/docs/instrumenting/exporters/">exportador de Prometheus</a> en tu(s) instancia(s) de BunkerWeb. Cuando está habilitado, puedes configurar tu(s) instancia(s) de Prometheus para que extraigan datos de un punto final específico en BunkerWeb y recopilen métricas internas.</p>
<p>También proporcionamos un <a href="https://grafana.com/grafana/dashboards/20755-bunkerweb/">panel de control de Grafana</a> que puedes importar en tu propia instancia y conectar a tu propia fuente de datos de Prometheus.</p>
<p><strong>Ten en cuenta que el uso del plugin exportador de Prometheus requiere habilitar el plugin de Monitoreo (<code>USE_MONITORING=yes</code>)</strong></p>
<p><strong>Lista de características</strong></p>
<ul>
<li>Exportador de Prometheus que proporciona métricas internas de BunkerWeb</li>
<li>Puerto, IP de escucha y URL dedicados y configurables</li>
<li>Lista blanca de IP/red para máxima seguridad</li>
</ul>
<p><strong>Lista de configuraciones</strong></p>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_PROMETHEUS_EXPORTER</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Habilitar el exportador de Prometheus.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_IP</code></td>
<td><code>0.0.0.0</code></td>
<td>global</td>
<td>no</td>
<td>IP de escucha del exportador de Prometheus.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_PORT</code></td>
<td><code>9113</code></td>
<td>global</td>
<td>no</td>
<td>Puerto de escucha del exportador de Prometheus.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_URL</code></td>
<td><code>/metrics</code></td>
<td>global</td>
<td>no</td>
<td>URL HTTP del exportador de Prometheus.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_ALLOW_IP</code></td>
<td><code>127.0.0.0/8 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16</code></td>
<td>global</td>
<td>no</td>
<td>Lista de IP/redes permitidas para contactar el punto final del exportador de Prometheus.</td>
</tr>
</tbody>
</table>
<h4 id="es-advanced-reportes-pro">Reportes <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>Soporte STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<div class="admonition warning">
<p class="admonition-title">Se necesita el plugin de Monitoreo</p>
<p>Este plugin requiere que el plugin de Monitoreo Pro esté instalado y habilitado con la configuración <code>USE_MONITORING</code> establecida en <code>yes</code>.</p>
</div>
<p>El plugin de Reportes proporciona una solución integral para la generación de informes periódicos de datos importantes de BunkerWeb, incluidas estadísticas globales, ataques, prohibiciones, solicitudes, motivos e información de AS. Ofrece una amplia gama de funciones, que incluyen la creación automática de informes, opciones de personalización y una integración perfecta con el plugin de monitoreo pro. Con el plugin de Reportes, puedes generar y gestionar fácilmente informes para monitorear el rendimiento y la seguridad de tu aplicación.</p>
<p><strong>Lista de características</strong></p>
<ul>
<li>Informes periódicos de datos importantes de BunkerWeb, incluidas estadísticas globales, ataques, prohibiciones, solicitudes, motivos e información de AS.</li>
<li>Integración con el plugin Monitoring Pro para una integración perfecta y capacidades de generación de informes mejoradas.</li>
<li>Soporte para webhooks (clásico, Discord y Slack) para notificaciones en tiempo real.</li>
<li>Soporte para SMTP para notificaciones por correo electrónico.</li>
<li>Opciones de configuración para personalización y flexibilidad.</li>
</ul>
<p><strong>Lista de configuraciones</strong></p>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Predeterminado</th>
<th>Contexto</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REPORTING_SMTP</code></td>
<td><code>no</code></td>
<td>global</td>
<td>Habilitar el envío del informe por correo electrónico.</td>
</tr>
<tr>
<td><code>USE_REPORTING_WEBHOOK</code></td>
<td><code>no</code></td>
<td>global</td>
<td>Habilitar el envío del informe a través de webhook.</td>
</tr>
<tr>
<td><code>REPORTING_SCHEDULE</code></td>
<td><code>weekly</code></td>
<td>global</td>
<td>La frecuencia con la que se envían los informes.</td>
</tr>
<tr>
<td><code>REPORTING_WEBHOOK_URLS</code></td>
<td></td>
<td>global</td>
<td>Lista de URLs de webhook para recibir el informe en Markdown (separadas por espacios).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_EMAILS</code></td>
<td></td>
<td>global</td>
<td>Lista de direcciones de correo electrónico para recibir el informe en formato HTML (separadas por espacios).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_HOST</code></td>
<td></td>
<td>global</td>
<td>El servidor anfitrión utilizado para el envío SMTP.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_PORT</code></td>
<td><code>465</code></td>
<td>global</td>
<td>El puerto utilizado para SMTP. Ten en cuenta que existen diferentes estándares según el tipo de conexión (SSL = 465, TLS = 587).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_EMAIL</code></td>
<td></td>
<td>global</td>
<td>La dirección de correo electrónico utilizada como remitente. Ten en cuenta que la 2FA debe estar deshabilitada para esta dirección de correo electrónico.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_USER</code></td>
<td></td>
<td>global</td>
<td>El valor de autenticación del usuario para enviar a través de la dirección de correo electrónico del remitente.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>El valor de autenticación de la contraseña para enviar a través de la dirección de correo electrónico del remitente.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SSL</code></td>
<td><code>SSL</code></td>
<td>global</td>
<td>Determinar si se debe utilizar o no una conexión segura para SMTP.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SUBJECT</code></td>
<td><code>BunkerWeb Report</code></td>
<td>global</td>
<td>La línea de asunto del correo electrónico.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Información y comportamiento</p>
<ul>
<li>si <code>USE_REPORTING_SMTP</code> se establece en <code>yes</code>, se debe establecer la configuración <code>REPORTING_SMTP_EMAILS</code>.</li>
<li>si <code>USE_REPORTING_WEBHOOK</code> se establece en <code>yes</code>, se debe establecer la configuración <code>REPORTING_WEBHOOK_URLS</code>.</li>
<li>Los valores aceptados para <code>REPORTING_SCHEDULE</code> son <code>daily</code>, <code>weekly</code> y <code>monthly</code>.</li>
<li>si no se establecen <code>REPORTING_SMTP_FROM_USER</code> y <code>REPORTING_SMTP_FROM_PASSWORD</code>, el plugin intentará enviar el correo electrónico sin autenticación.</li>
<li>si <code>REPORTING_SMTP_FROM_USER</code> no está configurado pero <code>REPORTING_SMTP_FROM_PASSWORD</code> sí, el plugin utilizará <code>REPORTING_SMTP_FROM_EMAIL</code> como nombre de usuario.</li>
<li>si el trabajo falla, el plugin volverá a intentar enviar el informe en la siguiente ejecución.</li>
</ul>
</div>
<h3 id="es-advanced-copia-de-seguridad-y-restauracion">Copia de seguridad y restauración</h3>
<h4 id="es-advanced-copia-de-seguridad-s3-pro">Copia de seguridad S3 <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>Soporte STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>La herramienta de Copia de seguridad S3 automatiza sin problemas la protección de datos, de forma similar al plugin de copia de seguridad de la comunidad. Sin embargo, se destaca por almacenar de forma segura las copias de seguridad directamente en un bucket S3.</p>
<p>Al activar esta función, estás salvaguardando proactivamente la <strong>integridad de tus datos</strong>. Almacenar las copias de seguridad de forma <strong>remota</strong> protege la información crucial de amenazas como <strong>fallos de hardware</strong>, <strong>ciberataques</strong> o <strong>desastres naturales</strong>. Esto garantiza tanto la <strong>seguridad</strong> como la <strong>disponibilidad</strong>, permitiendo una rápida recuperación durante <strong>eventos inesperados</strong>, preservando la <strong>continuidad operativa</strong> y asegurando la <strong>tranquilidad</strong>.</p>
<details class="warning">
<summary>Información para usuarios de Red Hat Enterprise Linux (RHEL) 8.9</summary>
<p>Si estás utilizando <strong>RHEL 8.9</strong> y planeas usar una <strong>base de datos externa</strong>, necesitarás instalar el paquete <code>mysql-community-client</code> para asegurar que el comando <code>mysqldump</code> esté disponible. Puedes instalar el paquete ejecutando los siguientes comandos:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="es-advanced-__tabbed_12_1" name="es-advanced-__tabbed_12" type="radio" /><input id="es-advanced-__tabbed_12_2" name="es-advanced-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_12_1">MySQL/MariaDB</label><label for="es-advanced-__tabbed_12_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Instalar el paquete de configuración del repositorio de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>https://dev.mysql.com/get/mysql80-community-release-el8-9.noarch.rpm
</code></pre></div>
</li>
<li>
<p><strong>Habilitar el repositorio de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--enable<span class="w"> </span>mysql80-community
</code></pre></div>
</li>
<li>
<p><strong>Instalar el cliente de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql-community-client
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Instalar el paquete de configuración del repositorio de PostgreSQL</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">/pgdg-redhat-repo-latest.noarch.rpm&quot;</span>
</code></pre></div>
</li>
<li>
<p><strong>Instalar el cliente de PostgreSQL</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span>postgresql&lt;version&gt;
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</details>
<p><strong>Lista de características</strong></p>
<ul>
<li>Copia de seguridad automática de datos a un bucket S3</li>
<li>Opciones de programación flexibles: diaria, semanal o mensual</li>
<li>Gestión de rotación para controlar el número de copias de seguridad a mantener</li>
<li>Nivel de compresión personalizable para los archivos de copia de seguridad</li>
</ul>
<p><strong>Lista de configuraciones</strong></p>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Predeterminado</th>
<th>Contexto</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BACKUP_S3</code></td>
<td><code>no</code></td>
<td>global</td>
<td>Habilitar o deshabilitar la función de copia de seguridad S3</td>
</tr>
<tr>
<td><code>BACKUP_S3_SCHEDULE</code></td>
<td><code>daily</code></td>
<td>global</td>
<td>La frecuencia de la copia de seguridad</td>
</tr>
<tr>
<td><code>BACKUP_S3_ROTATION</code></td>
<td><code>7</code></td>
<td>global</td>
<td>El número de copias de seguridad a mantener</td>
</tr>
<tr>
<td><code>BACKUP_S3_ENDPOINT</code></td>
<td></td>
<td>global</td>
<td>El punto final S3</td>
</tr>
<tr>
<td><code>BACKUP_S3_BUCKET</code></td>
<td></td>
<td>global</td>
<td>El bucket S3</td>
</tr>
<tr>
<td><code>BACKUP_S3_DIR</code></td>
<td></td>
<td>global</td>
<td>El directorio S3</td>
</tr>
<tr>
<td><code>BACKUP_S3_REGION</code></td>
<td></td>
<td>global</td>
<td>La región S3</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_ID</code></td>
<td></td>
<td>global</td>
<td>El ID de la clave de acceso S3</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_SECRET</code></td>
<td></td>
<td>global</td>
<td>El secreto de la clave de acceso S3</td>
</tr>
<tr>
<td><code>BACKUP_S3_COMP_LEVEL</code></td>
<td><code>6</code></td>
<td>global</td>
<td>El nivel de compresión del archivo zip de la copia de seguridad</td>
</tr>
</tbody>
</table>
<h5 id="es-advanced-copia-de-seguridad-manual">Copia de seguridad manual</h5>
<p>Para iniciar manualmente una copia de seguridad, ejecuta el siguiente comando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="es-advanced-__tabbed_13_1" name="es-advanced-__tabbed_13" type="radio" /><input id="es-advanced-__tabbed_13_2" name="es-advanced-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_13_1">Linux</label><label for="es-advanced-__tabbed_13_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
</div>
</div>
<p>Este comando creará una copia de seguridad de tu base de datos y la almacenará en el bucket S3 especificado en la configuración <code>BACKUP_S3_BUCKET</code>.</p>
<p>También puedes especificar un bucket S3 personalizado para la copia de seguridad proporcionando la variable de entorno <code>BACKUP_S3_BUCKET</code> al ejecutar el comando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="es-advanced-__tabbed_14_1" name="es-advanced-__tabbed_14" type="radio" /><input id="es-advanced-__tabbed_14_2" name="es-advanced-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_14_1">Linux</label><label for="es-advanced-__tabbed_14_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">BACKUP_S3_BUCKET</span><span class="o">=</span>your-bucket-name<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">BACKUP_S3_BUCKET</span><span class="o">=</span>your-bucket-name<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Especificaciones para MariaDB/MySQL</p>
<p>En caso de que estés usando MariaDB/MySQL, puedes encontrar el siguiente error al intentar hacer una copia de seguridad de tu base de datos:</p>
<div class="highlight"><pre><span></span><code>caching_sha2_password<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>loaded:<span class="w"> </span>Error<span class="w"> </span>loading<span class="w"> </span>shared<span class="w"> </span>library<span class="w"> </span>/usr/lib/mariadb/plugin/caching_sha2_password.so
</code></pre></div>
<p>Para resolver este problema, puedes ejecutar el siguiente comando para cambiar el plugin de autenticación a <code>mysql_native_password</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;yourusername&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">mysql_native_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;youpassword&#39;</span><span class="p">;</span>
</code></pre></div>
<p>Si estás usando la integración de Docker, puedes agregar el siguiente comando al archivo <code>docker-compose.yml</code> para cambiar automáticamente el plugin de autenticación:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="es-advanced-__tabbed_15_1" name="es-advanced-__tabbed_15" type="radio" /><input id="es-advanced-__tabbed_15_2" name="es-advanced-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_15_1">MariaDB</label><label for="es-advanced-__tabbed_15_2">MySQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<h5 id="es-advanced-restauracion-manual">Restauración manual</h5>
<p>Para iniciar manualmente una restauración, ejecuta el siguiente comando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="es-advanced-__tabbed_16_1" name="es-advanced-__tabbed_16" type="radio" /><input id="es-advanced-__tabbed_16_2" name="es-advanced-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_16_1">Linux</label><label for="es-advanced-__tabbed_16_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
</div>
</div>
<p>Este comando creará una copia de seguridad temporal de tu base de datos en el bucket S3 especificado en la configuración <code>BACKUP_S3_BUCKET</code> y restaurará tu base de datos a la última copia de seguridad disponible en el bucket.</p>
<p>También puedes especificar un archivo de copia de seguridad personalizado para la restauración proporcionando la ruta al mismo como argumento al ejecutar el comando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="es-advanced-__tabbed_17_1" name="es-advanced-__tabbed_17" type="radio" /><input id="es-advanced-__tabbed_17_2" name="es-advanced-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_17_1">Linux</label><label for="es-advanced-__tabbed_17_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore<span class="w"> </span>s3_backup_file.zip
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>restore<span class="w"> </span>s3_backup_file.zip
</code></pre></div>
</div>
</div>
</div>
<div class="admonition example">
<p class="admonition-title">En caso de fallo</p>
<p>No te preocupes si la restauración falla, siempre puedes restaurar tu base de datos al estado anterior ejecutando el comando de nuevo, ya que se crea una copia de seguridad antes de la restauración:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="es-advanced-__tabbed_18_1" name="es-advanced-__tabbed_18" type="radio" /><input id="es-advanced-__tabbed_18_2" name="es-advanced-__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_18_1">Linux</label><label for="es-advanced-__tabbed_18_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
</div>
</div>
</div>
<h3 id="es-advanced-migracion-pro">Migración <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h3>
<p>Soporte STREAM <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>El plugin de Migración <strong>revoluciona</strong> las transferencias de configuración de BunkerWeb entre instancias con su <strong>interfaz web fácil de usar</strong>, simplificando todo el proceso de migración. Ya sea que estés actualizando sistemas, escalando la infraestructura o haciendo la transición de entornos, esta herramienta te permite transferir sin esfuerzo <strong>configuraciones, preferencias y datos</strong> con una facilidad y confianza inigualables. Di adiós a los engorrosos procesos manuales y hola a una <strong>experiencia de migración fluida y sin complicaciones</strong>.</p>
<p><strong>Lista de características</strong></p>
<ul>
<li>
<p><strong>Migración sin esfuerzo:</strong> Transfiere fácilmente las configuraciones de BunkerWeb entre instancias sin las complejidades de los procedimientos manuales.</p>
</li>
<li>
<p><strong>Interfaz web intuitiva:</strong> Navega por el proceso de migración sin esfuerzo con una interfaz web fácil de usar diseñada para una operación intuitiva.</p>
</li>
<li>
<p><strong>Compatibilidad entre bases de datos:</strong> Disfruta de una migración fluida a través de varias plataformas de bases de datos, incluidas SQLite, MySQL, MariaDB y PostgreSQL, lo que garantiza la compatibilidad con tu entorno de base de datos preferido.</p>
</li>
</ul>
<h4 id="es-advanced-crear-un-archivo-de-migracion">Crear un archivo de migración</h4>
<p>Para crear manualmente un archivo de migración, ejecuta el siguiente comando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="es-advanced-__tabbed_19_1" name="es-advanced-__tabbed_19" type="radio" /><input id="es-advanced-__tabbed_19_2" name="es-advanced-__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_19_1">Linux</label><label for="es-advanced-__tabbed_19_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>create<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p>Crear un archivo de migración:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>create<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
<li>
<p>Copiar el archivo de migración a tu máquina local:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/migration/file<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
<p>Este comando creará una copia de seguridad de tu base de datos y la almacenará en el directorio de copia de seguridad especificado en el comando.</p>
<div class="admonition note">
<p class="admonition-title">Especificaciones para MariaDB/MySQL</p>
<p>En caso de que estés usando MariaDB/MySQL, puedes encontrar el siguiente error al intentar hacer una copia de seguridad de tu base de datos:</p>
<div class="highlight"><pre><span></span><code>caching_sha2_password<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>loaded:<span class="w"> </span>Error<span class="w"> </span>loading<span class="w"> </span>shared<span class="w"> </span>library<span class="w"> </span>/usr/lib/mariadb/plugin/caching_sha2_password.so
</code></pre></div>
<p>Para resolver este problema, puedes ejecutar el siguiente comando para cambiar el plugin de autenticación a <code>mysql_native_password</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;yourusername&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">mysql_native_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;youpassword&#39;</span><span class="p">;</span>
</code></pre></div>
<p>Si estás usando la integración de Docker, puedes agregar el siguiente comando al archivo <code>docker-compose.yml</code> para cambiar automáticamente el plugin de autenticación:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="es-advanced-__tabbed_20_1" name="es-advanced-__tabbed_20" type="radio" /><input id="es-advanced-__tabbed_20_2" name="es-advanced-__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_20_1">MariaDB</label><label for="es-advanced-__tabbed_20_2">MySQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<h4 id="es-advanced-iniciar-una-migracion">Iniciar una migración</h4>
<p>Para iniciar manualmente una migración, ejecuta el siguiente comando:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:3"><input checked="checked" id="es-advanced-__tabbed_21_1" name="es-advanced-__tabbed_21" type="radio" /><input id="es-advanced-__tabbed_21_2" name="es-advanced-__tabbed_21" type="radio" /><input id="es-advanced-__tabbed_21_3" name="es-advanced-__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="es-advanced-__tabbed_21_1">Linux</label><label for="es-advanced-__tabbed_21_2">Docker</label><label for="es-advanced-__tabbed_21_3">Todo en uno</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>migrate<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p>Copia el archivo de migración al contenedor:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>/path/to/migration/file<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/migration/file
</code></pre></div>
</li>
<li>
<p>Inicia la migración:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>migrate<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p>Copia el archivo de migración al contenedor:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>/path/to/migration/file<span class="w"> </span>bunkerweb-aio:/path/to/migration/file
</code></pre></div>
</li>
<li>
<p>Inicia la migración:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>bunkerweb-aio<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>migrate<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
<p>Este comando migra sin problemas tus datos de BunkerWeb para que coincidan precisamente con la configuración descrita en el archivo de migración.</p>
<h2 id="es-advanced-anti-ddos-pro">Anti DDoS <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h2>
<p>Soporte STREAM <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>El plugin <strong>Anti DDoS</strong> proporciona protección avanzada contra ataques de denegación de servicio distribuido (DDoS) mediante el monitoreo, análisis y filtrado de tráfico sospechoso en tiempo real.</p>
<p>Mediante el empleo de un <strong>mecanismo de ventana deslizante</strong>, el plugin mantiene un diccionario en memoria de las marcas de tiempo de las solicitudes para detectar picos de tráfico anormales de direcciones IP individuales. Según el modo de seguridad configurado, puede bloquear las conexiones ofensivas o registrar la actividad sospechosa para una revisión posterior.</p>
<h4 id="es-advanced-caracteristicas">Características</h4>
<ul>
<li><strong>Análisis de tráfico en tiempo real:</strong> Monitorea continuamente las solicitudes entrantes para detectar posibles ataques DDoS.</li>
<li><strong>Mecanismo de ventana deslizante:</strong> Rastrea la actividad de solicitudes recientes dentro de una ventana de tiempo configurable.</li>
<li><strong>Umbrales configurables:</strong> Te permite definir el número máximo de solicitudes sospechosas por IP.</li>
<li><strong>Lógica de bloqueo avanzada:</strong> Evalúa tanto el recuento de solicitudes por IP como el número de IP distintas que superan el umbral.</li>
<li><strong>Modos de seguridad flexibles:</strong> Elige entre el bloqueo inmediato de la conexión o el modo de solo detección (registro).</li>
<li><strong>Almacén de datos en memoria optimizado:</strong> Garantiza búsquedas de alta velocidad y un seguimiento eficiente de las métricas.</li>
<li><strong>Mantenimiento automático:</strong> Borra periódicamente los datos obsoletos para mantener un rendimiento óptimo.</li>
</ul>
<h4 id="es-advanced-configuracion">Configuración</h4>
<p>Personaliza el comportamiento del plugin usando las siguientes configuraciones:</p>
<table>
<thead>
<tr>
<th>Configuración</th>
<th>Predeterminado</th>
<th>Contexto</th>
<th>Múltiple</th>
<th>Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIDDOS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Habilita o deshabilita la protección Anti DDoS. Establécelo en <code>"yes"</code> para activar el plugin.</td>
</tr>
<tr>
<td><code>ANTIDDOS_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Tamaño del almacén de datos en memoria para el seguimiento de métricas de DDoS (p. ej., <code>10M</code>, <code>500k</code>).</td>
</tr>
<tr>
<td><code>ANTIDDOS_THRESHOLD</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td>Número máximo de solicitudes sospechosas permitidas por IP dentro de la ventana de tiempo definida.</td>
</tr>
<tr>
<td><code>ANTIDDOS_WINDOW_TIME</code></td>
<td><code>10</code></td>
<td>global</td>
<td>no</td>
<td>Ventana de tiempo en segundos durante la cual se cuentan las solicitudes sospechosas.</td>
</tr>
<tr>
<td><code>ANTIDDOS_STATUS_CODES</code></td>
<td><code>429 403 444</code></td>
<td>global</td>
<td>no</td>
<td>Códigos de estado HTTP considerados sospechosos y utilizados para activar acciones anti-DDoS.</td>
</tr>
<tr>
<td><code>ANTIDDOS_DISTINCT_IP</code></td>
<td><code>5</code></td>
<td>global</td>
<td>no</td>
<td>Número mínimo de IP distintas que deben superar el umbral antes de aplicar el modo de bloqueo.</td>
</tr>
</tbody>
</table>
<h4 id="es-advanced-mejores-practicas">Mejores prácticas</h4>
<ul>
<li><strong>Ajuste de umbrales:</strong> Ajusta <code>ANTIDDOS_THRESHOLD</code> y <code>ANTIDDOS_WINDOW_TIME</code> según tus patrones de tráfico típicos.</li>
<li><strong>Revisión de códigos de estado:</strong> Actualiza regularmente <code>ANTIDDOS_STATUS_CODES</code> para capturar comportamientos sospechosos nuevos o en evolución.</li>
<li><strong>Monitoreo:</strong> Analiza los registros y las métricas periódicamente para ajustar la configuración y mejorar la protección general.</li>
</ul>
<h2 id="es-advanced-administrador-de-usuarios-pro">Administrador de usuarios <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h2>
<p>El Plugin de gestión de usuarios ofrece una interfaz robusta para administrar cuentas de usuario dentro de tu sistema.</p>
<p>Con este plugin, los administradores pueden crear, actualizar y deshabilitar cuentas de usuario sin esfuerzo, gestionar roles de usuario, activar o desactivar la autenticación de dos factores (2FA) y ver información detallada del usuario, como las marcas de tiempo del último inicio de sesión y los estados de la cuenta (activa o inactiva). Diseñado teniendo en cuenta la seguridad y la facilidad de uso, este plugin simplifica las tareas rutinarias de gestión de usuarios al tiempo que garantiza el cumplimiento y la auditabilidad.</p>
<h4 id="es-advanced-caracteristicas_1">Características</h4>
<ul>
<li><strong>Operaciones de cuenta de usuario:</strong> Importar en formato CSV/XSLX, crear, editar y eliminar cuentas de usuario con facilidad.</li>
<li><strong>Control de acceso basado en roles:</strong> Asigna y modifica roles de usuario para gestionar permisos y niveles de acceso.</li>
<li><strong>Gestión de 2FA:</strong> Desactiva la autenticación de dos factores según las decisiones administrativas.</li>
<li><strong>Información completa del usuario:</strong> Supervisa los datos clave del usuario, incluidas las últimas horas de inicio de sesión, las fechas de creación de la cuenta y el estado activo/inactivo.</li>
<li><strong>Registro de auditoría:</strong> Mantiene un registro de auditoría de todas las acciones de gestión de usuarios para mejorar la seguridad y el cumplimiento.</li>
</ul>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/user-manager.png" />
  </p>
<figcaption>Página del Administrador de usuarios</figcaption>
</figure>
<figure>
<p><img align="center" alt="Formulario de creación de usuario" src="../assets/img/user-manager-create.png" />
  </p>
<figcaption>Administrador de usuarios - Formulario de creación de usuario</figcaption>
</figure>
<figure>
<p><img align="center" alt="Página de actividades" src="../assets/img/user-manager-activities.png" />
  </p>
<figcaption>Administrador de usuarios - Página de actividades</figcaption>
</figure>
<h2 id="es-advanced-easy-resolve-pro">Easy Resolve <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h2>
<p>El plugin Easy Resolve te permite remediar rápidamente falsos positivos y problemas recurrentes directamente desde la página de Informes. Convierte las acciones guiadas de "Resolver" en actualizaciones de configuración seguras y acotadas, sin edición manual.</p>
<h4 id="es-advanced-caracteristicas_2">Características</h4>
<ul>
<li>Acciones con un solo clic desde Informes y detalles del informe.</li>
<li>Sugerencias contextuales para ModSecurity, lista negra y DNSBL.</li>
<li>Genera exclusiones seguras de ModSecurity o actualiza las listas de ignorados.</li>
<li>Aplica cambios a nivel de servicio o global con comprobaciones de permisos.</li>
<li>Apertura automática opcional de la página de configuración relacionada después de aplicar.</li>
</ul>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/easy-resolve.png" />
  </p>
<figcaption>Página de informes - con Easy Resolve</figcaption>
</figure>
<div class="grid grid-2">
<figure>
<p><img alt="Resolución de ModSecurity" src="../assets/img/easy-resolve-modsecurity.png" width="100%" />
  </p>
<figcaption>Resolución de ModSecurity</figcaption>
</figure>
<figure>
<p><img alt="Resolución de DNSBL" src="../assets/img/easy-resolve-dnsbl.png" width="100%" />
  </p>
<figcaption>Resolución de DNSBL</figcaption>
</figure>
</div>
<div class="grid grid-5">
<figure>
<p><img alt="Resolución de lista negra - IP" src="../assets/img/easy-resolve-blacklist-ip.png" width="100%" />
  </p>
<figcaption>Lista negra - IP</figcaption>
</figure>
<figure>
<p><img alt="Resolución de lista negra - User-Agent" src="../assets/img/easy-resolve-blacklist-ua.png" width="100%" />
  </p>
<figcaption>Lista negra - User-Agent</figcaption>
</figure>
<figure>
<p><img alt="Resolución de lista negra - rDNS" src="../assets/img/easy-resolve-blacklist-rdns.png" width="100%" />
  </p>
<figcaption>Lista negra - rDNS</figcaption>
</figure>
<figure>
<p><img alt="Resolución de lista negra - ASN" src="../assets/img/easy-resolve-blacklist-asn.png" width="100%" />
  </p>
<figcaption>Lista negra - ASN</figcaption>
</figure>
<figure>
<p><img alt="Resolución de lista negra - URI" src="../assets/img/easy-resolve-blacklist-uri.png" width="100%" />
  </p>
<figcaption>Lista negra - URI</figcaption>
</figure>
</div></section><section class="print-page" id="es-web-ui" heading-number="7"><h1 id="es-web-ui-interfaz-de-usuario-web">Interfaz de usuario web</h1>
<h2 id="es-web-ui-descripcion-general">Descripción general</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/tGS3pzquEjY" title="Interfaz de usuario web de BunkerWeb" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<p>La "Interfaz de usuario web" es una aplicación web que te ayuda a gestionar tu instancia de BunkerWeb utilizando una interfaz fácil de usar en lugar de depender únicamente de la línea de comandos.</p>
<p>Aquí tienes una lista de las características que ofrece la interfaz de usuario web:</p>
<ul>
<li>Obtén una vista completa de los ataques bloqueados</li>
<li>Inicia, detén, reinicia y recarga tu instancia de BunkerWeb</li>
<li>Añade, edita y elimina configuraciones para tus aplicaciones web</li>
<li>Añade, edita y elimina configuraciones personalizadas para NGINX y ModSecurity</li>
<li>Instala y desinstala plugins externos</li>
<li>Explora los archivos en caché</li>
<li>Supervisa la ejecución de los trabajos y reinícialos según sea necesario</li>
<li>Visualiza los registros y busca patrones</li>
</ul>
<h2 id="es-web-ui-requisitos-previos">Requisitos previos</h2>
<p>Dado que la interfaz de usuario web es una aplicación web, la arquitectura recomendada es ejecutar BunkerWeb delante de ella como un proxy inverso. El procedimiento de instalación recomendado es utilizar el asistente de configuración, que te guiará paso a paso como se describe en la <a href="#es-quickstart-guide">guía de inicio rápido</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Consideraciones de seguridad</p>
<p>La seguridad de la interfaz de usuario web es extremadamente importante. Si una persona no autorizada obtiene acceso a la aplicación, no solo podrá editar tus configuraciones, sino que también podría ejecutar código en el contexto de BunkerWeb (por ejemplo, a través de una configuración personalizada que contenga código LUA). Te recomendamos encarecidamente que sigas las mejores prácticas de seguridad mínimas, como:</p>
<ul>
<li>Elige una contraseña segura para el inicio de sesión (<strong>al menos 8 caracteres, incluyendo 1 letra minúscula, 1 letra mayúscula, 1 dígito y 1 carácter especial</strong>)</li>
<li>Coloca la interfaz de usuario web bajo una URI "difícil de adivinar"</li>
<li>Habilita la autenticación de dos factores (2FA)</li>
<li>No expongas la interfaz de usuario web a Internet sin restricciones adicionales</li>
<li>Aplica las mejores prácticas enumeradas en la <a href="#es-advanced-security-tuning">sección de usos avanzados</a> de la documentación según tu caso de uso</li>
</ul>
</div>
<h2 id="es-web-ui-actualizar-a-pro">Actualizar a PRO</h2>
<div class="admonition tip">
<p class="admonition-title">Prueba gratuita de BunkerWeb PRO</p>
<p>¿Quieres probar rápidamente BunkerWeb PRO durante un mes? Usa el código <code>freetrial</code> al realizar tu pedido en el <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">panel de BunkerWeb</a> o haciendo clic <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">aquí</a> para aplicar directamente el código de promoción (se hará efectivo al finalizar la compra).</p>
</div>
<p>Una vez que tengas tu clave de licencia PRO del <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">panel de BunkerWeb</a>, puedes pegarla en la página PRO de la interfaz de usuario web.</p>
<figure>
<p><img align="center," alt="Actualización PRO" src="../assets/img/pro-ui-upgrade.png" width="700" />
  </p>
<figcaption>Actualizar a PRO desde la interfaz de usuario web</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Tiempo de actualización</p>
<p>La versión PRO se descarga en segundo plano por el programador, puede tardar un tiempo en actualizarse.</p>
</div>
<p>Cuando tu instancia de BunkerWeb se haya actualizado a la versión PRO, verás la fecha de caducidad de tu licencia y el número máximo de servicios que puedes proteger.</p>
<figure>
<p><img align="center," alt="Actualización PRO" src="../assets/img/ui-pro.png" width="700" />
  </p>
<figcaption>Información de la licencia PRO</figcaption>
</figure>
<h2 id="es-web-ui-acceso-a-los-registros">Acceso a los registros</h2>
<p>A partir de la versión <code>1.6</code>, el método de acceso a los registros ha cambiado. Esta actualización afecta específicamente a las integraciones basadas en contenedores: la interfaz de usuario web ahora leerá los archivos de registro del directorio <code>/var/log/bunkerweb</code>.</p>
<p>Para mantener los registros accesibles desde la interfaz de usuario web, te recomendamos que utilices un servidor de syslog, como <code>syslog-ng</code>, para leer los registros y crear los archivos correspondientes en el directorio <code>/var/log/bunkerweb</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Uso de una carpeta local para los registros</p>
<p>La interfaz de usuario web se ejecuta como un <strong>usuario sin privilegios con UID 101 y GID 101</strong> dentro del contenedor por razones de seguridad: en caso de que se explote una vulnerabilidad, el atacante no tendrá privilegios completos de root (UID/GID 0).</p>
<p>Sin embargo, hay una desventaja: si utilizas una <strong>carpeta local para los registros</strong>, debes <strong>establecer los permisos correctos</strong> para que el usuario sin privilegios pueda leer los archivos de registro. Por ejemplo:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
<p>Alternativamente, si la carpeta ya existe:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
<p>Si estás utilizando <a href="https://docs.docker.com/engine/security/rootless">Docker en modo sin raíz</a> o <a href="https://podman.io/">podman</a>, los UID y GID en el contenedor se mapearán a diferentes en el host. Primero necesitarás verificar tu subuid y subgid iniciales:</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>Por ejemplo, si tienes un valor de <strong>100000</strong>, el UID/GID mapeado será <strong>100100</strong> (100000 + 100):</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
<p>O si la carpeta ya existe:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
</div>
<h3 id="es-web-ui-plantillas-de-compose">Plantillas de Compose</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="es-web-ui-__tabbed_1_1" name="es-web-ui-__tabbed_1" type="radio" /><input id="es-web-ui-__tabbed_1_2" name="es-web-ui-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-web-ui-__tabbed_1_1">Docker</label><label for="es-web-ui-__tabbed_1_2">Docker Autoconf</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Para reenviar los registros correctamente al directorio <code>/var/log/bunkerweb</code> en la integración de Docker, necesitarás transmitir los registros a un archivo usando <code>syslog-ng</code>. Aquí hay un ejemplo de cómo hacerlo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># Anclamos las variables de entorno para evitar la duplicación</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">  </span><span class="c1"># Token de API opcional al asegurar el acceso a la API</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Esta será la etiqueta utilizada por syslog-ng para crear el archivo de registro</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del contenedor de syslog-ng</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Asegúrate de establecer el nombre de instancia correcto</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">      </span><span class="nt">SERVE_FILES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="w">      </span><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_TEMPLATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ui&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/changeme&quot;</span><span class="w"> </span><span class="c1"># Cámbialo a una URI difícil de adivinar</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-scheduler&quot;</span><span class="w"> </span><span class="c1"># Esta será la etiqueta utilizada por syslog-ng para crear el archivo de registro</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del contenedor de syslog-ng</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para el usuario administrador</span>
<span class="w">      </span><span class="nt">TOTP_ENCRYPTION_KEYS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una clave secreta más segura (consulta la sección de Requisitos previos)</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span><span class="w"> </span><span class="c1"># Este es el volumen utilizado para almacenar los registros</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-ui&quot;</span><span class="w"> </span><span class="c1"># Esta será la etiqueta utilizada por syslog-ng para crear el archivo de registro</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del contenedor de syslog-ng</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-syslog</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balabit/syslog-ng:4.9.0</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span><span class="w">  </span><span class="c1"># Enlazar a puertos bajos</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BROADCAST</span><span class="w">  </span><span class="c1"># Enviar broadcasts</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_RAW</span><span class="w">  </span><span class="c1"># Usar sockets raw</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_READ_SEARCH</span><span class="w">  </span><span class="c1"># Leer archivos omitiendo permisos</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_OVERRIDE</span><span class="w">  </span><span class="c1"># Omitir permisos de archivo</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CHOWN</span><span class="w">  </span><span class="c1"># Cambiar propietario</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SYSLOG</span><span class="w">  </span><span class="c1"># Escribir en los registros del sistema</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span><span class="w"> </span><span class="c1"># Este es el volumen utilizado para almacenar los registros</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./syslog-ng.conf:/etc/syslog-ng/syslog-ng.conf</span><span class="w"> </span><span class="c1"># Este es el archivo de configuración de syslog-ng</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.254</span><span class="w"> </span><span class="c1"># Asegúrate de establecer la dirección IP correcta</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-logs</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Para reenviar los registros correctamente al directorio <code>/var/log/bunkerweb</code> en la integración de Autoconf, necesitarás transmitir los registros a un archivo usando <code>syslog-ng</code>. Aquí hay un ejemplo de cómo hacerlo:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-ui-env</span>
<span class="w">  </span><span class="c1"># Anclamos las variables de entorno para evitar la duplicación</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Esta será la etiqueta utilizada por syslog-ng para crear el archivo de registro</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del contenedor de syslog-ng</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># No necesitamos especificar la instancia de BunkerWeb aquí, ya que son detectadas automáticamente por el servicio de autoconfiguración</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># El nombre del servidor se rellenará con las etiquetas de los servicios</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Configuración obligatoria para autoconfiguración / ui</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-scheduler&quot;</span><span class="w"> </span><span class="c1"># Esta será la etiqueta utilizada por syslog-ng para crear el archivo de registro</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del contenedor de syslog-ng</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del socket de Docker</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-autoconf&quot;</span><span class="w"> </span><span class="c1"># Esta será la etiqueta utilizada por syslog-ng para crear el archivo de registro</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del contenedor de syslog-ng</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para el usuario administrador</span>
<span class="w">      </span><span class="nt">TOTP_ENCRYPTION_KEYS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una clave secreta más segura (consulta la sección de Requisitos previos)</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_TEMPLATE=ui&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/changeme&quot;</span><span class="w"> </span><span class="c1"># Cámbialo a una URI difícil de adivinar</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://bw-ui:7000&quot;</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-ui&quot;</span><span class="w"> </span><span class="c1"># Esta será la etiqueta utilizada por syslog-ng para crear el archivo de registro</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># Esta es la dirección del contenedor de syslog-ng</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-syslog</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balabit/syslog-ng:4.9.0</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span><span class="w">  </span><span class="c1"># Enlazar a puertos bajos</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BROADCAST</span><span class="w">  </span><span class="c1"># Enviar broadcasts</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_RAW</span><span class="w">  </span><span class="c1"># Usar sockets raw</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_READ_SEARCH</span><span class="w">  </span><span class="c1"># Leer archivos omitiendo permisos</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_OVERRIDE</span><span class="w">  </span><span class="c1"># Omitir permisos de archivo</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CHOWN</span><span class="w">  </span><span class="c1"># Cambiar propietario</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SYSLOG</span><span class="w">  </span><span class="c1"># Escribir en los registros del sistema</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span><span class="w"> </span><span class="c1"># Este es el volumen utilizado para almacenar los registros</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./syslog-ng.conf:/etc/syslog-ng/syslog-ng.conf</span><span class="w"> </span><span class="c1"># Este es el archivo de configuración de syslog-ng</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.254</span><span class="w"> </span><span class="c1"># Asegúrate de establecer la dirección IP correcta</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-logs</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="es-web-ui-configuracion-de-syslog-ng">Configuración de Syslog-ng</h3>
<p>Aquí hay un ejemplo de un archivo <code>syslog-ng.conf</code> que puedes usar para reenviar los registros a un archivo:</p>
<div class="highlight"><pre><span></span><code>@version: 4.8

# Configuración de origen para recibir registros de contenedores de Docker
source s_net {
  udp(
    ip(&quot;0.0.0.0&quot;)
  );
};

# Plantilla para formatear mensajes de registro
template t_imp {
  template(&quot;$MSG\n&quot;);
  template_escape(no);
};

# Configuración de destino para escribir registros en archivos con nombres dinámicos
destination d_dyna_file {
  file(
    &quot;/var/log/bunkerweb/${PROGRAM}.log&quot;
    template(t_imp)
    owner(&quot;101&quot;)
    group(&quot;101&quot;)
    dir_owner(&quot;root&quot;)
    dir_group(&quot;101&quot;)
    perm(0440)
    dir_perm(0770)
    create_dirs(yes)
  );
};

# Ruta de registro para dirigir los registros a archivos con nombres dinámicos
log {
  source(s_net);
  destination(d_dyna_file);
};
</code></pre></div>
<h2 id="es-web-ui-gestion-de-la-cuenta">Gestión de la cuenta</h2>
<p>Puedes acceder a la página de gestión de la cuenta haciendo clic en la imagen de perfil en la esquina superior derecha:</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/manage-account.png" width="400" />
  </p>
<figcaption>Acceso a la página de la cuenta desde la esquina superior derecha</figcaption>
</figure>
<h3 id="es-web-ui-nombre-de-usuario-contrasena">Nombre de usuario / Contraseña</h3>
<div class="admonition warning">
<p class="admonition-title">Contraseña/nombre de usuario perdido</p>
<p>En caso de que hayas olvidado tus credenciales de la interfaz de usuario, puedes restablecerlas desde la CLI siguiendo <a href="#es-troubleshooting-web-ui">los pasos descritos en la sección de solución de problemas</a>.</p>
</div>
<p>Puedes actualizar tu nombre de usuario o contraseña rellenando los formularios dedicados en la pestaña <strong>Seguridad</strong>. Por razones de seguridad, debes introducir tu contraseña actual incluso si estás conectado.</p>
<p>Ten en cuenta que cuando tu nombre de usuario o contraseña se actualice, se cerrará la sesión de la interfaz de usuario web para que vuelvas a iniciarla.</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/profile-username-password.png" />
  </p>
<figcaption>Formulario de nombre de usuario / contraseña</figcaption>
</figure>
<h3 id="es-web-ui-autenticacion-de-dos-factores">Autenticación de dos factores</h3>
<div class="admonition tip">
<p class="admonition-title">Claves de cifrado obligatorias</p>
<p>Al habilitar la 2FA, debes proporcionar al menos una clave de cifrado. Esta clave se utilizará para cifrar tus secretos TOTP.</p>
<p>La forma recomendada de generar una clave válida es usar el paquete <code>passlib</code>:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from passlib import totp; print(totp.generate_secret())&quot;</span>
</code></pre></div>
<p>Establece la clave generada en la variable de entorno <code>TOTP_ENCRYPTION_KEYS</code> de la interfaz de usuario web. También puedes establecer varias claves separadas por espacios o como un diccionario (por compatibilidad con versiones anteriores).</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Clave secreta perdida</p>
<p>En caso de que hayas perdido tu clave secreta, hay dos opciones disponibles:</p>
<ul>
<li>Puedes recuperar tu cuenta usando uno de los códigos de recuperación proporcionados cuando habilitaste la 2FA (un código de recuperación solo se puede usar una vez).</li>
<li>Puedes deshabilitar la 2FA desde la CLI siguiendo <a href="#es-troubleshooting-web-ui">los pasos descritos en la sección de solución de problemas</a>.</li>
</ul>
</div>
<p>Puedes potenciar la seguridad de tu inicio de sesión añadiendo la <strong>Autenticación de Dos Factores (2FA)</strong> a tu cuenta. Al hacerlo, se necesitará un código extra además de tu contraseña.</p>
<p>La interfaz de usuario web utiliza la <a href="https://es.wikipedia.org/wiki/Contrase%C3%B1a_de_un_solo_uso_basada_en_tiempo">Contraseña de un Solo Uso Basada en el Tiempo (TOTP)</a> como implementación de 2FA: usando una <strong>clave secreta</strong>, el algoritmo generará <strong>contraseñas de un solo uso solo válidas por un corto período de tiempo</strong>.</p>
<p>Cualquier cliente TOTP como Google Authenticator, Authy, FreeOTP, ... puede ser utilizado para almacenar la clave secreta y generar los códigos. Ten en cuenta que una vez que se habilita TOTP, <strong>no podrás recuperarla desde la interfaz de usuario web</strong>.</p>
<p>Los siguientes pasos son necesarios para habilitar la función TOTP desde la interfaz de usuario web:</p>
<ul>
<li>Copia la clave secreta o usa el código QR en tu aplicación de autenticación</li>
<li>Introduce el código TOTP actual en la entrada de 2FA</li>
<li>Introduce tu contraseña actual</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Actualización de la clave secreta</p>
<p>Se genera una nueva clave secreta <strong>cada vez</strong> que visitas la página o envías el formulario. En caso de que algo haya salido mal (p. ej.: código TOTP caducado), necesitarás copiar la nueva clave secreta en tu aplicación de autenticación hasta que la 2FA se habilite con éxito.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Códigos de recuperación</p>
<p>Cuando habilites la 2FA, se te proporcionarán <strong>5 códigos de recuperación</strong>. Estos códigos se pueden utilizar para recuperar tu cuenta en caso de que hayas perdido tu clave secreta TOTP. Cada código solo se puede usar una vez. <strong>Estos códigos solo se mostrarán una vez, así que asegúrate de guardarlos en un lugar seguro</strong>.</p>
<p>Si alguna vez pierdes tus códigos de recuperación, <strong>puedes actualizarlos a través de la sección TOTP de la página de gestión de la cuenta</strong>. Ten en cuenta que los antiguos códigos de recuperación se invalidarán.</p>
</div>
<p>Puedes habilitar o deshabilitar la 2FA y también actualizar los códigos de recuperación en la pestaña <strong>Seguridad</strong>:</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/profile-totp.png" />
  </p>
<figcaption>Formularios para habilitar / deshabilitar / actualizar los códigos de recuperación de TOTP</figcaption>
</figure>
<p>Después de una combinación exitosa de inicio de sesión/contraseña, se te pedirá que introduzcas tu código TOTP:</p>
<figure>
<p><img align="center," alt="Descripción general" src="../assets/img/profile-2fa.png" width="400" />
  </p>
<figcaption>2FA en la página de inicio de sesión</figcaption>
</figure>
<h3 id="es-web-ui-sesiones-actuales">Sesiones actuales</h3>
<p>En la pestaña <strong>Sesión</strong>, podrás listar y revocar las sesiones actuales:</p>
<figure>
<p><img align="center" alt="Descripción general" src="../assets/img/sessions.png" />
  </p>
<figcaption>Gestionar sesiones</figcaption>
</figure>
<h2 id="es-web-ui-instalacion-avanzada">Instalación avanzada</h2>
<p>La interfaz de usuario web se puede desplegar y configurar sin pasar por el proceso del asistente de configuración: la configuración se realiza a través de variables de entorno, que se pueden añadir directamente a los contenedores o en el archivo <code>/etc/bunkerweb/ui.env</code> en el caso de una integración con Linux.</p>
<div class="admonition tip">
<p class="admonition-title">Variables de entorno específicas de la interfaz de usuario web</p>
<p>La interfaz de usuario web utiliza las siguientes variables de entorno:</p>
<ul>
<li><code>OVERRIDE_ADMIN_CREDS</code>: establécelo en <code>yes</code> para habilitar la anulación incluso si las credenciales de administrador ya están configuradas (el valor predeterminado es <code>no</code>).</li>
<li><code>ADMIN_USERNAME</code>: nombre de usuario para acceder a la interfaz de usuario web.</li>
<li><code>ADMIN_PASSWORD</code>: contraseña para acceder a la interfaz de usuario web.</li>
<li><code>FLASK_SECRET</code>: una clave secreta utilizada para cifrar la cookie de sesión (si no se establece, se generará una clave aleatoria).</li>
<li><code>TOTP_ENCRYPTION_KEYS</code> (o <code>TOTP_SECRETS</code>): una lista de claves de cifrado TOTP separadas por espacios o un diccionario (p. ej.: <code>{"1": "miclavesecreta"}</code> o <code>miclavesecreta</code> o <code>miclavesecreta miclavesecreta1</code>). <strong>Te recomendamos encarecidamente que establezcas esta variable si quieres usar 2FA, ya que se utilizará para cifrar las claves secretas de TOTP</strong> (si no se establece, se generará un número aleatorio de claves secretas). Consulta la <a href="https://passlib.readthedocs.io/en/stable/narr/totp-tutorial.html#application-secrets">documentación de passlib</a> para obtener más información.</li>
<li><code>UI_LISTEN_ADDR</code> (preferido): la dirección en la que escuchará la interfaz de usuario web (el valor predeterminado es <code>0.0.0.0</code> en <strong>imágenes de Docker</strong> y <code>127.0.0.1</code> en <strong>instalaciones de Linux</strong>). Vuelve a <code>LISTEN_ADDR</code> si no se establece.</li>
<li><code>UI_LISTEN_PORT</code> (preferido): el puerto en el que escuchará la interfaz de usuario web (el valor predeterminado es <code>7000</code>). Vuelve a <code>LISTEN_PORT</code> si no se establece.</li>
<li><code>MAX_WORKERS</code>: el número de trabajadores utilizados por la interfaz de usuario web (el valor predeterminado es el número de CPU).</li>
<li><code>MAX_THREADS</code>: el número de hilos utilizados por la interfaz de usuario web (el valor predeterminado es <code>MAX_WORKERS</code> * 2).</li>
<li><code>FORWARDED_ALLOW_IPS</code>: una lista de direcciones IP o redes que se pueden usar en la cabecera <code>X-Forwarded-For</code> (el valor predeterminado es <code>*</code> en <strong>imágenes de Docker</strong> y <code>127.0.0.1</code> en <strong>instalaciones de Linux</strong>).</li>
<li><code>CHECK_PRIVATE_IP</code>: establécelo en <code>yes</code> para no desconectar a los usuarios que hayan cambiado su dirección IP durante una sesión si están en una red privada (el valor predeterminado es <code>yes</code>). (Las direcciones IP no privadas siempre se comprueban).</li>
<li><code>ENABLE_HEALTHCHECK</code>: establécelo en <code>yes</code> para habilitar el punto final <code>/healthcheck</code> que devuelve una respuesta JSON simple con información de estado (el valor predeterminado es <code>no</code>).</li>
</ul>
<p>La interfaz de usuario web utilizará estas variables para autenticarte y gestionar la función 2FA.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Generación de secretos recomendados</p>
<p>Para generar una <strong>ADMIN_PASSWORD</strong> válida, te recomendamos que <strong>utilices un gestor de contraseñas</strong> o un <strong>generador de contraseñas</strong>.</p>
<p>Puedes generar una <strong>FLASK_SECRET</strong> válida usando el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import secrets; print(secrets.token_hex(64))&quot;</span>
</code></pre></div>
<p>Puedes generar <strong>TOTP_ENCRYPTION_KEYS</strong> válidas separadas por espacios usando el siguiente comando (necesitarás el paquete <code>passlib</code>):</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from passlib import totp; print(totp.generate_secret())&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="2:5"><input checked="checked" id="es-web-ui-__tabbed_2_1" name="es-web-ui-__tabbed_2" type="radio" /><input id="es-web-ui-__tabbed_2_2" name="es-web-ui-__tabbed_2" type="radio" /><input id="es-web-ui-__tabbed_2_3" name="es-web-ui-__tabbed_2" type="radio" /><input id="es-web-ui-__tabbed_2_4" name="es-web-ui-__tabbed_2" type="radio" /><input id="es-web-ui-__tabbed_2_5" name="es-web-ui-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="es-web-ui-__tabbed_2_1">Linux</label><label for="es-web-ui-__tabbed_2_2">Docker</label><label for="es-web-ui-__tabbed_2_3">Docker autoconf</label><label for="es-web-ui-__tabbed_2_4">Kubernetes</label><label for="es-web-ui-__tabbed_2_5">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>La instalación de la interfaz de usuario web utilizando la <a href="#es-integrations-linux">integración de Linux</a> es bastante sencilla porque se instala con BunkerWeb.</p>
<p>La interfaz de usuario web viene como un servicio systemd llamado <code>bunkerweb-ui</code>, asegúrate de que esté habilitado:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>bunkerweb-ui<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-ui
</code></pre></div>
<p>Un archivo de entorno dedicado ubicado en <code>/etc/bunkerweb/ui.env</code> se utiliza para configurar la interfaz de usuario web:</p>
<div class="highlight"><pre><span></span><code>ADMIN_USERNAME=changeme
ADMIN_PASSWORD=changeme
TOTP_ENCRYPTION_KEYS=mysecret
</code></pre></div>
<p>Reemplaza los datos de <code>changeme</code> con tus propios valores.</p>
<p>Recuerda establecer una clave secreta más segura para <code>TOTP_ENCRYPTION_KEYS</code>.</p>
<p>Cada vez que edites el archivo <code>/etc/bunkerweb/ui.env</code>, necesitarás reiniciar el servicio:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb-ui
</code></pre></div>
<p>Acceder a la interfaz de usuario web a través de BunkerWeb es una <a href="#es-quickstart-guide">configuración de proxy inverso</a> clásica. Ten en cuenta que la interfaz de usuario web está escuchando en el puerto <code>7000</code> y solo en la interfaz de bucle invertido.</p>
<p>Aquí está la plantilla de <code>/etc/bunkerweb/variables.env</code> que puedes usar:</p>
<div class="highlight"><pre><span></span><code>HTTP_PORT=80
HTTPS_PORT=443
DNS_RESOLVERS=9.9.9.9 8.8.8.8 8.8.4.4
API_LISTEN_IP=127.0.0.1
SERVER_NAME=www.example.com
MULTISITE=yes
www.example.com_USE_TEMPLATE=ui
www.example.com_USE_REVERSE_PROXY=yes
www.example.com_REVERSE_PROXY_URL=/changeme
www.example.com_REVERSE_PROXY_HOST=http://127.0.0.1:7000
</code></pre></div>
<p>No olvides recargar el servicio <code>bunkerweb</code>:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La interfaz de usuario web se puede desplegar utilizando un contenedor dedicado que está disponible en <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-ui
</code></pre></div>
<p>Alternativamente, también puedes construirla tú mismo:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-bunkerweb-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<p>Acceder a la interfaz de usuario web a través de BunkerWeb es una <a href="#es-quickstart-guide">configuración de proxy inverso</a> clásica. Te recomendamos que conectes BunkerWeb y la interfaz de usuario web utilizando una red dedicada (como <code>bw-universe</code>, también utilizada por el programador) para que no esté en la misma red que tus servicios web por razones de seguridad obvias. Ten en cuenta que el contenedor de la interfaz de usuario web está escuchando en el puerto <code>7000</code>.</p>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Si quieres otro backend de base de datos que no sea MariaDB, consulta los archivos docker-compose en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio.</p>
</div>
<p>Aquí está la plantilla de docker-compose que puedes usar (no olvides editar los datos de <code>changeme</code>):</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;ui-env</span>
<span class="w">  </span><span class="c1"># Anclamos las variables de entorno para evitar la duplicación</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># Para soporte de QUIC / HTTP3</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Asegúrate de establecer el rango de IP correcto para que el programador pueda enviar la configuración a la instancia</span>
<span class="w">      </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># Refleja el API_TOKEN si lo usas</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Asegúrate de establecer el nombre de instancia correcto</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Reflejamos el API_WHITELIST_IP del servicio bunkerweb</span>
<span class="w">      </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># Refleja el API_TOKEN si lo usas</span>
<span class="w">      </span><span class="nt">SERVE_FILES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="w">      </span><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_TEMPLATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ui&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una URI más segura</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># El contenedor de la interfaz de usuario web escucha en el puerto 7000 por defecto</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para el usuario changeme</span>
<span class="w">      </span><span class="nt">TOTP_ENCRYPTION_KEYS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una clave secreta más segura (consulta la sección de Requisitos previos)</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La interfaz de usuario web se puede desplegar utilizando un contenedor dedicado que está disponible en <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-ui
</code></pre></div>
<p>Alternativamente, también puedes construirla tú mismo:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-bunkerweb-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Variables de entorno</p>
<p>Por favor, lee la sección de <a href="#es-web-ui-prerequisites">Requisitos previos</a> para ver todas las variables de entorno que puedes establecer para personalizar la interfaz de usuario web.</p>
</div>
<p>Acceder a la interfaz de usuario web a través de BunkerWeb es una <a href="#es-quickstart-guide">configuración de proxy inverso</a> clásica. Te recomendamos que conectes BunkerWeb y la interfaz de usuario web utilizando una red dedicada (como <code>bw-universe</code>, también utilizada por el programador y la autoconfiguración) para que no esté en la misma red que tus servicios web por razones de seguridad obvias. Ten en cuenta que el contenedor de la interfaz de usuario web está escuchando en el puerto <code>7000</code>.</p>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Si quieres otro backend de base de datos que no sea MariaDB, consulta los archivos docker-compose en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio.</p>
</div>
<p>Aquí está la plantilla de docker-compose que puedes usar (no olvides editar los datos de <code>changeme</code>):</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;ui-env</span>
<span class="w">  </span><span class="c1"># Anclamos las variables de entorno para evitar la duplicación</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># Para soporte de QUIC / HTTP3</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Establecemos la etiqueta de la instancia para permitir que la autoconfiguración detecte la instancia</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para el usuario changeme</span>
<span class="w">      </span><span class="nt">TOTP_ENCRYPTION_KEYS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una clave secreta más segura (consulta la sección de Requisitos previos)</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_TEMPLATE=ui&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/changeme&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://bw-ui:7000&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La interfaz de usuario web se puede desplegar utilizando un contenedor dedicado que está disponible en <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a> y se puede desplegar como un <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a> estándar.</p>
<p>Acceder a la interfaz de usuario web a través de BunkerWeb es una <a href="#es-quickstart-guide">configuración de proxy inverso</a> clásica. La segmentación de la red entre la interfaz de usuario web y los servicios web no se cubre en esta documentación. Ten en cuenta que el contenedor de la interfaz de usuario web está escuchando en el puerto <code>7000</code>.</p>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Si quieres otro backend de base de datos que no sea MariaDB, consulta los archivos yaml en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio.</p>
</div>
<p>Aquí está la parte correspondiente de tu archivo values.yaml que puedes usar:</p>
<div class="highlight"><pre><span></span><code><span class="nt">settings</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Usa un secreto existente llamado bunkerweb y que contenga los siguientes valores:</span>
<span class="w">  </span><span class="c1"># - admin-username</span>
<span class="w">  </span><span class="c1"># - admin-password</span>
<span class="w">  </span><span class="c1"># - flask-secret</span>
<span class="w">  </span><span class="c1"># - totp-secrets</span>
<span class="w">  </span><span class="nt">existingSecret</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secret-bunkerweb&quot;</span>
<span class="nt">ui</span><span class="p">:</span>
<span class="w">  </span><span class="nt">wizard</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">serverName</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">    </span><span class="nt">serverPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/admin&quot;</span>
<span class="w">  </span><span class="nt">overrideAdminCreds</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Se puede encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>La interfaz de usuario web se puede desplegar utilizando un contenedor dedicado que está disponible en <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-ui
</code></pre></div>
<p>Alternativamente, también puedes construirla tú mismo:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-bunkerweb-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<p>Acceder a la interfaz de usuario web a través de BunkerWeb es una <a href="#es-quickstart-guide">configuración de proxy inverso</a> clásica. Te recomendamos que conectes BunkerWeb y la interfaz de usuario web utilizando una red dedicada (como <code>bw-universe</code>, también utilizada por el programador y la autoconfiguración) para que no esté en la misma red que tus servicios web por razones de seguridad obvias. Ten en cuenta que el contenedor de la interfaz de usuario web está escuchando en el puerto <code>7000</code>.</p>
<div class="admonition info">
<p class="admonition-title">Backend de la base de datos</p>
<p>Si quieres otro backend de base de datos que no sea MariaDB, consulta los archivos de la pila en la <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">carpeta misc/integrations</a> del repositorio.</p>
</div>
<p>Aquí está la plantilla de la pila que puedes usar (no olvides editar los datos de <code>changeme</code>):</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;ui-env</span>
<span class="w">  </span><span class="c1"># Anclamos las variables de entorno para evitar la duplicación</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># Para soporte de QUIC / HTTP3</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">      </span><span class="nt">UI_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># Cámbialo si es necesario</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># Se utiliza para persistir la caché y otros datos como las copias de seguridad</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Establecemos el tamaño máximo de paquete permitido para evitar problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para la base de datos</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una contraseña más segura para el usuario changeme</span>
<span class="w">      </span><span class="nt">TOTP_ENCRYPTION_KEYS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Recuerda establecer una clave secreta más segura (consulta la sección de Requisitos previos)</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_TEMPLATE=ui&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/changeme&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://bw-ui:7000&quot;</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-web-ui-soporte-de-idiomas-y-localizacion">Soporte de idiomas y localización</h2>
<p>La interfaz de usuario de BunkerWeb admite varios idiomas. Las traducciones se gestionan en el directorio <code>src/ui/app/static/locales</code>. Actualmente están disponibles los siguientes idiomas:</p>
<ul>
<li>Inglés (en)</li>
<li>Francés (fr)</li>
<li>Árabe (ar)</li>
<li>Bengalí (bn)</li>
<li>Español (es)</li>
<li>Hindi (hi)</li>
<li>Portugués (pt)</li>
<li>Ruso (ru)</li>
<li>Urdu (ur)</li>
<li>Chino (zh)</li>
<li>Alemán (de)</li>
<li>Italiano (it)</li>
</ul>
<p>Consulta el <a href="https://github.com/bunkerity/bunkerweb/raw/vtesting/src/ui/app/static/locales/README.md">locales/README.md</a> para obtener detalles sobre la procedencia de la traducción y el estado de la revisión.</p>
<h3 id="es-web-ui-contribuir-con-traducciones">Contribuir con traducciones</h3>
<p>¡Agradecemos las contribuciones para mejorar o añadir nuevos archivos de localización!</p>
<p><strong>Cómo contribuir con una traducción:</strong></p>
<ol>
<li>Edita el archivo <code>src/ui/app/lang_config.py</code> para añadir tu idioma (código, nombre, bandera, nombre en inglés).</li>
<li>Copia <code>en.json</code> como plantilla en <code>src/ui/app/static/locales/</code>, renómbralo con el código de tu idioma (p. ej., <code>de.json</code> para alemán).</li>
<li>Traduce los valores de tu nuevo archivo.</li>
<li>Actualiza la tabla en <code>locales/README.md</code> para añadir tu idioma e indicar quién lo creó/revisó.</li>
<li>Envía una solicitud de extracción.</li>
</ol>
<p>Para las actualizaciones, edita el archivo correspondiente y actualiza la tabla de procedencia según sea necesario.</p>
<p>Consulta el <a href="https://github.com/bunkerity/bunkerweb/raw/vtesting/src/ui/app/static/locales/README.md">locales/README.md</a> para obtener las directrices completas.
Genera una traducción limpia de este archivo</p></section><section class="print-page" id="es-api" heading-number="8"><h1 id="es-api-api">API</h1>
<h2 id="es-api-descripcion-general">Descripción general</h2>
<p>La API de BunkerWeb es el plano de control utilizado para gestionar las instancias de BunkerWeb de forma programática: listar y gestionar instancias, recargar/detener, manejar baneos, plugins, trabajos, configuraciones y más. Expone una aplicación FastAPI documentada con autenticación fuerte, autorización y limitación de velocidad.</p>
<p>Abre la documentación interactiva en <code>/docs</code> (o <code>&lt;root_path&gt;/docs</code> si estableciste <code>API_ROOT_PATH</code>). El esquema OpenAPI está disponible en <code>/openapi.json</code>.</p>
<div class="admonition warning">
<p class="admonition-title">Seguridad</p>
<p>La API es un plano de control privilegiado. No la expongas en la Internet pública sin protecciones adicionales.</p>
<p>Como mínimo, restringe las IP de origen (<code>API_WHITELIST_IPS</code>), habilita la autenticación (<code>API_TOKEN</code> o usuarios de API + Biscuit), y considera ponerla detrás de BunkerWeb con una ruta difícil de adivinar y controles de acceso adicionales.</p>
</div>
<h2 id="es-api-requisitos-previos">Requisitos previos</h2>
<p>El servicio de la API requiere acceso a la base de datos de BunkerWeb (<code>DATABASE_URI</code>). Generalmente se despliega junto con el Programador y opcionalmente la Interfaz de Usuario Web. La configuración recomendada es ejecutar BunkerWeb al frente como un proxy inverso y aislar la API en una red interna.</p>
<p>Consulta el asistente de inicio rápido y la guía de arquitectura en la <a href="#es-quickstart-guide">guía de inicio rápido</a>.</p>
<h2 id="es-api-puntos-destacados">Puntos destacados</h2>
<ul>
<li>Consciente de las instancias: transmite acciones operativas a las instancias descubiertas.</li>
<li>Autenticación fuerte: Básica para administradores, anulación de administrador con Bearer, o ACL de Biscuit para permisos detallados.</li>
<li>Lista blanca de IP y limitación de velocidad flexible por ruta.</li>
<li>Señales estándar de salud/disponibilidad y comprobaciones de seguridad al inicio.</li>
</ul>
<h2 id="es-api-plantillas-de-compose">Plantillas de Compose</h2>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="es-api-__tabbed_1_1" name="es-api-__tabbed_1" type="radio" /><input id="es-api-__tabbed_1_2" name="es-api-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-api-__tabbed_1_1">Docker</label><label for="es-api-__tabbed_1_2">Docker Autoconf</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Haz un proxy inverso de la API bajo <code>/api</code> con BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># Lista blanca compartida del plano de control de instancias para BunkerWeb/Scheduler</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w">  </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w">  </span><span class="c1"># Coincide con el nombre del servicio de la instancia</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span>
<span class="w">      </span><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="c1"># Proxy inverso de la API en /api</span>
<span class="w">      </span><span class="nt">www.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-api:8888&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-api</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-api:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w">  </span><span class="c1"># Usa una contraseña fuerte</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w">                      </span><span class="c1"># Lista blanca de la API</span>
<span class="w">      </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secret&quot;</span><span class="w">                                                 </span><span class="c1"># Token de anulación de administrador opcional</span>
<span class="w">      </span><span class="nt">API_ROOT_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api&quot;</span><span class="w">                                               </span><span class="c1"># Coincide con la ruta del proxy inverso</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># Evita problemas con consultas grandes</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w">  </span><span class="c1"># Usa una contraseña fuerte</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Lo mismo que arriba pero aprovechando el servicio Autoconf para descubrir y configurar servicios automáticamente. La API se expone bajo <code>/api</code> usando etiquetas en el contenedor de la API.</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;api-env</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w">  </span><span class="c1"># Usa una contraseña fuerte</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w">  </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">    </span><span class="c1"># Descubierto por Autoconf</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w">            </span><span class="c1"># Rellenado a través de etiquetas</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w">           </span><span class="c1"># Obligatorio con Autoconf</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*api-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-api</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-api:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*api-env</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secret&quot;</span>
<span class="w">      </span><span class="nt">API_ROOT_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api&quot;</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/api&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://bw-api:8888&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">unless-stopped</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
</code></pre></div>
</div>
</div>
</div>
<div class="admonition warning">
<p class="admonition-title">Ruta del proxy inverso</p>
<p>Mantén la ruta de la API difícil de adivinar y combínala con la lista blanca de la API y la autenticación.</p>
<p>Si ya expones otra aplicación en el mismo nombre de servidor con una plantilla (p. ej., <code>USE_TEMPLATE</code>), prefiere un nombre de host separado para la API para evitar conflictos.</p>
</div>
<h3 id="es-api-todo-en-uno">Todo en Uno</h3>
<p>Si utilizas la imagen Todo en Uno, la API se puede habilitar estableciendo <code>SERVICE_API=yes</code>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">SERVICE_API</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">API_WHITELIST_IPS</span><span class="o">=</span><span class="s2">&quot;127.0.0.0/8&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<h2 id="es-api-autenticacion">Autenticación</h2>
<p>Formas admitidas para autenticar solicitudes:</p>
<ul>
<li>Administrador Básico: Cuando las credenciales pertenecen a un usuario de API administrador, los puntos finales protegidos aceptan <code>Authorization: Basic &lt;base64(nombredeusuario:contraseña)&gt;</code>.</li>
<li>Anulación de Administrador con Bearer: Si se configura <code>API_TOKEN</code>, <code>Authorization: Bearer &lt;API_TOKEN&gt;</code> otorga acceso completo.</li>
<li>Token Biscuit (recomendado): Obtén un token desde <code>POST /auth</code> utilizando credenciales Básicas o un cuerpo JSON/formulario que contenga <code>username</code> y <code>password</code>. Utiliza el token devuelto como <code>Authorization: Bearer &lt;token&gt;</code> en llamadas posteriores.</li>
</ul>
<p>Ejemplo: obtener un Biscuit, listar instancias y luego recargar todas las instancias.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># 1) Obtener un token Biscuit con credenciales de administrador</span>
<span class="nv">TOKEN</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-u<span class="w"> </span>admin:changeme<span class="w"> </span>http://api.example.com/auth<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span>.token<span class="k">)</span>

<span class="c1"># 2) Listar instancias</span>
curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span>http://api.example.com/instances

<span class="c1"># 3) Recargar la configuración en todas las instancias (sin prueba)</span>
curl<span class="w"> </span>-X<span class="w"> </span>POST<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Authorization: Bearer </span><span class="nv">$TOKEN</span><span class="s2">&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">     </span><span class="s2">&quot;http://api.example.com/instances/reload?test=no&quot;</span>
</code></pre></div>
<h3 id="es-api-hechos-y-comprobaciones-de-biscuit">Hechos y comprobaciones de Biscuit</h3>
<p>Los tokens incorporan hechos como <code>user(&lt;username&gt;)</code>, <code>client_ip(&lt;ip&gt;)</code>, <code>domain(&lt;host&gt;)</code>, y un rol general <code>role("api_user", ["read", "write"])</code> derivado de los permisos de la base de datos. Los administradores incluyen <code>admin(true)</code> mientras que los no administradores llevan hechos detallados como <code>api_perm(&lt;resource_type&gt;, &lt;resource_id|*&gt;, &lt;permission&gt;)</code>.</p>
<p>La autorización mapea la ruta/método a los permisos requeridos; <code>admin(true)</code> siempre pasa. Cuando los hechos detallados están ausentes, la guarda recurre al rol general: GET/HEAD/OPTIONS requieren <code>read</code>; los verbos de escritura requieren <code>write</code>.</p>
<p>Las claves se almacenan en <code>/var/lib/bunkerweb/.api_biscuit_private_key</code> y <code>/var/lib/bunkerweb/.api_biscuit_public_key</code>. También puedes proporcionar <code>BISCUIT_PUBLIC_KEY</code>/<code>BISCUIT_PRIVATE_KEY</code> a través de variables de entorno; si no se establecen ni archivos ni variables de entorno, la API genera un par de claves al inicio y lo persiste de forma segura.</p>
<h2 id="es-api-permisos-acl">Permisos (ACL)</h2>
<p>Esta API soporta dos capas de autorización:</p>
<ul>
<li>Rol general: Los tokens llevan <code>role("api_user", ["read"[, "write"]])</code> para los puntos finales sin un mapeo detallado. Lectura se mapea a GET/HEAD/OPTIONS; escritura se mapea a POST/PUT/PATCH/DELETE.</li>
<li>ACL detallada: Los tokens incorporan <code>api_perm(&lt;resource_type&gt;, &lt;resource_id|*&gt;, &lt;permission&gt;)</code> y las rutas declaran lo que requieren. <code>admin(true)</code> omite todas las comprobaciones.</li>
</ul>
<p>Tipos de recursos admitidos: <code>instances</code>, <code>global_config</code>, <code>services</code>, <code>configs</code>, <code>plugins</code>, <code>cache</code>, <code>bans</code>, <code>jobs</code>.</p>
<p>Nombres de permisos por tipo de recurso:</p>
<ul>
<li>instances: <code>instances_read</code>, <code>instances_update</code>, <code>instances_delete</code>, <code>instances_create</code>, <code>instances_execute</code></li>
<li>global_config: <code>global_config_read</code>, <code>global_config_update</code></li>
<li>services: <code>service_read</code>, <code>service_create</code>, <code>service_update</code>, <code>service_delete</code>, <code>service_convert</code>, <code>service_export</code></li>
<li>configs: <code>configs_read</code>, <code>config_read</code>, <code>config_create</code>, <code>config_update</code>, <code>config_delete</code></li>
<li>plugins: <code>plugin_read</code>, <code>plugin_create</code>, <code>plugin_delete</code></li>
<li>cache: <code>cache_read</code>, <code>cache_delete</code></li>
<li>bans: <code>ban_read</code>, <code>ban_update</code>, <code>ban_delete</code>, <code>ban_created</code></li>
<li>jobs: <code>job_read</code>, <code>job_run</code></li>
</ul>
<p>ID de recursos: Para comprobaciones detalladas, el segundo segmento de la ruta se trata como <code>resource_id</code> cuando tiene sentido. Ejemplos: <code>/services/{service}</code> -&gt; <code>{service}</code>; <code>/configs/{service}/...</code> -&gt; <code>{service}</code>. Usa <code>"*"</code> (u omite) para otorgar globalmente para un tipo de recurso.</p>
<p>Configuración de usuario y ACL:</p>
<ul>
<li>Usuario administrador: Establece <code>API_USERNAME</code> y <code>API_PASSWORD</code> para crear el primer administrador al inicio. Para rotar las credenciales más tarde, establece <code>OVERRIDE_API_CREDS=yes</code> (o asegúrate de que el administrador fue creado con el método <code>manual</code>). Solo existe un administrador; los intentos adicionales recurren a la creación de no administradores.</li>
<li>Usuarios no administradores y concesiones: Proporciona <code>API_ACL_BOOTSTRAP_FILE</code> apuntando a un archivo JSON, o monta <code>/var/lib/bunkerweb/api_acl_bootstrap.json</code>. La API lo lee al inicio para crear/actualizar usuarios y permisos.</li>
<li>Archivo de caché de ACL: Se escribe un resumen de solo lectura en <code>/var/lib/bunkerweb/api_acl.json</code> al inicio para introspección; la autorización evalúa las concesiones respaldadas por la base de datos incorporadas en el token Biscuit.</li>
</ul>
<p>Ejemplos de JSON de arranque (se admiten ambas formas):</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;ci&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;admin&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Str0ng&amp;P@ss!&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;services&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;service_read&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">},</span>
<span class="w">          </span><span class="nt">&quot;app-frontend&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;service_update&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;service_delete&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">          </span><span class="nt">&quot;app-frontend&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;config_read&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;config_update&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="nt">&quot;ops&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;admin&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;password_hash&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;$2b$13$...bcrypt-hash...&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;instances&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;instances_execute&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="nt">&quot;jobs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;*&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;job_run&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>
<p>O en formato de lista:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;username&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ci&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;password&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Str0ng&amp;P@ss!&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;permissions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;resource_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;services&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;resource_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;*&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;permission&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;service_read&quot;</span><span class="w"> </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;resource_type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;services&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;resource_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;app-frontend&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;permission&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;service_update&quot;</span><span class="w"> </span><span class="p">}</span>
<span class="w">      </span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>Notas:</p>
<ul>
<li>Las contraseñas pueden ser texto plano (<code>password</code>) o bcrypt (<code>password_hash</code> / <code>password_bcrypt</code>). Las contraseñas de texto plano débiles son rechazadas en compilaciones que no son de depuración; si faltan, se genera una aleatoria y se registra una advertencia.</li>
<li><code>resource_id: "*"</code> (o nulo/vacío) otorga globalmente sobre ese tipo de recurso.</li>
<li>Las contraseñas de los usuarios existentes pueden actualizarse y se pueden aplicar concesiones adicionales a través del arranque.</li>
</ul>
<h2 id="es-api-referencia-de-caracteristicas">Referencia de características</h2>
<p>La API está organizada por enrutadores centrados en recursos. Utiliza las secciones a continuación como un mapa de capacidades; el esquema interactivo en <code>/docs</code> documenta los modelos de solicitud/respuesta en detalle.</p>
<h3 id="es-api-nucleo-y-autenticacion">Núcleo y autenticación</h3>
<ul>
<li><code>GET /ping</code>, <code>GET /health</code>: sondas de actividad ligeras para el propio servicio de la API.</li>
<li><code>POST /auth</code>: intercambia credenciales Básicas (o el token de anulación de administrador) por un Biscuit. Acepta JSON, formulario o cabeceras <code>Authorization</code>. Los administradores también pueden continuar usando HTTP Basic directamente en rutas protegidas cuando lo deseen.</li>
</ul>
<h3 id="es-api-plano-de-control-de-instancias">Plano de control de instancias</h3>
<ul>
<li><code>GET /instances</code>: lista las instancias registradas, incluyendo marcas de tiempo de creación/última vez visto, método de registro y metadatos.</li>
<li><code>POST /instances</code>: registra una nueva instancia gestionada por la API (nombre de host, puerto opcional, nombre de servidor, nombre amigable, método).</li>
<li><code>GET /instances/{hostname}</code> / <code>PATCH /instances/{hostname}</code> / <code>DELETE /instances/{hostname}</code>: inspecciona, actualiza campos mutables o elimina instancias gestionadas por la API.</li>
<li><code>DELETE /instances</code>: eliminación masiva; omite las instancias que no son de la API y las informa en <code>skipped</code>.</li>
<li><code>GET /instances/ping</code> y <code>GET /instances/{hostname}/ping</code>: comprobaciones de salud en todas o en instancias individuales.</li>
<li><code>POST /instances/reload?test=yes|no</code>, <code>POST /instances/{hostname}/reload</code>: activa la recarga de la configuración (el modo de prueba realiza una validación de ejecución en seco).</li>
<li><code>POST /instances/stop</code>, <code>POST /instances/{hostname}/stop</code>: retransmite comandos de detención a las instancias.</li>
</ul>
<h3 id="es-api-configuracion-global">Configuración global</h3>
<ul>
<li><code>GET /global_config</code>: obtiene configuraciones no predeterminadas (usa <code>full=true</code> para la configuración completa, <code>methods=true</code> para incluir la procedencia).</li>
<li><code>PATCH /global_config</code>: actualiza o inserta configuraciones globales propiedad de la API (<code>method="api"</code>); los errores de validación señalan claves desconocidas o de solo lectura.</li>
</ul>
<h3 id="es-api-ciclo-de-vida-del-servicio">Ciclo de vida del servicio</h3>
<ul>
<li><code>GET /services</code>: enumera los servicios con metadatos, incluido el estado de borrador y las marcas de tiempo.</li>
<li><code>GET /services/{service}</code>: recupera las superposiciones no predeterminadas (<code>full=false</code>) o la instantánea completa de la configuración (<code>full=true</code>) para un servicio.</li>
<li><code>POST /services</code>: crea servicios, opcionalmente como borrador, y siembra variables con prefijo (<code>{service}_{KEY}</code>). Actualiza la lista <code>SERVER_NAME</code> atómicamente.</li>
<li><code>PATCH /services/{service}</code>: renombra servicios, cambia los indicadores de borrador y actualiza las variables con prefijo. Ignora las ediciones directas a <code>SERVER_NAME</code> dentro de <code>variables</code> por seguridad.</li>
<li><code>DELETE /services/{service}</code>: elimina un servicio y sus claves de configuración derivadas.</li>
<li><code>POST /services/{service}/convert?convert_to=online|draft</code>: cambia rápidamente el estado borrador/en línea sin alterar otras variables.</li>
</ul>
<h3 id="es-api-fragmentos-de-configuracion-personalizados">Fragmentos de configuración personalizados</h3>
<ul>
<li><code>GET /configs</code>: lista fragmentos de configuración personalizados (HTTP/servidor/stream/ModSecurity/ganchos CRS) para un servicio (<code>service=global</code> por defecto). <code>with_data=true</code> incrusta contenido UTF-8 cuando es imprimible.</li>
<li><code>POST /configs</code> y <code>POST /configs/upload</code>: crea nuevos fragmentos a partir de cargas útiles JSON o archivos subidos. Los tipos aceptados incluyen <code>http</code>, <code>server_http</code>, <code>default_server_http</code>, <code>modsec</code>, <code>modsec_crs</code>, <code>stream</code>, <code>server_stream</code>, y ganchos de plugins CRS. Los nombres deben coincidir con <code>^[\w_-]{1,64}$</code>.</li>
<li><code>GET /configs/{service}/{type}/{name}</code>: recupera un fragmento con contenido opcional (<code>with_data=true</code>).</li>
<li><code>PATCH /configs/{service}/{type}/{name}</code> y <code>PATCH .../upload</code>: actualiza o mueve fragmentos gestionados por la API; las entradas gestionadas por plantilla o archivo permanecen de solo lectura.</li>
<li><code>DELETE /configs</code> y <code>DELETE /configs/{service}/{type}/{name}</code>: elimina fragmentos gestionados por la API conservando los gestionados por plantilla, devolviendo una lista <code>skipped</code> para las entradas ignoradas.</li>
</ul>
<h3 id="es-api-orquestacion-de-baneos">Orquestación de baneos</h3>
<ul>
<li><code>GET /bans</code>: agrega los baneos activos informados por todas las instancias.</li>
<li><code>POST /bans</code> o <code>POST /bans/ban</code>: aplica uno o varios baneos. Las cargas útiles pueden ser objetos JSON, matrices o JSON en formato de cadena. <code>service</code> es opcional; cuando se omite, el baneo es global.</li>
<li><code>POST /bans/unban</code> o <code>DELETE /bans</code>: elimina baneos globalmente o por servicio utilizando las mismas cargas útiles flexibles.</li>
</ul>
<h3 id="es-api-gestion-de-plugins">Gestión de plugins</h3>
<ul>
<li><code>GET /plugins?type=all|external|ui|pro</code>: lista plugins con metadatos; <code>with_data=true</code> incluye los bytes empaquetados cuando están disponibles.</li>
<li><code>POST /plugins/upload</code>: instala plugins de UI desde archivos <code>.zip</code>, <code>.tar.gz</code> o <code>.tar.xz</code>. Los archivos pueden agrupar múltiples plugins siempre que cada uno contenga un <code>plugin.json</code>.</li>
<li><code>DELETE /plugins/{id}</code>: elimina un plugin de UI por ID (<code>^[\w.-]{4,64}$</code>).</li>
</ul>
<h3 id="es-api-cache-y-ejecucion-de-trabajos">Caché y ejecución de trabajos</h3>
<ul>
<li><code>GET /cache</code>: lista los artefactos en caché producidos por los trabajos del programador, filtrados por servicio, ID de plugin o nombre de trabajo. <code>with_data=true</code> incluye contenido de archivo imprimible.</li>
<li><code>GET /cache/{service}/{plugin}/{job}/{file}</code>: obtiene un archivo de caché específico (<code>download=true</code> transmite un archivo adjunto).</li>
<li><code>DELETE /cache</code> o <code>DELETE /cache/{service}/{plugin}/{job}/{file}</code>: elimina archivos de caché y notifica al programador sobre los plugins afectados.</li>
<li><code>GET /jobs</code>: inspecciona trabajos conocidos, sus metadatos de programación y resúmenes de caché.</li>
<li><code>POST /jobs/run</code>: solicita la ejecución de un trabajo marcando el(los) plugin(s) asociado(s) como cambiado(s).</li>
</ul>
<h3 id="es-api-notas-operativas">Notas operativas</h3>
<ul>
<li>Los puntos finales de escritura persisten en la base de datos compartida; las instancias recogen los cambios a través de la sincronización del programador o después de un <code>/instances/reload</code>.</li>
<li>Los errores se normalizan a <code>{ "status": "error", "message": "..." }</code> con los códigos de estado HTTP apropiados (422 validación, 404 no encontrado, 403 ACL, 5xx fallos de origen).</li>
</ul>
<h2 id="es-api-limitacion-de-velocidad">Limitación de velocidad</h2>
<p>La limitación de velocidad por cliente es manejada por SlowAPI. Habilítala/deshabilítala y configura los límites a través de variables de entorno o <code>/etc/bunkerweb/api.yml</code>.</p>
<ul>
<li><code>API_RATE_LIMIT_ENABLED</code> (predeterminado: <code>yes</code>)</li>
<li>Límite predeterminado: <code>API_RATE_LIMIT_TIMES</code> por <code>API_RATE_LIMIT_SECONDS</code> (p. ej., <code>100</code> por <code>60</code>)</li>
<li><code>API_RATE_LIMIT_RULES</code>: JSON/CSV en línea, o una ruta a un archivo YAML/JSON con reglas por ruta</li>
<li>Backend de almacenamiento: en memoria o Redis/Valkey cuando <code>USE_REDIS=yes</code> y se proporcionan las variables <code>REDIS_*</code> (compatible con Sentinel)</li>
<li>Cabeceras: <code>API_RATE_LIMIT_HEADERS_ENABLED</code> (predeterminado: <code>yes</code>)</li>
</ul>
<p>Ejemplo de YAML (montado en <code>/etc/bunkerweb/api.yml</code>):</p>
<p><code>yaml
API_RATE_LIMIT_ENABLED: yes
API_RATE_LIMIT_DEFAULTS: ["200/minute"]
API_RATE_LIMIT_RULES:
  - path: "/auth"
    methods: "POST"
    times: 10
    seconds: 60
  - path: "/instances*"
    methods: "GET|POST"
    times: 100
    seconds: 60</code></p>
<h2 id="es-api-configuracion">Configuración</h2>
<p>Puedes configurar la API a través de variables de entorno, secretos de Docker y los archivos opcionales <code>/etc/bunkerweb/api.yml</code> o <code>/etc/bunkerweb/api.env</code>. Configuraciones clave:</p>
<ul>
<li>Documentación y esquema: <code>API_DOCS_URL</code>, <code>API_REDOC_URL</code>, <code>API_OPENAPI_URL</code>, <code>API_ROOT_PATH</code>.</li>
<li>Autenticación básica: <code>API_TOKEN</code> (Bearer de anulación de administrador), <code>API_USERNAME</code>/<code>API_PASSWORD</code> (crear/actualizar administrador), <code>OVERRIDE_API_CREDS</code>.</li>
<li>ACL y usuarios: <code>API_ACL_BOOTSTRAP_FILE</code> (ruta JSON).</li>
<li>Política de Biscuit: <code>API_BISCUIT_TTL_SECONDS</code> (0/desactivado deshabilita el TTL), <code>CHECK_PRIVATE_IP</code> (vincula el token a la IP del cliente a menos que sea privada).</li>
<li>Lista blanca de IP: <code>API_WHITELIST_ENABLED</code>, <code>API_WHITELIST_IPS</code>.</li>
<li>Limitación de velocidad (núcleo): <code>API_RATE_LIMIT_ENABLED</code>, <code>API_RATE_LIMIT_TIMES</code>, <code>API_RATE_LIMIT_SECONDS</code>, <code>API_RATE_LIMIT_HEADERS_ENABLED</code>.</li>
<li>Limitación de velocidad (avanzado): <code>API_RATE_LIMIT_AUTH_TIMES</code>, <code>API_RATE_LIMIT_AUTH_SECONDS</code>, <code>API_RATE_LIMIT_RULES</code>, <code>API_RATE_LIMIT_DEFAULTS</code>, <code>API_RATE_LIMIT_APPLICATION_LIMITS</code>, <code>API_RATE_LIMIT_STRATEGY</code>, <code>API_RATE_LIMIT_KEY</code>, <code>API_RATE_LIMIT_EXEMPT_IPS</code>, <code>API_RATE_LIMIT_STORAGE_OPTIONS</code>.</li>
<li>Almacenamiento de limitación de velocidad: en memoria o Redis/Valkey cuando <code>USE_REDIS=yes</code> y se establecen configuraciones de Redis como <code>REDIS_HOST</code>, <code>REDIS_PORT</code>, <code>REDIS_PASSWORD</code>, <code>REDIS_DATABASE</code>, <code>REDIS_SSL</code>, o variables de Sentinel. Consulta la tabla de configuraciones de Redis en <code>docs/features.md</code>.</li>
<li>Red/TLS: <code>API_LISTEN_ADDR</code>, <code>API_LISTEN_PORT</code>, <code>API_FORWARDED_ALLOW_IPS</code>, <code>API_SSL_ENABLED</code>, <code>API_SSL_CERTFILE</code>, <code>API_SSL_KEYFILE</code>, <code>API_SSL_CA_CERTS</code>.</li>
</ul>
<h3 id="es-api-como-se-carga-la-configuracion">Cómo se carga la configuración</h3>
<p>Precedencia de mayor a menor:</p>
<ul>
<li>Variables de entorno (p. ej., <code>environment:</code> del contenedor o variables de shell exportadas)</li>
<li>Archivos de secretos en <code>/run/secrets</code> (secretos de Docker/K8s; los nombres de archivo coinciden con los nombres de las variables)</li>
<li>Archivo YAML en <code>/etc/bunkerweb/api.yml</code></li>
<li>Archivo de entorno en <code>/etc/bunkerweb/api.env</code> (líneas clave=valor)</li>
<li>Valores predeterminados incorporados</li>
</ul>
<p>Notas:</p>
<ul>
<li>YAML admite la inserción de archivos de secretos con <code>&lt;file:relative/path&gt;</code>; la ruta se resuelve contra <code>/run/secrets</code>.</li>
<li>Establece las URL de la documentación en <code>off</code>/<code>disabled</code>/<code>none</code> para deshabilitar los puntos finales (p. ej., <code>API_DOCS_URL=off</code>).</li>
<li>Si <code>API_SSL_ENABLED=yes</code>, también debes establecer <code>API_SSL_CERTFILE</code> y <code>API_SSL_KEYFILE</code>.</li>
<li>Si Redis está habilitado (<code>USE_REDIS=yes</code>), proporciona los detalles de Redis; consulta la sección de Redis en <code>docs/features.md</code>.</li>
</ul>
<h3 id="es-api-autenticacion-y-usuarios">Autenticación y usuarios</h3>
<ul>
<li>Arranque de administrador: establece <code>API_USERNAME</code> y <code>API_PASSWORD</code> para crear el primer administrador. Para volver a aplicar más tarde, establece <code>OVERRIDE_API_CREDS=yes</code>.</li>
<li>No administradores y permisos: proporciona <code>API_ACL_BOOTSTRAP_FILE</code> con una ruta JSON (o monta en <code>/var/lib/bunkerweb/api_acl_bootstrap.json</code>). El archivo puede listar usuarios y concesiones detalladas.</li>
<li>Claves de Biscuit: establece <code>BISCUIT_PUBLIC_KEY</code>/<code>BISCUIT_PRIVATE_KEY</code> o monta archivos en <code>/var/lib/bunkerweb/.api_biscuit_public_key</code> y <code>/var/lib/bunkerweb/.api_biscuit_private_key</code>. Si no se proporciona ninguno, la API genera y persiste un par de claves al inicio.</li>
</ul>
<h3 id="es-api-tls-y-redes">TLS y redes</h3>
<ul>
<li>Dirección/puerto de enlace: <code>API_LISTEN_ADDR</code> (predeterminado <code>0.0.0.0</code>), <code>API_LISTEN_PORT</code> (predeterminado <code>8888</code>).</li>
<li>Proxies inversos: establece <code>API_FORWARDED_ALLOW_IPS</code> en las IP del proxy para que Gunicorn confíe en las cabeceras <code>X-Forwarded-*</code>.</li>
<li>Terminación de TLS en la API: <code>API_SSL_ENABLED=yes</code> más <code>API_SSL_CERTFILE</code> y <code>API_SSL_KEYFILE</code>; opcional <code>API_SSL_CA_CERTS</code></li>
</ul>
<h3 id="es-api-recetas-rapidas-de-limitacion-de-velocidad">Recetas rápidas de limitación de velocidad</h3>
<ul>
<li>Deshabilitar globalmente: <code>API_RATE_LIMIT_ENABLED=no</code></li>
<li>Establecer un límite global simple: <code>API_RATE_LIMIT_TIMES=100</code>, <code>API_RATE_LIMIT_SECONDS=60</code></li>
<li>Reglas por ruta: establece <code>API_RATE_LIMIT_RULES</code> en una ruta de archivo JSON/YAML o YAML en línea en <code>/etc/bunkerweb/api.yml</code>.</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Seguridad de inicio</p>
<p>La API se cierra si no hay una ruta de autenticación configurada (sin claves Biscuit, sin usuario administrador y sin <code>API_TOKEN</code>). Asegúrate de que al menos un método esté configurado antes de iniciar.</p>
</div>
<p>Seguridad de inicio: La API se cierra si no hay una ruta de autenticación disponible (sin claves Biscuit, sin usuario de API administrador y sin <code>API_TOKEN</code>). Asegúrate de que al menos una esté configurada.</p>
<div class="admonition info">
<p class="admonition-title">Ruta raíz y proxies</p>
<p>Si despliegas la API detrás de BunkerWeb en una subruta, establece <code>API_ROOT_PATH</code> en esa ruta para que <code>/docs</code> y las rutas relativas funcionen correctamente cuando se usan con un proxy.</p>
</div>
<h2 id="es-api-operaciones">Operaciones</h2>
<ul>
<li>Salud: <code>GET /health</code> devuelve <code>{"status":"ok"}</code> cuando el servicio está activo.</li>
<li>Servicio de Linux: se empaqueta una unidad <code>systemd</code> llamada <code>bunkerweb-api.service</code>. Personaliza a través de <code>/etc/bunkerweb/api.env</code> y gestiona con <code>systemctl</code>.</li>
<li>Seguridad de inicio: la API falla rápidamente cuando no hay una ruta de autenticación disponible (sin claves Biscuit, sin usuario administrador, sin <code>API_TOKEN</code>). Los errores se escriben en <code>/var/tmp/bunkerweb/api.error</code>.</li>
</ul></section><section class="print-page" id="es-upgrading" heading-number="9"><h1 id="es-upgrading-actualizacion">Actualización</h1>
<h2 id="es-upgrading-actualizacion-desde-16x">Actualización desde 1.6.X</h2>
<h3 id="es-upgrading-procedimiento">Procedimiento</h3>
<h4 id="es-upgrading-docker">Docker</h4>
<ol>
<li>
<p><strong>Hacer copia de seguridad de la base de datos</strong>:</p>
<ul>
<li>Antes de proceder con la actualización de la base de datos, asegúrate de realizar una copia de seguridad completa del estado actual de la base de datos.</li>
<li>Utiliza las herramientas adecuadas para hacer una copia de seguridad de toda la base de datos, incluyendo datos, esquemas y configuraciones.</li>
</ul>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/backup/directory<span class="w"> </span>/path/to/backup/directory
</code></pre></div>
</li>
<li>
<p><strong>Actualizar BunkerWeb</strong>:</p>
<ul>
<li>
<p>Actualiza BunkerWeb a la última versión.</p>
<ol>
<li>
<p><strong>Actualiza el archivo Docker Compose</strong>: Actualiza el archivo Docker Compose para usar la nueva versión de la imagen de BunkerWeb.
    <div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Reinicia los contenedores</strong>: Reinicia los contenedores para aplicar los cambios.
    <div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div></p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>Revisa los registros</strong>: Revisa los registros del servicio del programador para asegurarte de que la migración fue exitosa.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>&lt;scheduler_container&gt;
</code></pre></div>
</li>
<li>
<p><strong>Verifica la base de datos</strong>: Verifica que la actualización de la base de datos fue exitosa revisando los datos y las configuraciones en el nuevo contenedor de la base de datos.</p>
</li>
</ol>
<h4 id="es-upgrading-linux">Linux</h4>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="es-upgrading-__tabbed_1_1" name="es-upgrading-__tabbed_1" type="radio" /><input id="es-upgrading-__tabbed_1_2" name="es-upgrading-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_1_1">Actualización fácil usando el script de instalación</label><label for="es-upgrading-__tabbed_1_2">Manual</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ul>
<li>
<p><strong>Inicio rápido</strong>:</p>
<p>Para empezar, descarga el script de instalación y su suma de verificación, luego verifica la integridad del script antes de ejecutarlo.</p>
<div class="highlight"><pre><span></span><code><span class="nv">LATEST_VERSION</span><span class="o">=</span><span class="k">$(</span>curl<span class="w"> </span>-s<span class="w"> </span>https://api.github.com/repos/bunkerity/bunkerweb/releases/latest<span class="w"> </span><span class="p">|</span><span class="w"> </span>jq<span class="w"> </span>-r<span class="w"> </span>.tag_name<span class="k">)</span>

<span class="c1"># Descargar el script y su suma de verificación</span>
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/<span class="si">${</span><span class="nv">LATEST_VERSION</span><span class="si">}</span>/install-bunkerweb.sh
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/<span class="si">${</span><span class="nv">LATEST_VERSION</span><span class="si">}</span>/install-bunkerweb.sh.sha256

<span class="c1"># Verificar la suma de verificación</span>
sha256sum<span class="w"> </span>-c<span class="w"> </span>install-bunkerweb.sh.sha256

<span class="c1"># Si la verificación es exitosa, ejecuta el script</span>
chmod<span class="w"> </span>+x<span class="w"> </span>install-bunkerweb.sh
sudo<span class="w"> </span>./install-bunkerweb.sh
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Aviso de seguridad</p>
<p><strong>Siempre verifica la integridad del script de instalación antes de ejecutarlo.</strong></p>
<p>Descarga el archivo de suma de verificación y usa una herramienta como <code>sha256sum</code> para confirmar que el script no ha sido alterado o manipulado.</p>
<p>Si la verificación de la suma de verificación falla, <strong>no ejecutes el script</strong>—puede no ser seguro.</p>
</div>
</li>
<li>
<p><strong>Cómo funciona</strong>:</p>
<p>El mismo script de instalación multipropósito utilizado para instalaciones nuevas también puede realizar una actualización in situ. Cuando detecta una instalación existente y una versión de destino diferente, cambia al modo de actualización y aplica el siguiente flujo de trabajo:</p>
<ol>
<li>Detección y validación<ul>
<li>Detecta el SO/versión y confirma la matriz de soporte.</li>
<li>Lee la versión de BunkerWeb actualmente instalada desde <code>/usr/share/bunkerweb/VERSION</code>.</li>
</ul>
</li>
<li>Decisión del escenario de actualización<ul>
<li>Si la versión solicitada es igual a la instalada, se aborta (a menos que lo vuelvas a ejecutar explícitamente para ver el estado).</li>
<li>Si las versiones difieren, marca una actualización.</li>
</ul>
</li>
<li>(Opcional) Copia de seguridad automática previa a la actualización<ul>
<li>Si <code>bwcli</code> y el programador están disponibles y la copia de seguridad automática está habilitada, crea una copia de seguridad a través del plugin de copia de seguridad incorporado.</li>
<li>Destino: ya sea el directorio que proporcionaste con <code>--backup-dir</code> o una ruta generada como <code>/var/tmp/bunkerweb-backup-YYYYmmdd-HHMMSS</code>.</li>
<li>Puedes deshabilitar esto con <code>--no-auto-backup</code> (la copia de seguridad manual entonces se convierte en tu responsabilidad).</li>
</ul>
</li>
<li>Detención de servicios<ul>
<li>Detiene <code>bunkerweb</code>, <code>bunkerweb-ui</code> y <code>bunkerweb-scheduler</code> para garantizar una actualización consistente (coincide con las recomendaciones del procedimiento manual).</li>
</ul>
</li>
<li>Eliminación de bloqueos de paquetes<ul>
<li>Elimina temporalmente <code>apt-mark hold</code> / <code>dnf versionlock</code> en <code>bunkerweb</code> y <code>nginx</code> para que se pueda instalar la versión de destino.</li>
</ul>
</li>
<li>Ejecución de la actualización<ul>
<li>Instala solo la nueva versión del paquete de BunkerWeb (NGINX no se reinstala en modo de actualización a menos que falte, esto evita tocar un NGINX correctamente anclado).</li>
<li>Vuelve a aplicar los bloqueos/versionlocks para congelar las versiones actualizadas.</li>
</ul>
</li>
<li>Finalización y estado<ul>
<li>Muestra el estado de systemd para los servicios principales y los próximos pasos.</li>
<li>Deja tu configuración y base de datos intactas: solo se actualiza el código de la aplicación y los archivos gestionados.</li>
</ul>
</li>
</ol>
<p>Comportamientos clave / notas:</p>
<ul>
<li>El script NO modifica tu <code>/etc/bunkerweb/variables.env</code> ni el contenido de la base de datos.</li>
<li>Si la copia de seguridad automática falló (o se deshabilitó), aún puedes hacer una restauración manual usando la sección de Reversión a continuación.</li>
<li>El modo de actualización evita intencionadamente reinstalar o degradar NGINX fuera de la versión anclada compatible ya presente.</li>
<li>Los registros para la solución de problemas permanecen en <code>/var/log/bunkerweb/</code>.</li>
</ul>
<p>Resumen de la reversión:</p>
<ul>
<li>Usa el directorio de copia de seguridad generado (o tu copia de seguridad manual) + los pasos en la sección de Reversión para restaurar la base de datos, luego reinstala la versión anterior de la imagen/paquete y vuelve a bloquear los paquetes.</li>
</ul>
</li>
<li>
<p><strong>Opciones de línea de comandos</strong>:</p>
<p>Puedes realizar actualizaciones desatendidas con los mismos indicadores utilizados para la instalación. Los más relevantes para las actualizaciones:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Opción</th>
<th style="text-align: left;">Propósito</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;"><code>-v, --version &lt;X.Y.Z&gt;</code></td>
<td style="text-align: left;">Versión de BunkerWeb de destino a la que actualizar.</td>
</tr>
<tr>
<td style="text-align: left;"><code>-y, --yes</code></td>
<td style="text-align: left;">No interactivo (asume la confirmación de la actualización y habilita la copia de seguridad automática a menos que se use <code>--no-auto-backup</code>).</td>
</tr>
<tr>
<td style="text-align: left;"><code>--backup-dir &lt;RUTA&gt;</code></td>
<td style="text-align: left;">Destino para la copia de seguridad automática previa a la actualización. Se crea si no existe.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--no-auto-backup</code></td>
<td style="text-align: left;">Omitir la copia de seguridad automática (NO recomendado). Debes tener una copia de seguridad manual.</td>
</tr>
<tr>
<td style="text-align: left;"><code>-q, --quiet</code></td>
<td style="text-align: left;">Suprimir la salida (combinar con registro / monitoreo).</td>
</tr>
<tr>
<td style="text-align: left;"><code>-f, --force</code></td>
<td style="text-align: left;">Continuar en una versión de SO no compatible.</td>
</tr>
<tr>
<td style="text-align: left;"><code>--dry-run</code></td>
<td style="text-align: left;">Mostrar el entorno detectado, las acciones previstas y luego salir sin cambiar nada.</td>
</tr>
</tbody>
</table>
<p>Ejemplos:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Actualizar a testing interactivamente (pedirá confirmación para la copia de seguridad)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--version<span class="w"> </span>testing

<span class="c1"># Actualización no interactiva con copia de seguridad automática a un directorio personalizado</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>-v<span class="w"> </span>testing<span class="w"> </span>--backup-dir<span class="w"> </span>/var/backups/bw-2025-01<span class="w"> </span>-y

<span class="c1"># Actualización desatendida silenciosa (salida suprimida) – depende de la copia de seguridad automática predeterminada</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>-v<span class="w"> </span>testing<span class="w"> </span>-y<span class="w"> </span>-q

<span class="c1"># Realizar una ejecución de prueba (plan) sin aplicar cambios</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>-v<span class="w"> </span>testing<span class="w"> </span>--dry-run

<span class="c1"># Actualizar omitiendo la copia de seguridad automática (NO recomendado)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>-v<span class="w"> </span>testing<span class="w"> </span>--no-auto-backup<span class="w"> </span>-y
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Omitir copias de seguridad</p>
<p>Usar <code>--no-auto-backup</code> sin tener una copia de seguridad manual verificada puede resultar en una pérdida de datos irreversible si la actualización encuentra problemas. Siempre mantén al menos una copia de seguridad reciente y probada.</p>
</div>
</li>
</ul>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Hacer copia de seguridad de la base de datos</strong>:</p>
<ul>
<li>Antes de proceder con la actualización de la base de datos, asegúrate de realizar una copia de seguridad completa del estado actual de la base de datos.</li>
<li>Utiliza las herramientas adecuadas para hacer una copia de seguridad de toda la base de datos, incluyendo datos, esquemas y configuraciones.</li>
</ul>
<details class="warning">
<summary>Información para usuarios de Red Hat Enterprise Linux (RHEL) 8.10</summary>
<p>Si estás usando <strong>RHEL 8.10</strong> y planeas usar una <strong>base de datos externa</strong>, necesitarás instalar el paquete <code>mysql-community-client</code> para asegurar que el comando <code>mysqldump</code> esté disponible. Puedes instalar el paquete ejecutando los siguientes comandos:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="es-upgrading-__tabbed_2_1" name="es-upgrading-__tabbed_2" type="radio" /><input id="es-upgrading-__tabbed_2_2" name="es-upgrading-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_2_1">MySQL/MariaDB</label><label for="es-upgrading-__tabbed_2_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Instalar el paquete de configuración del repositorio de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>https://dev.mysql.com/get/mysql80-community-release-el8-9.noarch.rpm
</code></pre></div>
</li>
<li>
<p><strong>Habilitar el repositorio de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--enable<span class="w"> </span>mysql80-community
</code></pre></div>
</li>
<li>
<p><strong>Instalar el cliente de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql-community-client
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Instalar el paquete de configuración del repositorio de PostgreSQL</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">/pgdg-redhat-repo-latest.noarch.rpm&quot;</span>
</code></pre></div>
</li>
<li>
<p><strong>Instalar el cliente de PostgreSQL</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span>postgresql&lt;version&gt;
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</details>
<div class="highlight"><pre><span></span><code><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
</li>
<li>
<p><strong>Actualizar BunkerWeb</strong>:</p>
<ul>
<li>
<p>Actualiza BunkerWeb a la última versión.</p>
<ol>
<li>
<p><strong>Detener los servicios</strong>:
    <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb-ui
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb-scheduler
</code></pre></div></p>
</li>
<li>
<p><strong>Actualizar BunkerWeb</strong>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="es-upgrading-__tabbed_3_1" name="es-upgrading-__tabbed_3" type="radio" /><input id="es-upgrading-__tabbed_3_2" name="es-upgrading-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_3_1">Debian/Ubuntu</label><label for="es-upgrading-__tabbed_3_2">Fedora/RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Primero, si has mantenido previamente el paquete de BunkerWeb, desmárcalo:</p>
<p>Puedes imprimir una lista de paquetes mantenidos con <code>apt-mark showhold</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>unhold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>Luego, puedes actualizar el paquete de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span>testing
</code></pre></div>
<p>Para evitar que el paquete de BunkerWeb se actualice al ejecutar <code>apt upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>Más detalles en la <a href="#es-integrations-__tabbed_1_1">página de integración con Linux</a>.</p>
</div>
<div class="tabbed-block">
<p>Primero, si has mantenido previamente el paquete de BunkerWeb, desmárcalo:</p>
<p>Puedes imprimir una lista de paquetes mantenidos con <code>dnf versionlock list</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>nginx
</code></pre></div>
<p>Luego, puedes actualizar el paquete de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-testing
</code></pre></div>
<p>Para evitar que el paquete de BunkerWeb se actualice al ejecutar <code>dnf upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx
</code></pre></div>
<p>Más detalles en la <a href="#es-integrations-__tabbed_1_3">página de integración con Linux</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p><strong>Iniciar los servicios</strong>:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-ui
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
        O reinicia el sistema:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>reboot
</code></pre></div></p>
</li>
</ol>
</li>
</ul>
</li>
<li>
<p><strong>Revisa los registros</strong>: Revisa los registros del servicio del programador para asegurarte de que la migración fue exitosa.</p>
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-u<span class="w"> </span>bunkerweb<span class="w"> </span>--no-pager
</code></pre></div>
</li>
<li>
<p><strong>Verifica la base de datos</strong>: Verifica que la actualización de la base de datos fue exitosa revisando los datos y las configuraciones en el nuevo contenedor de la base de datos.</p>
</li>
</ol>
</div>
</div>
</div>
<h3 id="es-upgrading-reversion">Reversión</h3>
<div class="admonition failure">
<p class="admonition-title">En caso de problemas</p>
<p>Si encuentras algún problema durante la actualización, puedes volver a la versión anterior de la base de datos restaurando la copia de seguridad tomada en el <a href="#es-upgrading-__tabbed_1_1">paso 1</a>.</p>
<p>Obtén soporte y más información:</p>
<ul>
<li><a href="https://panel.bunkerweb.io/?utm_source=doc&amp;utm_campaign=self">Solicitar soporte profesional</a></li>
<li><a href="https://github.com/bunkerity/bunkerweb/issues">Crear un issue en GitHub</a></li>
<li><a href="https://discord.bunkerity.com">Unirse al servidor de Discord de BunkerWeb</a></li>
</ul>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="es-upgrading-__tabbed_4_1" name="es-upgrading-__tabbed_4" type="radio" /><input id="es-upgrading-__tabbed_4_2" name="es-upgrading-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_4_1">Docker</label><label for="es-upgrading-__tabbed_4_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extrae la copia de seguridad si está comprimida</strong>.</p>
<p>Primero extrae el archivo zip de la copia de seguridad:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="es-upgrading-__tabbed_5_1" name="es-upgrading-__tabbed_5" type="radio" /><input id="es-upgrading-__tabbed_5_2" name="es-upgrading-__tabbed_5" type="radio" /><input id="es-upgrading-__tabbed_5_3" name="es-upgrading-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_5_1">SQLite</label><label for="es-upgrading-__tabbed_5_2">MySQL/MariaDB</label><label for="es-upgrading-__tabbed_5_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Elimina el archivo de la base de datos existente.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Corrige los permisos.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Detén la pila.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;your_password&gt;<span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Detén la pila.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Elimina la base de datos existente.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Vuelve a crear la base de datos.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Detén la pila.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Retrocede la versión de BunkerWeb</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</li>
<li>
<p><strong>Inicia los contenedores</strong>.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extrae la copia de seguridad si está comprimida</strong>.</p>
<p>Primero extrae el archivo zip de la copia de seguridad:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Detén los servicios</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:3"><input checked="checked" id="es-upgrading-__tabbed_6_1" name="es-upgrading-__tabbed_6" type="radio" /><input id="es-upgrading-__tabbed_6_2" name="es-upgrading-__tabbed_6" type="radio" /><input id="es-upgrading-__tabbed_6_3" name="es-upgrading-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_6_1">SQLite</label><label for="es-upgrading-__tabbed_6_2">MySQL/MariaDB</label><label for="es-upgrading-__tabbed_6_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
sudo<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Elimina la base de datos existente.</strong></p>
<div class="highlight"><pre><span></span><code>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Vuelve a crear la base de datos.</strong></p>
<div class="highlight"><pre><span></span><code>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Inicia los servicios</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Retrocede la versión de BunkerWeb</strong>.</p>
<ul>
<li>Retrocede BunkerWeb a la versión anterior siguiendo los mismos pasos que al actualizar BunkerWeb en la <a href="#es-integrations-linux">página de integración con Linux</a></li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<h2 id="es-upgrading-actualizacion-desde-15x">Actualización desde 1.5.X</h2>
<h3 id="es-upgrading-que-ha-cambiado">¿Qué ha cambiado?</h3>
<h4 id="es-upgrading-programador">Programador</h4>
<p>A diferencia de las versiones 1.5.X, el servicio del Programador <strong>ya no utiliza el <em>proxy del socket de Docker</em> para obtener las instancias de BunkerWeb</strong>. En su lugar, utiliza la nueva variable de entorno <code>BUNKERWEB_INSTANCES</code>.</p>
<div class="admonition info">
<p class="admonition-title">Sobre la variable de entorno <code>BUNKERWEB_INSTANCES</code></p>
<p>Esta nueva variable es una lista de instancias de BunkerWeb separadas por espacios en este formato: <code>http://bunkerweb:5000 bunkerweb1:5000 bunkerweb2:5000 ...</code>. El programador utilizará entonces esta lista para obtener la configuración de las instancias y enviarles la configuración.</p>
<ul>
<li>El prefijo <code>http://</code> es opcional.</li>
<li>El puerto es opcional y por defecto es el valor de la variable de entorno <code>API_HTTP_PORT</code>.</li>
<li>El valor predeterminado de la variable de entorno <code>BUNKERWEB_INSTANCES</code> es <code>127.0.0.1</code>.</li>
</ul>
</div>
<p>En otras palabras, el nuevo sistema es totalmente agnóstico y genérico: el programador se encarga de gestionar una lista de instancias de BunkerWeb y no necesita preocuparse por el entorno.</p>
<div class="admonition tip">
<p class="admonition-title">Integraciones Autoconf/Kubernetes/Swarm</p>
<p>Si estás utilizando las integraciones <code>Autoconf</code>, <code>Kubernetes</code> o <code>Swarm</code>, puedes establecer la variable de entorno <code>BUNKERWEB_INSTANCES</code> en una cadena vacía (para que no intente enviar la configuración a la predeterminada que es <code>127.0.0.1</code>).</p>
<p><strong>Las instancias serán obtenidas automáticamente por el controlador</strong>. También puedes añadir instancias personalizadas a la lista que pueden no ser recogidas por el controlador.</p>
</div>
<p>Desde la versión <code>1.6</code>, el Programador también tiene un nuevo <a href="#es-concepts">sistema de comprobación de estado integrado</a>, que comprobará la salud de las instancias. Si una instancia deja de estar saludable, el programador dejará de enviarle la configuración. Si la instancia vuelve a estar saludable, el programador comenzará a enviarle la configuración de nuevo.</p>
<h4 id="es-upgrading-contenedor-de-bunkerweb">Contenedor de BunkerWeb</h4>
<p>Otro cambio importante es que las <strong>configuraciones</strong> que antes se declaraban en el contenedor de BunkerWeb <strong>ahora se declaran en el programador</strong>. Esto significa que tendrás que mover tus configuraciones del contenedor de BunkerWeb al contenedor del Programador.</p>
<p>Aunque las configuraciones se declaran ahora en el contenedor del Programador, <strong>todavía necesitarás declarar las configuraciones obligatorias relacionadas con la API en el contenedor de BunkerWeb</strong>, como la configuración <code>API_WHITELIST_IP</code>, que se utiliza para incluir en la lista blanca la dirección IP del Programador, para que pueda enviar la configuración a la instancia. Si usas <code>API_TOKEN</code>, también debes establecerlo en el contenedor de BunkerWeb (y reflejarlo en el Programador) para permitir las llamadas a la API autenticadas.</p>
<div class="admonition warning">
<p class="admonition-title">Configuraciones del contenedor de BunkerWeb</p>
<p>Cada configuración relacionada con la API que declares en el contenedor de BunkerWeb <strong>tiene que ser reflejada en el contenedor del Programador</strong> para que siga funcionando, ya que la configuración será sobrescrita por la configuración generada por el Programador.</p>
</div>
<h4 id="es-upgrading-valores-predeterminados-y-nuevas-configuraciones">Valores predeterminados y nuevas configuraciones</h4>
<p>Hicimos nuestro mejor esfuerzo para no cambiar el valor predeterminado, pero hemos añadido muchas otras configuraciones. Se recomienda encarecidamente leer las secciones de <a href="#es-advanced-security-tuning">ajuste de seguridad</a> y <a href="#es-features">configuraciones</a> de la documentación.</p>
<h4 id="es-upgrading-plantillas">Plantillas</h4>
<p>Hemos añadido una nueva característica llamada <strong>plantillas</strong>. Las plantillas proporcionan un enfoque estructurado y estandarizado para definir configuraciones y configuraciones personalizadas, consulta la sección <a href="#es-concepts-templates">conceptos/plantillas</a> para obtener más información.</p>
<h4 id="es-upgrading-espacios-de-nombres-de-autoconf">Espacios de nombres de Autoconf</h4>
<p>Hemos añadido una característica de <strong>espacio de nombres</strong> a las integraciones de autoconfiguración. Los espacios de nombres te permiten agrupar tus instancias y aplicarles configuraciones solo a ellas. Consulta las siguientes secciones según tu Integración para obtener más información:</p>
<ul>
<li><a href="#es-integrations-namespaces">Autoconf/espacios de nombres</a></li>
<li><a href="#es-integrations-namespaces_1">Kubernetes/espacios de nombres</a></li>
<li><a href="#es-integrations-namespaces_2">Swarm/espacios de nombres</a></li>
</ul>
<h3 id="es-upgrading-procedimiento_1">Procedimiento</h3>
<ol>
<li>
<p><strong>Hacer copia de seguridad de la base de datos</strong>:</p>
<ul>
<li>Antes de proceder con la actualización de la base de datos, asegúrate de realizar una copia de seguridad completa del estado actual de la base de datos.</li>
<li>Utiliza las herramientas adecuadas para hacer una copia de seguridad de toda la base de datos, incluyendo datos, esquemas y configuraciones.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="es-upgrading-__tabbed_7_1" name="es-upgrading-__tabbed_7" type="radio" /><input id="es-upgrading-__tabbed_7_2" name="es-upgrading-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_7_1">1.5.7 y posteriores</label><label for="es-upgrading-__tabbed_7_2">1.5.6 y anteriores</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="8:2"><input checked="checked" id="es-upgrading-__tabbed_8_1" name="es-upgrading-__tabbed_8" type="radio" /><input id="es-upgrading-__tabbed_8_2" name="es-upgrading-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_8_1">Docker</label><label for="es-upgrading-__tabbed_8_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/backup/directory<span class="w"> </span>/path/to/backup/directory
</code></pre></div>
</div>
<div class="tabbed-block">
<details class="warning">
<summary>Información para usuarios de Red Hat Enterprise Linux (RHEL) 8.10</summary>
<p>Si estás usando <strong>RHEL 8.10</strong> y planeas usar una <strong>base de datos externa</strong>, necesitarás instalar el paquete <code>mysql-community-client</code> para asegurar que el comando <code>mysqldump</code> esté disponible. Puedes instalar el paquete ejecutando los siguientes comandos:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="es-upgrading-__tabbed_9_1" name="es-upgrading-__tabbed_9" type="radio" /><input id="es-upgrading-__tabbed_9_2" name="es-upgrading-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_9_1">MySQL/MariaDB</label><label for="es-upgrading-__tabbed_9_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Instalar el paquete de configuración del repositorio de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>https://dev.mysql.com/get/mysql80-community-release-el8-9.noarch.rpm
</code></pre></div>
</li>
<li>
<p><strong>Habilitar el repositorio de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--enable<span class="w"> </span>mysql80-community
</code></pre></div>
</li>
<li>
<p><strong>Instalar el cliente de MySQL</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql-community-client
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Instalar el paquete de configuración del repositorio de PostgreSQL</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">/pgdg-redhat-repo-latest.noarch.rpm&quot;</span>
</code></pre></div>
</li>
<li>
<p><strong>Instalar el cliente de PostgreSQL</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span>postgresql&lt;version&gt;
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</details>
<div class="highlight"><pre><span></span><code><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="10:4"><input checked="checked" id="es-upgrading-__tabbed_10_1" name="es-upgrading-__tabbed_10" type="radio" /><input id="es-upgrading-__tabbed_10_2" name="es-upgrading-__tabbed_10" type="radio" /><input id="es-upgrading-__tabbed_10_3" name="es-upgrading-__tabbed_10" type="radio" /><input id="es-upgrading-__tabbed_10_4" name="es-upgrading-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_10_1">SQLite</label><label for="es-upgrading-__tabbed_10_2">MariaDB</label><label for="es-upgrading-__tabbed_10_3">MySQL</label><label for="es-upgrading-__tabbed_10_4">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="es-upgrading-__tabbed_11_1" name="es-upgrading-__tabbed_11" type="radio" /><input id="es-upgrading-__tabbed_11_2" name="es-upgrading-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_11_1">Docker</label><label for="es-upgrading-__tabbed_11_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Primero necesitamos instalar el paquete <code>sqlite</code> en el contenedor.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>apk<span class="w"> </span>add<span class="w"> </span>sqlite
</code></pre></div>
<p>Luego, haz una copia de seguridad de la base de datos.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span><span class="s2">&quot;.dump&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span><span class="s2">&quot;.dump&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="es-upgrading-__tabbed_12_1" name="es-upgrading-__tabbed_12" type="radio" /><input id="es-upgrading-__tabbed_12_2" name="es-upgrading-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_12_1">Docker</label><label for="es-upgrading-__tabbed_12_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mariadb-dump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>mariadb-dump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="es-upgrading-__tabbed_13_1" name="es-upgrading-__tabbed_13" type="radio" /><input id="es-upgrading-__tabbed_13_2" name="es-upgrading-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_13_1">Docker</label><label for="es-upgrading-__tabbed_13_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mysqldump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>mysqldump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="es-upgrading-__tabbed_14_1" name="es-upgrading-__tabbed_14" type="radio" /><input id="es-upgrading-__tabbed_14_2" name="es-upgrading-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_14_1">Docker</label><label for="es-upgrading-__tabbed_14_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">PGPASSWORD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>pg_dump<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">PGPASSWORD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>pg_dump<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</li>
<li>
<p><strong>Actualizar BunkerWeb</strong>:</p>
<ul>
<li>
<p>Actualiza BunkerWeb a la última versión.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="es-upgrading-__tabbed_15_1" name="es-upgrading-__tabbed_15" type="radio" /><input id="es-upgrading-__tabbed_15_2" name="es-upgrading-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_15_1">Docker</label><label for="es-upgrading-__tabbed_15_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Actualiza el archivo Docker Compose</strong>: Actualiza el archivo Docker Compose para usar la nueva versión de la imagen de BunkerWeb.
    <div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:testing</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Reinicia los contenedores</strong>: Reinicia los contenedores para aplicar los cambios.
    <div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div></p>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Detén los servicios</strong>:
    <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb-ui
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb-scheduler
</code></pre></div></p>
</li>
<li>
<p><strong>Actualiza BunkerWeb</strong>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="es-upgrading-__tabbed_16_1" name="es-upgrading-__tabbed_16" type="radio" /><input id="es-upgrading-__tabbed_16_2" name="es-upgrading-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_16_1">Debian/Ubuntu</label><label for="es-upgrading-__tabbed_16_2">Fedora/RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Primero, si has mantenido previamente el paquete de BunkerWeb, desmárcalo:</p>
<p>Puedes imprimir una lista de paquetes mantenidos con <code>apt-mark showhold</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>unhold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>Luego, puedes actualizar el paquete de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span>testing
</code></pre></div>
<p>Para evitar que el paquete de BunkerWeb se actualice al ejecutar <code>apt upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>Más detalles en la <a href="#es-integrations-__tabbed_1_1">página de integración con Linux</a>.</p>
</div>
<div class="tabbed-block">
<p>Primero, si has mantenido previamente el paquete de BunkerWeb, desmárcalo:</p>
<p>Puedes imprimir una lista de paquetes mantenidos con <code>dnf versionlock list</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>nginx
</code></pre></div>
<p>Luego, puedes actualizar el paquete de BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-testing
</code></pre></div>
<p>Para evitar que el paquete de BunkerWeb se actualice al ejecutar <code>dnf upgrade</code>, puedes usar el siguiente comando:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx
</code></pre></div>
<p>Más detalles en la <a href="#es-integrations-__tabbed_1_3">página de integración con Linux</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p><strong>Inicia los servicios</strong>:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-ui
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
        O reinicia el sistema:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>reboot
</code></pre></div></p>
</li>
</ol>
</div>
</div>
</div>
</li>
</ul>
</li>
<li>
<p><strong>Revisa los registros</strong>: Revisa los registros del servicio del programador para asegurarte de que la migración fue exitosa.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="es-upgrading-__tabbed_17_1" name="es-upgrading-__tabbed_17" type="radio" /><input id="es-upgrading-__tabbed_17_2" name="es-upgrading-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_17_1">Docker</label><label for="es-upgrading-__tabbed_17_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>&lt;scheduler_container&gt;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-u<span class="w"> </span>bunkerweb<span class="w"> </span>--no-pager
</code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p><strong>Verifica la base de datos</strong>: Verifica que la actualización de la base de datos fue exitosa revisando los datos y las configuraciones en el nuevo contenedor de la base de datos.</p>
</li>
</ol>
<h3 id="es-upgrading-reversion_1">Reversión</h3>
<div class="admonition failure">
<p class="admonition-title">En caso de problemas</p>
<p>Si encuentras algún problema durante la actualización, puedes volver a la versión anterior de la base de datos restaurando la copia de seguridad tomada en el <a href="#es-upgrading-__tabbed_1_1">paso 1</a>.</p>
<p>Obtén soporte y más información:</p>
<ul>
<li><a href="https://panel.bunkerweb.io/?utm_source=doc&amp;utm_campaign=self">Solicitar soporte profesional</a></li>
<li><a href="https://github.com/bunkerity/bunkerweb/issues">Crear un issue en GitHub</a></li>
<li><a href="https://discord.bunkerity.com">Unirse al servidor de Discord de BunkerWeb</a></li>
</ul>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="es-upgrading-__tabbed_18_1" name="es-upgrading-__tabbed_18" type="radio" /><input id="es-upgrading-__tabbed_18_2" name="es-upgrading-__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_18_1">Docker</label><label for="es-upgrading-__tabbed_18_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extrae la copia de seguridad si está comprimida</strong>.</p>
<p>Primero extrae el archivo zip de la copia de seguridad:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:3"><input checked="checked" id="es-upgrading-__tabbed_19_1" name="es-upgrading-__tabbed_19" type="radio" /><input id="es-upgrading-__tabbed_19_2" name="es-upgrading-__tabbed_19" type="radio" /><input id="es-upgrading-__tabbed_19_3" name="es-upgrading-__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_19_1">SQLite</label><label for="es-upgrading-__tabbed_19_2">MySQL/MariaDB</label><label for="es-upgrading-__tabbed_19_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Elimina el archivo de la base de datos existente.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Corrige los permisos.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Detén la pila.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;your_password&gt;<span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Detén la pila.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Elimina la base de datos existente.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Vuelve a crear la base de datos.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Detén la pila.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Retrocede la versión de BunkerWeb</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</li>
<li>
<p><strong>Inicia los contenedores</strong>.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extrae la copia de seguridad si está comprimida</strong>.</p>
<p>Primero extrae el archivo zip de la copia de seguridad:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Detén los servicios</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:3"><input checked="checked" id="es-upgrading-__tabbed_20_1" name="es-upgrading-__tabbed_20" type="radio" /><input id="es-upgrading-__tabbed_20_2" name="es-upgrading-__tabbed_20" type="radio" /><input id="es-upgrading-__tabbed_20_3" name="es-upgrading-__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="es-upgrading-__tabbed_20_1">SQLite</label><label for="es-upgrading-__tabbed_20_2">MySQL/MariaDB</label><label for="es-upgrading-__tabbed_20_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
sudo<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Elimina la base de datos existente.</strong></p>
<div class="highlight"><pre><span></span><code>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Vuelve a crear la base de datos.</strong></p>
<div class="highlight"><pre><span></span><code>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restaura la copia de seguridad.</strong></p>
<div class="highlight"><pre><span></span><code>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Inicia los servicios</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Retrocede la versión de BunkerWeb</strong>.</p>
<ul>
<li>Retrocede BunkerWeb a la versión anterior siguiendo los mismos pasos que al actualizar BunkerWeb en la <a href="#es-integrations-linux">página de integración con Linux</a></li>
</ul>
</li>
</ol>
</div>
</div>
</div></section><section class="print-page" id="es-troubleshooting" heading-number="10"><h1 id="es-troubleshooting-solucion-de-problemas">Solución de problemas</h1>
<div class="admonition info">
<p class="admonition-title">Panel de BunkerWeb</p>
<p>Si no puedes resolver tu problema, puedes <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">contactarnos directamente a través de nuestro panel</a>. Esto centraliza todas las solicitudes relacionadas con la solución BunkerWeb.</p>
</div>
<h2 id="es-troubleshooting-registros">Registros</h2>
<p>Al solucionar problemas, los registros son tus mejores amigos. Hacemos nuestro mejor esfuerzo para proporcionar registros fáciles de usar para ayudarte a entender lo que está sucediendo.</p>
<p>Ten en cuenta que puedes establecer el <code>LOG_LEVEL</code> en <code>info</code> (predeterminado: <code>notice</code>) para aumentar la verbosidad de BunkerWeb.</p>
<p>Aquí te mostramos cómo puedes acceder a los registros, dependiendo de tu integración:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="checked" id="es-troubleshooting-__tabbed_1_1" name="es-troubleshooting-__tabbed_1" type="radio" /><input id="es-troubleshooting-__tabbed_1_2" name="es-troubleshooting-__tabbed_1" type="radio" /><input id="es-troubleshooting-__tabbed_1_3" name="es-troubleshooting-__tabbed_1" type="radio" /><input id="es-troubleshooting-__tabbed_1_4" name="es-troubleshooting-__tabbed_1" type="radio" /><input id="es-troubleshooting-__tabbed_1_5" name="es-troubleshooting-__tabbed_1" type="radio" /><input id="es-troubleshooting-__tabbed_1_6" name="es-troubleshooting-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-troubleshooting-__tabbed_1_1">Docker</label><label for="es-troubleshooting-__tabbed_1_2">Docker autoconf</label><label for="es-troubleshooting-__tabbed_1_3">Todo en uno</label><label for="es-troubleshooting-__tabbed_1_4">Swarm</label><label for="es-troubleshooting-__tabbed_1_5">Kubernetes</label><label for="es-troubleshooting-__tabbed_1_6">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">Listar contenedores</p>
<p>Para listar los contenedores en ejecución, puedes usar el siguiente comando:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps
</code></pre></div></p>
</div>
<p>Puedes usar el comando <code>docker logs</code> (reemplaza <code>bunkerweb</code> con el nombre de tu contenedor):
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>bunkerweb
</code></pre></div></p>
<p>Aquí está el equivalente de docker-compose (reemplaza <code>bunkerweb</code> con el nombre de los servicios declarados en el archivo docker-compose.yml):
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>logs<span class="w"> </span>bunkerweb
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">Listar contenedores</p>
<p>Para listar los contenedores en ejecución, puedes usar el siguiente comando:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps
</code></pre></div></p>
</div>
<p>Puedes usar el comando <code>docker logs</code> (reemplaza <code>bunkerweb</code> y <code>bw-autoconf</code> con el nombre de tus contenedores):
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>bunkerweb
docker<span class="w"> </span>logs<span class="w"> </span>bw-autoconf
</code></pre></div></p>
<p>Aquí está el equivalente de docker-compose (reemplaza <code>bunkerweb</code> y <code>bw-autoconf</code> con el nombre de los servicios declarados en el archivo docker-compose.yml):
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>logs<span class="w"> </span>bunkerweb
docker-compose<span class="w"> </span>logs<span class="w"> </span>bw-autoconf
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">Nombre del contenedor</p>
<p>El nombre del contenedor predeterminado para la imagen Todo en uno es <code>bunkerweb-aio</code>. Si has usado un nombre diferente, por favor ajusta el comando en consecuencia.</p>
</div>
<p>Puedes usar el comando <code>docker logs</code>:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>bunkerweb-aio
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Puedes encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<div class="admonition tip">
<p class="admonition-title">Listar servicios</p>
<p>Para listar los servicios, puedes usar el siguiente comando:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>service<span class="w"> </span>ls
</code></pre></div></p>
</div>
<p>Puedes usar el comando <code>docker service logs</code> (reemplaza <code>bunkerweb</code> y <code>bw-autoconf</code> con el nombre de tus servicios):
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>service<span class="w"> </span>logs<span class="w"> </span>bunkerweb
docker<span class="w"> </span>service<span class="w"> </span>logs<span class="w"> </span>bw-autoconf
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">Listar pods</p>
<p>Para listar los pods, puedes usar el siguiente comando:
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div></p>
</div>
<p>Puedes usar el comando <code>kubectl logs</code> (reemplaza <code>bunkerweb</code> y <code>bunkerweb-controler</code> con el nombre de tus pods):
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>logs<span class="w"> </span>bunkerweb
kubectl<span class="w"> </span>logs<span class="w"> </span>bunkerweb-controler
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Para errores relacionados con los servicios de BunkerWeb (p. ej., que no se inician), puedes usar <code>journalctl</code>:
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-u<span class="w"> </span>bunkerweb<span class="w"> </span>--no-pager
</code></pre></div></p>
<p>Los registros comunes se encuentran dentro del directorio <code>/var/log/bunkerweb</code>:
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/var/log/bunkerweb/error.log
cat<span class="w"> </span>/var/log/bunkerweb/access.log
</code></pre></div></p>
</div>
</div>
</div>
<h2 id="es-troubleshooting-permisos">Permisos</h2>
<p>No olvides que BunkerWeb se ejecuta como un usuario sin privilegios por razones de seguridad obvias. Verifica dos veces los permisos de los archivos y carpetas utilizados por BunkerWeb, especialmente si usas configuraciones personalizadas (más información <a href="#es-advanced-custom-configurations">aquí</a>). Necesitarás establecer al menos derechos <strong><em>RW</em></strong> en los archivos y <strong><em>RWX</em></strong> en las carpetas.</p>
<h2 id="es-troubleshooting-desbloqueo-de-ip">Desbloqueo de IP</h2>
<p>Puedes desbloquear manualmente una IP, lo cual es útil al realizar pruebas para que puedas contactar la API interna de BunkerWeb (reemplaza <code>1.2.3.4</code> con la dirección IP a desbloquear):</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:5"><input checked="checked" id="es-troubleshooting-__tabbed_2_1" name="es-troubleshooting-__tabbed_2" type="radio" /><input id="es-troubleshooting-__tabbed_2_2" name="es-troubleshooting-__tabbed_2" type="radio" /><input id="es-troubleshooting-__tabbed_2_3" name="es-troubleshooting-__tabbed_2" type="radio" /><input id="es-troubleshooting-__tabbed_2_4" name="es-troubleshooting-__tabbed_2" type="radio" /><input id="es-troubleshooting-__tabbed_2_5" name="es-troubleshooting-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="es-troubleshooting-__tabbed_2_1">Docker / Docker Autoconf</label><label for="es-troubleshooting-__tabbed_2_2">Todo en uno</label><label for="es-troubleshooting-__tabbed_2_3">Swarm</label><label for="es-troubleshooting-__tabbed_2_4">Kubernetes</label><label for="es-troubleshooting-__tabbed_2_5">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Puedes usar el comando <code>docker exec</code> (reemplaza <code>bw-scheduler</code> con el nombre de tu contenedor):
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>bw-scheduler<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
<p>Aquí está el equivalente de docker-compose (reemplaza <code>bw-scheduler</code> con el nombre de los servicios declarados en el archivo docker-compose.yml):
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>bw-scheduler<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">Nombre del contenedor</p>
<p>El nombre del contenedor predeterminado para la imagen Todo en uno es <code>bunkerweb-aio</code>. Si has usado un nombre diferente, por favor ajusta el comando en consecuencia.</p>
</div>
<p>Puedes usar el comando <code>docker exec</code>:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>bunkerweb-aio<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Puedes encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Puedes usar el comando <code>docker exec</code> (reemplaza <code>bw-scheduler</code> con el nombre de tu servicio):
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>ps<span class="w"> </span>-q<span class="w"> </span>-f<span class="w"> </span><span class="nv">name</span><span class="o">=</span>bw-scheduler<span class="k">)</span><span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Puedes usar el comando <code>kubectl exec</code> (reemplaza <code>bunkerweb-scheduler</code> con el nombre de tu pod):
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>bunkerweb-scheduler<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>Puedes usar el comando <code>bwcli</code> (como root):
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
</div>
</div>
<h2 id="es-troubleshooting-falsos-positivos">Falsos positivos</h2>
<h3 id="es-troubleshooting-modo-de-solo-deteccion">Modo de solo detección</h3>
<p>Para fines de depuración/prueba, puedes configurar BunkerWeb en <a href="#es-features-security-modes">modo de solo detección</a> para que no bloquee las solicitudes y actúe como un proxy inverso clásico.</p>
<h3 id="es-troubleshooting-modsecurity">ModSecurity</h3>
<p>La configuración predeterminada de ModSecurity de BunkerWeb es cargar el Core Rule Set en modo de puntuación de anomalías con un nivel de paranoia (PL) de 1:</p>
<ul>
<li>Cada regla que coincida aumentará una puntuación de anomalía (por lo que muchas reglas pueden coincidir con una sola solicitud)</li>
<li>PL1 incluye reglas con menos posibilidades de falsos positivos (pero menos seguridad que PL4)</li>
<li>el umbral predeterminado para la puntuación de anomalía es 5 para las solicitudes y 4 para las respuestas</li>
</ul>
<p>Tomemos los siguientes registros como ejemplo de una detección de ModSecurity usando la configuración predeterminada (formateado para una mejor legibilidad):</p>
<div class="highlight"><pre><span></span><code>2022/04/26 12:01:10 [warn] 85#85: *11 ModSecurity: Warning. Matched &quot;Operator `PmFromFile&#39; with parameter `lfi-os-files.data&#39; against variable `ARGS:id&#39; (Value: `/etc/passwd&#39; )
    [file &quot;/usr/share/bunkerweb/core/modsecurity/files/coreruleset/rules/REQUEST-930-APPLICATION-ATTACK-LFI.conf&quot;]
    [line &quot;78&quot;]
    [id &quot;930120&quot;]
    [rev &quot;&quot;]
    [msg &quot;OS File Access Attempt&quot;]
    [data &quot;Matched Data: etc/passwd found within ARGS:id: /etc/passwd&quot;]
    [severity &quot;2&quot;]
    [ver &quot;OWASP_CRS/3.3.2&quot;]
    [maturity &quot;0&quot;]
    [accuracy &quot;0&quot;]
    [tag &quot;application-multi&quot;]
    [tag &quot;language-multi&quot;]
    [tag &quot;platform-multi&quot;]
    [tag &quot;attack-lfi&quot;]
    [tag &quot;paranoia-level/1&quot;]
    [tag &quot;OWASP_CRS&quot;]
    [tag &quot;capec/1000/255/153/126&quot;]
    [tag &quot;PCI/6.5.4&quot;]
    [hostname &quot;172.17.0.2&quot;]
    [uri &quot;/&quot;]
    [unique_id &quot;165097447014.179282&quot;]
    [ref &quot;o1,10v9,11t:utf8toUnicode,t:urlDecodeUni,t:normalizePathWin,t:lowercase&quot;],
    client: 172.17.0.1, server: localhost, request: &quot;GET /?id=/etc/passwd HTTP/1.1&quot;, host: &quot;localhost&quot;
2022/04/26 12:01:10 [warn] 85#85: *11 ModSecurity: Warning. Matched &quot;Operator `PmFromFile&#39; with parameter `unix-shell.data&#39; against variable `ARGS:id&#39; (Value: `/etc/passwd&#39; )
    [file &quot;/usr/share/bunkerweb/core/modsecurity/files/coreruleset/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf&quot;]
    [line &quot;480&quot;]
    [id &quot;932160&quot;]
    [rev &quot;&quot;]
    [msg &quot;Remote Command Execution: Unix Shell Code Found&quot;]
    [data &quot;Matched Data: etc/passwd found within ARGS:id: /etc/passwd&quot;]
    [severity &quot;2&quot;]
    [ver &quot;OWASP_CRS/3.3.2&quot;]
    [maturity &quot;0&quot;]
    [accuracy &quot;0&quot;]
    [tag &quot;application-multi&quot;]
    [tag &quot;language-shell&quot;]
    [tag &quot;platform-unix&quot;]
    [tag &quot;attack-rce&quot;]
    [tag &quot;paranoia-level/1&quot;]
    [tag &quot;OWASP_CRS&quot;]
    [tag &quot;capec/1000/152/248/88&quot;]
    [tag &quot;PCI/6.5.2&quot;]
    [hostname &quot;172.17.0.2&quot;]
    [uri &quot;/&quot;]
    [unique_id &quot;165097447014.179282&quot;]
    [ref &quot;o1,10v9,11t:urlDecodeUni,t:cmdLine,t:normalizePath,t:lowercase&quot;],
    client: 172.17.0.1, server: localhost, request: &quot;GET /?id=/etc/passwd HTTP/1.1&quot;, host: &quot;localhost&quot;
2022/04/26 12:01:10 [error] 85#85: *11 [client 172.17.0.1] ModSecurity: Access denied with code 403 (phase 2). Matched &quot;Operator `Ge&#39; with parameter `5&#39; against variable `TX:ANOMALY_SCORE&#39; (Value: `10&#39; )
    [file &quot;/usr/share/bunkerweb/core/modsecurity/files/coreruleset/rules/REQUEST-949-BLOCKING-EVALUATION.conf&quot;]
    [line &quot;80&quot;]
    [id &quot;949110&quot;]
    [rev &quot;&quot;]
    [msg &quot;Inbound Anomaly Score Exceeded (Total Score: 10)&quot;]
    [data &quot;&quot;]
    [severity &quot;2&quot;]
    [ver &quot;OWASP_CRS/3.3.2&quot;]
    [maturity &quot;0&quot;]
    [accuracy &quot;0&quot;]
    [tag &quot;application-multi&quot;]
    [tag &quot;language-multi&quot;]
    [tag &quot;platform-multi&quot;]
    [tag &quot;attack-generic&quot;]
    [hostname &quot;172.17.0.2&quot;]
    [uri &quot;/&quot;]
    [unique_id &quot;165097447014.179282&quot;]
    [ref &quot;&quot;],
    client: 172.17.0.1, server: localhost, request: &quot;GET /?id=/etc/passwd HTTP/1.1&quot;, host: &quot;localhost&quot;
</code></pre></div>
<p>Como podemos ver, hay 3 registros diferentes:</p>
<ol>
<li>La regla <strong>930120</strong> coincidió</li>
<li>La regla <strong>932160</strong> coincidió</li>
<li>Acceso denegado (regla <strong>949110</strong>)</li>
</ol>
<p>Una cosa importante a entender es que la regla <strong>949110</strong> no es una regla "real": es la que denegará la solicitud porque se alcanza el umbral de anomalía (que es <strong>10</strong> en este ejemplo). ¡Nunca deberías eliminar la regla <strong>949110</strong>!</p>
<p>Si se trata de un falso positivo, deberías centrarte en las reglas <strong>930120</strong> y <strong>932160</strong>. El ajuste de ModSecurity y/o CRS está fuera del alcance de esta documentación, pero no olvides que puedes aplicar configuraciones personalizadas antes y después de que se cargue el CRS (más información <a href="#es-advanced-custom-configurations">aquí</a>).</p>
<h3 id="es-troubleshooting-mal-comportamiento">Mal comportamiento</h3>
<p>Un caso común de falso positivo es cuando el cliente es baneado debido a la característica de "mal comportamiento", lo que significa que se generaron demasiados códigos de estado HTTP sospechosos en un período de tiempo (más información <a href="#es-features-bad-behavior">aquí</a>). Deberías empezar por revisar la configuración y luego editarla de acuerdo a tu(s) aplicación(es) web, como eliminar un código HTTP sospechoso, disminuir el tiempo de conteo, aumentar el umbral, ...</p>
<h3 id="es-troubleshooting-lista-blanca">Lista blanca</h3>
<p>Si tienes bots (o administradores) que necesitan acceder a tu sitio web, la forma recomendada de evitar cualquier falso positivo es incluirlos en la lista blanca usando la <a href="#es-features-whitelist">característica de lista blanca</a>. No recomendamos usar las configuraciones <code>WHITELIST_URI*</code> o <code>WHITELIST_USER_AGENT*</code> a menos que se establezcan en valores secretos e impredecibles. Los casos de uso comunes son:</p>
<ul>
<li>Bot de comprobación de estado / estado</li>
<li>Devolución de llamada como IPN o webhook</li>
<li>Rastreador de redes sociales</li>
</ul>
<h2 id="es-troubleshooting-errores-comunes">Errores comunes</h2>
<h3 id="es-troubleshooting-el-upstream-envio-una-cabecera-demasiado-grande">El upstream envió una cabecera demasiado grande</h3>
<p>Si ves el siguiente error <code>upstream sent too big header while reading response header from upstream</code> en los registros, necesitarás ajustar los diversos tamaños de los búferes del proxy usando las siguientes configuraciones:</p>
<ul>
<li><code>PROXY_BUFFERS</code></li>
<li><code>PROXY_BUFFER_SIZE</code></li>
<li><code>PROXY_BUSY_BUFFERS_SIZE</code></li>
</ul>
<h3 id="es-troubleshooting-no-se-pudo-construir-el-hash-de-server_names">No se pudo construir el hash de server_names</h3>
<p>Si ves el siguiente error <code>could not build server_names_hash, you should increase server_names_hash_bucket_size</code> en los registros, necesitarás ajustar la configuración <code>SERVER_NAMES_HASH_BUCKET_SIZE</code>.</p>
<h2 id="es-troubleshooting-zona-horaria">Zona horaria</h2>
<p>Cuando se utilizan integraciones basadas en contenedores, la zona horaria del contenedor puede no coincidir con la de la máquina anfitriona. Para resolver esto, puedes establecer la variable de entorno <code>TZ</code> a la zona horaria de tu elección en tus contenedores (p. ej., <code>TZ=Europe/Paris</code>). Encontrarás la lista de identificadores de zona horaria <a href="https://es.wikipedia.org/wiki/Anexo:Lista_de_zonas_horarias_de_la_base_de_datos_IANA#Lista">aquí</a>.</p>
<h2 id="es-troubleshooting-interfaz-de-usuario-web">Interfaz de usuario web</h2>
<p>En caso de que hayas olvidado tus credenciales de la interfaz de usuario o estés experimentando problemas con la 2FA, puedes conectarte a la base de datos para recuperar el acceso.</p>
<h3 id="es-troubleshooting-acceder-a-la-base-de-datos">Acceder a la base de datos</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="es-troubleshooting-__tabbed_3_1" name="es-troubleshooting-__tabbed_3" type="radio" /><input id="es-troubleshooting-__tabbed_3_2" name="es-troubleshooting-__tabbed_3" type="radio" /><input id="es-troubleshooting-__tabbed_3_3" name="es-troubleshooting-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="es-troubleshooting-__tabbed_3_1">SQLite</label><label for="es-troubleshooting-__tabbed_3_2">MariaDB / MySQL</label><label for="es-troubleshooting-__tabbed_3_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="es-troubleshooting-__tabbed_4_1" name="es-troubleshooting-__tabbed_4" type="radio" /><input id="es-troubleshooting-__tabbed_4_2" name="es-troubleshooting-__tabbed_4" type="radio" /><input id="es-troubleshooting-__tabbed_4_3" name="es-troubleshooting-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="es-troubleshooting-__tabbed_4_1">Linux</label><label for="es-troubleshooting-__tabbed_4_2">Docker</label><label for="es-troubleshooting-__tabbed_4_3">Todo en uno</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Instalar SQLite (Debian/Ubuntu):</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>sqlite3
</code></pre></div>
<p>Instalar SQLite (Fedora/RedHat):</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>sqlite
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Obtén un shell en tu contenedor del programador:</p>
<div class="admonition note">
<p class="admonition-title">Argumentos de Docker</p>
<ul>
<li>la opción <code>-u 0</code> es para ejecutar el comando como root (obligatorio)</li>
<li>las opciones <code>-it</code> son para ejecutar el comando interactivamente (obligatorio)</li>
<li><code>&lt;bunkerweb_scheduler_container&gt;</code>: el nombre o ID de tu contenedor del programador</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>&lt;bunkerweb_scheduler_container&gt;<span class="w"> </span>bash
</code></pre></div>
<p>Instala SQLite:</p>
<div class="highlight"><pre><span></span><code>apk<span class="w"> </span>add<span class="w"> </span>sqlite
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Obtén un shell en tu contenedor Todo en uno:</p>
<div class="admonition note">
<p class="admonition-title">Argumentos de Docker</p>
<ul>
<li>la opción <code>-u 0</code> es para ejecutar el comando como root (obligatorio).</li>
<li>las opciones <code>-it</code> son para ejecutar el comando interactivamente (obligatorio).</li>
<li><code>bunkerweb-aio</code> es el nombre del contenedor predeterminado; ajústalo si has usado un nombre personalizado.</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>bunkerweb-aio<span class="w"> </span>bash
</code></pre></div>
</div>
</div>
</div>
<p>Accede a tu base de datos:</p>
<div class="admonition note">
<p class="admonition-title">Ruta de la base de datos</p>
<p>Asumimos que estás utilizando la ruta de la base de datos predeterminada. Si estás utilizando una ruta personalizada, necesitarás adaptar el comando.
Para Todo en uno, asumimos que la base de datos es <code>db.sqlite3</code> ubicada en el volumen persistente <code>/data</code> (<code>/data/db.sqlite3</code>).</p>
</div>
<div class="highlight"><pre><span></span><code>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
<p>Deberías ver algo como esto:</p>
<div class="highlight"><pre><span></span><code>SQLite version &lt;VER&gt; &lt;DATE&gt;
Enter &quot;.help&quot; for usage hints.
sqlite&gt;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition note">
<p class="admonition-title">Solo MariaDB / MySQL</p>
<p>Los siguientes pasos solo son válidos para bases de datos MariaDB / MySQL. Si estás utilizando otra base de datos, por favor consulta la documentación de tu base de datos.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Credenciales y nombre de la base de datos</p>
<p>Necesitarás usar las mismas credenciales y el nombre de la base de datos utilizados en la configuración <code>DATABASE_URI</code>.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="es-troubleshooting-__tabbed_5_1" name="es-troubleshooting-__tabbed_5" type="radio" /><input id="es-troubleshooting-__tabbed_5_2" name="es-troubleshooting-__tabbed_5" type="radio" /><input id="es-troubleshooting-__tabbed_5_3" name="es-troubleshooting-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="es-troubleshooting-__tabbed_5_1">Linux</label><label for="es-troubleshooting-__tabbed_5_2">Docker</label><label for="es-troubleshooting-__tabbed_5_3">Todo en uno</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Accede a tu base de datos local:</p>
<div class="highlight"><pre><span></span><code>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;user&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database&gt;
</code></pre></div>
<p>Luego introduce la contraseña del usuario de la base de datos y deberías poder acceder a tu base de datos.</p>
</div>
<div class="tabbed-block">
<p>Accede a tu contenedor de base de datos:</p>
<div class="admonition note">
<p class="admonition-title">Argumentos de Docker</p>
<ul>
<li>la opción <code>-u 0</code> es para ejecutar el comando como root (obligatorio)</li>
<li>las opciones <code>-it</code> son para ejecutar el comando interactivamente (obligatorio)</li>
<li><code>&lt;bunkerweb_db_container&gt;</code>: el nombre o ID de tu contenedor de base de datos</li>
<li><code>&lt;user&gt;</code>: el usuario de la base de datos</li>
<li><code>&lt;database&gt;</code>: el nombre de la base de datos</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>&lt;bunkerweb_db_container&gt;<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;user&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database&gt;
</code></pre></div>
<p>Luego introduce la contraseña del usuario de la base de datos y deberías poder acceder a tu base de datos.</p>
</div>
<div class="tabbed-block">
<p>La imagen Todo en uno no incluye un servidor MariaDB/MySQL. Si has configurado la AIO para usar una base de datos externa MariaDB/MySQL (estableciendo la variable de entorno <code>DATABASE_URI</code>), deberías conectarte a esa base de datos directamente usando las herramientas de cliente de MySQL estándar.</p>
<p>El método de conexión sería similar a la pestaña "Linux" (si te conectas desde el host donde se ejecuta la AIO u otra máquina) o ejecutando un cliente de MySQL en un contenedor de Docker separado si se prefiere, apuntando al host y las credenciales de tu base de datos externa.</p>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="admonition note">
<p class="admonition-title">Solo PostgreSQL</p>
<p>Los siguientes pasos solo son válidos para bases de datos PostgreSQL. Si estás utilizando otra base de datos, por favor consulta la documentación de tu base de datos.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Credenciales, host y nombre de la base de datos</p>
<p>Necesitarás usar las mismas credenciales (usuario/contraseña), host y nombre de la base de datos utilizados en la configuración <code>DATABASE_URI</code>.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="6:3"><input checked="checked" id="es-troubleshooting-__tabbed_6_1" name="es-troubleshooting-__tabbed_6" type="radio" /><input id="es-troubleshooting-__tabbed_6_2" name="es-troubleshooting-__tabbed_6" type="radio" /><input id="es-troubleshooting-__tabbed_6_3" name="es-troubleshooting-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="es-troubleshooting-__tabbed_6_1">Linux</label><label for="es-troubleshooting-__tabbed_6_2">Docker</label><label for="es-troubleshooting-__tabbed_6_3">Todo en uno</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Accede a tu base de datos local:</p>
<div class="highlight"><pre><span></span><code>psql<span class="w"> </span>-U<span class="w"> </span>&lt;user&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database&gt;
</code></pre></div>
<p>Si tu base de datos está en otro host, incluye el nombre de host/IP y el puerto:</p>
<div class="highlight"><pre><span></span><code>psql<span class="w"> </span>-h<span class="w"> </span>&lt;host&gt;<span class="w"> </span>-p<span class="w"> </span><span class="m">5432</span><span class="w"> </span>-U<span class="w"> </span>&lt;user&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database&gt;
</code></pre></div>
<p>Luego introduce la contraseña del usuario de la base de datos y deberías poder acceder a tu base de datos.</p>
</div>
<div class="tabbed-block">
<p>Accede a tu contenedor de base de datos:</p>
<div class="admonition note">
<p class="admonition-title">Argumentos de Docker</p>
<ul>
<li>la opción <code>-u 0</code> es para ejecutar el comando como root (obligatorio)</li>
<li>las opciones <code>-it</code> son para ejecutar el comando interactivamente (obligatorio)</li>
<li><code>&lt;bunkerweb_db_container&gt;</code>: el nombre o ID de tu contenedor de base de datos</li>
<li><code>&lt;user&gt;</code>: el usuario de la base de datos</li>
<li><code>&lt;database&gt;</code>: el nombre de la base de datos</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>&lt;bunkerweb_db_container&gt;<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>&lt;user&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database&gt;
</code></pre></div>
<p>Si la base de datos está alojada en otro lugar, añade las opciones <code>-h &lt;host&gt;</code> y <code>-p 5432</code> en consecuencia.</p>
</div>
<div class="tabbed-block">
<p>La imagen Todo en uno no incluye un servidor PostgreSQL. Si has configurado la AIO para usar una base de datos externa PostgreSQL (estableciendo la variable de entorno <code>DATABASE_URI</code>), deberías conectarte a esa base de datos directamente usando las herramientas de cliente de PostgreSQL estándar.</p>
<p>El método de conexión sería similar a la pestaña "Linux" (si te conectas desde el host donde se ejecuta la AIO u otra máquina) o ejecutando un cliente de PostgreSQL en un contenedor de Docker separado si se prefiere, apuntando al host y las credenciales de tu base de datos externa.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<h3 id="es-troubleshooting-acciones-de-solucion-de-problemas">Acciones de solución de problemas</h3>
<div class="admonition info">
<p class="admonition-title">Esquema de las tablas</p>
<p>El esquema de la tabla <code>bw_ui_users</code> es el siguiente:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">Campo</th>
<th style="text-align: left;">Tipo</th>
<th style="text-align: left;">Nulo</th>
<th style="text-align: left;">Clave</th>
<th style="text-align: left;">Predeterminado</th>
<th style="text-align: left;">Extra</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">username</td>
<td style="text-align: left;">varchar(256)</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;">PRI</td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">email</td>
<td style="text-align: left;">varchar(256)</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;">UNI</td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">password</td>
<td style="text-align: left;">varchar(60)</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">method</td>
<td style="text-align: left;">enum('ui','scheduler','autoconf','manual','wizard')</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">admin</td>
<td style="text-align: left;">tinyint(1)</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">theme</td>
<td style="text-align: left;">enum('light','dark')</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">language</td>
<td style="text-align: left;">varchar(2)</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">totp_secret</td>
<td style="text-align: left;">varchar(256)</td>
<td style="text-align: left;">YES</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">creation_date</td>
<td style="text-align: left;">datetime</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
<tr>
<td style="text-align: left;">update_date</td>
<td style="text-align: left;">datetime</td>
<td style="text-align: left;">NO</td>
<td style="text-align: left;"></td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;"></td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="7:5"><input checked="checked" id="es-troubleshooting-__tabbed_7_1" name="es-troubleshooting-__tabbed_7" type="radio" /><input id="es-troubleshooting-__tabbed_7_2" name="es-troubleshooting-__tabbed_7" type="radio" /><input id="es-troubleshooting-__tabbed_7_3" name="es-troubleshooting-__tabbed_7" type="radio" /><input id="es-troubleshooting-__tabbed_7_4" name="es-troubleshooting-__tabbed_7" type="radio" /><input id="es-troubleshooting-__tabbed_7_5" name="es-troubleshooting-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="es-troubleshooting-__tabbed_7_1">Recuperar nombre de usuario</label><label for="es-troubleshooting-__tabbed_7_2">Actualizar la contraseña del usuario administrador</label><label for="es-troubleshooting-__tabbed_7_3">Desactivar la autenticación 2FA para el usuario administrador</label><label for="es-troubleshooting-__tabbed_7_4">Actualizar los códigos de recuperación 2FA</label><label for="es-troubleshooting-__tabbed_7_5">Exportar configuración y registros anonimizados</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Ejecuta el siguiente comando para extraer datos de la tabla <code>bw_ui_users</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="p">;</span>
</code></pre></div>
<p>Deberías ver algo como esto:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">username</th>
<th style="text-align: left;">email</th>
<th style="text-align: left;">password</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">admin</th>
<th style="text-align: left;">theme</th>
<th style="text-align: left;">totp_secret</th>
<th style="text-align: left;">creation_date</th>
<th style="text-align: left;">update_date</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">manual</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">light</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p>Primero necesitas hashear la nueva contraseña usando el algoritmo bcrypt.</p>
<p>Instala la librería de Python bcrypt:</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>bcrypt
</code></pre></div>
<p>Genera tu hash (reemplaza <code>mypassword</code> con tu propia contraseña):</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;from bcrypt import hashpw, gensalt ; print(hashpw(b&quot;&quot;&quot;mypassword&quot;&quot;&quot;, gensalt(rounds=10)).decode(&quot;utf-8&quot;))&#39;</span>
</code></pre></div>
<p>Puedes actualizar tu nombre de usuario / contraseña ejecutando este comando:</p>
<div class="highlight"><pre><span></span><code><span class="k">UPDATE</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;password_hash&gt;&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>Si vuelves a comprobar tu tabla <code>bw_ui_users</code> después de este comando:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>Deberías ver algo como esto:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">username</th>
<th style="text-align: left;">email</th>
<th style="text-align: left;">password</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">admin</th>
<th style="text-align: left;">theme</th>
<th style="text-align: left;">totp_secret</th>
<th style="text-align: left;">creation_date</th>
<th style="text-align: left;">update_date</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">manual</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">light</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
</tr>
</tbody>
</table>
<p>Ahora deberías poder usar las nuevas credenciales para iniciar sesión en la interfaz de usuario web.</p>
</div>
<div class="tabbed-block">
<p>Puedes desactivar la 2FA ejecutando este comando:</p>
<div class="highlight"><pre><span></span><code><span class="k">UPDATE</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">totp_secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>Si vuelves a comprobar tu tabla <code>bw_ui_users</code> siguiendo este comando:</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>Deberías ver algo como esto:</p>
<table>
<thead>
<tr>
<th style="text-align: left;">username</th>
<th style="text-align: left;">email</th>
<th style="text-align: left;">password</th>
<th style="text-align: left;">method</th>
<th style="text-align: left;">admin</th>
<th style="text-align: left;">theme</th>
<th style="text-align: left;">totp_secret</th>
<th style="text-align: left;">creation_date</th>
<th style="text-align: left;">update_date</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">manual</td>
<td style="text-align: left;">1</td>
<td style="text-align: left;">light</td>
<td style="text-align: left;">NULL</td>
<td style="text-align: left;">***</td>
<td style="text-align: left;">***</td>
</tr>
</tbody>
</table>
<p>Ahora deberías poder iniciar sesión en la interfaz de usuario web solo con tu nombre de usuario y contraseña sin 2FA.</p>
</div>
<div class="tabbed-block">
<p>Los códigos de recuperación se pueden actualizar en tu <strong>página de perfil</strong> de la interfaz de usuario web en la pestaña <code>Seguridad</code>.</p>
</div>
<div class="tabbed-block">
<p>Usa la <strong>página de Soporte</strong> en la Interfaz de Usuario Web para recopilar rápidamente la configuración y los registros para la solución de problemas.</p>
<ul>
<li>Abre la Interfaz de Usuario Web y ve a la página de Soporte.</li>
<li>Elige el alcance: exporta la configuración Global o selecciona un Servicio específico.</li>
<li>Haz clic para descargar el archivo de configuración para el alcance elegido.</li>
<li>Opcionalmente descarga los registros: los registros exportados se anonimizan automáticamente (todas las direcciones IP y dominios están enmascarados).</li>
</ul>
</div>
</div>
</div>
<h3 id="es-troubleshooting-cargar-plugin">Cargar plugin</h3>
<p>Puede que no sea posible cargar un plugin desde la interfaz de usuario en ciertas situaciones:</p>
<ul>
<li>Falta de un paquete para gestionar archivos comprimidos en tu integración, en cuyo caso necesitarás añadir los paquetes necesarios</li>
<li>Navegador Safari: el 'modo seguro' puede impedirte añadir un plugin. Necesitarás hacer los cambios necesarios en tu máquina</li>
</ul></section><section class="print-page" id="es-plugins" heading-number="11"><h1 id="es-plugins-plugins">Plugins</h1>
<p>BunkerWeb viene con un sistema de plugins que permite añadir fácilmente nuevas características. Una vez que un plugin está instalado, puedes gestionarlo usando configuraciones adicionales definidas por el plugin.</p>
<h2 id="es-plugins-plugins-oficiales">Plugins oficiales</h2>
<p>Aquí está la lista de plugins "oficiales" que mantenemos (consulta el repositorio <a href="https://github.com/bunkerity/bunkerweb-plugins">bunkerweb-plugins</a> para más información):</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Nombre</th>
<th style="text-align: center;">Versión</th>
<th style="text-align: left;">Descripción</th>
<th style="text-align: center;">Enlace</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><strong>ClamAV</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Escanea automáticamente los archivos subidos con el motor antivirus ClamAV y deniega la solicitud cuando un archivo es detectado como malicioso.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/clamav">bunkerweb-plugins/clamav</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>Coraza</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Inspecciona las solicitudes usando el WAF de Coraza (alternativa a ModSecurity).</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/coraza">bunkerweb-plugins/coraza</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>Discord</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Envía notificaciones de seguridad a un canal de Discord usando un Webhook.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/discord">bunkerweb-plugins/discord</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>Slack</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Envía notificaciones de seguridad a un canal de Slack usando un Webhook.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/slack">bunkerweb-plugins/slack</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>VirusTotal</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Escanea automáticamente los archivos subidos con la API de VirusTotal y deniega la solicitud cuando un archivo es detectado como malicioso.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/virustotal">bunkerweb-plugins/virustotal</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>WebHook</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Envía notificaciones de seguridad a un punto final HTTP personalizado usando un Webhook.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/webhook">bunkerweb-plugins/webhook</a></td>
</tr>
</tbody>
</table>
<h2 id="es-plugins-como-usar-un-plugin">Cómo usar un plugin</h2>
<h3 id="es-plugins-automatico">Automático</h3>
<p>Si quieres instalar rápidamente plugins externos, puedes usar la configuración <code>EXTERNAL_PLUGIN_URLS</code>. Acepta una lista de URLs separadas por espacios, cada una apuntando a un archivo comprimido (formato zip) que contiene uno o más plugins.</p>
<p>Puedes usar el siguiente valor si quieres instalar automáticamente los plugins oficiales: <code>EXTERNAL_PLUGIN_URLS=https://github.com/bunkerity/bunkerweb-plugins/archive/refs/tags/v1.9.zip</code></p>
<h3 id="es-plugins-manual">Manual</h3>
<p>El primer paso es instalar el plugin colocando sus archivos dentro de la carpeta de datos <code>plugins</code> correspondiente. El procedimiento depende de tu integración:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:5"><input checked="checked" id="es-plugins-__tabbed_1_1" name="es-plugins-__tabbed_1" type="radio" /><input id="es-plugins-__tabbed_1_2" name="es-plugins-__tabbed_1" type="radio" /><input id="es-plugins-__tabbed_1_3" name="es-plugins-__tabbed_1" type="radio" /><input id="es-plugins-__tabbed_1_4" name="es-plugins-__tabbed_1" type="radio" /><input id="es-plugins-__tabbed_1_5" name="es-plugins-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="es-plugins-__tabbed_1_1">Docker</label><label for="es-plugins-__tabbed_1_2">Docker autoconf</label><label for="es-plugins-__tabbed_1_3">Swarm</label><label for="es-plugins-__tabbed_1_4">Kubernetes</label><label for="es-plugins-__tabbed_1_5">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-docker">integración de Docker</a>, los plugins deben colocarse en el volumen montado en <code>/data/plugins</code> en el contenedor del programador.</p>
<p>Lo primero que hay que hacer es crear la carpeta de plugins:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<p>Luego, puedes colocar los plugins de tu elección en esa carpeta:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<details class="warning">
<summary>Usar una carpeta local para datos persistentes</summary>
<p>El programador se ejecuta como un <strong>usuario sin privilegios con UID 101 y GID 101</strong> dentro del contenedor. La razón detrás de esto es la seguridad: en caso de que se explote una vulnerabilidad, el atacante no tendrá privilegios completos de root (UID/GID 0).
Pero hay una desventaja: si usas una <strong>carpeta local para los datos persistentes</strong>, necesitarás <strong>establecer los permisos correctos</strong> para que el usuario sin privilegios pueda escribir datos en ella. Algo como esto debería funcionar:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Alternativamente, si la carpeta ya existe:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Si estás utilizando <a href="https://docs.docker.com/engine/security/rootless">Docker en modo sin raíz</a> o <a href="https://podman.io/">podman</a>, los UID y GID en el contenedor se mapearán a diferentes en el host. Primero necesitarás verificar tu subuid y subgid iniciales:</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>Por ejemplo, si tienes un valor de <strong>100000</strong>, el UID/GID mapeado será <strong>100100</strong> (100000 + 100):</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>O si la carpeta ya existe:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
</details>
<p>Luego puedes montar el volumen al iniciar tu pila de Docker:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-docker-autoconf">integración de Docker autoconf</a>, los plugins deben colocarse en el volumen montado en <code>/data/plugins</code> en el contenedor del programador.</p>
<p>Lo primero que hay que hacer es crear la carpeta de plugins:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<p>Luego, puedes colocar los plugins de tu elección en esa carpeta:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<p>Debido a que el programador se ejecuta como un usuario sin privilegios con UID y GID 101, necesitarás editar los permisos:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">101</span>:101<span class="w"> </span>./bw-data
</code></pre></div>
<p>Luego puedes montar el volumen al iniciar tu pila de Docker:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Obsoleto</p>
<p>La integración de Swarm está obsoleta y se eliminará en una futura versión. Por favor, considera usar la <a href="#es-integrations-kubernetes">integración de Kubernetes</a> en su lugar.</p>
<p><strong>Puedes encontrar más información en la <a href="#es-integrations-swarm">documentación de la integración de Swarm</a>.</strong></p>
</div>
<p>Cuando se utiliza la <a href="#es-integrations-swarm">integración de Swarm</a>, los plugins deben colocarse en el volumen montado en <code>/data/plugins</code> en el contenedor del programador.</p>
<div class="admonition info">
<p class="admonition-title">Volumen de Swarm</p>
<p>La configuración de un volumen de Swarm que persistirá cuando el servicio del programador se ejecute en diferentes nodos no se cubre en esta documentación. Asumiremos que tienes una carpeta compartida montada en <code>/shared</code> en todos los nodos.</p>
</div>
<p>Lo primero que hay que hacer es crear la carpeta de plugins:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/shared/bw-plugins
</code></pre></div>
<p>Luego, puedes colocar los plugins de tu elección en esa carpeta:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>/shared/bw-plugins
</code></pre></div>
<p>Debido a que el programador se ejecuta como un usuario sin privilegios con UID y GID 101, necesitarás editar los permisos:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">101</span>:101<span class="w"> </span>/shared/bw-plugins
</code></pre></div>
<p>Luego puedes montar el volumen al iniciar tu pila de Swarm:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/shared/bw-plugins:/data/plugins</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-kubernetes">integración de Kubernetes</a>, los plugins deben colocarse en el volumen montado en <code>/data/plugins</code> en el contenedor del programador.</p>
<p>Lo primero que hay que hacer es declarar una <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">PersistentVolumeClaim</a> que contendrá los datos de nuestros plugins:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pvc-bunkerweb-plugins</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5Gi</span>
</code></pre></div>
<p>Ahora puedes añadir el montaje del volumen y un contenedor de inicialización para aprovisionar automáticamente el volumen:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">strategy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Recreate</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sa-bunkerweb</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">          </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KUBERNETES_MODE</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DATABASE_URI&quot;</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@svc-bunkerweb-db:3306/db&quot;</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/data/plugins&quot;</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vol-plugins</span>
<span class="w">      </span><span class="nt">initContainers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler-init</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alpine/git</span>
<span class="w">          </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;/bin/sh&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;git</span><span class="nv"> </span><span class="s">clone</span><span class="nv"> </span><span class="s">https://github.com/bunkerity/bunkerweb-plugins</span><span class="nv"> </span><span class="s">/data/plugins</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">chown</span><span class="nv"> </span><span class="s">-R</span><span class="nv"> </span><span class="s">101:101</span><span class="nv"> </span><span class="s">/data/plugins&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/data/plugins&quot;</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vol-plugins</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vol-plugins</span>
<span class="w">          </span><span class="nt">persistentVolumeClaim</span><span class="p">:</span>
<span class="w">            </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pvc-bunkerweb-plugins</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Cuando se utiliza la <a href="#es-integrations-linux">integración de Linux</a>, los plugins deben escribirse en la carpeta <code>/etc/bunkerweb/plugins</code>:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>/etc/bunkerweb/plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>-R<span class="w"> </span>nginx:nginx<span class="w"> </span>/etc/bunkerweb/plugins
</code></pre></div>
</div>
</div>
</div>
<h2 id="es-plugins-escribir-un-plugin">Escribir un plugin</h2>
<h3 id="es-plugins-estructura">Estructura</h3>
<div class="admonition tip">
<p class="admonition-title">Plugins existentes</p>
<p>Si la documentación no es suficiente, puedes echar un vistazo al código fuente existente de los <a href="https://github.com/bunkerity/bunkerweb-plugins">plugins oficiales</a> y los <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/src/common/core">plugins del núcleo</a> (ya incluidos en BunkerWeb, pero técnicamente son plugins).</p>
</div>
<p>Así es como se ve la estructura de un plugin:
<div class="highlight"><pre><span></span><code>plugin /
    confs / tipo_conf / nombre_conf.conf
    ui / actions.py
         hooks.py
         template.html
         blueprints / &lt;archivo(s)_blueprint&gt;
              templates / &lt;plantilla(s)_blueprint&gt;
    jobs / mi-trabajo.py
    templates / mi-plantilla.json
          mi-plantilla / configs / tipo_conf / nombre_conf.conf
    plugin.lua
    plugin.json
</code></pre></div></p>
<ul>
<li>
<p><strong>nombre_conf.conf</strong>: Añade <a href="#es-advanced-custom-configurations">configuraciones personalizadas de NGINX</a> (como plantillas de Jinja2).</p>
</li>
<li>
<p><strong>actions.py</strong>: Script para ejecutar en el servidor Flask. Este script se ejecuta en un contexto de Flask, dándote acceso a librerías y utilidades como <code>jinja2</code> y <code>requests</code>.</p>
</li>
<li>
<p><strong>hooks.py</strong>: Archivo Python personalizado que contiene los hooks de Flask y que se ejecutará cuando se cargue el plugin.</p>
</li>
<li>
<p><strong>template.html</strong>: Página del plugin personalizada a la que se accede a través de la UI.</p>
</li>
<li>
<p><strong>carpeta blueprints (dentro de ui)</strong>:
  Esta carpeta se utiliza para sobrescribir los blueprints de Flask existentes o crear nuevos. Dentro, puedes incluir archivos de blueprint y una subcarpeta opcional <strong>templates</strong> para las plantillas específicas del blueprint.</p>
</li>
<li>
<p><strong>archivo py de trabajos</strong>: Archivos Python personalizados ejecutados como trabajos por el programador.</p>
</li>
<li>
<p><strong>mi-plantilla.json</strong>: Añade <a href="#es-concepts-templates">plantillas personalizadas</a> para sobrescribir los valores predeterminados de las configuraciones y aplicar configuraciones personalizadas fácilmente.</p>
</li>
<li>
<p><strong>plugin.lua</strong>: Código ejecutado en NGINX usando el <a href="https://github.com/openresty/lua-nginx-module">módulo LUA de NGINX</a>.</p>
</li>
<li>
<p><strong>plugin.json</strong>: Metadatos, configuraciones y definiciones de trabajos para tu plugin.</p>
</li>
</ul>
<h3 id="es-plugins-empezando">Empezando</h3>
<p>El primer paso es crear una carpeta que contendrá el plugin:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>miplugin<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>miplugin
</code></pre></div>
<h3 id="es-plugins-metadatos">Metadatos</h3>
<p>Un archivo llamado <strong>plugin.json</strong> y escrito en la raíz de la carpeta del plugin debe contener metadatos sobre el plugin. Aquí hay un ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;miplugin&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Mi Plugin&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Solo un plugin de ejemplo.&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;parcial&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;DUMMY_SETTING&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;multisite&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1234&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;help&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Aquí está la ayuda de la configuración.&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dummy-id&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Configuración de ejemplo&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;regex&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^.*$&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;jobs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mi-trabajo&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;mi-trabajo.py&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;every&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hour&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>Aquí están los detalles de los campos:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Campo</th>
<th style="text-align: center;">Obligatorio</th>
<th style="text-align: center;">Tipo</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>id</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">ID interno para el plugin: debe ser único entre otros plugins (incluidos los del "núcleo") y contener solo caracteres en minúscula.</td>
</tr>
<tr>
<td style="text-align: center;"><code>name</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Nombre de tu plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>description</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Descripción de tu plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>version</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Versión de tu plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>stream</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Información sobre el soporte de stream: <code>no</code>, <code>yes</code> o <code>partial</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>settings</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">dict</td>
<td style="text-align: left;">Lista de las configuraciones de tu plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>jobs</code></td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">lista</td>
<td style="text-align: left;">Lista de los trabajos de tu plugin.</td>
</tr>
</tbody>
</table>
<p>Cada configuración tiene los siguientes campos (la clave es el ID de las configuraciones utilizadas en una configuración):</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Campo</th>
<th style="text-align: center;">Obligatorio</th>
<th style="text-align: center;">Tipo</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>context</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Contexto de la configuración: <code>multisite</code> o <code>global</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>default</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">El valor predeterminado de la configuración.</td>
</tr>
<tr>
<td style="text-align: center;"><code>help</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Texto de ayuda sobre el plugin (mostrado en la interfaz de usuario web).</td>
</tr>
<tr>
<td style="text-align: center;"><code>id</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">ID interno utilizado por la interfaz de usuario web para los elementos HTML.</td>
</tr>
<tr>
<td style="text-align: center;"><code>label</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Etiqueta mostrada por la interfaz de usuario web.</td>
</tr>
<tr>
<td style="text-align: center;"><code>regex</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">La expresión regular utilizada para validar el valor proporcionado por el usuario.</td>
</tr>
<tr>
<td style="text-align: center;"><code>type</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">El tipo del campo: <code>text</code>, <code>check</code>, <code>select</code> o <code>password</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>multiple</code></td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">ID único para agrupar múltiples configuraciones con números como sufijo.</td>
</tr>
<tr>
<td style="text-align: center;"><code>select</code></td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">lista</td>
<td style="text-align: left;">Lista de posibles valores de cadena cuando <code>type</code> es <code>select</code>.</td>
</tr>
</tbody>
</table>
<p>Cada trabajo tiene los siguientes campos:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Campo</th>
<th style="text-align: center;">Obligatorio</th>
<th style="text-align: center;">Tipo</th>
<th style="text-align: left;">Descripción</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>name</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Nombre del trabajo.</td>
</tr>
<tr>
<td style="text-align: center;"><code>file</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Nombre del archivo dentro de la carpeta de trabajos.</td>
</tr>
<tr>
<td style="text-align: center;"><code>every</code></td>
<td style="text-align: center;">sí</td>
<td style="text-align: center;">cadena</td>
<td style="text-align: left;">Frecuencia de programación del trabajo: <code>minute</code>, <code>hour</code>, <code>day</code>, <code>week</code> u <code>once</code> (sin frecuencia, solo una vez antes de (re)generar la configuración).</td>
</tr>
</tbody>
</table>
<h3 id="es-plugins-configuraciones">Configuraciones</h3>
<p>Puedes añadir configuraciones personalizadas de NGINX añadiendo una carpeta llamada <strong>confs</strong> con contenido similar a las <a href="#es-advanced-custom-configurations">configuraciones personalizadas</a>. Cada subcarpeta dentro de <strong>confs</strong> contendrá plantillas de <a href="https://jinja.palletsprojects.com">jinja2</a> que se generarán y cargarán en el contexto correspondiente (<code>http</code>, <code>server-http</code>, <code>default-server-http</code>, <code>stream</code>, <code>server-stream</code>, <code>modsec</code>, <code>modsec-crs</code>, <code>crs-plugins-before</code> y <code>crs-plugins-after</code>).</p>
<p>Aquí hay un ejemplo para un archivo de plantilla de configuración dentro de la carpeta <strong>confs/server-http</strong> llamado <strong>example.conf</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="k">location</span><span class="w"> </span><span class="s">/setting</span><span class="w"> </span><span class="p">{</span>
<span class="w">  </span><span class="kn">default_type</span><span class="w"> </span><span class="s">&#39;text/plain&#39;</span><span class="p">;</span>
<span class="w">    </span><span class="kn">content_by_lua_block</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="kn">ngx.say(&#39;{{</span><span class="w"> </span><span class="s">DUMMY_SETTING</span><span class="w"> </span><span class="err">}}</span><span class="s">&#39;)</span>
<span class="w">    </span><span class="err">}</span>
<span class="err">}</span>
</code></pre></div>
<p><code>{{ DUMMY_SETTING }}</code> será reemplazado por el valor de <code>DUMMY_SETTING</code> elegido por el usuario del plugin.</p>
<h3 id="es-plugins-plantillas">Plantillas</h3>
<p>Consulta la <a href="#es-concepts-templates">documentación de plantillas</a> para obtener más información.</p>
<h3 id="es-plugins-lua">LUA</h3>
<h4 id="es-plugins-script-principal">Script principal</h4>
<p>Internamente, BunkerWeb utiliza el <a href="https://github.com/openresty/lua-nginx-module">módulo LUA de NGINX</a> para ejecutar código dentro de NGINX. Los plugins que necesiten ejecutar código deben proporcionar un archivo lua en el directorio raíz de la carpeta del plugin utilizando el valor <code>id</code> de <strong>plugin.json</strong> como su nombre. Aquí hay un ejemplo llamado <strong>miplugin.lua</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">class</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;middleclass&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">plugin</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.plugin&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">utils</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.utils&quot;</span>


<span class="kd">local</span><span class="w"> </span><span class="nv">myplugin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">class</span><span class="p">(</span><span class="s2">&quot;myplugin&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">plugin</span><span class="p">)</span>


<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">initialize</span><span class="p">(</span><span class="nv">ctx</span><span class="p">)</span>
<span class="w">    </span><span class="nv">plugin</span><span class="p">.</span><span class="nf">initialize</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;myplugin&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">ctx</span><span class="p">)</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">dummy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;dummy&quot;</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">init</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;init called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">set</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;set called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">access</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;access called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">log</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;log called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">log_default</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;log_default called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">preread</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;preread called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">log_stream</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;log_stream called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">return</span><span class="w"> </span><span class="nv">myplugin</span>
</code></pre></div>
<p>Las funciones declaradas se llaman automáticamente durante contextos específicos. Aquí están los detalles de cada función:</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Función</th>
<th style="text-align: center;">Contexto</th>
<th style="text-align: left;">Descripción</th>
<th style="text-align: left;">Valor de retorno</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>init</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#init_by_lua">init_by_lua</a></td>
<td style="text-align: left;">Se llama cuando NGINX acaba de iniciarse o recibió una orden de recarga. El caso de uso típico es preparar cualquier dato que será utilizado por tu plugin.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (booleano): true si no hay error, de lo contrario false</li><li><code>msg</code> (cadena): mensaje de éxito o error</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>set</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#set_by_lua">set_by_lua</a></td>
<td style="text-align: left;">Se llama antes de cada solicitud recibida por el servidor. El caso de uso típico es para computar antes de la fase de acceso.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (booleano): true si no hay error, de lo contrario false</li><li><code>msg</code> (cadena): mensaje de éxito o error</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>access</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#access_by_lua">access_by_lua</a></td>
<td style="text-align: left;">Se llama en cada solicitud recibida por el servidor. El caso de uso típico es hacer las comprobaciones de seguridad aquí y denegar la solicitud si es necesario.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code>,<code>status</code>,<code>redirect</code><ul><li><code>ret</code> (booleano): true si no hay error, de lo contrario false</li><li><code>msg</code> (cadena): mensaje de éxito o error</li><li><code>status</code> (número): interrumpe el proceso actual y devuelve el <a href="https://github.com/openresty/lua-nginx-module#http-status-constants">estado HTTP</a></li><li><code>redirect</code> (URL): si se establece, redirigirá a la URL dada</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>log</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#log_by_lua">log_by_lua</a></td>
<td style="text-align: left;">Se llama cuando una solicitud ha terminado (y antes de que se registre en los registros de acceso). El caso de uso típico es hacer estadísticas o calcular contadores, por ejemplo.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (booleano): true si no hay error, de lo contrario false</li><li><code>msg</code> (cadena): mensaje de éxito o error</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>log_default</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#log_by_lua">log_by_lua</a></td>
<td style="text-align: left;">Igual que <code>log</code> pero solo se llama en el servidor predeterminado.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (booleano): true si no hay error, de lo contrario false</li><li><code>msg</code> (cadena): mensaje de éxito o error</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>preread</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/stream-lua-nginx-module#preread_by_lua_block">preread_by_lua</a></td>
<td style="text-align: left;">Similar a la función <code>access</code> pero para el modo stream.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code>,<code>status</code><ul><li><code>ret</code> (booleano): true si no hay error, de lo contrario false</li><li><code>msg</code> (cadena): mensaje de éxito o error</li><li><code>status</code> (número): interrumpe el proceso actual y devuelve el <a href="https://github.com/openresty/lua-nginx-module#http-status-constants">estado</a></li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>log_stream</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/stream-lua-nginx-module#log_by_lua_block">log_by_lua</a></td>
<td style="text-align: left;">Similar a la función <code>log</code> pero para el modo stream.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (booleano): true si no hay error, de lo contrario false</li><li><code>msg</code> (cadena): mensaje de éxito o error</li></ul></td>
</tr>
</tbody>
</table>
<h4 id="es-plugins-librerias">Librerías</h4>
<p>Todas las directivas del <a href="https://github.com/openresty/lua-nginx-module">módulo LUA de NGINX</a> y del <a href="https://github.com/openresty/stream-lua-nginx-module">módulo LUA de stream de NGINX</a> están disponibles. Además de eso, puedes usar las librerías LUA incluidas en BunkerWeb: consulta <a href="https://github.com/bunkerity/bunkerweb/blobsrc/deps/clone.sh">este script</a> para la lista completa.</p>
<p>Si necesitas librerías adicionales, puedes ponerlas en la carpeta raíz del plugin y acceder a ellas prefijándolas con el ID de tu plugin. Aquí hay un ejemplo de archivo llamado <strong>mialibreria.lua</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">_M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="nv">_M</span><span class="p">.</span><span class="py">dummy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="s2">&quot;dummy&quot;</span>
<span class="kr">end</span>

<span class="kr">return</span><span class="w"> </span><span class="nv">_M</span>
</code></pre></div>
<p>Y aquí está cómo puedes usarla desde el archivo <strong>miplugin.lua</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">mialibreria</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;miplugin.mialibreria&quot;</span>

<span class="p">...</span>

<span class="nv">mialibreria</span><span class="p">.</span><span class="nf">dummy</span><span class="p">()</span>

<span class="p">...</span>
</code></pre></div>
<h4 id="es-plugins-ayudantes">Ayudantes</h4>
<p>Algunos módulos de ayudantes proporcionan ayudantes comunes y útiles:</p>
<ul>
<li><code>self.variables</code>: permite acceder y almacenar los atributos de los plugins</li>
<li><code>self.logger</code>: imprime registros</li>
<li><code>bunkerweb.utils</code>: varias funciones útiles</li>
<li><code>bunkerweb.datastore</code>: accede a los datos compartidos globales en una instancia (almacén de clave/valor)</li>
<li><code>bunkerweb.clusterstore</code>: accede a un almacén de datos Redis compartido entre las instancias de BunkerWeb (almacén de clave/valor)</li>
</ul>
<p>Para acceder a las funciones, primero necesitas <strong>requerir</strong> los módulos:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">utils</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.utils&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">datastore</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.datastore&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">clustestore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.clustertore&quot;</span>
</code></pre></div>
<p>Recuperar el valor de una configuración:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">myvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">variables</span><span class="p">[</span><span class="s2">&quot;DUMMY_SETTING&quot;</span><span class="p">]</span>
<span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">myvar</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ERR</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;no se puede recuperar la configuración DUMMY_SETTING&quot;</span><span class="p">)</span>
<span class="kr">else</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DUMMY_SETTING = &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">value</span><span class="p">)</span>
<span class="kr">end</span>
</code></pre></div>
<p>Almacenar algo en la caché local:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">ok</span><span class="p">,</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">datastore</span><span class="p">:</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;plugin_myplugin_something&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;somevalue&quot;</span><span class="p">)</span>
<span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">ok</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ERR</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;no se puede guardar plugin_myplugin_something en el datastore: &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">err</span><span class="p">)</span>
<span class="kr">else</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;se guardó correctamente plugin_myplugin_something en el datastore&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</code></pre></div>
<p>Comprobar si una dirección IP es global:</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">ret</span><span class="p">,</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">utils</span><span class="p">.</span><span class="nf">ip_is_global</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="p">)</span>
<span class="kr">if</span><span class="w"> </span><span class="nv">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ERR</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;error al comprobar si la IP &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot; es global o no: &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">err</span><span class="p">)</span>
<span class="kr">elseif</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">ret</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;la IP &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot; no es global&quot;</span><span class="p">)</span>
<span class="kr">else</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;la IP &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot; es global&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Más ejemplos</p>
<p>Si quieres ver la lista completa de funciones disponibles, puedes echar un vistazo a los archivos presentes en el <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/src/bw/lua/bunkerweb">directorio lua</a> del repositorio.</p>
</div>
<h3 id="es-plugins-trabajos">Trabajos</h3>
<p>BunkerWeb utiliza un programador de trabajos interno para tareas periódicas como renovar certificados con certbot, descargar listas negras, descargar archivos MMDB, ... Puedes añadir tareas de tu elección colocándolas dentro de una subcarpeta llamada <strong>jobs</strong> y listándolas en el archivo de metadatos <strong>plugin.json</strong>. No olvides añadir los permisos de ejecución para todos para evitar cualquier problema cuando un usuario clone e instale tu plugin.</p>
<h3 id="es-plugins-pagina-del-plugin">Página del plugin</h3>
<p>Todo lo relacionado con la interfaz de usuario web se encuentra dentro de la subcarpeta <strong>ui</strong>, como vimos en la <a href="#es-plugins-estructura">sección de estructura anterior.</a>.</p>
<h4 id="es-plugins-requisitos-previos">Requisitos previos</h4>
<p>Cuando quieras crear una página de plugin, necesitas dos archivos:</p>
<ul>
<li>
<p><strong>template.html</strong> que será accesible con un <strong>GET /plugins/&lt;<em>id_plugin</em>&gt;</strong>.</p>
</li>
<li>
<p><strong>actions.py</strong> donde puedes añadir algo de scripting y lógica con un <strong>POST /plugins/&lt;<em>id_plugin</em>&gt;</strong>. Ten en cuenta que este archivo <strong>necesita una función con el mismo nombre que el plugin</strong> para funcionar. Este archivo es necesario incluso si la función está vacía.</p>
</li>
</ul>
<h4 id="es-plugins-ejemplo-basico">Ejemplo básico</h4>
<div class="admonition info">
<p class="admonition-title">Plantilla de Jinja 2</p>
<p>El archivo <strong>template.html</strong> es una plantilla de Jinja2, por favor consulta la <a href="https://jinja.palletsprojects.com">documentación de Jinja2</a> si es necesario.</p>
</div>
<p>Podemos dejar de lado el archivo <strong>actions.py</strong> y empezar a <strong>usar solo la plantilla en una situación GET</strong>. La plantilla puede acceder al contexto y las librerías de la aplicación, por lo que puedes usar Jinja, request o las utilidades de Flask.</p>
<p>Por ejemplo, puedes obtener los argumentos de la solicitud en tu plantilla de esta manera:</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>argumentos de la solicitud: {{ request.args.get() }}.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="es-plugins-actionspy">Actions.py</h4>
<div class="admonition warning">
<p class="admonition-title">Token CSRF</p>
<p>Ten en cuenta que cada envío de formulario está protegido mediante un token CSRF, necesitarás incluir el siguiente fragmento en tus formularios:
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;csrf_token&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ csrf_token() }}&quot;</span> <span class="p">/&gt;</span>
</code></pre></div></p>
</div>
<p>Puedes potenciar tu página de plugin con scripting adicional con el archivo <strong>actions.py</strong> al enviar un <strong>POST /plugins/&lt;<em>id_plugin</em>&gt;</strong>.</p>
<p>Tienes dos funciones por defecto en <strong>actions.py</strong>:</p>
<p><strong>Función pre_render</strong></p>
<p>Esto te permite recuperar datos cuando haces un <strong>GET</strong> de la plantilla, y usar los datos con la variable pre_render disponible en Jinja para mostrar contenido de forma más dinámica.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pre_render</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="n">datos_pre_render</span><span class="o">&gt;</span>
</code></pre></div>
<p>BunkerWeb te enviará este tipo de respuesta:</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ok|ko&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span> <span class="p">:</span> <span class="n">XXX</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">datos_pre_render</span><span class="o">&gt;</span><span class="p">}),</span> <span class="mi">200</span>
</code></pre></div>
<p><strong>Función &lt;<em>id_plugin</em>&gt;</strong></p>
<p>Esto te permite recuperar datos cuando haces un <strong>POST</strong> desde el punto final de la plantilla, que debe usarse en AJAX.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">miplugin</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="n">datos_id_plugin</span><span class="o">&gt;</span>
</code></pre></div>
<p>BunkerWeb te enviará este tipo de respuesta:</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">datos_id_plugin</span><span class="o">&gt;</span><span class="p">}),</span> <span class="mi">200</span><span class="err">```</span>

<span class="o">**</span><span class="n">A</span> <span class="n">qué</span> <span class="n">puedes</span> <span class="n">acceder</span> <span class="n">desde</span> <span class="n">action</span><span class="o">.</span><span class="n">py</span><span class="o">**</span>

<span class="n">Aquí</span> <span class="n">están</span> <span class="n">los</span> <span class="n">argumentos</span> <span class="n">que</span> <span class="n">se</span> <span class="n">pasan</span> <span class="n">y</span> <span class="n">a</span> <span class="n">los</span> <span class="n">que</span> <span class="n">se</span> <span class="n">accede</span> <span class="n">en</span> <span class="n">las</span> <span class="n">funciones</span> <span class="n">de</span> <span class="n">action</span><span class="o">.</span><span class="n">py</span><span class="p">:</span>

<span class="err">```</span><span class="n">python</span>
<span class="n">funcion</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="ow">or</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Librerías de Python disponibles</p>
<p>La interfaz de usuario web de BunkerWeb incluye un conjunto de librerías de Python preinstaladas que puedes usar en el archivo <code>actions.py</code> de tu plugin u otros scripts relacionados con la interfaz de usuario. Estas están disponibles de serie sin necesidad de instalaciones adicionales.</p>
<p>Aquí está la lista completa de librerías incluidas:</p>
<ul>
<li><strong>bcrypt</strong> - Librería para el hashing de contraseñas</li>
<li><strong>biscuit-python</strong> - Tokens de autenticación Biscuit</li>
<li><strong>certbot</strong> - Cliente ACME para Let's Encrypt</li>
<li><strong>Flask</strong> - Framework web</li>
<li><strong>Flask-Login</strong> - Gestión de sesiones de usuario</li>
<li><strong>Flask-Session[cachelib]</strong> - Almacenamiento de sesiones del lado del servidor</li>
<li><strong>Flask-WTF</strong> - Manejo de formularios y protección CSRF</li>
<li><strong>gunicorn[gthread]</strong> - Servidor HTTP WSGI</li>
<li><strong>pillow</strong> - Procesamiento de imágenes</li>
<li><strong>psutil</strong> - Utilidades del sistema y de procesos</li>
<li><strong>python_dateutil</strong> - Utilidades de fecha y hora</li>
<li><strong>qrcode</strong> - Generación de códigos QR</li>
<li><strong>regex</strong> - Expresiones regulares avanzadas</li>
<li><strong>urllib3</strong> - Cliente HTTP</li>
<li><strong>user_agents</strong> - Análisis de agentes de usuario</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Uso de librerías en tu plugin</p>
<p>Para importar y usar estas librerías en tu archivo <code>actions.py</code>, simplemente usa la declaración estándar de <code>import</code> de Python. Por ejemplo:</p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">bcrypt</span>
</code></pre></div>
</div>
<details class="warning">
<summary>Librerías externas</summary>
<p>Si necesitas librerías que no están en la lista anterior, instálalas dentro de la carpeta <code>ui</code> de tu plugin e impórtalas usando la directiva clásica de <code>import</code>. Asegúrate de la compatibilidad con el entorno existente para evitar conflictos.</p>
</details>
</div>
<p><strong>Algunos ejemplos</strong></p>
<ul>
<li>Recuperar datos enviados de un formulario</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span><span class="w"> </span><span class="nf">miplugin</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">mi_valor_formulario</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">&quot;mi_entrada_formulario&quot;</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">mi_valor_formulario</span>
</code></pre></div>
<ul>
<li>Acceder a la configuración de la aplicación</li>
</ul>
<p><strong>action.py</strong>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pre_render</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;app&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;CONFIG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">config</span><span class="err">```</span>

<span class="o">**</span><span class="n">plantilla</span><span class="o">**</span>
<span class="err">```</span><span class="n">html</span>
<span class="o">&lt;</span><span class="err">!</span><span class="o">--</span> <span class="n">metadatos</span> <span class="o">+</span> <span class="n">configuración</span> <span class="o">--&gt;</span>
<span class="o">&lt;</span><span class="n">div</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">pre_render</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">div</span><span class="o">&gt;</span><span class="err">```</span>

<span class="c1">### Hooks.py</span>

<span class="n">Esta</span> <span class="n">documentación</span> <span class="n">describe</span> <span class="n">los</span> <span class="n">ganchos</span> <span class="n">de</span> <span class="n">ciclo</span> <span class="n">de</span> <span class="n">vida</span> <span class="n">utilizados</span> <span class="n">para</span> <span class="n">gestionar</span> <span class="n">diferentes</span> <span class="n">etapas</span> <span class="n">de</span> <span class="n">una</span> <span class="n">solicitud</span> <span class="n">dentro</span> <span class="n">de</span> <span class="n">la</span> <span class="n">aplicación</span><span class="o">.</span> <span class="n">Cada</span> <span class="n">gancho</span> <span class="n">está</span> <span class="n">asociado</span> <span class="n">a</span> <span class="n">una</span> <span class="n">fase</span> <span class="n">específica</span><span class="o">.</span>

<span class="o">===</span> <span class="s2">&quot;before_request&quot;</span>
    <span class="n">Estos</span> <span class="n">ganchos</span> <span class="n">se</span> <span class="n">ejecutan</span> <span class="o">**</span><span class="n">antes</span><span class="o">**</span> <span class="n">de</span> <span class="n">procesar</span> <span class="n">una</span> <span class="n">solicitud</span> <span class="n">entrante</span><span class="o">.</span> <span class="n">Se</span> <span class="n">utilizan</span> <span class="n">normalmente</span> <span class="n">para</span> <span class="n">tareas</span> <span class="n">de</span> <span class="n">preprocesamiento</span> <span class="n">como</span> <span class="n">autenticación</span><span class="p">,</span> <span class="n">validación</span> <span class="n">o</span> <span class="n">registro</span><span class="o">.</span>

    <span class="n">Si</span> <span class="n">el</span> <span class="n">gancho</span> <span class="n">devuelve</span> <span class="n">un</span> <span class="n">objeto</span> <span class="n">de</span> <span class="n">respuesta</span><span class="p">,</span> <span class="n">Flask</span> <span class="n">omitirá</span> <span class="n">el</span> <span class="n">manejo</span> <span class="n">de</span> <span class="n">la</span> <span class="n">solicitud</span> <span class="n">y</span> <span class="n">devolverá</span> <span class="n">la</span> <span class="n">respuesta</span> <span class="n">directamente</span><span class="o">.</span> <span class="n">Esto</span> <span class="n">puede</span> <span class="n">ser</span> <span class="n">útil</span> <span class="n">para</span> <span class="n">cortocircuitar</span> <span class="n">el</span> <span class="n">pipeline</span> <span class="n">de</span> <span class="n">procesamiento</span> <span class="n">de</span> <span class="n">la</span> <span class="n">solicitud</span><span class="o">.</span>

    <span class="o">**</span><span class="n">Ejemplo</span><span class="p">:</span><span class="o">**</span>

    <span class="err">```</span><span class="n">python</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span><span class="p">,</span> <span class="n">Response</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">before_request</span><span class="p">():</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Antes de la solicitud: validando la solicitud...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Realizar autenticación, validación o registro aquí</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="c1"># Estamos en el contexto de la aplicación</span>
            <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s2">&quot;¡Solicitud inválida!&quot;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">is_valid_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
        <span class="c1"># Lógica de validación ficticia</span>
        <span class="k">return</span> <span class="s2">&quot;user&quot;</span> <span class="ow">in</span> <span class="n">request</span>
    <span class="err">```</span>
<span class="o">===</span> <span class="s2">&quot;after_request&quot;</span>
    <span class="n">Estos</span> <span class="n">ganchos</span> <span class="n">se</span> <span class="n">ejecutan</span> <span class="o">**</span><span class="n">después</span><span class="o">**</span> <span class="n">de</span> <span class="n">que</span> <span class="n">la</span> <span class="n">solicitud</span> <span class="n">ha</span> <span class="n">sido</span> <span class="n">procesada</span><span class="o">.</span> <span class="n">Son</span> <span class="n">ideales</span> <span class="n">para</span> <span class="n">tareas</span> <span class="n">de</span> <span class="n">postprocesamiento</span> <span class="n">como</span> <span class="n">limpieza</span><span class="p">,</span> <span class="n">registro</span> <span class="n">adicional</span> <span class="n">o</span> <span class="n">modificación</span> <span class="n">de</span> <span class="n">la</span> <span class="n">respuesta</span> <span class="n">antes</span> <span class="n">de</span> <span class="n">que</span> <span class="n">se</span> <span class="n">envíe</span> <span class="n">de</span> <span class="n">vuelta</span><span class="o">.</span>

    <span class="n">Reciben</span> <span class="n">el</span> <span class="n">objeto</span> <span class="n">de</span> <span class="n">respuesta</span> <span class="n">como</span> <span class="n">argumento</span> <span class="n">y</span> <span class="n">pueden</span> <span class="n">modificarlo</span> <span class="n">antes</span> <span class="n">de</span> <span class="n">devolverlo</span><span class="o">.</span> <span class="n">El</span> <span class="n">primer</span> <span class="n">gancho</span> <span class="n">after_request</span> <span class="n">que</span> <span class="n">devuelva</span> <span class="n">una</span> <span class="n">respuesta</span> <span class="n">se</span> <span class="n">utilizará</span> <span class="n">como</span> <span class="n">la</span> <span class="n">respuesta</span> <span class="n">final</span><span class="o">.</span>

    <span class="o">**</span><span class="n">Ejemplo</span><span class="p">:</span><span class="o">**</span>

    <span class="err">```</span><span class="n">python</span>
    <span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">after_request</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Después de la solicitud: registrando la respuesta...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Realizar registro, limpieza o modificaciones de la respuesta aquí</span>
        <span class="n">log_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">log_response</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
        <span class="c1"># Lógica de registro ficticia</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Respuesta registrada:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="err">```</span>
<span class="o">===</span> <span class="s2">&quot;teardown_request&quot;</span>
    <span class="n">Estos</span> <span class="n">ganchos</span> <span class="n">se</span> <span class="n">invocan</span> <span class="n">cuando</span> <span class="n">el</span> <span class="n">contexto</span> <span class="n">de</span> <span class="n">la</span> <span class="n">solicitud</span> <span class="n">se</span> <span class="n">está</span> <span class="n">desmontando</span><span class="o">.</span> <span class="n">Estos</span> <span class="n">ganchos</span> <span class="n">se</span> <span class="n">utilizan</span> <span class="n">para</span> <span class="n">liberar</span> <span class="n">recursos</span> <span class="n">o</span> <span class="n">manejar</span> <span class="n">errores</span> <span class="n">que</span> <span class="n">ocurrieron</span> <span class="n">durante</span> <span class="n">el</span> <span class="n">ciclo</span> <span class="n">de</span> <span class="n">vida</span> <span class="n">de</span> <span class="n">la</span> <span class="n">solicitud</span><span class="o">.</span>

    <span class="o">**</span><span class="n">Ejemplo</span><span class="p">:</span><span class="o">**</span>

    <span class="err">```</span><span class="n">python</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">teardown_request</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Desmontaje de la solicitud: limpiando recursos...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Realizar limpieza, liberar recursos o manejar errores aquí</span>
        <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
            <span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
        <span class="n">cleanup_resources</span><span class="p">()</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
        <span class="c1"># Lógica de manejo de errores ficticia</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error encontrado:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="k">def</span><span class="w"> </span><span class="nf">cleanup_resources</span><span class="p">():</span>
        <span class="c1"># Lógica de limpieza de recursos ficticia</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Los recursos han sido limpiados.&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="err">```</span>
<span class="o">===</span> <span class="s2">&quot;context_processor&quot;</span>
    <span class="n">Estos</span> <span class="n">ganchos</span> <span class="n">se</span> <span class="n">utilizan</span> <span class="n">para</span> <span class="n">inyectar</span> <span class="n">contexto</span> <span class="n">adicional</span> <span class="n">en</span> <span class="n">las</span> <span class="n">plantillas</span> <span class="n">o</span> <span class="n">vistas</span><span class="o">.</span> <span class="n">Enriquecen</span> <span class="n">el</span> <span class="n">contexto</span> <span class="n">de</span> <span class="n">tiempo</span> <span class="n">de</span> <span class="n">ejecución</span> <span class="n">pasando</span> <span class="n">datos</span> <span class="n">comunes</span> <span class="p">(</span><span class="n">como</span> <span class="n">información</span> <span class="k">del</span> <span class="n">usuario</span> <span class="n">o</span> <span class="n">configuraciones</span><span class="p">)</span> <span class="n">a</span> <span class="n">las</span> <span class="n">plantillas</span><span class="o">.</span>

    <span class="n">Si</span> <span class="n">un</span> <span class="n">procesador</span> <span class="n">de</span> <span class="n">contexto</span> <span class="n">devuelve</span> <span class="n">un</span> <span class="n">diccionario</span><span class="p">,</span> <span class="n">las</span> <span class="n">claves</span> <span class="n">y</span> <span class="n">los</span> <span class="n">valores</span> <span class="n">se</span> <span class="n">añadirán</span> <span class="n">al</span> <span class="n">contexto</span> <span class="n">para</span> <span class="n">todas</span> <span class="n">las</span> <span class="n">plantillas</span><span class="o">.</span> <span class="n">Esto</span> <span class="n">te</span> <span class="n">permite</span> <span class="n">compartir</span> <span class="n">datos</span> <span class="n">entre</span> <span class="n">múltiples</span> <span class="n">vistas</span> <span class="n">o</span> <span class="n">plantillas</span><span class="o">.</span>

    <span class="o">**</span><span class="n">Ejemplo</span><span class="p">:</span><span class="o">**</span>

    <span class="err">```</span><span class="n">python</span>
    <span class="k">def</span><span class="w"> </span><span class="nf">context_processor</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Procesador de contexto: inyectando datos de contexto...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Devolver un diccionario que contenga datos de contexto para las plantillas/vistas</span>
        <span class="k">return</span> <span class="p">{</span>
            <span class="s2">&quot;current_user&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
            <span class="s2">&quot;app_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
            <span class="s2">&quot;feature_flags&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;new_ui&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="err">```</span>

<span class="n">Este</span> <span class="n">diseño</span> <span class="n">de</span> <span class="n">ganchos</span> <span class="n">de</span> <span class="n">ciclo</span> <span class="n">de</span> <span class="n">vida</span> <span class="n">proporciona</span> <span class="n">un</span> <span class="n">enfoque</span> <span class="n">modular</span> <span class="n">y</span> <span class="n">sistemático</span> <span class="n">para</span> <span class="n">gestionar</span> <span class="n">diversos</span> <span class="n">aspectos</span> <span class="k">del</span> <span class="n">ciclo</span> <span class="n">de</span> <span class="n">vida</span> <span class="n">de</span> <span class="n">una</span> <span class="n">solicitud</span><span class="p">:</span>

<span class="o">-</span> <span class="o">**</span><span class="n">Modularidad</span><span class="p">:</span><span class="o">**</span> <span class="n">Cada</span> <span class="n">gancho</span> <span class="n">es</span> <span class="n">responsable</span> <span class="n">de</span> <span class="n">una</span> <span class="n">fase</span> <span class="n">distinta</span><span class="p">,</span> <span class="n">asegurando</span> <span class="n">que</span> <span class="n">las</span> <span class="n">responsabilidades</span> <span class="n">estén</span> <span class="n">separadas</span><span class="o">.</span>
<span class="o">-</span> <span class="o">**</span><span class="n">Mantenibilidad</span><span class="p">:</span><span class="o">**</span> <span class="n">Los</span> <span class="n">desarrolladores</span> <span class="n">pueden</span> <span class="n">añadir</span><span class="p">,</span> <span class="n">modificar</span> <span class="n">o</span> <span class="n">eliminar</span> <span class="n">fácilmente</span> <span class="n">implementaciones</span> <span class="n">de</span> <span class="n">ganchos</span> <span class="n">sin</span> <span class="n">afectar</span> <span class="n">otras</span> <span class="n">partes</span> <span class="k">del</span> <span class="n">ciclo</span> <span class="n">de</span> <span class="n">vida</span> <span class="n">de</span> <span class="n">la</span> <span class="n">solicitud</span><span class="o">.</span>
<span class="o">-</span> <span class="o">**</span><span class="n">Extensibilidad</span><span class="p">:</span><span class="o">**</span> <span class="n">El</span> <span class="n">marco</span> <span class="n">es</span> <span class="n">flexible</span><span class="p">,</span> <span class="n">lo</span> <span class="n">que</span> <span class="n">permite</span> <span class="n">añadir</span> <span class="n">ganchos</span> <span class="n">adicionales</span> <span class="n">o</span> <span class="n">mejoras</span> <span class="n">a</span> <span class="n">medida</span> <span class="n">que</span> <span class="n">evolucionan</span> <span class="n">los</span> <span class="n">requisitos</span> <span class="n">de</span> <span class="n">la</span> <span class="n">aplicación</span><span class="o">.</span>

<span class="n">Al</span> <span class="n">definir</span> <span class="n">claramente</span> <span class="n">las</span> <span class="n">responsabilidades</span> <span class="n">de</span> <span class="n">cada</span> <span class="n">gancho</span> <span class="n">y</span> <span class="n">sus</span> <span class="n">prefijos</span> <span class="n">de</span> <span class="n">registro</span> <span class="n">asociados</span><span class="p">,</span> <span class="n">el</span> <span class="n">sistema</span> <span class="n">asegura</span> <span class="n">que</span> <span class="n">cada</span> <span class="n">etapa</span> <span class="k">del</span> <span class="n">procesamiento</span> <span class="n">de</span> <span class="n">la</span> <span class="n">solicitud</span> <span class="n">sea</span> <span class="n">transparente</span> <span class="n">y</span> <span class="n">manejable</span><span class="o">.</span>

<span class="c1">### Blueprints</span>

<span class="n">En</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">los</span> <span class="o">**</span><span class="n">blueprints</span><span class="o">**</span> <span class="n">sirven</span> <span class="n">como</span> <span class="n">una</span> <span class="n">forma</span> <span class="n">modular</span> <span class="n">de</span> <span class="n">organizar</span> <span class="n">componentes</span> <span class="n">relacionados</span> <span class="err">—</span><span class="n">como</span> <span class="n">vistas</span><span class="p">,</span> <span class="n">plantillas</span> <span class="n">y</span> <span class="n">archivos</span> <span class="n">estáticos</span><span class="err">—</span> <span class="n">dentro</span> <span class="n">de</span> <span class="n">tu</span> <span class="n">aplicación</span><span class="o">.</span> <span class="n">Te</span> <span class="n">permiten</span> <span class="n">agrupar</span> <span class="n">la</span> <span class="n">funcionalidad</span> <span class="n">de</span> <span class="n">manera</span> <span class="n">lógica</span> <span class="n">y</span> <span class="n">se</span> <span class="n">pueden</span> <span class="n">usar</span> <span class="n">para</span> <span class="n">crear</span> <span class="n">nuevas</span> <span class="n">secciones</span> <span class="n">de</span> <span class="n">tu</span> <span class="n">aplicación</span> <span class="n">o</span> <span class="n">sobrescribir</span> <span class="n">las</span> <span class="n">existentes</span><span class="o">.</span>

<span class="c1">#### Crear un Blueprint</span>

<span class="n">Para</span> <span class="n">definir</span> <span class="n">un</span> <span class="n">blueprint</span><span class="p">,</span> <span class="n">creas</span> <span class="n">una</span> <span class="n">instancia</span> <span class="n">de</span> <span class="n">la</span> <span class="n">clase</span> <span class="err">`</span><span class="n">Blueprint</span><span class="err">`</span><span class="p">,</span> <span class="n">especificando</span> <span class="n">su</span> <span class="n">nombre</span> <span class="n">y</span> <span class="n">la</span> <span class="n">ruta</span> <span class="n">de</span> <span class="n">importación</span><span class="o">.</span> <span class="n">Luego</span><span class="p">,</span> <span class="n">defines</span> <span class="n">las</span> <span class="n">rutas</span> <span class="n">y</span> <span class="n">vistas</span> <span class="n">asociadas</span> <span class="n">a</span> <span class="n">este</span> <span class="n">blueprint</span><span class="o">.</span>

<span class="o">**</span><span class="n">Ejemplo</span><span class="p">:</span> <span class="n">Definir</span> <span class="n">un</span> <span class="n">nuevo</span> <span class="n">Blueprint</span><span class="o">**</span>

<span class="err">```</span><span class="n">python</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">dirname</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">render_template</span>

<span class="c1"># Definir el blueprint</span>
<span class="n">mi_blueprint</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">&#39;mi_blueprint&#39;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">,</span> <span class="n">template_folder</span><span class="o">=</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/templates&#39;</span><span class="p">)</span> <span class="c1"># La carpeta de plantillas se establece para evitar conflictos con el blueprint original</span>

<span class="c1"># Definir una ruta dentro del blueprint</span>
<span class="nd">@mi_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/mi_blueprint&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">mi_pagina_blueprint</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;mi_blueprint.html&#39;</span><span class="p">)</span>
</code></pre></div></p>
<p>En este ejemplo, se crea un blueprint llamado <code>mi_blueprint</code> y se define una ruta <code>/mi_blueprint</code> dentro de él.</p>
<h4 id="es-plugins-sobrescribir-un-blueprint-existente">Sobrescribir un Blueprint existente</h4>
<p>Los blueprints también pueden sobrescribir los existentes para modificar o ampliar la funcionalidad. Para hacer esto, asegúrate de que el nuevo blueprint tenga el mismo nombre que el que estás sobrescribiendo y regístralo después del original.</p>
<p><strong>Ejemplo: Sobrescribir un Blueprint existente</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">dirname</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">Blueprint</span>

<span class="c1"># Blueprint original</span>
<span class="n">instances</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">&#39;instances&#39;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">,</span> <span class="n">template_folder</span><span class="o">=</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/templates&#39;</span><span class="p">)</span> <span class="c1"># La carpeta de plantillas se establece para evitar conflictos con el blueprint original</span>

<span class="nd">@instances</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/instances&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">override_instances</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;Mi nueva página de instancias&quot;</span>
</code></pre></div>
<p>En este escenario, al acceder a la URL <code>/instances</code> se mostrará "Mi nueva página de instancias" porque el blueprint <code>instances</code>, registrado en último lugar, sobrescribe el blueprint <code>instances</code> original.</p>
<div class="admonition warning">
<p class="admonition-title">Sobre la sobrescritura</p>
<p>Ten cuidado al sobrescribir los blueprints existentes, ya que puede afectar el comportamiento de la aplicación. Asegúrate de que los cambios se alineen con los requisitos de la aplicación y no introduzcan efectos secundarios inesperados.</p>
<p>Todas las rutas existentes se eliminarán del blueprint original, por lo que necesitarás volver a implementarlas si es necesario.</p>
</div>
<h4 id="es-plugins-convenciones-de-nomenclatura">Convenciones de nomenclatura</h4>
<div class="admonition danger">
<p class="admonition-title">Importante</p>
<p>Asegúrate de que el nombre del blueprint coincida con el nombre de la variable del blueprint, de lo contrario no se considerará un blueprint válido y no se registrará.</p>
</div>
<p>Para la coherencia y la claridad, es aconsejable seguir estas convenciones de nomenclatura:</p>
<ul>
<li>
<p><strong>Nombres de Blueprint</strong>: Usa nombres cortos, todo en minúsculas. Se pueden usar guiones bajos para mejorar la legibilidad, por ejemplo, <code>user_auth</code>.</p>
</li>
<li>
<p><strong>Nombres de archivo</strong>: Haz que el nombre del archivo coincida con el nombre del blueprint, asegurándote de que esté todo en minúsculas con guiones bajos según sea necesario, por ejemplo, <code>user_auth.py</code>.</p>
</li>
</ul>
<p>Esta práctica se alinea con las convenciones de nomenclatura de módulos de Python y ayuda a mantener una estructura de proyecto clara.</p>
<p><strong>Ejemplo: Nomenclatura de Blueprint y archivo</strong></p>
<div class="highlight"><pre><span></span><code>plugin /
    ui / blueprints / user_auth.py
                      templates / user_auth.html
</code></pre></div>
<p>En esta estructura, <code>user_auth.py</code> contiene el blueprint <code>user_auth</code>, y <code>user_auth.html</code> es la plantilla asociada, cumpliendo con las convenciones de nomenclatura recomendadas.</p></section><section class="print-page" id="es-professional-services" heading-number="12"><h1 id="es-professional-services-servicios-profesionales">Servicios profesionales</h1>
<h2 id="es-professional-services-por-que-deberia-contratar-servicios-profesionales">¿Por qué debería contratar servicios profesionales?</h2>
<p>Dado que BunkerWeb es un software libre (como en libertad), tienes derecho a usarlo libremente siempre que respetes la <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">licencia AGPLv3</a>.</p>
<p>También puedes actualizar BunkerWeb a la versión PRO en cualquier momento. Al hacerlo, obtendrás una experiencia mejorada para ayudarte en la seguridad de tus servicios web. Nuestro objetivo es ayudarte a centrarte en las necesidades de tu negocio. La versión PRO se actualiza regularmente y hacemos todo lo posible para recopilar los comentarios de las empresas para incluir las características necesarias.</p>
<p>Pero dedicar tiempo a una tecnología específica puede no ser fácil dependiendo de las prioridades de tu negocio. Sin mencionar que la ciberseguridad es un dominio complejo donde no se recomienda ser juez y parte.</p>
<p>Obtener servicios profesionales además de la versión de código abierto o PRO es la solución ideal para cubrir las necesidades de tu negocio. Puedes centrarte en tus principales prioridades y confiar en un socio de confianza cuando se trata de seguridad web.</p>
<p>Ten en cuenta que los servicios profesionales son ofrecidos directamente por <a href="https://www.bunkerity.com/?utm_campaign=self&amp;utm_source=doc">Bunkerity</a>, la empresa que mantiene el proyecto BunkerWeb, a través de nuestra plataforma en línea <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a>.</p>
<h2 id="es-professional-services-que-servicios-profesionales-ofreceis">¿Qué servicios profesionales ofrecéis?</h2>
<p>Ofrecemos soporte técnico y consultoría en torno a la solución BunkerWeb. Al utilizar este servicio, te ayudaremos con los problemas técnicos (instalación, configuración, falsos positivos, ...). También podemos ofrecer un SLA personalizado según tus necesidades.</p>
<p>Según tus necesidades, tienes la opción de elegir entre ofertas "puntuales" y de suscripción.</p>
<h2 id="es-professional-services-como-puedo-obtener-mas-informacion">¿Cómo puedo obtener más información?</h2>
<p>Encontrarás más información visitando el <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">Panel de BunkerWeb</a>, nuestra plataforma dedicada a los servicios profesionales.</p>
<p>No dudes en <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contactarnos</a> si tienes alguna pregunta, estaremos encantados de responder a tus necesidades.</p></section><section class="print-page" id="es-about" heading-number="13"><h1 id="es-about-acerca-de">Acerca de</h1>
<h2 id="es-about-quien-mantiene-bunkerweb">¿Quién mantiene BunkerWeb?</h2>
<p>BunkerWeb es mantenido por <a href="https://www.bunkerity.com/?utm_campaign=self&amp;utm_source=doc">Bunkerity</a>, una empresa francesa 🇫🇷 especializada en Ciberseguridad 🛡️.</p>
<h2 id="es-about-teneis-una-version-profesional">¿Tenéis una versión profesional?</h2>
<div class="admonition tip">
<p class="admonition-title">Prueba gratuita de BunkerWeb PRO</p>
<p>¿Quieres probar rápidamente BunkerWeb PRO durante un mes? Usa el código <code>freetrial</code> al realizar tu pedido en el <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">panel de BunkerWeb</a> o haciendo clic <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">aquí</a> para aplicar directamente el código de promoción (se hará efectivo al finalizar la compra).</p>
</div>
<p>Sí, ofrecemos una versión profesional de BunkerWeb llamada "BunkerWeb PRO" con características adicionales y soporte técnico (opcional).</p>
<p>No dudes en <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contactarnos</a> si tienes alguna pregunta, estaremos encantados de responder a tus necesidades.</p>
<h2 id="es-about-ofreceis-servicios-profesionales">¿Ofrecéis servicios profesionales?</h2>
<p>Sí, ofrecemos servicios profesionales relacionados con BunkerWeb.</p>
<p>Puedes ponerte en contacto con nosotros para cualquiera de los siguientes:</p>
<ul>
<li>Consultoría</li>
<li>Soporte</li>
<li>Desarrollo a medida</li>
<li>Asociaciones</li>
</ul>
<p>Tenemos un <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">panel dedicado</a> para centralizar todas las solicitudes profesionales.</p>
<p>También puedes <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contactarnos</a> si estás interesado.</p>
<h2 id="es-about-donde-obtener-soporte-de-la-comunidad">¿Dónde obtener soporte de la comunidad?</h2>
<p>Para obtener soporte gratuito de la comunidad, puedes utilizar los siguientes medios:</p>
<ul>
<li>El canal #help de BunkerWeb en el <a href="https.discord.com/invite/fTf46FmtyD">servidor de Discord</a></li>
<li>La categoría de ayuda de las <a href="https://github.com/bunkerity/bunkerweb/discussions">discusiones de GitHub</a></li>
<li>El subreddit <a href="https://www.reddit.com/r/BunkerWeb">/r/BunkerWeb</a></li>
<li>Los foros de <a href="https://serverfault.com/">Server Fault</a> y <a href="https://superuser.com/">Super User</a></li>
</ul>
<p>Por favor, no utilices los <a href="https://github.com/bunkerity/bunkerweb/issues">issues de GitHub</a> para pedir ayuda, úsalos solo para informes de errores y solicitudes de nuevas características.</p>
<h2 id="es-about-como-puedo-contribuir">¿Cómo puedo contribuir?</h2>
<p>Aquí tienes una lista no exhaustiva de lo que puedes hacer:</p>
<ul>
<li>Unirte al <a href="https://discord.com/invite/fTf46FmtyD">servidor de Discord</a>, al subreddit <a href="https://www.reddit.com/r/BunkerWeb">/r/BunkerWeb</a> y a las <a href="https://github.com/bunkerity/bunkerweb/discussions">discusiones de GitHub</a> para hablar sobre el proyecto y ayudar a otros</li>
<li>Seguirnos en <a href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>, <a href="https://x.com/bunkerity">X (Anteriormente Twitter)</a> y <a href="https://github.com/bunkerity">GitHub</a></li>
<li>Reportar errores y proponer nuevas características usando los <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a></li>
<li>Contribuir al código usando <a href="https://github.com/bunkerity/bunkerweb/pulls">pull requests</a></li>
<li>Escribir un increíble <a href="#es-plugins">plugin</a></li>
<li>Hablar de BunkerWeb a tus amigos/colegas, en redes sociales, en tu blog, ...</li>
</ul>
<h2 id="es-about-como-reportar-problemas-de-seguridad">¿Cómo reportar problemas de seguridad?</h2>
<p>Por favor, contáctanos en <a href="mailto:security@bunkerity.com">security@bunkerity.com</a>.</p></section></div><style>.print-site-enumerate-headings #es > h1:before { content: '1 ' }

                .print-site-enumerate-headings #es h2:before { content: '1.' counter(counter-es-2) ' ' }
                .print-site-enumerate-headings #es h2 {  counter-reset: counter-es-3 ;  counter-increment: counter-es-2 }
            
                .print-site-enumerate-headings #es h3:before { content: '1.' counter(counter-es-2) '.' counter(counter-es-3) ' ' }
                .print-site-enumerate-headings #es h3 {  counter-increment: counter-es-3 }
            
.print-site-enumerate-headings #es-concepts > h1:before { content: '2 ' }

                .print-site-enumerate-headings #es-concepts h2:before { content: '2.' counter(counter-es-concepts-2) ' ' }
                .print-site-enumerate-headings #es-concepts h2 {  counter-reset: counter-es-concepts-3 ;  counter-increment: counter-es-concepts-2 }
            
                .print-site-enumerate-headings #es-concepts h3:before { content: '2.' counter(counter-es-concepts-2) '.' counter(counter-es-concepts-3) ' ' }
                .print-site-enumerate-headings #es-concepts h3 {  counter-increment: counter-es-concepts-3 }
            
.print-site-enumerate-headings #es-integrations > h1:before { content: '3 ' }

                .print-site-enumerate-headings #es-integrations h2:before { content: '3.' counter(counter-es-integrations-2) ' ' }
                .print-site-enumerate-headings #es-integrations h2 {  counter-reset: counter-es-integrations-3 ;  counter-increment: counter-es-integrations-2 }
            
                .print-site-enumerate-headings #es-integrations h3:before { content: '3.' counter(counter-es-integrations-2) '.' counter(counter-es-integrations-3) ' ' }
                .print-site-enumerate-headings #es-integrations h3 {  counter-increment: counter-es-integrations-3 }
            
.print-site-enumerate-headings #es-quickstart-guide > h1:before { content: '4 ' }

                .print-site-enumerate-headings #es-quickstart-guide h2:before { content: '4.' counter(counter-es-quickstart-guide-2) ' ' }
                .print-site-enumerate-headings #es-quickstart-guide h2 {  counter-reset: counter-es-quickstart-guide-3 ;  counter-increment: counter-es-quickstart-guide-2 }
            
                .print-site-enumerate-headings #es-quickstart-guide h3:before { content: '4.' counter(counter-es-quickstart-guide-2) '.' counter(counter-es-quickstart-guide-3) ' ' }
                .print-site-enumerate-headings #es-quickstart-guide h3 {  counter-increment: counter-es-quickstart-guide-3 }
            
.print-site-enumerate-headings #es-features > h1:before { content: '5 ' }

                .print-site-enumerate-headings #es-features h2:before { content: '5.' counter(counter-es-features-2) ' ' }
                .print-site-enumerate-headings #es-features h2 {  counter-reset: counter-es-features-3 ;  counter-increment: counter-es-features-2 }
            
                .print-site-enumerate-headings #es-features h3:before { content: '5.' counter(counter-es-features-2) '.' counter(counter-es-features-3) ' ' }
                .print-site-enumerate-headings #es-features h3 {  counter-increment: counter-es-features-3 }
            
.print-site-enumerate-headings #es-advanced > h1:before { content: '6 ' }

                .print-site-enumerate-headings #es-advanced h2:before { content: '6.' counter(counter-es-advanced-2) ' ' }
                .print-site-enumerate-headings #es-advanced h2 {  counter-reset: counter-es-advanced-3 ;  counter-increment: counter-es-advanced-2 }
            
                .print-site-enumerate-headings #es-advanced h3:before { content: '6.' counter(counter-es-advanced-2) '.' counter(counter-es-advanced-3) ' ' }
                .print-site-enumerate-headings #es-advanced h3 {  counter-increment: counter-es-advanced-3 }
            
.print-site-enumerate-headings #es-web-ui > h1:before { content: '7 ' }

                .print-site-enumerate-headings #es-web-ui h2:before { content: '7.' counter(counter-es-web-ui-2) ' ' }
                .print-site-enumerate-headings #es-web-ui h2 {  counter-reset: counter-es-web-ui-3 ;  counter-increment: counter-es-web-ui-2 }
            
                .print-site-enumerate-headings #es-web-ui h3:before { content: '7.' counter(counter-es-web-ui-2) '.' counter(counter-es-web-ui-3) ' ' }
                .print-site-enumerate-headings #es-web-ui h3 {  counter-increment: counter-es-web-ui-3 }
            
.print-site-enumerate-headings #es-api > h1:before { content: '8 ' }

                .print-site-enumerate-headings #es-api h2:before { content: '8.' counter(counter-es-api-2) ' ' }
                .print-site-enumerate-headings #es-api h2 {  counter-reset: counter-es-api-3 ;  counter-increment: counter-es-api-2 }
            
                .print-site-enumerate-headings #es-api h3:before { content: '8.' counter(counter-es-api-2) '.' counter(counter-es-api-3) ' ' }
                .print-site-enumerate-headings #es-api h3 {  counter-increment: counter-es-api-3 }
            
.print-site-enumerate-headings #es-upgrading > h1:before { content: '9 ' }

                .print-site-enumerate-headings #es-upgrading h2:before { content: '9.' counter(counter-es-upgrading-2) ' ' }
                .print-site-enumerate-headings #es-upgrading h2 {  counter-reset: counter-es-upgrading-3 ;  counter-increment: counter-es-upgrading-2 }
            
                .print-site-enumerate-headings #es-upgrading h3:before { content: '9.' counter(counter-es-upgrading-2) '.' counter(counter-es-upgrading-3) ' ' }
                .print-site-enumerate-headings #es-upgrading h3 {  counter-increment: counter-es-upgrading-3 }
            
.print-site-enumerate-headings #es-troubleshooting > h1:before { content: '10 ' }

                .print-site-enumerate-headings #es-troubleshooting h2:before { content: '10.' counter(counter-es-troubleshooting-2) ' ' }
                .print-site-enumerate-headings #es-troubleshooting h2 {  counter-reset: counter-es-troubleshooting-3 ;  counter-increment: counter-es-troubleshooting-2 }
            
                .print-site-enumerate-headings #es-troubleshooting h3:before { content: '10.' counter(counter-es-troubleshooting-2) '.' counter(counter-es-troubleshooting-3) ' ' }
                .print-site-enumerate-headings #es-troubleshooting h3 {  counter-increment: counter-es-troubleshooting-3 }
            
.print-site-enumerate-headings #es-plugins > h1:before { content: '11 ' }

                .print-site-enumerate-headings #es-plugins h2:before { content: '11.' counter(counter-es-plugins-2) ' ' }
                .print-site-enumerate-headings #es-plugins h2 {  counter-reset: counter-es-plugins-3 ;  counter-increment: counter-es-plugins-2 }
            
                .print-site-enumerate-headings #es-plugins h3:before { content: '11.' counter(counter-es-plugins-2) '.' counter(counter-es-plugins-3) ' ' }
                .print-site-enumerate-headings #es-plugins h3 {  counter-increment: counter-es-plugins-3 }
            
.print-site-enumerate-headings #es-professional-services > h1:before { content: '12 ' }

                .print-site-enumerate-headings #es-professional-services h2:before { content: '12.' counter(counter-es-professional-services-2) ' ' }
                .print-site-enumerate-headings #es-professional-services h2 {  counter-reset: counter-es-professional-services-3 ;  counter-increment: counter-es-professional-services-2 }
            
                .print-site-enumerate-headings #es-professional-services h3:before { content: '12.' counter(counter-es-professional-services-2) '.' counter(counter-es-professional-services-3) ' ' }
                .print-site-enumerate-headings #es-professional-services h3 {  counter-increment: counter-es-professional-services-3 }
            
.print-site-enumerate-headings #es-about > h1:before { content: '13 ' }

                .print-site-enumerate-headings #es-about h2:before { content: '13.' counter(counter-es-about-2) ' ' }
                .print-site-enumerate-headings #es-about h2 {  counter-reset: counter-es-about-3 ;  counter-increment: counter-es-about-2 }
            
                .print-site-enumerate-headings #es-about h3:before { content: '13.' counter(counter-es-about-2) '.' counter(counter-es-about-3) ' ' }
                .print-site-enumerate-headings #es-about h3 {  counter-increment: counter-es-about-3 }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; <script>document.write(new Date().getFullYear())</script> Bunkerity
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://discord.com/invite/fTf46FmtyD" target="_blank" rel="noopener" title="discord.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/bunkerity" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/bunkerity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.reddit.com/r/BunkerWeb/" target="_blank" rel="noopener" title="www.reddit.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/bunkerweb/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M224.3 141a115 115 0 1 0-.6 230 115 115 0 1 0 .6-230m-.6 40.4a74.6 74.6 0 1 1 .6 149.2 74.6 74.6 0 1 1-.6-149.2m93.4-45.1a26.8 26.8 0 1 1 53.6 0 26.8 26.8 0 1 1-53.6 0m129.7 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M399 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bunkerity" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/latest", "features": ["navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "content.code.copy"], "search": "../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copiado al portapapeles", "clipboard.copy": "Copiar al portapapeles", "search.result.more.one": "1 m\u00e1s en esta p\u00e1gina", "search.result.more.other": "# m\u00e1s en esta p\u00e1gina", "search.result.none": "No se encontraron documentos", "search.result.one": "1 documento encontrado", "search.result.other": "# documentos encontrados", "search.result.placeholder": "Teclee para comenzar b\u00fasqueda", "search.result.term.missing": "Falta", "select.version": "Seleccionar versi\u00f3n"}, "version": {"provider": "mike", "version": "latest"}}</script>
    
    
      <script src="../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../assets/extra.js"></script>
      
        <script src="https://chatbot.bunkerweb.io/static/js/chatbot.js"></script>
      
    
  </body>
</html>