
<!doctype html>
<html lang="zh" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation of BunkerWeb, the open source and next generation WAF.">
      
      
      
        <link rel="canonical" href="https://docs.bunkerweb.io/latest/zh/integrations/">
      
      
        <link rel="prev" href="../concepts/">
      
      
        <link rel="next" href="../quickstart-guide/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>é›†æˆ - BunkerWeb æ–‡æ¡£</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
      


    
    
    <script async
            defer
            data-domain="docs.bunkerweb.io"
            src="https://data.bunkerity.com/js/script.js"></script>

    <script defer>
      window.addEventListener('DOMContentLoaded', (e) => {

        const customHeaders = document.querySelectorAll('[data-custom-header]')
        customHeaders.forEach(header => {
          const getHeaders = document.querySelectorAll(`#${header.getAttribute('id')}`);
          getHeaders.forEach(el => {

            if(!el.hasAttribute('data-custom-header')) el.remove()
        })})
      })
    </script>

    <script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script>

    <script defer>
  // Lazy load images and embed youtube videos
  window.addEventListener("load", () => {
    document.querySelectorAll("[data-src]").forEach((el) => {
      el.setAttribute("src", el.getAttribute("data-src"));
    });
  });
  // Add missing label
  try {
    document
      .querySelector('div.md-search[data-md-component="search"][role="dialog"]')
      .setAttribute("aria-label", "Search in documentation");
  } catch (err) {}
    </script>

    <script defer>
      window.addEventListener('DOMContentLoaded', () => {
        const bannerEl = document.querySelector('aside.md-banner');
        let defaultContent = [{ "content" : '<p>Get the most of BunkerWeb by upgrading to the PRO version. Click <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&utm_source=doc">here</a> and use the <strong>freetrial</strong> promo code to get started.</p>'},
        { "content" : '<p>Need premium support or tailored consulting around BunkerWeb ? Check out our <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc#services">professional services</a>.</p>'},
        { "content" : '<p>Be part of the Bunker community by joining the <a style="text-decoration:underline; color: white;" href="https://discord.bunkerweb.io">Discord chat</a> and following us on <a style="text-decoration:underline; color: white;" href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>.</p>'}
        ]

      function setBannerStyle() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        bannerEl.style.backgroundColor = "#2eac68";
        bannerItem.style.textAlign = "center";
        bannerItem.style.transition = "all 0.5s ease-out";
      }

      function setDefault() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        const clone = bannerItem.cloneNode(true);
        clone.innerHTML = defaultContent[0]["content"];
        bannerEl.replaceChild(clone, bannerItem);
      }

      function startBannerLoop() {
        const switchDelay = 7000;
        let i = 0;

        setInterval(() => {
          // Update or reset index
          if(i + 1 === defaultContent.length) {
            i = 0;
          } else {
            i++;
          }

          // Prepare data with next el with opacity 0 too
          const currItem = bannerEl.querySelector('.md-banner__inner');
          currItem.style.opacity = 0;
          const clone = currItem.cloneNode(true);
          clone.innerHTML = defaultContent[i]["content"];
          setTimeout(() => {
            bannerEl.replaceChild(clone, currItem);
            setTimeout(() => {
              const newItem = bannerEl.querySelector('.md-banner__inner');
              newItem.style.opacity = 1;
            }, 20);
          }, 600);

        }, switchDelay);
      }

      function runBanner() {
        startBannerLoop();
        // Try to get dynamic content
        // Else keep static ones
        // fetch("https://www.bunkerweb.io/api/bw-ui-news")
        // .then((res) => {
        //   return res.json();
        // })
        // .then((res) => {
        //   defaultContent = res.data[0].data;
        //   startBannerLoop();
        // })
        // .catch((e) => {
        //   startBannerLoop();
        // });
      }

        setBannerStyle();
        setDefault();
        runBanner()

      })
    </script>

    
      
    
    
      <link rel="stylesheet" href="../../assets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="é›†æˆ - BunkerWeb æ–‡æ¡£" >
      
        <meta  property="og:description"  content="Documentation of BunkerWeb, the open source and next generation WAF." >
      
        <meta  property="og:image"  content="https://docs.bunkerweb.io/latest/assets/images/social/zh/integrations.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://docs.bunkerweb.io/latest/zh/integrations/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="é›†æˆ - BunkerWeb æ–‡æ¡£" >
      
        <meta  name="twitter:description"  content="Documentation of BunkerWeb, the open source and next generation WAF." >
      
        <meta  name="twitter:image"  content="https://docs.bunkerweb.io/latest/assets/images/social/zh/integrations.png" >
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#_1" class="md-skip">
          è·³è½¬è‡³
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
    ğŸ“¢ Looking for BunkerWeb CLOUD, PRO version, technical support or tailored services ? Visit the
    <a href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc"
       style="color: #3f6ec6;
              text-decoration: underline">BunkerWeb Panel</a>
    for more information on our enterprise offers.

          </div>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
    You're not viewing the
    documentation of the latest version.
    <a href="../../..">
        <strong>Click here to view latest.</strong>
    </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="é¡µçœ‰">
    <a href="../" title="BunkerWeb æ–‡æ¡£" class="md-header__button md-logo" aria-label="BunkerWeb æ–‡æ¡£" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BunkerWeb æ–‡æ¡£
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              é›†æˆ
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="é€‰æ‹©å½“å‰è¯­è¨€">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../integrations/" hreflang="en" class="md-select__link">
              English - ğŸ‡¬ğŸ‡§
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../fr/integrations/" hreflang="fr" class="md-select__link">
              FranÃ§ais - ğŸ‡«ğŸ‡·
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../de/integrations/" hreflang="de" class="md-select__link">
              Deutsch - ğŸ‡©ğŸ‡ª
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../es/integrations/" hreflang="es" class="md-select__link">
              EspaÃ±ol - ğŸ‡ªğŸ‡¸
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="zh" class="md-select__link">
              ä¸­æ–‡ - ğŸ‡¨ğŸ‡³
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="æœç´¢" placeholder="æœç´¢" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="æŸ¥æ‰¾">
        
        <button type="reset" class="md-search__icon md-icon" title="æ¸…ç©ºå½“å‰å†…å®¹" aria-label="æ¸…ç©ºå½“å‰å†…å®¹" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            æ­£åœ¨åˆå§‹åŒ–æœç´¢å¼•æ“
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bunkerity/bunkerweb" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="æ ‡ç­¾" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  ä»‹ç»

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../concepts/" class="md-tabs__link">
        
  
  
    
  
  æ¦‚å¿µ

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  é›†æˆ

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart-guide/" class="md-tabs__link">
        
  
  
    
  
  å¿«é€Ÿå…¥é—¨æŒ‡å—

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../features/" class="md-tabs__link">
        
  
  
    
  
  åŠŸèƒ½

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../advanced/" class="md-tabs__link">
        
  
  
    
  
  é«˜çº§ç”¨æ³•

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../web-ui/" class="md-tabs__link">
        
  
  
    
  
  Web ç•Œé¢

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../api/" class="md-tabs__link">
        
  
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../upgrading/" class="md-tabs__link">
        
  
  
    
  
  å‡çº§

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../troubleshooting/" class="md-tabs__link">
        
  
  
    
  
  æ•…éšœæ’é™¤

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../plugins/" class="md-tabs__link">
        
  
  
    
  
  æ’ä»¶

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../professional-services/" class="md-tabs__link">
        
  
  
    
  
  ä¸“ä¸šæœåŠ¡

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
  
    
  
  å…³äº

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="å¯¼èˆªæ " data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../" title="BunkerWeb æ–‡æ¡£" class="md-nav__button md-logo" aria-label="BunkerWeb æ–‡æ¡£" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    BunkerWeb æ–‡æ¡£
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bunkerity/bunkerweb" title="å‰å¾€ä»“åº“" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ä»‹ç»
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    æ¦‚å¿µ
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    é›†æˆ
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    é›†æˆ
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="ç›®å½•">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      ç›®å½•
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bunkerweb" class="md-nav__link">
    <span class="md-ellipsis">
      BunkerWeb äº‘
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#all-in-one-aio-image" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸€ä½“åŒ– (AIO) é•œåƒ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ä¸€ä½“åŒ– (AIO) é•œåƒ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployment" class="md-nav__link">
    <span class="md-ellipsis">
      éƒ¨ç½²
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api" class="md-nav__link">
    <span class="md-ellipsis">
      API é›†æˆ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      è®¿é—®è®¾ç½®å‘å¯¼
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#redis-integration" class="md-nav__link">
    <span class="md-ellipsis">
      Redis é›†æˆ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crowdsec-integration" class="md-nav__link">
    <span class="md-ellipsis">
      CrowdSec é›†æˆ
    </span>
  </a>
  
    <nav class="md-nav" aria-label="CrowdSec é›†æˆ">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_3" class="md-nav__link">
    <span class="md-ellipsis">
      é»˜è®¤é›†åˆå’Œè§£æå™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_4" class="md-nav__link">
    <span class="md-ellipsis">
      æ·»åŠ é¢å¤–çš„é›†åˆ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_5" class="md-nav__link">
    <span class="md-ellipsis">
      ç¦ç”¨ç‰¹å®šè§£æå™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#appsec" class="md-nav__link">
    <span class="md-ellipsis">
      AppSec å¼€å…³
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crowdsec-api" class="md-nav__link">
    <span class="md-ellipsis">
      å¤–éƒ¨ CrowdSec API
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_6" class="md-nav__link">
    <span class="md-ellipsis">
      ç¯å¢ƒå˜é‡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#docker-secrets" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ Docker secrets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_7" class="md-nav__link">
    <span class="md-ellipsis">
      è°ƒåº¦å™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_8" class="md-nav__link">
    <span class="md-ellipsis">
      ç½‘ç»œ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#compose" class="md-nav__link">
    <span class="md-ellipsis">
      å®Œæ•´çš„ compose æ–‡ä»¶
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_9" class="md-nav__link">
    <span class="md-ellipsis">
      ä»æºä»£ç æ„å»º
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_10" class="md-nav__link">
    <span class="md-ellipsis">
      ç®€æ˜“å®‰è£…è„šæœ¬
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ç®€æ˜“å®‰è£…è„šæœ¬">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_11" class="md-nav__link">
    <span class="md-ellipsis">
      å¿«é€Ÿå¼€å§‹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_12" class="md-nav__link">
    <span class="md-ellipsis">
      å·¥ä½œåŸç†
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_13" class="md-nav__link">
    <span class="md-ellipsis">
      äº¤äº’å¼å®‰è£…
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_14" class="md-nav__link">
    <span class="md-ellipsis">
      å‘½ä»¤è¡Œé€‰é¡¹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#crowdsec-integration-with-the-script" class="md-nav__link">
    <span class="md-ellipsis">
      CrowdSec ä¸è„šæœ¬çš„é›†æˆ
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#rhel" class="md-nav__link">
    <span class="md-ellipsis">
      RHEL æ³¨æ„äº‹é¡¹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_15" class="md-nav__link">
    <span class="md-ellipsis">
      å®‰è£…å
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_16" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_17" class="md-nav__link">
    <span class="md-ellipsis">
      é…ç½®å’ŒæœåŠ¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_18" class="md-nav__link">
    <span class="md-ellipsis">
      é«˜å¯ç”¨æ€§
    </span>
  </a>
  
    <nav class="md-nav" aria-label="é«˜å¯ç”¨æ€§">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_19" class="md-nav__link">
    <span class="md-ellipsis">
      ç®¡ç†å™¨
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_20" class="md-nav__link">
    <span class="md-ellipsis">
      å·¥ä½œèŠ‚ç‚¹
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#web-ui" class="md-nav__link">
    <span class="md-ellipsis">
      Web UI
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-autoconf" class="md-nav__link">
    <span class="md-ellipsis">
      Docker è‡ªåŠ¨é…ç½®
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker è‡ªåŠ¨é…ç½®">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_21" class="md-nav__link">
    <span class="md-ellipsis">
      è‡ªåŠ¨é…ç½®æœåŠ¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespaces" class="md-nav__link">
    <span class="md-ellipsis">
      å‘½åç©ºé—´
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_22" class="md-nav__link">
    <span class="md-ellipsis">
      å®‰è£…æ–¹æ³•
    </span>
  </a>
  
    <nav class="md-nav" aria-label="å®‰è£…æ–¹æ³•">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#helm-chart" class="md-nav__link">
    <span class="md-ellipsis">
      ä½¿ç”¨ helm chartï¼ˆæ¨èï¼‰
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidecar-container-helm" class="md-nav__link">
    <span class="md-ellipsis">
      Sidecar Container + Helm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sidecar Container + Helm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      Prerequisites
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#sidecar-discovery-modes" class="md-nav__link">
    <span class="md-ellipsis">
      Sidecar Discovery Modes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Sidecar Discovery Modes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#mode-1-automatic-discovery-controller-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Mode 1: Automatic Discovery (Controller - Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#mode-2-manual-configuration-bunkerweb_instances" class="md-nav__link">
    <span class="md-ellipsis">
      Mode 2: Manual Configuration (BUNKERWEB_INSTANCES)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1-scheduler-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Step 1: Scheduler Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 1: Scheduler Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-a-with-controller-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Option A: With Controller (Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-b-manual-configuration-with-bunkerweb_instances" class="md-nav__link">
    <span class="md-ellipsis">
      Option B: Manual Configuration with BUNKERWEB_INSTANCES
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-creating-the-deployment-with-sidecar" class="md-nav__link">
    <span class="md-ellipsis">
      Step 2: Creating the Deployment with Sidecar
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 2: Creating the Deployment with Sidecar">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deployment-structure-with-controller-automatic-mode-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment Structure with Controller (Automatic Mode - Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#deployment-structure-without-controller-manual-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Deployment Structure without Controller (Manual Mode)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#important-environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Important Environment Variables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-creating-services" class="md-nav__link">
    <span class="md-ellipsis">
      Step 3: Creating Services
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 3: Creating Services">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#clusterip-service-external-exposure" class="md-nav__link">
    <span class="md-ellipsis">
      ClusterIP Service (external exposure)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headless-service-internal-api-conditional" class="md-nav__link">
    <span class="md-ellipsis">
      Headless Service (internal API) - Conditional
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-4-reverse-proxy-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Step 4: Reverse Proxy Configuration
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 4: Reverse Proxy Configuration">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#option-a-via-web-interface-ui" class="md-nav__link">
    <span class="md-ellipsis">
      Option A: Via Web Interface (UI)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#option-b-via-environment-variables" class="md-nav__link">
    <span class="md-ellipsis">
      Option B: Via Environment Variables
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-5-deployment" class="md-nav__link">
    <span class="md-ellipsis">
      Step 5: Deployment
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Step 5: Deployment">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with-controller-automatic-mode-recommended" class="md-nav__link">
    <span class="md-ellipsis">
      With Controller (Automatic Mode - Recommended)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#without-controller-manual-mode" class="md-nav__link">
    <span class="md-ellipsis">
      Without Controller (Manual Mode)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#common-issues" class="md-nav__link">
    <span class="md-ellipsis">
      Common Issues
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#adding-a-new-application" class="md-nav__link">
    <span class="md-ellipsis">
      Adding a New Application
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Adding a New Application">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#with-controller-automatic-mode" class="md-nav__link">
    <span class="md-ellipsis">
      With Controller (Automatic Mode)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#without-controller-manual-mode_1" class="md-nav__link">
    <span class="md-ellipsis">
      Without Controller (Manual Mode)
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      Best Practices
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#yaml" class="md-nav__link">
    <span class="md-ellipsis">
      å®Œæ•´çš„ YAML æ–‡ä»¶
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress èµ„æº
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespaces_1" class="md-nav__link">
    <span class="md-ellipsis">
      å‘½åç©ºé—´
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress_1" class="md-nav__link">
    <span class="md-ellipsis">
      Ingress ç±»
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_23" class="md-nav__link">
    <span class="md-ellipsis">
      è‡ªå®šä¹‰åŸŸå
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ingress_2" class="md-nav__link">
    <span class="md-ellipsis">
      ä¸ç°æœ‰ ingress æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ä¸ç°æœ‰ ingress æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#nginx-ingress" class="md-nav__link">
    <span class="md-ellipsis">
      nginx ingress æ§åˆ¶å™¨å®‰è£…
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#swarm" class="md-nav__link">
    <span class="md-ellipsis">
      Swarm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Swarm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#swarm_1" class="md-nav__link">
    <span class="md-ellipsis">
      Swarm æœåŠ¡
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#namespaces_2" class="md-nav__link">
    <span class="md-ellipsis">
      å‘½åç©ºé—´
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microsoft-azure" class="md-nav__link">
    <span class="md-ellipsis">
      Microsoft Azure
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å¿«é€Ÿå…¥é—¨æŒ‡å—
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    åŠŸèƒ½
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    é«˜çº§ç”¨æ³•
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web ç•Œé¢
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å‡çº§
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    æ•…éšœæ’é™¤
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    æ’ä»¶
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../professional-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    ä¸“ä¸šæœåŠ¡
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    å…³äº
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="_1">é›†æˆ</h1>
<h2 id="bunkerweb">BunkerWeb äº‘</h2>
<figure>
<p><img align="center," alt="æ¦‚è¿°" src="../../assets/img/bunkerweb-cloud.webp" width="600" />
  </p>
<figcaption>BunkerWeb äº‘</figcaption>
</figure>
<p>BunkerWeb Cloud å°†æ˜¯å¼€å§‹ä½¿ç”¨ BunkerWeb çš„æœ€ç®€å•æ–¹å¼ã€‚å®ƒä¸ºæ‚¨æä¾›ä¸€ä¸ªå®Œå…¨æ‰˜ç®¡çš„ BunkerWeb æœåŠ¡ï¼Œæ— éœ€ä»»ä½•éº»çƒ¦ã€‚å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª BunkerWeb å³æœåŠ¡ï¼</p>
<p>è¯•è¯•æˆ‘ä»¬çš„ <a href="https://panel.bunkerweb.io/store/bunkerweb-cloud?utm_campaign=self&amp;utm_source=doc">BunkerWeb Cloud æœåŠ¡</a>ï¼Œæ‚¨å°†è·å¾—ï¼š</p>
<ul>
<li>ä¸€ä¸ªå®Œå…¨æ‰˜ç®¡åœ¨æˆ‘ä»¬äº‘ç«¯çš„ BunkerWeb å®ä¾‹</li>
<li>æ‰€æœ‰ BunkerWeb åŠŸèƒ½ï¼ŒåŒ…æ‹¬ PRO åŠŸèƒ½</li>
<li>ä¸€ä¸ªå¸¦æœ‰ä»ªè¡¨æ¿å’Œè­¦æŠ¥çš„ç›‘æ§å¹³å°</li>
<li>ååŠ©æ‚¨è¿›è¡Œé…ç½®çš„æŠ€æœ¯æ”¯æŒ</li>
</ul>
<p>å¦‚æœæ‚¨å¯¹ BunkerWeb Cloud æœåŠ¡æ„Ÿå…´è¶£ï¼Œè¯·éšæ—¶<a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">è”ç³»æˆ‘ä»¬</a>ï¼Œä»¥ä¾¿æˆ‘ä»¬è®¨è®ºæ‚¨çš„éœ€æ±‚ã€‚</p>
<h2 id="all-in-one-aio-image">ä¸€ä½“åŒ– (AIO) é•œåƒ</h2>
<figure>
<p><img align="center," alt="AIO æ¶æ„å›¾å ä½ç¬¦" src="../../assets/img/aio-graph-placeholder.png" width="600" />
  </p>
<figcaption>BunkerWeb ä¸€ä½“åŒ–æ¶æ„ (AIO)</figcaption>
</figure>
<h3 id="deployment">éƒ¨ç½²</h3>
<p>è¦éƒ¨ç½²ä¸€ä½“åŒ–å®¹å™¨ï¼Œæ‚¨åªéœ€è¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå®¹å™¨æš´éœ²ï¼š</p>
<ul>
<li>8080/tcp ç”¨äº HTTP</li>
<li>8443/tcp ç”¨äº HTTPS</li>
<li>8443/udp ç”¨äº QUIC</li>
<li>7000/tcp ç”¨äºåœ¨æ²¡æœ‰ BunkerWeb å‰ç½®çš„æƒ…å†µä¸‹çš„ Web UI è®¿é—®ï¼ˆä¸å»ºè®®åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨ï¼‰</li>
<li>å½“ <code>SERVICE_API=yes</code> æ—¶ï¼Œ8888/tcp ç”¨äº APIï¼ˆå†…éƒ¨ä½¿ç”¨ï¼›å»ºè®®é€šè¿‡ BunkerWeb ä½œä¸ºåå‘ä»£ç†æš´éœ²ï¼Œè€Œä¸æ˜¯ç›´æ¥å‘å¸ƒï¼‰</li>
</ul>
<p>éœ€è¦ä¸€ä¸ªå‘½åå·ï¼ˆæˆ–ç»‘å®šæŒ‚è½½ï¼‰æ¥æŒä¹…åŒ–å®¹å™¨å†… <code>/data</code> ç›®å½•ä¸‹çš„ SQLite æ•°æ®åº“ã€ç¼“å­˜å’Œå¤‡ä»½ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb-aio</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-all-in-one:testing</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">ä½¿ç”¨æœ¬åœ°æ–‡ä»¶å¤¹å­˜å‚¨æŒä¹…åŒ–æ•°æ®</p>
<p>ä¸€ä½“åŒ–å®¹å™¨ä»¥å†…ç½®çš„ <strong>éç‰¹æƒç”¨æˆ·ï¼ˆUID 101ã€GID 101ï¼‰</strong> è¿è¡Œå„é¡¹æœåŠ¡ã€‚è¿™èƒ½å¤Ÿæå‡å®‰å…¨æ€§ï¼šå³ä¾¿ç»„ä»¶è¢«æ”»ç ´ï¼Œä¹Ÿæ— æ³•åœ¨å®¿ä¸»æœºä¸Šè·å¾— root æƒé™ï¼ˆUID/GID 0ï¼‰ã€‚</p>
<p>å¦‚æœæŒ‚è½½äº†ä¸€ä¸ª<strong>æœ¬åœ°æ–‡ä»¶å¤¹</strong>ï¼Œè¯·ç¡®ä¿ç›®å½•æƒé™å…è®¸è¯¥éç‰¹æƒç”¨æˆ·å†™å…¥ï¼š</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>å¦‚æœç›®å½•å·²å­˜åœ¨ï¼Œå¯ä»¥æ‰§è¡Œï¼š</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>åœ¨ä½¿ç”¨ <a href="https://docs.docker.com/engine/security/rootless">Docker æ— æ ¹æ¨¡å¼</a> æˆ– <a href="https://podman.io/">Podman</a> æ—¶ï¼Œå®¹å™¨å†…çš„ UID/GID ä¼šè¢«é‡æ–°æ˜ å°„ã€‚è¯·å…ˆæ£€æŸ¥è‡ªå·±çš„ <code>subuid</code> ä¸ <code>subgid</code> èŒƒå›´ï¼š</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>ä¾‹å¦‚ï¼Œå¦‚æœèµ·å§‹å€¼æ˜¯ <strong>100000</strong>ï¼Œå¯¹åº”çš„æ˜ å°„ UID/GID å°†æ˜¯ <strong>100100</strong>ï¼ˆ100000 + 100ï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>æˆ–è€…ï¼Œå¦‚æœç›®å½•å·²å­˜åœ¨ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
</div>
<p>ä¸€ä½“åŒ–é•œåƒå†…ç½®äº†å‡ ä¸ªæœåŠ¡ï¼Œå¯ä»¥é€šè¿‡ç¯å¢ƒå˜é‡æ¥æ§åˆ¶ï¼š</p>
<ul>
<li><code>SERVICE_UI=yes</code> (é»˜è®¤) - å¯ç”¨ Web UI æœåŠ¡</li>
<li><code>SERVICE_SCHEDULER=yes</code> (é»˜è®¤) - å¯ç”¨è°ƒåº¦å™¨æœåŠ¡</li>
<li><code>SERVICE_API=no</code> (é»˜è®¤) - å¯ç”¨ API æœåŠ¡ (FastAPI æ§åˆ¶å¹³é¢)</li>
<li><code>AUTOCONF_MODE=no</code> (é»˜è®¤) - å¯ç”¨è‡ªåŠ¨é…ç½®æœåŠ¡</li>
<li><code>USE_REDIS=yes</code> (é»˜è®¤) - å¯ç”¨å†…ç½®çš„ <a href="#redis-integration">Redis</a> å®ä¾‹</li>
<li><code>USE_CROWDSEC=no</code> (é»˜è®¤) - <a href="#crowdsec-integration">CrowdSec</a> é›†æˆé»˜è®¤ç¦ç”¨</li>
<li><code>HIDE_SERVICE_LOGS=</code>ï¼ˆå¯é€‰ï¼‰- ä»¥é€—å·åˆ†éš”çš„æœåŠ¡åˆ—è¡¨ï¼Œç”¨äºåœ¨å®¹å™¨æ—¥å¿—ä¸­é™éŸ³è¿™äº›æœåŠ¡ã€‚æ”¯æŒçš„å€¼ï¼š<code>api</code>ã€<code>autoconf</code>ã€<code>bunkerweb</code>ã€<code>crowdsec</code>ã€<code>redis</code>ã€<code>scheduler</code>ã€<code>ui</code>ã€<code>nginx.access</code>ã€<code>nginx.error</code>ã€<code>modsec</code>ã€‚æ—¥å¿—ä»ä¼šå†™å…¥ <code>/var/log/bunkerweb/&lt;service&gt;.log</code>ã€‚</li>
</ul>
<h3 id="api">API é›†æˆ</h3>
<p>ä¸€ä½“åŒ–é•œåƒå†…åµŒäº† BunkerWeb APIã€‚å®ƒé»˜è®¤æ˜¯ç¦ç”¨çš„ï¼Œå¯ä»¥é€šè¿‡è®¾ç½® <code>SERVICE_API=yes</code> æ¥å¯ç”¨ã€‚</p>
<div class="admonition warning">
<p class="admonition-title">å®‰å…¨</p>
<p>API æ˜¯ä¸€ä¸ªç‰¹æƒæ§åˆ¶å¹³é¢ã€‚ä¸è¦ç›´æ¥å°†å…¶æš´éœ²åœ¨äº’è”ç½‘ä¸Šã€‚è¯·å°†å…¶ä¿ç•™åœ¨å†…éƒ¨ç½‘ç»œä¸Šï¼Œä½¿ç”¨ <code>API_WHITELIST_IPS</code> é™åˆ¶æº IPï¼Œè¦æ±‚èº«ä»½éªŒè¯ï¼ˆ<code>API_TOKEN</code> æˆ– API ç”¨æˆ· + Biscuitï¼‰ï¼Œå¹¶æœ€å¥½é€šè¿‡ BunkerWeb ä½œä¸ºåå‘ä»£ç†åœ¨ä¸€ä¸ªéš¾ä»¥çŒœæµ‹çš„è·¯å¾„ä¸Šè®¿é—®å®ƒã€‚</p>
</div>
<p>å¿«é€Ÿå¯ç”¨ï¼ˆç‹¬ç«‹ï¼‰â€” å‘å¸ƒ API ç«¯å£ï¼›ä»…ç”¨äºæµ‹è¯•ï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">SERVICE_API</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">API_WHITELIST_IPS</span><span class="o">=</span><span class="s2">&quot;127.0.0.0/8&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">API_USERNAME</span><span class="o">=</span>changeme<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">API_PASSWORD</span><span class="o">=</span>StrongP@ssw0rd<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">8888</span>:8888/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>æ¨èï¼ˆåœ¨ BunkerWeb ä¹‹åï¼‰â€” ä¸è¦å‘å¸ƒ <code>8888</code>ï¼›è€Œæ˜¯åå‘ä»£ç†å®ƒï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb-aio</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-all-in-one:testing</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-aio</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;api.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">api.example.com_USE_TEMPLATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-api&quot;</span>
<span class="w">      </span><span class="nt">api.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">api.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api-&lt;unguessable&gt;&quot;</span>
<span class="w">      </span><span class="nt">api.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://127.0.0.1:8888&quot;</span><span class="w"> </span><span class="c1"># å†…éƒ¨ API ç«¯ç‚¹</span>

<span class="w">      </span><span class="c1"># API è®¾ç½®</span>
<span class="w">      </span><span class="nt">SERVICE_API</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="c1"># è®¾ç½®å¼ºå£®çš„å‡­æ®å¹¶ä¸”åªå…è®¸å¯ä¿¡çš„ IP/ç½‘ç»œï¼ˆè¯¦è§ä¸‹æ–‡ï¼‰</span>
<span class="w">      </span><span class="nt">API_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">API_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;StrongP@ssw0rd&quot;</span>
<span class="w">      </span><span class="nt">API_ROOT_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api-&lt;unguessable&gt;&quot;</span><span class="w"> </span><span class="c1"># éœ€ä¸ REVERSE_PROXY_URL ä¿æŒä¸€è‡´</span>

<span class="w">      </span><span class="c1"># é»˜è®¤åœç”¨ UIï¼›æ”¹ä¸º &quot;yes&quot; å¯å¯ç”¨</span>
<span class="w">      </span><span class="nt">SERVICE_UI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
</code></pre></div>
<p>æœ‰å…³èº«ä»½éªŒè¯ã€æƒé™ (ACL)ã€é€Ÿç‡é™åˆ¶ã€TLS å’Œé…ç½®é€‰é¡¹çš„è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜… <a href="../api/">API æ–‡æ¡£</a>ã€‚</p>
<h3 id="_2">è®¿é—®è®¾ç½®å‘å¯¼</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œå½“æ‚¨é¦–æ¬¡è¿è¡Œ AIO å®¹å™¨æ—¶ï¼Œè®¾ç½®å‘å¯¼ä¼šè‡ªåŠ¨å¯åŠ¨ã€‚è¦è®¿é—®å®ƒï¼Œè¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>
<ol>
<li><strong>å¯åŠ¨ AIO å®¹å™¨</strong>ï¼Œå¦‚<a href="#deployment">ä¸Šæ–‡</a>æ‰€è¿°ï¼Œç¡®ä¿ <code>SERVICE_UI=yes</code> (é»˜è®¤)ã€‚</li>
<li>é€šè¿‡æ‚¨çš„ä¸»è¦ BunkerWeb ç«¯ç‚¹<strong>è®¿é—® UI</strong>ï¼Œä¾‹å¦‚ <code>https://your-domain</code>ã€‚</li>
</ol>
<blockquote>
<p>è¯·æŒ‰ç…§<a href="../quickstart-guide/#complete-the-setup-wizard">å¿«é€Ÿå…¥é—¨æŒ‡å—</a>ä¸­çš„åç»­æ­¥éª¤è®¾ç½® Web UIã€‚</p>
</blockquote>
<h3 id="redis-integration">Redis é›†æˆ</h3>
<p>BunkerWeb <strong>ä¸€ä½“åŒ–</strong>é•œåƒå¼€ç®±å³ç”¨åœ°åŒ…å«äº† Redisï¼Œç”¨äº<a href="../advanced/#persistence-of-bans-and-reports">æŒä¹…åŒ–å°ç¦å’ŒæŠ¥å‘Š</a>ã€‚è¯·æ³¨æ„ï¼š</p>
<ul>
<li>åªæœ‰åœ¨ <code>USE_REDIS=yes</code> <strong>ä¸”</strong> <code>REDIS_HOST</code> ä¿æŒé»˜è®¤å€¼ (<code>127.0.0.1</code>/<code>localhost</code>) æ—¶ï¼Œå†…ç½® Redis æœåŠ¡æ‰ä¼šå¯åŠ¨ã€‚</li>
<li>å®ƒä»…ç›‘å¬å®¹å™¨çš„å›ç¯æ¥å£ï¼Œå› æ­¤åªèƒ½è¢«å®¹å™¨å†…éƒ¨çš„è¿›ç¨‹è®¿é—®ï¼Œå…¶ä»–å®¹å™¨æˆ–å®¿ä¸»æœºæ— æ³•ç›´æ¥è®¿é—®ã€‚</li>
<li>ä»…å½“ä½ å·²ç»å‡†å¤‡å¥½å¤–éƒ¨ Redis/Valkey ç»ˆç«¯æ—¶æ‰è¦†ç›– <code>REDIS_HOST</code>ï¼Œå¦åˆ™å†…ç½®å®ä¾‹å°†ä¸ä¼šå¯åŠ¨ã€‚</li>
<li>è‹¥è¦å®Œå…¨ç¦ç”¨ Redisï¼Œè¯·è®¾ç½® <code>USE_REDIS=no</code>ã€‚</li>
<li>Redis æ—¥å¿—åœ¨ Docker æ—¥å¿—å’Œ <code>/var/log/bunkerweb/redis.log</code> ä¸­ä»¥ <code>[REDIS]</code> å‰ç¼€å‡ºç°ã€‚</li>
</ul>
<h3 id="crowdsec-integration">CrowdSec é›†æˆ</h3>
<p>BunkerWeb <strong>ä¸€ä½“åŒ–</strong> Docker é•œåƒå®Œå…¨é›†æˆäº† CrowdSecâ€”â€”æ— éœ€é¢å¤–çš„å®¹å™¨æˆ–æ‰‹åŠ¨è®¾ç½®ã€‚è¯·æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤åœ¨æ‚¨çš„éƒ¨ç½²ä¸­å¯ç”¨ã€é…ç½®å’Œæ‰©å±• CrowdSecã€‚</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒCrowdSec æ˜¯<strong>ç¦ç”¨</strong>çš„ã€‚è¦å¼€å¯å®ƒï¼Œåªéœ€æ·»åŠ  <code>USE_CROWDSEC</code> ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<ul>
<li>
<p>å½“ <code>USE_CROWDSEC=yes</code> æ—¶ï¼Œå…¥å£ç‚¹å°†ï¼š</p>
<ol>
<li><strong>æ³¨å†Œ</strong>å¹¶<strong>å¯åŠ¨</strong>æœ¬åœ° CrowdSec ä»£ç†ï¼ˆé€šè¿‡ <code>cscli</code>ï¼‰ã€‚</li>
<li><strong>å®‰è£…æˆ–å‡çº§</strong>é»˜è®¤çš„é›†åˆå’Œè§£æå™¨ã€‚</li>
<li><strong>é…ç½®</strong> <code>crowdsec-bunkerweb-bouncer/v1.6</code> æ‹¦æˆªå™¨ã€‚</li>
</ol>
</li>
</ul>
<hr />
<h4 id="_3">é»˜è®¤é›†åˆå’Œè§£æå™¨</h4>
<p>åœ¨é¦–æ¬¡å¯åŠ¨æ—¶ï¼ˆæˆ–å‡çº§åï¼‰ï¼Œè¿™äº›èµ„äº§ä¼šè‡ªåŠ¨å®‰è£…å¹¶ä¿æŒæœ€æ–°ï¼š</p>
<table>
<thead>
<tr>
<th>ç±»å‹</th>
<th>åç§°</th>
<th>ç›®çš„</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>é›†åˆ</strong></td>
<td><code>bunkerity/bunkerweb</code></td>
<td>ä¿æŠ¤ Nginx æœåŠ¡å™¨å…å—å„ç§åŸºäº HTTP çš„æ”»å‡»ï¼Œä»æš´åŠ›ç ´è§£åˆ°æ³¨å…¥å°è¯•ã€‚</td>
</tr>
<tr>
<td><strong>é›†åˆ</strong></td>
<td><code>crowdsecurity/appsec-virtual-patching</code></td>
<td>æä¾›ä¸€ä¸ªåŠ¨æ€æ›´æ–°çš„ WAF é£æ ¼è§„åˆ™é›†ï¼Œé’ˆå¯¹å·²çŸ¥çš„ CVEï¼Œæ¯æ—¥è‡ªåŠ¨ä¿®è¡¥ä»¥ä¿æŠ¤ Web åº”ç”¨ç¨‹åºå…å—æ–°å‘ç°çš„æ¼æ´å½±å“ã€‚</td>
</tr>
<tr>
<td><strong>é›†åˆ</strong></td>
<td><code>crowdsecurity/appsec-generic-rules</code></td>
<td>å¯¹ <code>crowdsecurity/appsec-virtual-patching</code> è¿›è¡Œè¡¥å……ï¼Œæä¾›é’ˆå¯¹é€šç”¨åº”ç”¨å±‚æ”»å‡»æ¨¡å¼çš„å¯å‘å¼è§„åˆ™â€”â€”ä¾‹å¦‚æšä¸¾ã€è·¯å¾„éå†å’Œè‡ªåŠ¨åŒ–æ¢æµ‹â€”â€”å¡«è¡¥äº†å°šæ—  CVE ç‰¹å®šè§„åˆ™çš„ç©ºç™½ã€‚</td>
</tr>
<tr>
<td><strong>è§£æå™¨</strong></td>
<td><code>crowdsecurity/geoip-enrich</code></td>
<td>ç”¨ GeoIP ä¸Šä¸‹æ–‡ä¸°å¯Œäº‹ä»¶</td>
</tr>
</tbody>
</table>
<details>
<summary><strong>å†…éƒ¨å·¥ä½œåŸç†</strong></summary>

å…¥å£ç‚¹è„šæœ¬è°ƒç”¨ï¼š

<div class="highlight"><pre><span></span><code>cscli<span class="w"> </span>hub<span class="w"> </span>update
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>bunkerity/bunkerweb
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-virtual-patching
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-generic-rules
cscli<span class="w"> </span>install<span class="w"> </span>parser<span class="w">     </span>crowdsecurity/geoip-enrich
</code></pre></div>

</details>

<div class="admonition info">
<p class="admonition-title">Docker ä¸­çœ‹ä¸åˆ°é›†åˆï¼Ÿ</p>
<p>å¦‚æœåœ¨å®¹å™¨å†…æ‰§è¡Œ <code>cscli collections list</code> ä»ç„¶çœ‹ä¸åˆ° <code>bunkerity/bunkerweb</code>ï¼Œè¯·è¿è¡Œ <code>docker exec -it bunkerweb-aio cscli hub update</code>ï¼Œç„¶åé‡å¯å®¹å™¨ï¼ˆ<code>docker restart bunkerweb-aio</code>ï¼‰ï¼Œä»¥åˆ·æ–°æœ¬åœ° hub ç¼“å­˜ã€‚</p>
</div>
<hr />
<h4 id="_4">æ·»åŠ é¢å¤–çš„é›†åˆ</h4>
<p>éœ€è¦æ›´å¤šçš„è¦†ç›–èŒƒå›´ï¼Ÿä½¿ç”¨ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„ Hub é›†åˆåˆ—è¡¨æ¥å®šä¹‰ <code>CROWDSEC_EXTRA_COLLECTIONS</code>ï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_EXTRA_COLLECTIONS</span><span class="o">=</span><span class="s2">&quot;crowdsecurity/apache2 crowdsecurity/mysql&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">å†…éƒ¨å·¥ä½œåŸç†</p>
<p>è„šæœ¬ä¼šéå†æ¯ä¸ªåç§°å¹¶æ ¹æ®éœ€è¦è¿›è¡Œå®‰è£…æˆ–å‡çº§â€”â€”æ— éœ€æ‰‹åŠ¨æ­¥éª¤ã€‚</p>
</div>
<hr />
<h4 id="_5">ç¦ç”¨ç‰¹å®šè§£æå™¨</h4>
<p>å¦‚æœæ‚¨æƒ³ä¿ç•™é»˜è®¤è®¾ç½®ä½†æ˜ç¡®ç¦ç”¨ä¸€ä¸ªæˆ–å¤šä¸ªè§£æå™¨ï¼Œè¯·é€šè¿‡ <code>CROWDSEC_DISABLED_PARSERS</code> æä¾›ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„åˆ—è¡¨ï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_DISABLED_PARSERS</span><span class="o">=</span><span class="s2">&quot;crowdsecurity/geoip-enrich foo/bar-parser&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<p>æ³¨æ„ï¼š
- è¯¥åˆ—è¡¨åœ¨å®‰è£…/æ›´æ–°æ‰€éœ€é¡¹ç›®ååº”ç”¨ï¼›åªæœ‰æ‚¨åˆ—å‡ºçš„è§£æå™¨ä¼šè¢«ç§»é™¤ã€‚
- ä½¿ç”¨ <code>cscli parsers list</code> æ˜¾ç¤ºçš„ hub slugï¼ˆä¾‹å¦‚ï¼Œ<code>crowdsecurity/geoip-enrich</code>ï¼‰ã€‚</p>
<hr />
<h4 id="appsec">AppSec å¼€å…³</h4>
<p>CrowdSec <a href="https://docs.crowdsec.net/docs/appsec/intro/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">AppSec</a> åŠŸèƒ½â€”â€”ç”± <code>appsec-virtual-patching</code> å’Œ <code>appsec-generic-rules</code> é›†åˆæä¾›æ”¯æŒâ€”â€”<strong>é»˜è®¤å¯ç”¨</strong>ã€‚</p>
<p>è¦<strong>ç¦ç”¨</strong>æ‰€æœ‰ AppSec (WAF/è™šæ‹Ÿè¡¥ä¸) åŠŸèƒ½ï¼Œè¯·è®¾ç½®ï¼š</p>
<div class="highlight"><pre><span></span><code>-e<span class="w"> </span><span class="nv">CROWDSEC_APPSEC_URL</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</code></pre></div>
<p>è¿™å®é™…ä¸Šä¼šå…³é—­ AppSec ç«¯ç‚¹ï¼Œå› æ­¤ä¸ä¼šåº”ç”¨ä»»ä½•è§„åˆ™ã€‚</p>
<hr />
<h4 id="crowdsec-api">å¤–éƒ¨ CrowdSec API</h4>
<p>å¦‚æœæ‚¨æ“ä½œä¸€ä¸ªè¿œç¨‹ CrowdSec å®ä¾‹ï¼Œè¯·å°†å®¹å™¨æŒ‡å‘æ‚¨çš„ APIï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_API</span><span class="o">=</span><span class="s2">&quot;https://crowdsec.example.com:8000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:testing
</code></pre></div>
<ul>
<li>å½“ <code>CROWDSEC_API</code> ä¸æ˜¯ <code>127.0.0.1</code> æˆ– <code>localhost</code> æ—¶ï¼Œå°†è·³è¿‡<strong>æœ¬åœ°æ³¨å†Œ</strong>ã€‚</li>
<li>ä½¿ç”¨å¤–éƒ¨ API æ—¶ï¼Œ<strong>AppSec</strong> é»˜è®¤æ˜¯ç¦ç”¨çš„ã€‚è¦å¯ç”¨å®ƒï¼Œè¯·å°† <code>CROWDSEC_APPSEC_URL</code> è®¾ç½®ä¸ºæ‚¨æœŸæœ›çš„ç«¯ç‚¹ã€‚</li>
<li>æ‹¦æˆªå™¨æ³¨å†Œä»ç„¶ä¼šé’ˆå¯¹è¿œç¨‹ API è¿›è¡Œã€‚</li>
<li>è¦é‡ç”¨ç°æœ‰çš„æ‹¦æˆªå™¨å¯†é’¥ï¼Œè¯·æä¾› <code>CROWDSEC_API_KEY</code> å¹¶é™„ä¸Šæ‚¨é¢„å…ˆç”Ÿæˆçš„ä»¤ç‰Œã€‚</li>
</ul>
<hr />
<div class="admonition tip">
<p class="admonition-title">æ›´å¤šé€‰é¡¹</p>
<p>æœ‰å…³æ‰€æœ‰ CrowdSec é€‰é¡¹çš„å…¨é¢ä»‹ç»ï¼ˆè‡ªå®šä¹‰åœºæ™¯ã€æ—¥å¿—ã€æ•…éšœæ’é™¤ç­‰ï¼‰ï¼Œè¯·å‚é˜… <a href="../features/#crowdsec">BunkerWeb CrowdSec æ’ä»¶æ–‡æ¡£</a>æˆ–è®¿é—®<a href="https://www.crowdsec.net/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">å®˜æ–¹ CrowdSec ç½‘ç«™</a>ã€‚</p>
</div>
<h2 id="docker">Docker</h2>
<figure>
<p><img align="center," alt="æ¦‚è¿°" src="../../assets/img/integration-docker.svg" width="600" />
  </p>
<figcaption>Docker é›†æˆ</figcaption>
</figure>
<p>ä½¿ç”¨ BunkerWeb ä½œä¸º <a href="https://www.docker.com/">Docker</a> å®¹å™¨æä¾›äº†ä¸€ç§æ–¹ä¾¿ç›´æ¥çš„æ–¹æ³•æ¥æµ‹è¯•å’Œä½¿ç”¨è¯¥è§£å†³æ–¹æ¡ˆï¼Œç‰¹åˆ«æ˜¯å¦‚æœæ‚¨å·²ç»ç†Ÿæ‚‰ Docker æŠ€æœ¯ã€‚</p>
<p>ä¸ºäº†æ–¹ä¾¿æ‚¨çš„ Docker éƒ¨ç½²ï¼Œæˆ‘ä»¬åœ¨ <a href="https://hub.docker.com/r/bunkerity/bunkerweb">Docker Hub</a> ä¸Šæä¾›äº†æ”¯æŒå¤šç§æ¶æ„çš„é¢„æ„å»ºé•œåƒã€‚è¿™äº›é¢„æ„å»ºé•œåƒç»è¿‡ä¼˜åŒ–ï¼Œå¯ç”¨äºä»¥ä¸‹æ¶æ„ï¼š</p>
<ul>
<li>x64 (64ä½)</li>
<li>x86</li>
<li>armv8 (ARM 64ä½)</li>
<li>armv7 (ARM 32ä½)</li>
</ul>
<p>é€šè¿‡ä» Docker Hub è·å–è¿™äº›é¢„æ„å»ºé•œåƒï¼Œæ‚¨å¯ä»¥å¿«é€Ÿåœ¨æ‚¨çš„ Docker ç¯å¢ƒä¸­æ‹‰å–å¹¶è¿è¡Œ BunkerWebï¼Œæ— éœ€è¿›è¡Œå¹¿æ³›çš„é…ç½®æˆ–è®¾ç½®è¿‡ç¨‹ã€‚è¿™ç§ç®€åŒ–çš„æ–¹æ³•è®©æ‚¨èƒ½å¤Ÿä¸“æ³¨äºåˆ©ç”¨ BunkerWeb çš„åŠŸèƒ½ï¼Œè€Œæ— éœ€ä¸å¿…è¦çš„å¤æ‚æ€§ã€‚</p>
<p>æ— è®ºæ‚¨æ˜¯è¿›è¡Œæµ‹è¯•ã€å¼€å‘åº”ç”¨ç¨‹åºè¿˜æ˜¯åœ¨ç”Ÿäº§ä¸­éƒ¨ç½² BunkerWebï¼ŒDocker å®¹å™¨åŒ–é€‰é¡¹éƒ½æä¾›äº†çµæ´»æ€§å’Œæ˜“ç”¨æ€§ã€‚é‡‡ç”¨è¿™ç§æ–¹æ³•ä½¿æ‚¨èƒ½å¤Ÿå……åˆ†åˆ©ç”¨ BunkerWeb çš„åŠŸèƒ½ï¼ŒåŒæ—¶åˆ©ç”¨ Docker æŠ€æœ¯çš„ä¼˜åŠ¿ã€‚</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb:testing
</code></pre></div>
<p>Docker é•œåƒä¹Ÿå¯åœ¨ <a href="https://github.com/orgs/bunkerity/packages?repo_name=bunkerweb">GitHub packages</a> ä¸Šæ‰¾åˆ°ï¼Œå¯ä»¥ä½¿ç”¨ <code>ghcr.io</code> ä»“åº“åœ°å€ä¸‹è½½ï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/bunkerity/bunkerweb:testing
</code></pre></div>
<p>Docker é›†æˆçš„å…³é”®æ¦‚å¿µåŒ…æ‹¬ï¼š</p>
<ul>
<li><strong>ç¯å¢ƒå˜é‡</strong>ï¼šä½¿ç”¨ç¯å¢ƒå˜é‡è½»æ¾é…ç½® BunkerWebã€‚è¿™äº›å˜é‡å…è®¸æ‚¨è‡ªå®šä¹‰ BunkerWeb è¡Œä¸ºçš„å„ä¸ªæ–¹é¢ï¼Œä¾‹å¦‚ç½‘ç»œè®¾ç½®ã€å®‰å…¨é€‰é¡¹å’Œå…¶ä»–å‚æ•°ã€‚</li>
<li><strong>è°ƒåº¦å™¨å®¹å™¨</strong>ï¼šä½¿ç”¨ä¸€ä¸ªåä¸º<a href="../concepts/#scheduler">è°ƒåº¦å™¨</a>çš„ä¸“ç”¨å®¹å™¨æ¥ç®¡ç†é…ç½®å’Œæ‰§è¡Œä½œä¸šã€‚</li>
<li><strong>ç½‘ç»œ</strong>ï¼šDocker ç½‘ç»œåœ¨ BunkerWeb çš„é›†æˆä¸­æ‰®æ¼”ç€è‡³å…³é‡è¦çš„è§’è‰²ã€‚è¿™äº›ç½‘ç»œæœ‰ä¸¤ä¸ªä¸»è¦ç›®çš„ï¼šå‘å®¢æˆ·ç«¯å…¬å¼€ç«¯å£ä»¥åŠè¿æ¥åˆ°ä¸Šæ¸¸ Web æœåŠ¡ã€‚é€šè¿‡å…¬å¼€ç«¯å£ï¼ŒBunkerWeb å¯ä»¥æ¥å—æ¥è‡ªå®¢æˆ·ç«¯çš„ä¼ å…¥è¯·æ±‚ï¼Œå…è®¸ä»–ä»¬è®¿é—®å—ä¿æŠ¤çš„ Web æœåŠ¡ã€‚æ­¤å¤–ï¼Œé€šè¿‡è¿æ¥åˆ°ä¸Šæ¸¸ Web æœåŠ¡ï¼ŒBunkerWeb å¯ä»¥é«˜æ•ˆåœ°è·¯ç”±å’Œç®¡ç†æµé‡ï¼Œæä¾›å¢å¼ºçš„å®‰å…¨æ€§å’Œæ€§èƒ½ã€‚</li>
</ul>
<div class="admonition info">
<p class="admonition-title">æ•°æ®åº“åç«¯</p>
<p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„è¯´æ˜å‡è®¾æ‚¨æ­£åœ¨ä½¿ç”¨ SQLite ä½œä¸ºé»˜è®¤çš„æ•°æ®åº“åç«¯ï¼Œè¿™æ˜¯ç”± <code>DATABASE_URI</code> è®¾ç½®é…ç½®çš„ã€‚ä½†æ˜¯ï¼Œä¹Ÿæ”¯æŒå…¶ä»–æ•°æ®åº“åç«¯ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä»“åº“çš„ <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">misc/integrations æ–‡ä»¶å¤¹</a>ä¸­çš„ docker-compose æ–‡ä»¶ã€‚</p>
</div>
<h3 id="_6">ç¯å¢ƒå˜é‡</h3>
<p>è®¾ç½®é€šè¿‡ Docker ç¯å¢ƒå˜é‡ä¼ é€’ç»™è°ƒåº¦å™¨ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MY_SETTING=value</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ANOTHER_SETTING=another value</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># ç”¨äºæŒä¹…åŒ–ç¼“å­˜å’Œå¤‡ä»½ç­‰å…¶ä»–æ•°æ®</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">å®Œæ•´åˆ—è¡¨</p>
<p>æœ‰å…³ç¯å¢ƒå˜é‡çš„å®Œæ•´åˆ—è¡¨ï¼Œè¯·å‚é˜…æ–‡æ¡£çš„<a href="../features/">è®¾ç½®éƒ¨åˆ†</a>ã€‚</p>
</div>
<h3 id="docker-secrets">ä½¿ç”¨ Docker secrets</h3>
<p>ä¸å…¶é€šè¿‡ç¯å¢ƒå˜é‡ä¼ é€’æ•æ„Ÿè®¾ç½®ï¼Œä¸å¦‚å°†å®ƒä»¬å­˜å‚¨ä¸º Docker secretsã€‚å¯¹äºæ¯ä¸ªæ‚¨æƒ³è¦ä¿æŠ¤çš„è®¾ç½®ï¼Œåˆ›å»ºä¸€ä¸ªåç§°ä¸è®¾ç½®é”®ï¼ˆå¤§å†™ï¼‰åŒ¹é…çš„ Docker secretã€‚BunkerWeb çš„å…¥å£ç‚¹è„šæœ¬ä¼šè‡ªåŠ¨ä» <code>/run/secrets</code> åŠ è½½ secrets å¹¶å°†å®ƒä»¬å¯¼å‡ºä¸ºç¯å¢ƒå˜é‡ã€‚</p>
<p>ç¤ºä¾‹ï¼š
<div class="highlight"><pre><span></span><code><span class="c1"># ä¸º ADMIN_PASSWORD åˆ›å»ºä¸€ä¸ª Docker secret</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;S3cr3tP@ssw0rd&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>ADMIN_PASSWORD<span class="w"> </span>-
</code></pre></div></p>
<p>éƒ¨ç½²æ—¶æŒ‚è½½ secretsï¼š
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ADMIN_PASSWORD</span>
<span class="nn">...</span>
<span class="nt">secrets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div></p>
<p>è¿™ç¡®ä¿äº†æ•æ„Ÿè®¾ç½®ä¸ä¼šå‡ºç°åœ¨ç¯å¢ƒå’Œæ—¥å¿—ä¸­ã€‚</p>
<h3 id="_7">è°ƒåº¦å™¨</h3>
<p><a href="../concepts/#scheduler">è°ƒåº¦å™¨</a> åœ¨å…¶è‡ªå·±çš„å®¹å™¨ä¸­è¿è¡Œï¼Œè¯¥å®¹å™¨ä¹Ÿå¯åœ¨ Docker Hub ä¸Šæ‰¾åˆ°ï¼š</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-scheduler:testing
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">BunkerWeb è®¾ç½®</p>
<p>è‡ª <code>1.6.0</code> ç‰ˆæœ¬èµ·ï¼Œè°ƒåº¦å™¨å®¹å™¨æ˜¯æ‚¨å®šä¹‰ BunkerWeb è®¾ç½®çš„åœ°æ–¹ã€‚ç„¶åï¼Œè°ƒåº¦å™¨å°†é…ç½®æ¨é€åˆ° BunkerWeb å®¹å™¨ã€‚</p>
<p>âš  <strong>é‡è¦æç¤º</strong>ï¼šæ‰€æœ‰ä¸ API ç›¸å…³çš„è®¾ç½®ï¼ˆä¾‹å¦‚ <code>API_HTTP_PORT</code>ã€<code>API_LISTEN_IP</code>ã€<code>API_SERVER_NAME</code>ã€<code>API_WHITELIST_IP</code>ï¼Œå¦‚æœæ‚¨ä½¿ç”¨ <code>API_TOKEN</code> çš„è¯ä¹ŸåŒ…æ‹¬å®ƒï¼‰<strong>ä¹Ÿå¿…é¡»åœ¨ BunkerWeb å®¹å™¨ä¸­å®šä¹‰</strong>ã€‚è¿™äº›è®¾ç½®å¿…é¡»åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­ä¿æŒä¸€è‡´ï¼›å¦åˆ™ï¼ŒBunkerWeb å®¹å™¨å°†ä¸æ¥å—æ¥è‡ªè°ƒåº¦å™¨çš„ API è¯·æ±‚ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé”šç‚¹æ¥é¿å…åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­é‡å¤ç›¸åŒçš„è®¾ç½®</span>
<span class="w">  </span><span class="nt">API_HTTP_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5000&quot;</span><span class="w"> </span><span class="c1"># é»˜è®¤å€¼</span>
<span class="w">  </span><span class="nt">API_LISTEN_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.0.0.0&quot;</span><span class="w"> </span><span class="c1"># é»˜è®¤å€¼</span>
<span class="w">  </span><span class="nt">API_SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bwapi&quot;</span><span class="w"> </span><span class="c1"># é»˜è®¤å€¼</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># æ ¹æ®æ‚¨çš„ç½‘ç»œè®¾ç½®æ¥é…ç½®</span>
<span class="w">  </span><span class="c1"># å¯é€‰çš„ä»¤ç‰Œï¼›å¦‚æœè®¾ç½®ï¼Œè°ƒåº¦å™¨ä¼šå‘é€ Authorization: Bearer &lt;token&gt;</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># è¿™å°†ä¸º BunkerWeb å®¹å™¨è®¾ç½® API</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># è¿™å°†ä¸ºè°ƒåº¦å™¨å®¹å™¨è®¾ç½® API</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># ç”¨äºæŒä¹…åŒ–ç¼“å­˜å’Œå¤‡ä»½ç­‰å…¶ä»–æ•°æ®</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<p>éœ€è¦ä¸€ä¸ªå·æ¥å­˜å‚¨è°ƒåº¦å™¨ä½¿ç”¨çš„ SQLite æ•°æ®åº“å’Œå¤‡ä»½ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">ä¸ºæŒä¹…åŒ–æ•°æ®ä½¿ç”¨æœ¬åœ°æ–‡ä»¶å¤¹</p>
<p>è°ƒåº¦å™¨åœ¨å®¹å™¨å†…ä»¥<strong>UID 101 å’Œ GID 101 çš„éç‰¹æƒç”¨æˆ·</strong>èº«ä»½è¿è¡Œã€‚è¿™å¢å¼ºäº†å®‰å…¨æ€§ï¼šä¸‡ä¸€æ¼æ´è¢«åˆ©ç”¨ï¼Œæ”»å‡»è€…å°†ä¸ä¼šæ‹¥æœ‰å®Œå…¨çš„ root (UID/GID 0) æƒé™ã€‚</p>
<p>ä½†æ˜¯ï¼Œå¦‚æœæ‚¨ä¸ºæŒä¹…åŒ–æ•°æ®ä½¿ç”¨<strong>æœ¬åœ°æ–‡ä»¶å¤¹</strong>ï¼Œæ‚¨å¿…é¡»<strong>è®¾ç½®æ­£ç¡®çš„æƒé™</strong>ï¼Œä»¥ä¾¿éç‰¹æƒç”¨æˆ·å¯ä»¥å‘å…¶ä¸­å†™å…¥æ•°æ®ã€‚ä¾‹å¦‚ï¼š</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>æˆ–è€…ï¼Œå¦‚æœæ–‡ä»¶å¤¹å·²ç»å­˜åœ¨ï¼š</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨<a href="https://docs.docker.com/engine/security/rootless">æ— æ ¹æ¨¡å¼çš„ Docker</a> æˆ– <a href="https://podman.io/">Podman</a>ï¼Œå®¹å™¨ä¸­çš„ UID å’Œ GID å°†æ˜ å°„åˆ°ä¸»æœºä¸Šä¸åŒçš„ UID å’Œ GIDã€‚æ‚¨é¦–å…ˆéœ€è¦æ£€æŸ¥æ‚¨çš„åˆå§‹ subuid å’Œ subgidï¼š</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„å€¼ä¸º <strong>100000</strong>ï¼Œåˆ™æ˜ å°„çš„ UID/GID å°†ä¸º <strong>100100</strong> (100000 + 100)ï¼š</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>æˆ–è€…å¦‚æœæ–‡ä»¶å¤¹å·²ç»å­˜åœ¨ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
</div>
<h3 id="_8">ç½‘ç»œ</h3>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒBunkerWeb å®¹å™¨åœ¨ï¼ˆå®¹å™¨å†…éƒ¨ï¼‰<strong>8080/tcp</strong> ç«¯å£ä¸Šç›‘å¬ <strong>HTTP</strong>ï¼Œåœ¨ <strong>8443/tcp</strong> ç«¯å£ä¸Šç›‘å¬ <strong>HTTPS</strong>ï¼Œåœ¨ <strong>8443/udp</strong> ç«¯å£ä¸Šç›‘å¬ <strong>QUIC</strong>ã€‚</p>
<div class="admonition warning">
<p class="admonition-title">åœ¨æ— æ ¹æ¨¡å¼æˆ–ä½¿ç”¨ Podman æ—¶çš„ç‰¹æƒç«¯å£</p>
<p>å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨<a href="https://docs.docker.com/engine/security/rootless">æ— æ ¹æ¨¡å¼çš„ Docker</a> å¹¶å¸Œæœ›å°†ç‰¹æƒç«¯å£ï¼ˆ&lt; 1024ï¼‰ï¼Œå¦‚ 80 å’Œ 443ï¼Œé‡å®šå‘åˆ° BunkerWebï¼Œè¯·å‚é˜…<a href="https://docs.docker.com/engine/security/rootless/#exposing-privileged-ports">æ­¤å¤„</a>çš„å…ˆå†³æ¡ä»¶ã€‚</p>
<p>å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ <a href="https://podman.io/">Podman</a>ï¼Œå¯ä»¥é™ä½éç‰¹æƒç«¯å£çš„æœ€å°æ•°é‡ï¼š
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>sysctl<span class="w"> </span>net.ipv4.ip_unprivileged_port_start<span class="o">=</span><span class="m">1</span>
</code></pre></div></p>
</div>
<p>ä½¿ç”¨ Docker é›†æˆæ—¶ï¼Œå…¸å‹çš„ BunkerWeb å †æ ˆåŒ…å«ä»¥ä¸‹å®¹å™¨ï¼š</p>
<ul>
<li>BunkerWeb</li>
<li>è°ƒåº¦å™¨</li>
<li>æ‚¨çš„æœåŠ¡</li>
</ul>
<p>å‡ºäºæ·±åº¦é˜²å¾¡çš„ç›®çš„ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®åˆ›å»ºè‡³å°‘ä¸‰ä¸ªä¸åŒçš„ Docker ç½‘ç»œï¼š</p>
<ul>
<li><code>bw-services</code>ï¼šç”¨äº BunkerWeb å’Œæ‚¨çš„ Web æœåŠ¡</li>
<li><code>bw-universe</code>ï¼šç”¨äº BunkerWeb å’Œè°ƒåº¦å™¨</li>
<li><code>bw-db</code>ï¼šç”¨äºæ•°æ®åº“ï¼ˆå¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨ï¼‰</li>
</ul>
<p>ä¸ºäº†ä¿æŠ¤è°ƒåº¦å™¨å’Œ BunkerWeb API ä¹‹é—´çš„é€šä¿¡ï¼Œ<strong>è¯·æˆæƒ API è°ƒç”¨</strong>ã€‚ä½¿ç”¨ <code>API_WHITELIST_IP</code> è®¾ç½®æ¥æŒ‡å®šå…è®¸çš„ IP åœ°å€å’Œå­ç½‘ã€‚ä¸ºäº†æ›´å¼ºçš„ä¿æŠ¤ï¼Œè¯·åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­è®¾ç½® <code>API_TOKEN</code>ï¼›è°ƒåº¦å™¨å°†è‡ªåŠ¨åŒ…å« <code>Authorization: Bearer &lt;token&gt;</code>ã€‚</p>
<p><strong>å¼ºçƒˆå»ºè®®ä¸º <code>bw-universe</code> ç½‘ç»œä½¿ç”¨é™æ€å­ç½‘</strong>ä»¥å¢å¼ºå®‰å…¨æ€§ã€‚é€šè¿‡å®æ–½è¿™äº›æªæ–½ï¼Œæ‚¨å¯ä»¥ç¡®ä¿åªæœ‰æˆæƒçš„æºæ‰èƒ½è®¿é—® BunkerWeb APIï¼Œä»è€Œé™ä½æœªç»æˆæƒçš„è®¿é—®æˆ–æ¶æ„æ´»åŠ¨çš„é£é™©ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé”šç‚¹æ¥é¿å…åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­é‡å¤ç›¸åŒçš„è®¾ç½®</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># å¯é€‰çš„ API ä»¤ç‰Œ</span>
<span class="w">  </span><span class="c1"># å¯é€‰çš„ API ä»¤ç‰Œï¼Œç”¨äºç»è¿‡èº«ä»½éªŒè¯çš„ API è®¿é—®</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># è¿™ä¸ªè®¾ç½®æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œç”¨æ¥æŒ‡å®š BunkerWeb å®ä¾‹</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># ç”¨äºæŒä¹…åŒ–ç¼“å­˜å’Œå¤‡ä»½ç­‰å…¶ä»–æ•°æ®</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># é™æ€å­ç½‘ï¼Œä»¥ä¾¿åªæœ‰æˆæƒçš„æºå¯ä»¥è®¿é—® BunkerWeb API</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="compose">å®Œæ•´çš„ compose æ–‡ä»¶</h3>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé”šç‚¹æ¥é¿å…åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­é‡å¤ç›¸åŒçš„è®¾ç½®</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># è¿™ä¸ªè®¾ç½®æ˜¯å¼ºåˆ¶æ€§çš„ï¼Œç”¨æ¥æŒ‡å®š BunkerWeb å®ä¾‹</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># ç”¨äºæŒä¹…åŒ–ç¼“å­˜å’Œå¤‡ä»½ç­‰å…¶ä»–æ•°æ®</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># é™æ€å­ç½‘ï¼Œä»¥ä¾¿åªæœ‰æˆæƒçš„æºå¯ä»¥è®¿é—® BunkerWeb API</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="_9">ä»æºä»£ç æ„å»º</h3>
<p>æˆ–è€…ï¼Œå¦‚æœæ‚¨æ›´å–œæ¬¢äº²è‡ªåŠ¨æ‰‹ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ç›´æ¥ä»<a href="https://github.com/bunkerity/bunkerweb">æºä»£ç </a>æ„å»º Docker é•œåƒã€‚ä»æºä»£ç æ„å»ºé•œåƒå¯ä»¥è®©æ‚¨å¯¹éƒ¨ç½²è¿‡ç¨‹æœ‰æ›´å¤§çš„æ§åˆ¶å’Œå®šåˆ¶ã€‚ä½†æ˜¯ï¼Œè¯·æ³¨æ„ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½éœ€è¦ä¸€äº›æ—¶é—´æ‰èƒ½å®Œæˆï¼Œå…·ä½“å–å†³äºæ‚¨çš„ç¡¬ä»¶é…ç½®ï¼ˆå¦‚æœéœ€è¦ï¼Œæ‚¨å¯ä»¥å»å–æ¯å’–å•¡ â˜•ï¼‰ã€‚</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw<span class="w"> </span>-f<span class="w"> </span>src/bw/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-scheduler<span class="w"> </span>-f<span class="w"> </span>src/scheduler/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-autoconf<span class="w"> </span>-f<span class="w"> </span>src/autoconf/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<h2 id="linux">Linux</h2>
<figure>
<p><img align="center," alt="æ¦‚è¿°" src="../../assets/img/integration-linux.svg" width="600" />
  </p>
<figcaption>Linux é›†æˆ</figcaption>
</figure>
<p>æ”¯æŒ BunkerWeb çš„ Linux å‘è¡Œç‰ˆï¼ˆamd64/x86_64 å’Œ arm64/aarch64 æ¶æ„ï¼‰åŒ…æ‹¬ï¼š</p>
<ul>
<li>Debian 12 "Bookworm"</li>
<li>Debian 13 "Trixie"</li>
<li>Ubuntu 22.04 "Jammy"</li>
<li>Ubuntu 24.04 "Noble"</li>
<li>Fedora 41 å’Œ 42</li>
<li>Red Hat Enterprise Linux (RHEL) 8, 9 å’Œ 10</li>
</ul>
<h3 id="_10">ç®€æ˜“å®‰è£…è„šæœ¬</h3>
<p>ä¸ºäº†ç®€åŒ–å®‰è£…ä½“éªŒï¼ŒBunkerWeb æä¾›äº†ä¸€ä¸ªç®€æ˜“å®‰è£…è„šæœ¬ï¼Œå¯ä»¥è‡ªåŠ¨å¤„ç†æ•´ä¸ªè®¾ç½®è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ NGINX å®‰è£…ã€ä»“åº“é…ç½®å’ŒæœåŠ¡è®¾ç½®ã€‚</p>
<h4 id="_11">å¿«é€Ÿå¼€å§‹</h4>
<p>è¦å¼€å§‹ä½¿ç”¨ï¼Œè¯·ä¸‹è½½å®‰è£…è„šæœ¬åŠå…¶æ ¡éªŒå’Œï¼Œç„¶ååœ¨è¿è¡Œå‰éªŒè¯è„šæœ¬çš„å®Œæ•´æ€§ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="c1"># ä¸‹è½½è„šæœ¬åŠå…¶æ ¡éªŒå’Œ</span>
curl<span class="w"> </span>-fsSL<span class="w"> </span>-O<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/vtesting/install-bunkerweb.sh
curl<span class="w"> </span>-fsSL<span class="w"> </span>-O<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/vtesting/install-bunkerweb.sh.sha256

<span class="c1"># éªŒè¯æ ¡éªŒå’Œ</span>
sha256sum<span class="w"> </span>-c<span class="w"> </span>install-bunkerweb.sh.sha256

<span class="c1"># å¦‚æœæ£€æŸ¥æˆåŠŸï¼Œåˆ™è¿è¡Œè„šæœ¬</span>
chmod<span class="w"> </span>+x<span class="w"> </span>install-bunkerweb.sh
sudo<span class="w"> </span>./install-bunkerweb.sh
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">å®‰å…¨æç¤º</p>
<p><strong>åœ¨è¿è¡Œå®‰è£…è„šæœ¬ä¹‹å‰ï¼Œè¯·åŠ¡å¿…éªŒè¯å…¶å®Œæ•´æ€§ã€‚</strong></p>
<p>ä¸‹è½½æ ¡éªŒå’Œæ–‡ä»¶ï¼Œå¹¶ä½¿ç”¨åƒ <code>sha256sum</code> è¿™æ ·çš„å·¥å…·æ¥ç¡®è®¤è„šæœ¬æ²¡æœ‰è¢«æ›´æ”¹æˆ–ç¯¡æ”¹ã€‚</p>
<p>å¦‚æœæ ¡éªŒå’ŒéªŒè¯å¤±è´¥ï¼Œ<strong>è¯·ä¸è¦æ‰§è¡Œè¯¥è„šæœ¬</strong>â€”â€”å®ƒå¯èƒ½ä¸å®‰å…¨ã€‚</p>
</div>
<h4 id="_12">å·¥ä½œåŸç†</h4>
<p>ç®€æ˜“å®‰è£…è„šæœ¬æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å·¥å…·ï¼Œæ—¨åœ¨ç®€åŒ–åœ¨å…¨æ–°çš„ Linux ç³»ç»Ÿä¸Šè®¾ç½® BunkerWeb çš„è¿‡ç¨‹ã€‚å®ƒä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹å…³é”®æ­¥éª¤ï¼š</p>
<ol>
<li><strong>ç³»ç»Ÿåˆ†æ</strong>ï¼šæ£€æµ‹æ‚¨çš„æ“ä½œç³»ç»Ÿå¹¶å¯¹ç…§æ”¯æŒçš„å‘è¡Œç‰ˆåˆ—è¡¨è¿›è¡ŒéªŒè¯ã€‚</li>
<li><strong>å®‰è£…å®šåˆ¶</strong>ï¼šåœ¨äº¤äº’æ¨¡å¼ä¸‹ï¼Œå®ƒä¼šæç¤ºæ‚¨é€‰æ‹©å®‰è£…ç±»å‹ï¼ˆä¸€ä½“åŒ–ã€ç®¡ç†å™¨ã€å·¥ä½œèŠ‚ç‚¹ç­‰ï¼‰ï¼Œå¹¶å†³å®šæ˜¯å¦å¯ç”¨åŸºäº Web çš„è®¾ç½®å‘å¯¼ã€‚</li>
<li><strong>å¯é€‰é›†æˆ</strong>ï¼šæä¾›è‡ªåŠ¨å®‰è£…å’Œé…ç½® <a href="#crowdsec-integration-with-the-script">CrowdSec å®‰å…¨å¼•æ“</a>çš„é€‰é¡¹ã€‚</li>
<li><strong>ä¾èµ–ç®¡ç†</strong>ï¼šä»å®˜æ–¹æºå®‰è£… BunkerWeb æ‰€éœ€çš„æ­£ç¡®ç‰ˆæœ¬çš„ NGINXï¼Œå¹¶é”å®šç‰ˆæœ¬ä»¥é˜²æ­¢æ„å¤–å‡çº§ã€‚</li>
<li><strong>BunkerWeb å®‰è£…</strong>ï¼šæ·»åŠ  BunkerWeb è½¯ä»¶åŒ…ä»“åº“ï¼Œå®‰è£…å¿…è¦çš„è½¯ä»¶åŒ…ï¼Œå¹¶é”å®šç‰ˆæœ¬ã€‚</li>
<li><strong>æœåŠ¡é…ç½®</strong>ï¼šæ ¹æ®æ‚¨é€‰æ‹©çš„å®‰è£…ç±»å‹è®¾ç½®å¹¶å¯ç”¨ <code>systemd</code> æœåŠ¡ã€‚</li>
<li><strong>å®‰è£…åæŒ‡å¯¼</strong>ï¼šæä¾›æ¸…æ™°çš„åç»­æ­¥éª¤ï¼Œå¸®åŠ©æ‚¨å¼€å§‹ä½¿ç”¨æ–°çš„ BunkerWeb å®ä¾‹ã€‚</li>
</ol>
<h4 id="_13">äº¤äº’å¼å®‰è£…</h4>
<p>å½“ä¸å¸¦ä»»ä½•é€‰é¡¹è¿è¡Œæ—¶ï¼Œè„šæœ¬ä¼šè¿›å…¥ä¸€ä¸ªäº¤äº’æ¨¡å¼ï¼Œå¼•å¯¼æ‚¨å®Œæˆè®¾ç½®è¿‡ç¨‹ã€‚æ‚¨å°†è¢«è¦æ±‚åšå‡ºä»¥ä¸‹é€‰æ‹©ï¼š</p>
<ol>
<li><strong>å®‰è£…ç±»å‹</strong>ï¼šé€‰æ‹©æ‚¨æƒ³è¦å®‰è£…çš„ç»„ä»¶ã€‚<ul>
<li><strong>å®Œæ•´å †æ ˆï¼ˆé»˜è®¤ï¼‰</strong>ï¼šä¸€ä¸ªä¸€ä½“åŒ–çš„å®‰è£…ï¼ŒåŒ…æ‹¬ BunkerWebã€è°ƒåº¦å™¨å’Œ Web UIã€‚</li>
<li><strong>ç®¡ç†å™¨</strong>ï¼šå®‰è£…è°ƒåº¦å™¨å’Œ Web UIï¼Œç”¨äºç®¡ç†ä¸€ä¸ªæˆ–å¤šä¸ªè¿œç¨‹ BunkerWeb å·¥ä½œèŠ‚ç‚¹ã€‚</li>
<li><strong>å·¥ä½œèŠ‚ç‚¹</strong>ï¼šä»…å®‰è£… BunkerWeb å®ä¾‹ï¼Œå¯ç”±è¿œç¨‹ç®¡ç†å™¨ç®¡ç†ã€‚</li>
<li><strong>ä»…è°ƒåº¦å™¨</strong>ï¼šä»…å®‰è£…è°ƒåº¦å™¨ç»„ä»¶ã€‚</li>
<li><strong>ä»… Web UI</strong>ï¼šä»…å®‰è£… Web UI ç»„ä»¶ã€‚</li>
<li><strong>ä»… API</strong>ï¼šä»…å®‰è£… API æœåŠ¡ä»¥ä¾¿è¿›è¡Œç¼–ç¨‹è®¿é—®ã€‚</li>
</ul>
</li>
<li><strong>è®¾ç½®å‘å¯¼</strong>ï¼šé€‰æ‹©æ˜¯å¦å¯ç”¨åŸºäº Web çš„é…ç½®å‘å¯¼ã€‚å¼ºçƒˆå»ºè®®åˆæ¬¡ä½¿ç”¨çš„ç”¨æˆ·é€‰æ‹©æ­¤é¡¹ã€‚</li>
<li><strong>CrowdSec é›†æˆ</strong>ï¼šé€‰æ‹©å®‰è£… CrowdSec å®‰å…¨å¼•æ“ï¼Œä»¥è·å¾—å…ˆè¿›çš„å®æ—¶å¨èƒé˜²æŠ¤ã€‚ä»…é€‚ç”¨äºå®Œæ•´å †æ ˆå®‰è£…ã€‚</li>
<li><strong>CrowdSec AppSec</strong>ï¼šå¦‚æœæ‚¨é€‰æ‹©å®‰è£… CrowdSecï¼Œæ‚¨è¿˜å¯ä»¥å¯ç”¨åº”ç”¨ç¨‹åºå®‰å…¨ (AppSec) ç»„ä»¶ï¼Œå®ƒå¢åŠ äº† WAF åŠŸèƒ½ã€‚</li>
<li><strong>API æœåŠ¡</strong>ï¼šå¯¹äºå®Œæ•´å †æ ˆå’Œç®¡ç†å™¨å®‰è£…ï¼Œé€‰æ‹©æ˜¯å¦å¯ç”¨å¯é€‰çš„å¤–éƒ¨ API æœåŠ¡ã€‚åœ¨ Linux å®‰è£…ä¸­ï¼Œå®ƒé»˜è®¤æ˜¯ç¦ç”¨çš„ã€‚</li>
</ol>
<div class="admonition info">
<p class="admonition-title">ç®¡ç†å™¨å’Œè°ƒåº¦å™¨å®‰è£…</p>
<p>å¦‚æœæ‚¨é€‰æ‹©<strong>ç®¡ç†å™¨</strong>æˆ–<strong>ä»…è°ƒåº¦å™¨</strong>å®‰è£…ç±»å‹ï¼Œç³»ç»Ÿè¿˜ä¼šæç¤ºæ‚¨æä¾›æ‚¨çš„ BunkerWeb å·¥ä½œèŠ‚ç‚¹å®ä¾‹çš„ IP åœ°å€æˆ–ä¸»æœºåã€‚</p>
</div>
<h4 id="_14">å‘½ä»¤è¡Œé€‰é¡¹</h4>
<p>å¯¹äºéäº¤äº’å¼æˆ–è‡ªåŠ¨åŒ–è®¾ç½®ï¼Œå¯ä»¥ä½¿ç”¨å‘½ä»¤è¡Œæ ‡å¿—æ¥æ§åˆ¶è„šæœ¬ï¼š</p>
<p><strong>é€šç”¨é€‰é¡¹ï¼š</strong></p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-v, --version VERSION</code></td>
<td>æŒ‡å®šè¦å®‰è£…çš„ BunkerWeb ç‰ˆæœ¬ï¼ˆä¾‹å¦‚ <code>testing</code>ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>-w, --enable-wizard</code></td>
<td>å¯ç”¨è®¾ç½®å‘å¯¼ã€‚</td>
</tr>
<tr>
<td><code>-n, --no-wizard</code></td>
<td>ç¦ç”¨è®¾ç½®å‘å¯¼ã€‚</td>
</tr>
<tr>
<td><code>-y, --yes</code></td>
<td>ä»¥éäº¤äº’æ¨¡å¼è¿è¡Œï¼Œå¯¹æ‰€æœ‰æç¤ºä½¿ç”¨é»˜è®¤ç­”æ¡ˆã€‚</td>
</tr>
<tr>
<td><code>-f, --force</code></td>
<td>å³ä½¿åœ¨ä¸å—æ”¯æŒçš„æ“ä½œç³»ç»Ÿç‰ˆæœ¬ä¸Šï¼Œä¹Ÿå¼ºåˆ¶ç»§ç»­å®‰è£…ã€‚</td>
</tr>
<tr>
<td><code>-q, --quiet</code></td>
<td>é™é»˜å®‰è£…ï¼ˆæŠ‘åˆ¶è¾“å‡ºï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--api</code>, <code>--enable-api</code></td>
<td>å¯ç”¨ API (FastAPI) systemd æœåŠ¡ï¼ˆé»˜è®¤ç¦ç”¨ï¼‰ã€‚</td>
</tr>
<tr>
<td><code>--no-api</code></td>
<td>æ˜ç¡®ç¦ç”¨ API æœåŠ¡ã€‚</td>
</tr>
<tr>
<td><code>-h, --help</code></td>
<td>æ˜¾ç¤ºåŒ…å«æ‰€æœ‰å¯ç”¨é€‰é¡¹çš„å¸®åŠ©ä¿¡æ¯ã€‚</td>
</tr>
<tr>
<td><code>--dry-run</code></td>
<td>æ˜¾ç¤ºå°†è¦å®‰è£…çš„å†…å®¹ï¼Œä½†ä¸å®é™…æ‰§è¡Œã€‚</td>
</tr>
</tbody>
</table>
<p><strong>å®‰è£…ç±»å‹ï¼š</strong></p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--full</code></td>
<td>å®Œæ•´å †æ ˆå®‰è£…ï¼ˆBunkerWebã€è°ƒåº¦å™¨ã€UIï¼‰ã€‚è¿™æ˜¯é»˜è®¤é€‰é¡¹ã€‚</td>
</tr>
<tr>
<td><code>--manager</code></td>
<td>å®‰è£…è°ƒåº¦å™¨å’Œ UI ä»¥ç®¡ç†è¿œç¨‹å·¥ä½œèŠ‚ç‚¹ã€‚</td>
</tr>
<tr>
<td><code>--worker</code></td>
<td>ä»…å®‰è£… BunkerWeb å®ä¾‹ã€‚</td>
</tr>
<tr>
<td><code>--scheduler-only</code></td>
<td>ä»…å®‰è£…è°ƒåº¦å™¨ç»„ä»¶ã€‚</td>
</tr>
<tr>
<td><code>--ui-only</code></td>
<td>ä»…å®‰è£… Web UI ç»„ä»¶ã€‚</td>
</tr>
<tr>
<td><code>--api-only</code></td>
<td>ä»…å®‰è£… API æœåŠ¡ï¼ˆç«¯å£ 8000ï¼‰ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>å®‰å…¨é›†æˆï¼š</strong></p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--crowdsec</code></td>
<td>å®‰è£…å¹¶é…ç½® CrowdSec å®‰å…¨å¼•æ“ã€‚</td>
</tr>
<tr>
<td><code>--no-crowdsec</code></td>
<td>è·³è¿‡ CrowdSec å®‰è£…ã€‚</td>
</tr>
<tr>
<td><code>--crowdsec-appsec</code></td>
<td>å®‰è£…å¸¦æœ‰ AppSec ç»„ä»¶çš„ CrowdSecï¼ˆåŒ…æ‹¬ WAF åŠŸèƒ½ï¼‰ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>é«˜çº§é€‰é¡¹ï¼š</strong></p>
<table>
<thead>
<tr>
<th>é€‰é¡¹</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--instances "IP1 IP2"</code></td>
<td>ä»¥ç©ºæ ¼åˆ†éš”çš„ BunkerWeb å®ä¾‹åˆ—è¡¨ï¼ˆåœ¨ç®¡ç†å™¨/è°ƒåº¦å™¨æ¨¡å¼ä¸‹ä¸ºå¿…éœ€ï¼‰ã€‚</td>
</tr>
</tbody>
</table>
<p><strong>ç”¨æ³•ç¤ºä¾‹ï¼š</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># ä»¥äº¤äº’æ¨¡å¼è¿è¡Œï¼ˆæ¨èç»™å¤§å¤šæ•°ç”¨æˆ·ï¼‰</span>
sudo<span class="w"> </span>./install-bunkerweb.sh

<span class="c1"># ä½¿ç”¨é»˜è®¤è®¾ç½®è¿›è¡Œéäº¤äº’å¼å®‰è£…ï¼ˆå®Œæ•´å †æ ˆï¼Œå¯ç”¨å‘å¯¼ï¼‰</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--yes

<span class="c1"># å®‰è£…ä¸€ä¸ªä¸å¸¦è®¾ç½®å‘å¯¼çš„å·¥ä½œèŠ‚ç‚¹</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--worker<span class="w"> </span>--no-wizard

<span class="c1"># å®‰è£…ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--version<span class="w"> </span>testing

<span class="c1"># å¸¦æœ‰è¿œç¨‹å·¥ä½œå®ä¾‹çš„ç®¡ç†å™¨è®¾ç½®ï¼ˆéœ€è¦ instancesï¼‰</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--manager<span class="w"> </span>--instances<span class="w"> </span><span class="s2">&quot;192.168.1.10 192.168.1.11&quot;</span>

<span class="c1"># å¸¦æœ‰ CrowdSec å’Œ AppSec çš„å®Œæ•´å®‰è£…</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--crowdsec-appsec

<span class="c1"># é™é»˜éäº¤äº’å¼å®‰è£…</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--quiet<span class="w"> </span>--yes

<span class="c1"># é¢„è§ˆå®‰è£…è€Œä¸æ‰§è¡Œ</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--dry-run

<span class="c1"># åœ¨ç®€æ˜“å®‰è£…æœŸé—´å¯ç”¨ APIï¼ˆéäº¤äº’å¼ï¼‰</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--yes<span class="w"> </span>--api

<span class="c1"># é”™è¯¯ï¼šCrowdSec ä¸èƒ½ç”¨äºå·¥ä½œèŠ‚ç‚¹å®‰è£…</span>
<span class="c1"># sudo ./install-bunkerweb.sh --worker --crowdsec  # è¿™å°†å¤±è´¥</span>

<span class="c1"># é”™è¯¯ï¼šåœ¨éäº¤äº’æ¨¡å¼ä¸‹ï¼Œç®¡ç†å™¨éœ€è¦ instances</span>
<span class="c1"># sudo ./install-bunkerweb.sh --manager --yes  # å¦‚æœæ²¡æœ‰ --instancesï¼Œè¿™å°†å¤±è´¥</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">å…³äºé€‰é¡¹å…¼å®¹æ€§çš„é‡è¦è¯´æ˜</p>
<p><strong>CrowdSec é™åˆ¶ï¼š</strong></p>
<ul>
<li>CrowdSec é€‰é¡¹ï¼ˆ<code>--crowdsec</code>, <code>--crowdsec-appsec</code>ï¼‰ä»…ä¸ <code>--full</code>ï¼ˆé»˜è®¤ï¼‰å®‰è£…ç±»å‹å…¼å®¹</li>
<li>å®ƒä»¬ä¸èƒ½ä¸ <code>--manager</code>, <code>--worker</code>, <code>--scheduler-only</code>, <code>--ui-only</code> æˆ– <code>--api-only</code> å®‰è£…ä¸€èµ·ä½¿ç”¨</li>
</ul>
<p><strong>API æœåŠ¡å¯ç”¨æ€§ï¼š</strong></p>
<ul>
<li>å¤–éƒ¨ API æœåŠ¡ï¼ˆç«¯å£ 8000ï¼‰é€‚ç”¨äº <code>--full</code> å’Œ <code>--manager</code> å®‰è£…ç±»å‹</li>
<li>å®ƒä¸é€‚ç”¨äº <code>--worker</code>, <code>--scheduler-only</code> æˆ– <code>--ui-only</code> å®‰è£…</li>
<li>ä½¿ç”¨ <code>--api-only</code> è¿›è¡Œä¸“ç”¨çš„ API æœåŠ¡å®‰è£…</li>
</ul>
<p><strong>Instances è¦æ±‚ï¼š</strong>
- <code>--instances</code> é€‰é¡¹ä»…å¯¹ <code>--manager</code> å’Œ <code>--scheduler-only</code> å®‰è£…ç±»å‹æœ‰æ•ˆ
- å½“ä½¿ç”¨ <code>--manager</code> æˆ– <code>--scheduler-only</code> å¹¶å¸¦æœ‰ <code>--yes</code>ï¼ˆéäº¤äº’æ¨¡å¼ï¼‰æ—¶ï¼Œ<code>--instances</code> é€‰é¡¹æ˜¯å¼ºåˆ¶æ€§çš„
- æ ¼å¼ï¼š<code>--instances "192.168.1.10 192.168.1.11 192.168.1.12"</code></p>
<p><strong>äº¤äº’å¼ä¸éäº¤äº’å¼ï¼š</strong>
- äº¤äº’æ¨¡å¼ï¼ˆé»˜è®¤ï¼‰å°†æç¤ºè¾“å…¥ç¼ºå¤±çš„å¿…éœ€å€¼
- éäº¤äº’æ¨¡å¼ï¼ˆ<code>--yes</code>ï¼‰è¦æ±‚é€šè¿‡å‘½ä»¤è¡Œæä¾›æ‰€æœ‰å¿…è¦çš„é€‰é¡¹</p>
</div>
<h4 id="crowdsec-integration-with-the-script">CrowdSec ä¸è„šæœ¬çš„é›†æˆ</h4>
<p>å¦‚æœæ‚¨é€‰æ‹©åœ¨äº¤äº’å¼è®¾ç½®è¿‡ç¨‹ä¸­å®‰è£… CrowdSecï¼Œè„šæœ¬ä¼šå®Œå…¨è‡ªåŠ¨åŒ–å…¶ä¸ BunkerWeb çš„é›†æˆï¼š</p>
<ul>
<li>å®ƒä¼šæ·»åŠ å®˜æ–¹çš„ CrowdSec ä»“åº“å¹¶å®‰è£…ä»£ç†ã€‚</li>
<li>å®ƒä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„é‡‡é›†æ–‡ä»¶ï¼Œè®© CrowdSec è§£æ BunkerWeb çš„æ—¥å¿—ï¼ˆ<code>access.log</code>ã€<code>error.log</code> å’Œ <code>modsec_audit.log</code>ï¼‰ã€‚</li>
<li>å®ƒä¼šå®‰è£…å¿…è¦çš„é›†åˆï¼ˆ<code>bunkerity/bunkerweb</code>ï¼‰å’Œè§£æå™¨ï¼ˆ<code>crowdsecurity/geoip-enrich</code>ï¼‰ã€‚</li>
<li>å®ƒä¼šä¸º BunkerWeb æ³¨å†Œä¸€ä¸ªæ‹¦æˆªå™¨ï¼Œå¹¶è‡ªåŠ¨åœ¨ <code>/etc/bunkerweb/variables.env</code> ä¸­é…ç½® API å¯†é’¥ã€‚</li>
<li>å¦‚æœæ‚¨è¿˜é€‰æ‹©äº†<strong>AppSec ç»„ä»¶</strong>ï¼Œå®ƒä¼šå®‰è£… <code>appsec-virtual-patching</code> å’Œ <code>appsec-generic-rules</code> é›†åˆï¼Œå¹¶ä¸º BunkerWeb é…ç½® AppSec ç«¯ç‚¹ã€‚</li>
</ul>
<p>è¿™æä¾›äº†ä¸€ä¸ªæ— ç¼ã€å¼€ç®±å³ç”¨çš„é›†æˆï¼Œä»¥å®ç°å¼ºå¤§çš„å…¥ä¾µé˜²æŠ¤ã€‚</p>
<h4 id="rhel">RHEL æ³¨æ„äº‹é¡¹</h4>
<div class="admonition warning">
<p class="admonition-title">RHEL-based ç³»ç»Ÿä¸Šçš„å¤–éƒ¨æ•°æ®åº“æ”¯æŒ</p>
<p>å¦‚æœæ‚¨è®¡åˆ’ä½¿ç”¨å¤–éƒ¨æ•°æ®åº“ï¼ˆæ¨èç”¨äºç”Ÿäº§ç¯å¢ƒï¼‰ï¼Œæ‚¨å¿…é¡»å®‰è£…ç›¸åº”çš„æ•°æ®åº“å®¢æˆ·ç«¯è½¯ä»¶åŒ…ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># å¯¹äº MariaDB</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mariadb

<span class="c1"># å¯¹äº MySQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql

<span class="c1"># å¯¹äº PostgreSQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>postgresql
</code></pre></div>
<p>è¿™æ˜¯ BunkerWeb è°ƒåº¦å™¨è¿æ¥åˆ°æ‚¨çš„å¤–éƒ¨æ•°æ®åº“æ‰€å¿…éœ€çš„ã€‚</p>
</div>
<h4 id="_15">å®‰è£…å</h4>
<p>æ ¹æ®æ‚¨åœ¨å®‰è£…è¿‡ç¨‹ä¸­çš„é€‰æ‹©ï¼š</p>
<p><strong>å¯ç”¨è®¾ç½®å‘å¯¼ï¼š</strong></p>
<ol>
<li>åœ¨ä»¥ä¸‹åœ°å€è®¿é—®è®¾ç½®å‘å¯¼ï¼š<code>https://your-server-ip/setup</code></li>
<li>æŒ‰ç…§å¼•å¯¼é…ç½®æ¥è®¾ç½®æ‚¨çš„ç¬¬ä¸€ä¸ªå—ä¿æŠ¤çš„æœåŠ¡</li>
<li>é…ç½® SSL/TLS è¯ä¹¦å’Œå…¶ä»–å®‰å…¨è®¾ç½®</li>
</ol>
<p><strong>æœªå¯ç”¨è®¾ç½®å‘å¯¼ï¼š</strong></p>
<ol>
<li>ç¼–è¾‘ <code>/etc/bunkerweb/variables.env</code> æ¥æ‰‹åŠ¨é…ç½® BunkerWeb</li>
<li>æ·»åŠ æ‚¨çš„æœåŠ¡å™¨è®¾ç½®å’Œå—ä¿æŠ¤çš„æœåŠ¡</li>
<li>é‡å¯è°ƒåº¦å™¨ï¼š<code>sudo systemctl restart bunkerweb-scheduler</code></li>
</ol>
<h3 id="_16">ä½¿ç”¨åŒ…ç®¡ç†å™¨å®‰è£…</h3>
<p>è¯·ç¡®ä¿åœ¨å®‰è£… BunkerWeb ä¹‹å‰<strong>å·²ç»å®‰è£…äº† NGINX 1.28.0</strong>ã€‚å¯¹äºé™¤ Fedora ä¹‹å¤–çš„æ‰€æœ‰å‘è¡Œç‰ˆï¼Œå¼ºåˆ¶è¦æ±‚ä½¿ç”¨æ¥è‡ª<a href="https://nginx.org/en/linux_packages.html">å®˜æ–¹ NGINX ä»“åº“</a>çš„é¢„æ„å»ºåŒ…ã€‚ä»æºä»£ç ç¼–è¯‘ NGINX æˆ–ä½¿ç”¨æ¥è‡ªä¸åŒä»“åº“çš„åŒ…å°†æ— æ³•ä¸ BunkerWeb çš„å®˜æ–¹é¢„æ„å»ºåŒ…ä¸€èµ·å·¥ä½œã€‚ä½†æ˜¯ï¼Œæ‚¨å¯ä»¥é€‰æ‹©ä»æºä»£ç æ„å»º BunkerWebã€‚</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Debian Bookworm/Trixie</label><label for="__tabbed_1_2">Ubuntu</label><label for="__tabbed_1_3">Fedora</label><label for="__tabbed_1_4">RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>ç¬¬ä¸€æ­¥æ˜¯æ·»åŠ  NGINX å®˜æ–¹ä»“åº“ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>debian-archive-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/debian `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>æ‚¨ç°åœ¨åº”è¯¥èƒ½å¤Ÿå®‰è£… NGINX 1.28.0ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">æµ‹è¯•/å¼€å‘ç‰ˆæœ¬</p>
<p>å¦‚æœæ‚¨ä½¿ç”¨ <code>testing</code> æˆ– <code>dev</code> ç‰ˆæœ¬ï¼Œæ‚¨éœ€è¦åœ¨å®‰è£… BunkerWeb ä¹‹å‰å°† <code>force-bad-version</code> æŒ‡ä»¤æ·»åŠ åˆ°æ‚¨çš„ <code>/etc/dpkg/dpkg.cfg</code> æ–‡ä»¶ä¸­ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">ç¦ç”¨è®¾ç½®å‘å¯¼</p>
<p>å¦‚æœæ‚¨ä¸å¸Œæœ›åœ¨å®‰è£… BunkerWeb æ—¶ä½¿ç”¨ Web UI çš„è®¾ç½®å‘å¯¼ï¼Œè¯·å¯¼å‡ºä»¥ä¸‹å˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>æœ€åå®‰è£… BunkerWeb testingï¼š</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span>testing
</code></pre></div>
<p>è¦é˜²æ­¢åœ¨æ‰§è¡Œ <code>apt upgrade</code> æ—¶å‡çº§ NGINX å’Œ/æˆ– BunkerWeb åŒ…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>ç¬¬ä¸€æ­¥æ˜¯æ·»åŠ  NGINX å®˜æ–¹ä»“åº“ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>ubuntu-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/ubuntu `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>æ‚¨ç°åœ¨åº”è¯¥èƒ½å¤Ÿå®‰è£… NGINX 1.28.0ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">æµ‹è¯•/å¼€å‘ç‰ˆæœ¬</p>
<p>å¦‚æœæ‚¨ä½¿ç”¨ <code>testing</code> æˆ– <code>dev</code> ç‰ˆæœ¬ï¼Œæ‚¨éœ€è¦åœ¨å®‰è£… BunkerWeb ä¹‹å‰å°† <code>force-bad-version</code> æŒ‡ä»¤æ·»åŠ åˆ°æ‚¨çš„ <code>/etc/dpkg/dpkg.cfg</code> æ–‡ä»¶ä¸­ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">ç¦ç”¨è®¾ç½®å‘å¯¼</p>
<p>å¦‚æœæ‚¨ä¸å¸Œæœ›åœ¨å®‰è£… BunkerWeb æ—¶ä½¿ç”¨ Web UI çš„è®¾ç½®å‘å¯¼ï¼Œè¯·å¯¼å‡ºä»¥ä¸‹å˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>æœ€åå®‰è£… BunkerWeb testingï¼š</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span>testing
</code></pre></div>
<p>è¦é˜²æ­¢åœ¨æ‰§è¡Œ <code>apt upgrade</code> æ—¶å‡çº§ NGINX å’Œ/æˆ– BunkerWeb åŒ…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Fedora æ›´æ–°æµ‹è¯•</p>
<p>å¦‚æœæ‚¨åœ¨ç¨³å®šä»“åº“ä¸­æ‰¾ä¸åˆ°åˆ—å‡ºçš„ NGINX ç‰ˆæœ¬ï¼Œå¯ä»¥å¯ç”¨ <code>updates-testing</code> ä»“åº“ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>setopt<span class="w"> </span>updates-testing.enabled<span class="o">=</span><span class="m">1</span>
</code></pre></div>
</div>
<p>Fedora å·²ç»æä¾›äº†æˆ‘ä»¬æ”¯æŒçš„ NGINX 1.28.0</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">ç¦ç”¨è®¾ç½®å‘å¯¼</p>
<p>å¦‚æœæ‚¨ä¸å¸Œæœ›åœ¨å®‰è£… BunkerWeb æ—¶ä½¿ç”¨ Web UI çš„è®¾ç½®å‘å¯¼ï¼Œè¯·å¯¼å‡ºä»¥ä¸‹å˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>æœ€åå®‰è£… BunkerWeb testingï¼š</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-testing
</code></pre></div>
<p>è¦é˜²æ­¢åœ¨æ‰§è¡Œ <code>dnf upgrade</code> æ—¶å‡çº§ NGINX å’Œ/æˆ– BunkerWeb åŒ…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>ç¬¬ä¸€æ­¥æ˜¯æ·»åŠ  NGINX å®˜æ–¹ä»“åº“ã€‚åœ¨ <code>/etc/yum.repos.d/nginx.repo</code> å¤„åˆ›å»ºä»¥ä¸‹æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre><span></span><code>[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true

[nginx-mainline]
name=nginx mainline repo
baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/
gpgcheck=1
enabled=0
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true
</code></pre></div>
<p>æ‚¨ç°åœ¨åº”è¯¥èƒ½å¤Ÿå®‰è£… NGINX 1.28.0ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">ç¦ç”¨è®¾ç½®å‘å¯¼</p>
<p>å¦‚æœæ‚¨ä¸å¸Œæœ›åœ¨å®‰è£… BunkerWeb æ—¶ä½¿ç”¨ Web UI çš„è®¾ç½®å‘å¯¼ï¼Œè¯·å¯¼å‡ºä»¥ä¸‹å˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>æœ€åå®‰è£… BunkerWeb testingï¼š</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>check-update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-testing
</code></pre></div>
<p>è¦é˜²æ­¢åœ¨æ‰§è¡Œ <code>dnf upgrade</code> æ—¶å‡çº§ NGINX å’Œ/æˆ– BunkerWeb åŒ…ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤ï¼š</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
</div>
</div>
<h3 id="_17">é…ç½®å’ŒæœåŠ¡</h3>
<p>BunkerWeb çš„æ‰‹åŠ¨é…ç½®æ˜¯é€šè¿‡ç¼–è¾‘ <code>/etc/bunkerweb/variables.env</code> æ–‡ä»¶æ¥å®Œæˆçš„ï¼š</p>
<div class="highlight"><pre><span></span><code>MY_SETTING_1=value1
MY_SETTING_2=value2
...
</code></pre></div>
<p>å®‰è£…åï¼ŒBunkerWeb å¸¦æœ‰ä¸‰ä¸ªæœåŠ¡ <code>bunkerweb</code>ã€<code>bunkerweb-scheduler</code> å’Œ <code>bunkerweb-ui</code>ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ <code>systemctl</code> æ¥ç®¡ç†å®ƒä»¬ã€‚</p>
<p>å¦‚æœæ‚¨æ‰‹åŠ¨ç¼–è¾‘äº† BunkerWeb çš„é…ç½®ï¼ˆä½¿ç”¨ <code>/etc/bunkerweb/variables.env</code>ï¼‰ï¼Œé‡å¯ <code>bunkerweb-scheduler</code> æœåŠ¡å°±è¶³ä»¥ç”Ÿæˆå¹¶é‡æ–°åŠ è½½é…ç½®ï¼Œè€Œä¸ä¼šæœ‰ä»»ä½•åœæœºæ—¶é—´ã€‚ä½†åœ¨æŸäº›æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚æ›´æ”¹ç›‘å¬ç«¯å£ï¼‰ï¼Œæ‚¨å¯èƒ½éœ€è¦é‡å¯ <code>bunkerweb</code> æœåŠ¡ã€‚</p>
<h3 id="_18">é«˜å¯ç”¨æ€§</h3>
<p>è°ƒåº¦å™¨å¯ä»¥ä¸ BunkerWeb å®ä¾‹åˆ†ç¦»ï¼Œä»¥æä¾›é«˜å¯ç”¨æ€§ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œè°ƒåº¦å™¨å°†å®‰è£…åœ¨ä¸€å°ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šï¼Œå¹¶èƒ½å¤Ÿç®¡ç†å¤šä¸ª BunkerWeb å®ä¾‹ã€‚</p>
<h4 id="_19">ç®¡ç†å™¨</h4>
<p>è¦ä»…åœ¨æœåŠ¡å™¨ä¸Šå®‰è£…è°ƒåº¦å™¨ï¼Œæ‚¨å¯ä»¥åœ¨æ‰§è¡Œ BunkerWeb å®‰è£…ä¹‹å‰å¯¼å‡ºä»¥ä¸‹å˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">MANAGER_MODE</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
<p>æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥å¯¼å‡ºä»¥ä¸‹å˜é‡ä»¥ä»…å¯ç”¨è°ƒåº¦å™¨ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<h4 id="_20">å·¥ä½œèŠ‚ç‚¹</h4>
<p>åœ¨å¦ä¸€å°æœåŠ¡å™¨ä¸Šï¼Œè¦ä»…å®‰è£… BunkerWebï¼Œæ‚¨å¯ä»¥åœ¨æ‰§è¡Œ BunkerWeb å®‰è£…ä¹‹å‰å¯¼å‡ºä»¥ä¸‹å˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">WORKER_MODE</span><span class="o">=</span>yes
</code></pre></div>
<p>æˆ–è€…ï¼Œæ‚¨ä¹Ÿå¯ä»¥å¯¼å‡ºä»¥ä¸‹å˜é‡ä»¥ä»…å¯ç”¨ BunkerWebï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<h4 id="web-ui">Web UI</h4>
<p>Web UI å¯ä»¥å®‰è£…åœ¨ä¸€å°ç‹¬ç«‹çš„æœåŠ¡å™¨ä¸Šï¼Œä»¥æä¾›ä¸€ä¸ªä¸“é—¨ç”¨äºç®¡ç† BunkerWeb å®ä¾‹çš„ç•Œé¢ã€‚è¦ä»…å®‰è£… Web UIï¼Œæ‚¨å¯ä»¥åœ¨æ‰§è¡Œ BunkerWeb å®‰è£…ä¹‹å‰å¯¼å‡ºä»¥ä¸‹å˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>yes
</code></pre></div>
<h2 id="docker-autoconf">Docker è‡ªåŠ¨é…ç½®</h2>
<figure>
<p><img align="center," alt="æ¦‚è¿°" src="../../assets/img/integration-autoconf.svg" width="600" />
  </p>
<figcaption>Docker è‡ªåŠ¨é…ç½®é›†æˆ</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Docker é›†æˆ</p>
<p>Docker è‡ªåŠ¨é…ç½®é›†æˆæ˜¯ Docker é›†æˆçš„ä¸€ä¸ªâ€œæ¼”è¿›â€ã€‚å¦‚æœéœ€è¦ï¼Œè¯·å…ˆé˜…è¯»<a href="#docker">Docker é›†æˆéƒ¨åˆ†</a>ã€‚</p>
</div>
<p>æœ‰ä¸€ç§æ›¿ä»£æ–¹æ³•å¯ä»¥è§£å†³æ¯æ¬¡æ›´æ–°æ—¶éƒ½éœ€è¦é‡æ–°åˆ›å»ºå®¹å™¨çš„ä¸ä¾¿ã€‚é€šè¿‡ä½¿ç”¨å¦ä¸€ä¸ªåä¸º <strong>autoconf</strong> çš„é•œåƒï¼Œæ‚¨å¯ä»¥è‡ªåŠ¨å®æ—¶é‡æ–°é…ç½® BunkerWebï¼Œè€Œæ— éœ€é‡æ–°åˆ›å»ºå®¹å™¨ã€‚</p>
<p>è¦åˆ©ç”¨æ­¤åŠŸèƒ½ï¼Œæ‚¨å¯ä»¥ä¸ºæ‚¨çš„ Web åº”ç”¨ç¨‹åºå®¹å™¨æ·»åŠ <strong>æ ‡ç­¾</strong>ï¼Œè€Œä¸æ˜¯ä¸º BunkerWeb å®¹å™¨å®šä¹‰ç¯å¢ƒå˜é‡ã€‚ç„¶åï¼Œ<strong>autoconf</strong> é•œåƒå°†ç›‘å¬ Docker äº‹ä»¶ï¼Œå¹¶æ— ç¼å¤„ç† BunkerWeb çš„é…ç½®æ›´æ–°ã€‚</p>
<p>è¿™ä¸ªâ€œ<em>è‡ªåŠ¨åŒ–</em>â€è¿‡ç¨‹ç®€åŒ–äº† BunkerWeb é…ç½®çš„ç®¡ç†ã€‚é€šè¿‡ä¸ºæ‚¨çš„ Web åº”ç”¨ç¨‹åºå®¹å™¨æ·»åŠ æ ‡ç­¾ï¼Œæ‚¨å¯ä»¥å°†é‡æ–°é…ç½®ä»»åŠ¡å§”æ‰˜ç»™ <strong>autoconf</strong>ï¼Œè€Œæ— éœ€æ‰‹åŠ¨å¹²é¢„å®¹å™¨çš„é‡æ–°åˆ›å»ºã€‚è¿™ç®€åŒ–äº†æ›´æ–°è¿‡ç¨‹å¹¶å¢å¼ºäº†ä¾¿åˆ©æ€§ã€‚</p>
<p>é€šè¿‡é‡‡ç”¨è¿™ç§æ–¹æ³•ï¼Œæ‚¨å¯ä»¥äº«å— BunkerWeb çš„å®æ—¶é‡æ–°é…ç½®ï¼Œè€Œæ— éœ€é‡æ–°åˆ›å»ºå®¹å™¨çš„éº»çƒ¦ï¼Œä½¿å…¶æ›´é«˜æ•ˆã€æ›´ç”¨æˆ·å‹å¥½ã€‚</p>
<div class="admonition info">
<p class="admonition-title">å¤šç«™ç‚¹æ¨¡å¼</p>
<p>Docker è‡ªåŠ¨é…ç½®é›†æˆæ„å‘³ç€ä½¿ç”¨<strong>å¤šç«™ç‚¹æ¨¡å¼</strong>ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…æ–‡æ¡£çš„<a href="../concepts/#multisite-mode">å¤šç«™ç‚¹éƒ¨åˆ†</a>ã€‚</p>
</div>
<div class="admonition info">
<p class="admonition-title">æ•°æ®åº“åç«¯</p>
<p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„è¯´æ˜å‡è®¾æ‚¨æ­£åœ¨ä½¿ç”¨ MariaDB ä½œä¸ºé»˜è®¤çš„æ•°æ®åº“åç«¯ï¼Œè¿™æ˜¯ç”± <code>DATABASE_URI</code> è®¾ç½®é…ç½®çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ç†è§£æ‚¨å¯èƒ½æ›´å–œæ¬¢ä¸ºæ‚¨çš„ Docker é›†æˆä½¿ç”¨å…¶ä»–åç«¯ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œè¯·æ”¾å¿ƒï¼Œå…¶ä»–æ•°æ®åº“åç«¯ä»ç„¶æ˜¯å¯è¡Œçš„ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä»“åº“çš„ <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">misc/integrations æ–‡ä»¶å¤¹</a>ä¸­çš„ docker-compose æ–‡ä»¶ã€‚</p>
</div>
<p>è¦å¯ç”¨è‡ªåŠ¨é…ç½®æ›´æ–°ï¼Œè¯·åœ¨å †æ ˆä¸­åŒ…å«ä¸€ä¸ªåä¸º <code>bw-autoconf</code> çš„é¢å¤–å®¹å™¨ã€‚æ­¤å®¹å™¨æ‰¿è½½è‡ªåŠ¨é…ç½®æœåŠ¡ï¼Œè¯¥æœåŠ¡ç®¡ç† BunkerWeb çš„åŠ¨æ€é…ç½®æ›´æ”¹ã€‚</p>
<p>ä¸ºäº†æ”¯æŒæ­¤åŠŸèƒ½ï¼Œè¯·ä½¿ç”¨ä¸€ä¸ªä¸“ç”¨çš„â€œçœŸå®â€æ•°æ®åº“åç«¯ï¼ˆä¾‹å¦‚ï¼ŒMariaDBã€MySQL æˆ– PostgreSQLï¼‰è¿›è¡ŒåŒæ­¥é…ç½®å­˜å‚¨ã€‚é€šè¿‡é›†æˆ <code>bw-autoconf</code> å’Œåˆé€‚çš„æ•°æ®åº“åç«¯ï¼Œæ‚¨ä¸º BunkerWeb ä¸­æ— ç¼çš„è‡ªåŠ¨é…ç½®ç®¡ç†å»ºç«‹äº†åŸºç¡€è®¾æ–½ã€‚</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé”šç‚¹æ¥é¿å…åœ¨ä¸¤ä¸ªå®¹å™¨ä¸­é‡å¤ç›¸åŒçš„è®¾ç½®</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># è‡ªåŠ¨é…ç½®æœåŠ¡è¯†åˆ« BunkerWeb å®ä¾‹çš„å¼ºåˆ¶æ€§æ ‡ç­¾</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># æˆ‘ä»¬ä¸éœ€è¦åœ¨è¿™é‡ŒæŒ‡å®š BunkerWeb å®ä¾‹ï¼Œå› ä¸ºå®ƒä»¬ç”±è‡ªåŠ¨é…ç½®æœåŠ¡è‡ªåŠ¨æ£€æµ‹</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># æœåŠ¡å™¨åç§°å°†ç”±æœåŠ¡æ ‡ç­¾å¡«å……</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># è‡ªåŠ¨é…ç½®çš„å¼ºåˆ¶æ€§è®¾ç½®</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># è®°å¾—ä¸ºæ•°æ®åº“è®¾ç½®ä¸€ä¸ªæ›´å¼ºçš„å¯†ç </span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># ç”¨äºæŒä¹…åŒ–ç¼“å­˜å’Œå¤‡ä»½ç­‰å…¶ä»–æ•°æ®</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># è®°å¾—ä¸ºæ•°æ®åº“è®¾ç½®ä¸€ä¸ªæ›´å¼ºçš„å¯†ç </span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># Docker å¥—æ¥å­—</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># æˆ‘ä»¬è®¾ç½®äº†æœ€å¤§å…è®¸çš„æ•°æ®åŒ…å¤§å°ä»¥é¿å…å¤§æŸ¥è¯¢çš„é—®é¢˜</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># è®°å¾—ä¸ºæ•°æ®åº“è®¾ç½®ä¸€ä¸ªæ›´å¼ºçš„å¯†ç </span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">æ•°æ®åº“åœ¨ <code>bw-db</code> ç½‘ç»œä¸­</p>
<p>æ•°æ®åº“å®¹å™¨æœ‰æ„æœªåŒ…å«åœ¨ <code>bw-universe</code> ç½‘ç»œä¸­ã€‚å®ƒç”± <code>bw-autoconf</code> å’Œ <code>bw-scheduler</code> å®¹å™¨ä½¿ç”¨ï¼Œè€Œä¸æ˜¯ç›´æ¥ç”± BunkerWeb ä½¿ç”¨ã€‚å› æ­¤ï¼Œæ•°æ®åº“å®¹å™¨æ˜¯ <code>bw-db</code> ç½‘ç»œçš„ä¸€éƒ¨åˆ†ï¼Œè¿™é€šè¿‡ä½¿å¯¹æ•°æ®åº“çš„å¤–éƒ¨è®¿é—®æ›´å…·æŒ‘æˆ˜æ€§æ¥å¢å¼ºå®‰å…¨æ€§ã€‚<strong>è¿™ç§åˆ»æ„çš„è®¾è®¡é€‰æ‹©æœ‰åŠ©äºä¿æŠ¤æ•°æ®åº“å¹¶åŠ å¼ºç³»ç»Ÿçš„æ•´ä½“å®‰å…¨è§†è§’</strong>ã€‚</p>
</div>
<div class="admonition warning">
<p class="admonition-title">åœ¨æ— æ ¹æ¨¡å¼ä¸‹ä½¿ç”¨ Docker</p>
<p>å¦‚æœæ‚¨æ­£åœ¨ä½¿ç”¨<a href="https://docs.docker.com/engine/security/rootless">æ— æ ¹æ¨¡å¼çš„ Docker</a>ï¼Œæ‚¨éœ€è¦å°† docker å¥—æ¥å­—çš„æŒ‚è½½æ›¿æ¢ä¸ºä»¥ä¸‹å€¼ï¼š<code>$XDG_RUNTIME_DIR/docker.sock:/var/run/docker.sock:ro</code>ã€‚</p>
</div>
<h3 id="_21">è‡ªåŠ¨é…ç½®æœåŠ¡</h3>
<p>ä¸€æ—¦å †æ ˆè®¾ç½®å¥½ï¼Œæ‚¨å°†èƒ½å¤Ÿåˆ›å»º Web åº”ç”¨ç¨‹åºå®¹å™¨ï¼Œå¹¶ä½¿ç”¨â€œbunkerweb.â€å‰ç¼€å°†è®¾ç½®æ·»åŠ ä¸ºæ ‡ç­¾ï¼Œä»¥ä¾¿è‡ªåŠ¨è®¾ç½® BunkerWebï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="namespaces">å‘½åç©ºé—´</h3>
<p>ä» <code>1.6.0</code> ç‰ˆæœ¬å¼€å§‹ï¼ŒBunkerWeb çš„è‡ªåŠ¨é…ç½®å †æ ˆç°åœ¨æ”¯æŒå‘½åç©ºé—´ã€‚æ­¤åŠŸèƒ½ä½¿æ‚¨èƒ½å¤Ÿåœ¨åŒä¸€ä¸ª Docker ä¸»æœºä¸Šç®¡ç†å¤šä¸ª BunkerWeb å®ä¾‹å’ŒæœåŠ¡çš„â€œ<em>é›†ç¾¤</em>â€ã€‚è¦åˆ©ç”¨å‘½åç©ºé—´ï¼Œåªéœ€åœ¨æ‚¨çš„æœåŠ¡ä¸Šè®¾ç½® <code>NAMESPACE</code> æ ‡ç­¾ã€‚è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># ä¸ºæœåŠ¡è®¾ç½®å‘½åç©ºé—´</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">å‘½åç©ºé—´è¡Œä¸º</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è‡ªåŠ¨é…ç½®å †æ ˆéƒ½ç›‘å¬æ‰€æœ‰å‘½åç©ºé—´ã€‚å¦‚æœæ‚¨æƒ³å°†ä¸€ä¸ªå †æ ˆé™åˆ¶åœ¨ç‰¹å®šçš„å‘½åç©ºé—´ï¼Œå¯ä»¥åœ¨ <code>bw-autoconf</code> æœåŠ¡ä¸­è®¾ç½® <code>NAMESPACES</code> ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># ä¸º BunkerWeb å®ä¾‹è®¾ç½®å‘½åç©ºé—´ï¼Œä»¥ä¾¿è‡ªåŠ¨é…ç½®æœåŠ¡å¯ä»¥æ£€æµ‹åˆ°å®ƒ</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># åªç›‘å¬è¿™äº›å‘½åç©ºé—´</span>
<span class="nn">...</span>
</code></pre></div>
<p>è¯·è®°ä½ï¼Œ<code>NAMESPACES</code> ç¯å¢ƒå˜é‡æ˜¯ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„å‘½åç©ºé—´åˆ—è¡¨ã€‚</p>
</div>
<div class="admonition warning">
<p class="admonition-title">å‘½åç©ºé—´è§„èŒƒ</p>
<p>æ¯ä¸ªå‘½åç©ºé—´åªèƒ½æœ‰<strong>ä¸€ä¸ªæ•°æ®åº“</strong>å’Œ<strong>ä¸€ä¸ªè°ƒåº¦å™¨</strong>ã€‚å¦‚æœæ‚¨å°è¯•åœ¨åŒä¸€ä¸ªå‘½åç©ºé—´ä¸­åˆ›å»ºå¤šä¸ªæ•°æ®åº“æˆ–è°ƒåº¦å™¨ï¼Œé…ç½®æœ€ç»ˆä¼šç›¸äº’å†²çªã€‚</p>
<p>è°ƒåº¦å™¨ä¸éœ€è¦ <code>NAMESPACE</code> æ ‡ç­¾å³å¯æ­£å¸¸å·¥ä½œã€‚å®ƒåªéœ€è¦æ­£ç¡®é…ç½® <code>DATABASE_URI</code> è®¾ç½®ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è®¿é—®ä¸è‡ªåŠ¨é…ç½®æœåŠ¡ç›¸åŒçš„æ•°æ®åº“ã€‚</p>
</div>
<h2 id="kubernetes">Kubernetes</h2>
<figure>
<p><img align="center," alt="æ¦‚è¿°" src="../../assets/img/integration-kubernetes.svg" width="600" />
  </p>
<figcaption>Kubernetes é›†æˆ</figcaption>
</figure>
<p>ä¸ºäº†åœ¨ Kubernetes ç¯å¢ƒä¸­è‡ªåŠ¨åŒ– BunkerWeb å®ä¾‹çš„é…ç½®ï¼Œ
autoconf æœåŠ¡å……å½“ä¸€ä¸ª <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/">Ingress æ§åˆ¶å™¨</a>ã€‚
å®ƒæ ¹æ® <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingress èµ„æº</a> é…ç½® BunkerWeb å®ä¾‹ï¼Œ
å¹¶ç›‘æ§å…¶ä»– Kubernetes å¯¹è±¡ï¼Œä¾‹å¦‚ <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>ï¼Œä»¥è·å–è‡ªå®šä¹‰é…ç½®ã€‚</p>
<div class="admonition info">
<p class="admonition-title">ConfigMap åŒæ­¥</p>
<ul>
<li>Ingress æ§åˆ¶å™¨ä»…ç®¡ç†å¸¦æœ‰ <code>bunkerweb.io/CONFIG_TYPE</code> æ³¨è§£çš„ ConfigMapã€‚</li>
<li>å¦‚æœéœ€è¦å°†é…ç½®é™å®šåˆ°å•ä¸ªæœåŠ¡ï¼ˆæœåŠ¡å™¨åå¿…é¡»å·²å­˜åœ¨ï¼‰ï¼Œè¯·æ·»åŠ  <code>bunkerweb.io/CONFIG_SITE</code>ï¼›
  æœªè®¾ç½®æ—¶è¡¨ç¤ºå…¨å±€åº”ç”¨ã€‚</li>
<li>åˆ é™¤è¯¥æ³¨è§£æˆ–åˆ é™¤ ConfigMap ä¼šç§»é™¤å¯¹åº”çš„è‡ªå®šä¹‰é…ç½®ã€‚</li>
</ul>
</div>
<p>ä¸ºäº†è·å¾—æœ€ä½³è®¾ç½®ï¼Œå»ºè®®å°† BunkerWeb å®šä¹‰ä¸ºä¸€ä¸ª <strong><a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a></strong>ï¼Œè¿™æ ·å¯ä»¥ç¡®ä¿åœ¨æ‰€æœ‰èŠ‚ç‚¹ä¸Šéƒ½åˆ›å»ºä¸€ä¸ª podï¼Œè€Œå°† <strong>autoconf å’Œ scheduler</strong> å®šä¹‰ä¸º<strong>å•ä¸ªå‰¯æœ¬çš„ <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a></strong>ã€‚</p>
<p>é‰´äºå­˜åœ¨å¤šä¸ª BunkerWeb å®ä¾‹ï¼Œæœ‰å¿…è¦å»ºç«‹ä¸€ä¸ªå…±äº«æ•°æ®å­˜å‚¨ï¼Œå®ç°ä¸ºä¸€ä¸ª <a href="https://redis.io/">Redis</a> æˆ– <a href="https://valkey.io/">Valkey</a> æœåŠ¡ã€‚è¿™äº›å®ä¾‹å°†åˆ©ç”¨è¯¥æœåŠ¡æ¥ç¼“å­˜å’Œå…±äº«å½¼æ­¤ä¹‹é—´çš„æ•°æ®ã€‚æœ‰å…³ Redis/Valkey è®¾ç½®çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚è§<a href="../features/#redis">æ­¤å¤„</a>ã€‚</p>
<div class="admonition info">
<p class="admonition-title">æ•°æ®åº“åç«¯</p>
<p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„è¯´æ˜å‡è®¾æ‚¨æ­£åœ¨ä½¿ç”¨ MariaDB ä½œä¸ºé»˜è®¤çš„æ•°æ®åº“åç«¯ï¼Œè¿™æ˜¯ç”± <code>DATABASE_URI</code> è®¾ç½®é…ç½®çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ç†è§£æ‚¨å¯èƒ½æ›´å–œæ¬¢ä¸ºæ‚¨çš„ Docker é›†æˆä½¿ç”¨å…¶ä»–åç«¯ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œè¯·æ”¾å¿ƒï¼Œå…¶ä»–æ•°æ®åº“åç«¯ä»ç„¶æ˜¯å¯è¡Œçš„ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä»“åº“çš„ <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">misc/integrations æ–‡ä»¶å¤¹</a>ä¸­çš„ docker-compose æ–‡ä»¶ã€‚</p>
<p>é›†ç¾¤æ•°æ®åº“åç«¯çš„è®¾ç½®è¶…å‡ºäº†æœ¬æ–‡æ¡£çš„èŒƒå›´ã€‚</p>
</div>
<p>è¯·ç¡®ä¿è‡ªåŠ¨é…ç½®æœåŠ¡æœ‰æƒè®¿é—® Kubernetes APIã€‚å»ºè®®ä¸ºæ­¤ç›®çš„åˆ©ç”¨ <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC æˆæƒ</a>ã€‚</p>
<div class="admonition warning">
<p class="admonition-title">Kubernetes API çš„è‡ªå®šä¹‰ CA</p>
<p>å¦‚æœæ‚¨ä¸ºæ‚¨çš„ Kubernetes API ä½¿ç”¨è‡ªå®šä¹‰ CAï¼Œæ‚¨å¯ä»¥åœ¨ ingress æ§åˆ¶å™¨ä¸ŠæŒ‚è½½ä¸€ä¸ªåŒ…å«æ‚¨çš„ä¸­é—´è¯ä¹¦å’Œæ ¹è¯ä¹¦çš„æ†ç»‘æ–‡ä»¶ï¼Œå¹¶å°† <code>KUBERNETES_SSL_CA_CERT</code> ç¯å¢ƒå˜é‡çš„å€¼è®¾ç½®ä¸ºå®¹å™¨å†…æ†ç»‘æ–‡ä»¶çš„è·¯å¾„ã€‚æˆ–è€…ï¼Œå³ä½¿ä¸æ¨èï¼Œæ‚¨ä¹Ÿå¯ä»¥é€šè¿‡å°† ingress æ§åˆ¶å™¨çš„ <code>KUBERNETES_SSL_VERIFY</code> ç¯å¢ƒå˜é‡è®¾ç½®ä¸º <code>no</code>ï¼ˆé»˜è®¤ä¸º <code>yes</code>ï¼‰æ¥ç¦ç”¨è¯ä¹¦éªŒè¯ã€‚</p>
</div>
<p>æ­¤å¤–ï¼Œ<strong>åœ¨ä½¿ç”¨ Kubernetes é›†æˆæ—¶ï¼Œå°† <code>KUBERNETES_MODE</code> ç¯å¢ƒå˜é‡è®¾ç½®ä¸º <code>yes</code> è‡³å…³é‡è¦</strong>ã€‚æ­¤å˜é‡æ˜¯æ­£å¸¸è¿è¡Œæ‰€å¿…éœ€çš„ã€‚</p>
<h3 id="_22">å®‰è£…æ–¹æ³•</h3>
<h4 id="helm-chart">ä½¿ç”¨ helm chartï¼ˆæ¨èï¼‰</h4>
<p>å®‰è£… Kubernetes çš„æ¨èæ–¹æ³•æ˜¯ä½¿ç”¨ä½äº <code>https://repo.bunkerweb.io/charts</code> çš„ Helm chartï¼š</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
</code></pre></div>
<p>ç„¶åæ‚¨å¯ä»¥ä½¿ç”¨è¯¥ä»“åº“ä¸­çš„ bunkerweb helm chartï¼š</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>-f<span class="w"> </span>myvalues.yaml<span class="w"> </span>mybunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>å€¼çš„å®Œæ•´åˆ—è¡¨åœ¨ <a href="https://github.com/bunkerity/bunkerweb-helm">bunkerity/bunkerweb-helm ä»“åº“</a> çš„ <a href="https://github.com/bunkerity/bunkerweb-helm/blob/main/charts/bunkerweb/values.yaml">charts/bunkerweb/values.yaml æ–‡ä»¶</a> ä¸­åˆ—å‡ºã€‚</p>
<h4 id="sidecar-container-helm">Sidecar Container + Helm</h4>
<p>This documentation explains how to deploy BunkerWeb as a sidecar to protect your Kubernetes applications. In this architecture, each application has its own BunkerWeb container acting as a security reverse proxy.</p>
<h5 id="architecture">Architecture</h5>
<pre class="mermaid"><code>flowchart TB

  %% ---------- æ ·å¼ ----------
  classDef scheduler     fill:#eef2ff,stroke:#4c1d95,stroke-width:1px,rx:6px,ry:6px;
  classDef podContainer  fill:none,stroke:#9ca3af,stroke-width:1px,stroke-dasharray:6 3,rx:6px,ry:6px;
  classDef component     fill:#f9fafb,stroke:#6b7280,stroke-width:1px,rx:4px,ry:4px;
  classDef lb            fill:#e0f2fe,stroke:#0369a1,stroke-width:1px,rx:6px,ry:6px;

  %% ---------- é¡¶éƒ¨ï¼šè°ƒåº¦å™¨ ----------
  SCHED["BunkerWeb è°ƒåº¦å™¨ï¼ˆé›†ä¸­å¼ï¼‰&lt;br/&gt;+ UI + MariaDB + Redis"]:::scheduler

  %% ---------- Pods ç»„ ----------
  subgraph PODS["Pod ç»„"]
    %% åº”ç”¨ Pod 1 ----------
    subgraph POD1["åº”ç”¨ Pod"]
      BW1["BunkerWeb"]:::component
      APP1["åº”ç”¨ç¨‹åº&lt;br/&gt;(ç«¯å£ 80)"]:::component
      BW1 --&gt;|åˆæ³•è¯·æ±‚| APP1
    end
    class POD1 podContainer

    %% åº”ç”¨ Pod 2 ----------
    subgraph POD2["åº”ç”¨ Pod"]
      BW2["BunkerWeb"]:::component
      APP2["åº”ç”¨ç¨‹åº&lt;br/&gt;(ç«¯å£ XX)"]:::component
      BW2 --&gt;|åˆæ³•è¯·æ±‚| APP2
    end
    class POD2 podContainer
  end

  %% ---------- åº•éƒ¨ï¼šè´Ÿè½½å‡è¡¡å™¨ ----------
  LB["è´Ÿè½½å‡è¡¡å™¨"]:::lb

  %% è°ƒåº¦å™¨é€šè¿‡ API æ§åˆ¶ BunkerWeb å®ä¾‹
  %% The Scheduler controls the BunkerWeb instances (API)
  SCHED --&gt;|API 5000| BW1
  SCHED --&gt;|API 5000| BW2
  %% è´Ÿè½½å‡è¡¡å™¨å°†æµé‡å‘é€åˆ° BunkerWeb
  %% The load balancer sends traffic to BunkerWeb
  LB --&gt;|HTTP/HTTPS| BW1
  LB --&gt;|HTTP/HTTPS| BW2
  %% ---------- å¸ƒå±€è¾…åŠ©ï¼ˆéšè—ï¼‰ ----------
  %% å°†è´Ÿè½½å‡è¡¡å™¨æ”¾ç½®åœ¨æ•´ä¸ª Pod ç»„ä¹‹ä¸‹
  %% Place the load balancer under the entire PODS group
  PODS --&gt; LB
  linkStyle 6 stroke-width:0px,stroke:transparent;</code></pre>
<h5 id="prerequisites">Prerequisites</h5>
<ul>
<li>A working Kubernetes cluster</li>
<li>Helm 3.x installed</li>
<li>BunkerWeb Helm chart deployed with:</li>
<li><code>scheduler</code> enabled</li>
<li><code>ui</code> enabled</li>
<li><code>mariadb</code> enabled (to store configurations)</li>
<li><code>redis</code> enabled (for synchronization)</li>
<li><code>controller</code> enabled (recommended for automatic sidecar discovery)</li>
<li><code>bunkerweb.replicas: 0</code> (no standalone deployment)</li>
</ul>
<h5 id="sidecar-discovery-modes">Sidecar Discovery Modes</h5>
<p>BunkerWeb offers two modes for sidecar discovery:</p>
<h6 id="mode-1-automatic-discovery-controller-recommended">Mode 1: Automatic Discovery (Controller - Recommended)</h6>
<p>The <strong>BunkerWeb controller</strong> automatically discovers pods with BunkerWeb sidecars without manual configuration.</p>
<p><strong>Advantages:</strong>
- âœ… Automatic discovery of new sidecars
- âœ… No need to manually maintain <code>BUNKERWEB_INSTANCES</code>
- âœ… Automatic scaling</p>
<p><strong>Configuration:</strong></p>
<ol>
<li>
<p>Enable the controller in <code>values.yaml</code>:
<div class="highlight"><pre><span></span><code><span class="nt">controller</span><span class="p">:</span>
<span class="w">  </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.6.5&quot;</span>
</code></pre></div></p>
</li>
<li>
<p>For each sidecar, add:</p>
</li>
<li><strong>Pod annotation</strong>: <code>bunkerweb.io/INSTANCE: "yes"</code></li>
<li><strong>Environment variable</strong>: <code>KUBERNETES_MODE: "yes"</code></li>
</ol>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-bw</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-bw</span>
<span class="w">      </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># Mandatory annotation for auto-discovery when using bunkerweb-controller</span>
<span class="w">        </span><span class="nt">bunkerweb.io/INSTANCE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># Random WebApp you want to protect</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx:latest</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="c1"># Sidecar BunkerWeb</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:latest</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">entrypoint</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bwapi</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9113</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">metrics</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_WHITELIST_IP</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.0.0.0/8</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">192.168.0.0/16&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KUBERNETES_MODE</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx-bw</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w"> </span><span class="c1"># BunkerWeb exposed port</span>
</code></pre></div>
<ol>
<li>
<p><strong>No need for headless service</strong> - the controller communicates directly with pods</p>
</li>
<li>
<p><strong>No need</strong> to manually configure the scheduler with <code>BUNKERWEB_INSTANCES</code> - the controller handles discovery</p>
</li>
</ol>
<h6 id="mode-2-manual-configuration-bunkerweb_instances">Mode 2: Manual Configuration (BUNKERWEB_INSTANCES)</h6>
<p>Explicit configuration of each instance via the <code>BUNKERWEB_INSTANCES</code> environment variable.</p>
<p><strong>Advantages:</strong>
- âœ… Precise control over managed instances
- âœ… Useful for complex multi-namespace environments</p>
<p><strong>Configuration:</strong></p>
<p>See the following sections for details.</p>
<h5 id="step-1-scheduler-configuration">Step 1: Scheduler Configuration</h5>
<p>The BunkerWeb scheduler is the central component that distributes configurations to all sidecars.</p>
<h6 id="option-a-with-controller-recommended">Option A: With Controller (Recommended)</h6>
<p>If you're using the controller for automatic discovery, <strong>no special configuration is needed</strong> for the scheduler. The controller will automatically detect pods with the <code>bunkerweb.io/INSTANCE: "yes"</code> annotation.</p>
<h6 id="option-b-manual-configuration-with-bunkerweb_instances">Option B: Manual Configuration with <code>BUNKERWEB_INSTANCES</code></h6>
<p>In your BunkerWeb chart <code>values.yaml</code>, configure the <code>BUNKERWEB_INSTANCES</code> environment variable with the URLs of all your headless services:</p>
<div class="highlight"><pre><span></span><code><span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.6.5&quot;</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BUNKERWEB_INSTANCES</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://app1-bunkerweb-workers.namespace.svc.cluster.local:5000</span><span class="nv"> </span><span class="s">http://app2-bunkerweb-workers.namespace.svc.cluster.local:5000&quot;</span>
</code></pre></div>
<p><strong>Important:</strong>
- Separate URLs with spaces
- Use port <strong>5000</strong> (BunkerWeb internal API)
- Format: <code>http://&lt;service-name&gt;.&lt;namespace&gt;.svc.cluster.local:5000</code></p>
<h5 id="step-2-creating-the-deployment-with-sidecar">Step 2: Creating the Deployment with Sidecar</h5>
<h6 id="deployment-structure-with-controller-automatic-mode-recommended">Deployment Structure with Controller (Automatic Mode - Recommended)</h6>
<p><strong>Recommended configuration</strong> with automatic discovery:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app-bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-namespace</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">      </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bunkerweb.io/INSTANCE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w">  </span><span class="c1"># Enable automatic discovery</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># Your application</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-image:latest</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w">  </span><span class="c1"># Port your app listens on</span>

<span class="w">        </span><span class="c1"># BunkerWeb Sidecar</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.6-rc2</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w">  </span><span class="c1"># Exposed HTTP port</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span><span class="w">  </span><span class="c1"># Internal API (mandatory)</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KUBERNETES_MODE</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w">  </span><span class="c1"># Enable Kubernetes mode</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_WHITELIST_IP</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.0.0.0/8</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">192.168.0.0/16&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MULTISITE</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REVERSE_PROXY</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LOG_LEVEL</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;info&quot;</span>
</code></pre></div>
<p><strong>Key points for automatic mode:</strong>
- âœ… <strong>Mandatory annotation</strong>: <code>bunkerweb.io/INSTANCE: "yes"</code> at pod level
- âœ… <strong>Mandatory environment variable</strong>: <code>KUBERNETES_MODE: "yes"</code>
- âœ… <strong>No headless service needed</strong>: the controller communicates directly with pods via Kubernetes API
- âœ… <strong>No need to manually configure</strong> <code>BUNKERWEB_INSTANCES</code></p>
<h6 id="deployment-structure-without-controller-manual-mode">Deployment Structure without Controller (Manual Mode)</h6>
<p>If you're not using the controller:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app-bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-namespace</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="c1"># Your application</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-image:latest</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span><span class="w">  </span><span class="c1"># Port your app listens on</span>

<span class="w">        </span><span class="c1"># BunkerWeb Sidecar</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w">  </span><span class="c1"># Exposed HTTP port</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span><span class="w">  </span><span class="c1"># Internal API (mandatory)</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">API_WHITELIST_IP</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.0.0.0/8</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">192.168.0.0/16&quot;</span>
</code></pre></div>
<h6 id="important-environment-variables">Important Environment Variables</h6>
<table>
<thead>
<tr>
<th>Variable</th>
<th>Value</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>KUBERNETES_MODE</code></td>
<td><code>yes</code></td>
<td><strong>Mandatory</strong> for automatic discovery via the controller</td>
</tr>
<tr>
<td><code>API_WHITELIST_IP</code></td>
<td><code>127.0.0.0/8 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16</code></td>
<td>IPs allowed to access the API</td>
</tr>
</tbody>
</table>
<h5 id="step-3-creating-services">Step 3: Creating Services</h5>
<h6 id="clusterip-service-external-exposure">ClusterIP Service (external exposure)</h6>
<p>Service to expose your application through BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app-bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-namespace</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span><span class="w">  </span><span class="c1"># or LoadBalancer depending on your needs</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span><span class="w">  </span><span class="c1"># BunkerWeb port</span>
</code></pre></div>
<h6 id="headless-service-internal-api-conditional">Headless Service (internal API) - Conditional</h6>
<p><strong>Only required in manual mode (without controller)</strong>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app-bunkerweb-workers</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">your-namespace</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">clusterIP</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">None</span><span class="w">  </span><span class="c1"># Headless service</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bwapi</span>
<span class="w">      </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5000</span>
</code></pre></div>
<p><strong>Important:</strong>
- âš ï¸ <strong>Not required with controller</strong> - the controller communicates directly with pods via Kubernetes API
- âœ… <strong>Mandatory without controller</strong> - this service name must be manually added to <code>BUNKERWEB_INSTANCES</code>
- The <code>selector</code> must match your deployment labels</p>
<h5 id="step-4-reverse-proxy-configuration">Step 4: Reverse Proxy Configuration</h5>
<p>You have <strong>two options</strong> to configure the reverse proxy:</p>
<h6 id="option-a-via-web-interface-ui">Option A: Via Web Interface (UI)</h6>
<ol>
<li>Access the BunkerWeb UI</li>
<li>Go to the <strong>"Services"</strong></li>
<li>Create a new service with:</li>
<li><strong>Server name</strong>: <code>my-app.example.com</code></li>
<li><strong>Reverse proxy host</strong>: <code>http://127.0.0.1:80</code> (or your app's port)</li>
<li><strong>Use reverse proxy</strong>: <code>yes</code></li>
<li>Save</li>
</ol>
<p>The scheduler will automatically send the configuration to the sidecar via the API (port 5000).</p>
<h6 id="option-b-via-environment-variables">Option B: Via Environment Variables</h6>
<p>Add these variables in the <code>bunkerweb</code> container:</p>
<div class="highlight"><pre><span></span><code><span class="nt">env</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MULTISITE</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SERVER_NAME</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-app.example.com&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app.example.com_USE_REVERSE_PROXY</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app.example.com_REVERSE_PROXY_HOST</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://127.0.0.1:80&quot;</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-app.example.com_REVERSE_PROXY_URL</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
</code></pre></div>
<p><strong>Note:</strong> The UI option is recommended for centralized and dynamic management.</p>
<h5 id="step-5-deployment">Step 5: Deployment</h5>
<h6 id="with-controller-automatic-mode-recommended">With Controller (Automatic Mode - Recommended)</h6>
<ol>
<li><strong>Deploy your application with the sidecar</strong>:
   <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>my-app-deployment.yaml
</code></pre></div></li>
</ol>
<p>Make sure that:
   - The annotation <code>bunkerweb.io/INSTANCE: "yes"</code> is present in <code>template.metadata.annotations</code>
   - The variable <code>KUBERNETES_MODE: "yes"</code> is defined in the bunkerweb container</p>
<ol>
<li>
<p><strong>Verify that the controller detects the sidecar</strong>:
   <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>bunkerweb<span class="w"> </span>deployment/bunkerweb-controller<span class="w"> </span>-f
</code></pre></div>
   You should see logs indicating the discovery of the new pod.</p>
</li>
<li>
<p><strong>Create the reverse proxy configuration</strong> via the BunkerWeb UI</p>
</li>
<li>
<p><strong>Test your application</strong>:
   <div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: my-app.example.com&quot;</span><span class="w"> </span>http://&lt;service-ip&gt;
</code></pre></div></p>
</li>
</ol>
<h6 id="without-controller-manual-mode">Without Controller (Manual Mode)</h6>
<ol>
<li>
<p><strong>Deploy your application with the sidecar</strong>:
   <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>my-app-deployment.yaml
</code></pre></div></p>
</li>
<li>
<p><strong>Add the headless service to <code>BUNKERWEB_INSTANCES</code></strong>:
   Update your <code>values.yaml</code> and upgrade the Helm chart:
   <div class="highlight"><pre><span></span><code>helm<span class="w"> </span>upgrade<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerity/bunkerweb<span class="w"> </span>-n<span class="w"> </span>bunkerweb<span class="w"> </span>-f<span class="w"> </span>values.yaml
</code></pre></div></p>
</li>
<li>
<p><strong>Verify that the scheduler detects the sidecar</strong>:
   <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>logs<span class="w"> </span>-n<span class="w"> </span>bunkerweb<span class="w"> </span>deployment/bunkerweb-scheduler<span class="w"> </span>-f
</code></pre></div>
   You should see logs indicating the connection to the new worker.</p>
</li>
<li>
<p><strong>Create the reverse proxy configuration</strong> via the BunkerWeb UI</p>
</li>
<li>
<p><strong>Test your application</strong>:
   <div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: my-app.example.com&quot;</span><span class="w"> </span>http://&lt;service-ip&gt;
</code></pre></div></p>
</li>
</ol>
<h6 id="common-issues">Common Issues</h6>
<table>
<thead>
<tr>
<th>Issue</th>
<th>Cause</th>
<th>Solution</th>
</tr>
</thead>
<tbody>
<tr>
<td>Scheduler can't find the sidecar</td>
<td>Missing or misconfigured headless service</td>
<td>Verify the service exists and is in <code>BUNKERWEB_INSTANCES</code></td>
</tr>
<tr>
<td>502 Bad Gateway error</td>
<td>App is not accessible from BunkerWeb</td>
<td>Verify the reverse proxy URL is correct (<code>127.0.0.1:port</code>)</td>
</tr>
<tr>
<td>Configuration not applied</td>
<td>Sidecar didn't receive the config</td>
<td>Check scheduler and sidecar logs</td>
</tr>
<tr>
<td>Port 5000 not accessible</td>
<td>Port not exposed in the container</td>
<td>Add <code>- containerPort: 5000</code> in the bunkerweb container</td>
</tr>
</tbody>
</table>
<h5 id="adding-a-new-application">Adding a New Application</h5>
<h6 id="with-controller-automatic-mode">With Controller (Automatic Mode)</h6>
<p>To add a new application protected by BunkerWeb:</p>
<ol>
<li><strong>Create a new deployment</strong> with the BunkerWeb sidecar with:</li>
<li>Annotation <code>bunkerweb.io/INSTANCE: "yes"</code> in <code>template.metadata.annotations</code></li>
<li>
<p>Environment variable <code>KUBERNETES_MODE: "yes"</code> in the bunkerweb container</p>
</li>
<li>
<p><strong>Create only the ClusterIP service</strong> (no headless service needed!)</p>
</li>
<li>
<p><strong>Apply the deployment</strong>:
   <div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>apply<span class="w"> </span>-f<span class="w"> </span>new-app-deployment.yaml
</code></pre></div></p>
</li>
<li>
<p><strong>The controller automatically detects the new pod</strong> - no chart redeployment needed!</p>
</li>
<li>
<p><strong>Configure the reverse proxy</strong> in the UI</p>
</li>
</ol>
<h6 id="without-controller-manual-mode_1">Without Controller (Manual Mode)</h6>
<p>To add a new application protected by BunkerWeb:</p>
<ol>
<li>
<p><strong>Create a new deployment</strong> with the BunkerWeb sidecar (as described above)</p>
</li>
<li>
<p><strong>Create both services</strong> (ClusterIP + Headless)</p>
</li>
<li>
<p><strong>Add the new headless service</strong> to <code>BUNKERWEB_INSTANCES</code>:
   <div class="highlight"><pre><span></span><code><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">BUNKERWEB_INSTANCES</span>
<span class="w">    </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://app1-workers.ns.svc.cluster.local:5000</span><span class="nv"> </span><span class="s">http://app2-workers.ns.svc.cluster.local:5000&quot;</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Redeploy the chart</strong>:
   <div class="highlight"><pre><span></span><code>helm<span class="w"> </span>upgrade<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerity/bunkerweb<span class="w"> </span>-n<span class="w"> </span>bunkerweb<span class="w"> </span>-f<span class="w"> </span>values.yaml
</code></pre></div></p>
</li>
<li>
<p><strong>Configure the reverse proxy</strong> in the UI or via env vars</p>
</li>
</ol>
<h5 id="best-practices">Best Practices</h5>
<p>âœ… <strong>Use the controller</strong> for automatic sidecar discovery (simpler, no headless service needed)
âœ… <strong>Use a single centralized scheduler</strong> to manage all sidecars
âœ… <strong>Always add the annotation</strong> <code>bunkerweb.io/INSTANCE: "yes"</code> and environment variable <code>KUBERNETES_MODE: "yes"</code> when using controller mode
âœ… <strong>No headless service needed with controller</strong> - only ClusterIP service is sufficient
âœ… <strong>Use the UI</strong> to manage configurations (more flexible)
âœ… <strong>Define resource limits</strong> for containers
âœ… <strong>Use Kubernetes secrets</strong> for sensitive configurations
âœ… <strong>Check logs</strong> of scheduler and sidecars regularly</p>
<h4 id="yaml">å®Œæ•´çš„ YAML æ–‡ä»¶</h4>
<p>é™¤äº†ä½¿ç”¨ helm chartï¼Œæ‚¨è¿˜å¯ä»¥ä½¿ç”¨ GitHub ä»“åº“ä¸­ <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">misc/integrations æ–‡ä»¶å¤¹</a>å†…çš„ YAML æ ·æ¿æ–‡ä»¶ã€‚è¯·æ³¨æ„ï¼Œæˆ‘ä»¬å¼ºçƒˆå»ºè®®æ‚¨æ”¹ç”¨ helm chartã€‚</p>
<h3 id="ingress">Ingress èµ„æº</h3>
<p>ä¸€æ—¦ BunkerWeb Kubernetes å †æ ˆæˆåŠŸè®¾ç½®å¹¶è¿è¡Œï¼ˆæœ‰å…³è¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚é˜…è‡ªåŠ¨é…ç½®æ—¥å¿—ï¼‰ï¼Œæ‚¨å°±å¯ä»¥ç»§ç»­åœ¨é›†ç¾¤å†…éƒ¨ç½² Web åº”ç”¨ç¨‹åºå¹¶å£°æ˜æ‚¨çš„ Ingress èµ„æºã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒBunkerWeb è®¾ç½®éœ€è¦ä½œä¸º Ingress èµ„æºçš„æ³¨è§£æ¥æŒ‡å®šã€‚å¯¹äºåŸŸéƒ¨åˆ†ï¼Œè¯·ä½¿ç”¨ç‰¹æ®Šå€¼ <strong><code>bunkerweb.io</code></strong>ã€‚é€šè¿‡åŒ…å«é€‚å½“çš„æ³¨è§£ï¼Œæ‚¨å¯ä»¥ç›¸åº”åœ°ä¸º Ingress èµ„æºé…ç½® BunkerWebã€‚</p>
<div class="admonition tip">
<p class="admonition-title">å¿½ç•¥å˜ˆæ‚çš„æ³¨è§£</p>
<p>å½“æŸäº›æ³¨è§£ä¸åº”å½±å“ autoconf æ—¶ï¼Œè¯·åœ¨æ§åˆ¶å™¨éƒ¨ç½²ä¸­è®¾ç½® <code>KUBERNETES_IGNORE_ANNOTATIONS</code>ã€‚æä¾›ä»¥ç©ºæ ¼æˆ–é€—å·åˆ†éš”çš„æ³¨è§£é”®åˆ—è¡¨ï¼ˆä¾‹å¦‚ <code>bunkerweb.io/EXTRA_FOO</code>ï¼‰æˆ–ä»…åç¼€ï¼ˆ<code>EXTRA_FOO</code>ï¼‰ã€‚åŒ¹é…çš„æ³¨è§£å°†ä» ingress æ´¾ç”Ÿçš„è®¾ç½®ä¸­å‰¥ç¦»ï¼Œå¹¶ä¸”åœ¨å®ä¾‹å‘ç°æœŸé—´å®Œå…¨è·³è¿‡æºå¸¦å®ƒä»¬çš„ podã€‚</p>
</div>
<div class="admonition info">
<p class="admonition-title">TLS æ”¯æŒ</p>
<p>BunkerWeb ingress æ§åˆ¶å™¨å®Œå…¨æ”¯æŒä½¿ç”¨ tls è§„èŒƒçš„è‡ªå®šä¹‰ HTTPS è¯ä¹¦ï¼Œå¦‚ç¤ºä¾‹æ‰€ç¤ºã€‚é…ç½®è¯¸å¦‚ <code>cert-manager</code> ä¹‹ç±»çš„è§£å†³æ–¹æ¡ˆä»¥è‡ªåŠ¨ç”Ÿæˆ tls secret è¶…å‡ºäº†æœ¬æ–‡æ¡£çš„èŒƒå›´ã€‚</p>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># å°†åº”ç”¨äºæ­¤ ingress ä¸­çš„æ‰€æœ‰ä¸»æœº</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="c1"># å°†ä»…åº”ç”¨äº www.example.com ä¸»æœº</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># TLS æ˜¯å¯é€‰çš„ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä½¿ç”¨å†…ç½®çš„ Let&#39;s Encrypt ç­‰</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1">#   - hosts:</span>
<span class="w">  </span><span class="c1">#       - www.example.com</span>
<span class="w">  </span><span class="c1">#     secretName: secret-example-tls</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="nn">...</span>
</code></pre></div>
<h3 id="namespaces_1">å‘½åç©ºé—´</h3>
<p>ä» <code>1.6.0</code> ç‰ˆæœ¬å¼€å§‹ï¼ŒBunkerWeb çš„è‡ªåŠ¨é…ç½®å †æ ˆç°åœ¨æ”¯æŒå‘½åç©ºé—´ã€‚æ­¤åŠŸèƒ½ä½¿æ‚¨èƒ½å¤Ÿåœ¨åŒä¸€ä¸ª Kubernetes é›†ç¾¤ä¸Šç®¡ç†å¤šä¸ª BunkerWeb å®ä¾‹å’ŒæœåŠ¡çš„é›†ç¾¤ã€‚è¦åˆ©ç”¨å‘½åç©ºé—´ï¼Œåªéœ€åœ¨æ‚¨çš„ BunkerWeb å®ä¾‹å’ŒæœåŠ¡ä¸Šè®¾ç½® <code>namespace</code> å…ƒæ•°æ®å­—æ®µã€‚è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DaemonSet</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># ä¸º BunkerWeb å®ä¾‹è®¾ç½®å‘½åç©ºé—´</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">å‘½åç©ºé—´è¡Œä¸º</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è‡ªåŠ¨é…ç½®å †æ ˆéƒ½ç›‘å¬æ‰€æœ‰å‘½åç©ºé—´ã€‚å¦‚æœæ‚¨æƒ³å°†ä¸€ä¸ªå †æ ˆé™åˆ¶åœ¨ç‰¹å®šçš„å‘½åç©ºé—´ï¼Œå¯ä»¥åœ¨ <code>bunkerweb-controller</code> éƒ¨ç½²ä¸­è®¾ç½® <code>NAMESPACES</code> ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># ä¸ºæ§åˆ¶å™¨è®¾ç½®å‘½åç©ºé—´</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">strategy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Recreate</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sa-bunkerweb</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">          </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># åªç›‘å¬è¿™äº›å‘½åç©ºé—´</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
</code></pre></div>
<p>è¯·è®°ä½ï¼Œ<code>NAMESPACES</code> ç¯å¢ƒå˜é‡æ˜¯ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„å‘½åç©ºé—´åˆ—è¡¨ã€‚</p>
</div>
<div class="admonition warning">
<p class="admonition-title">å‘½åç©ºé—´è§„èŒƒ</p>
<p>æ¯ä¸ªå‘½åç©ºé—´åªèƒ½æœ‰<strong>ä¸€ä¸ªæ•°æ®åº“</strong>å’Œ<strong>ä¸€ä¸ªè°ƒåº¦å™¨</strong>ã€‚å¦‚æœæ‚¨å°è¯•åœ¨åŒä¸€ä¸ªå‘½åç©ºé—´ä¸­åˆ›å»ºå¤šä¸ªæ•°æ®åº“æˆ–è°ƒåº¦å™¨ï¼Œé…ç½®æœ€ç»ˆä¼šç›¸äº’å†²çªã€‚</p>
<p>è°ƒåº¦å™¨ä¸éœ€è¦ <code>NAMESPACE</code> æ³¨è§£å³å¯æ­£å¸¸å·¥ä½œã€‚å®ƒåªéœ€è¦æ­£ç¡®é…ç½® <code>DATABASE_URI</code> è®¾ç½®ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è®¿é—®ä¸è‡ªåŠ¨é…ç½®æœåŠ¡ç›¸åŒçš„æ•°æ®åº“ã€‚</p>
</div>
<h3 id="ingress_1">Ingress ç±»</h3>
<p>å½“ä½¿ç”¨æ–‡æ¡£ä¸­çš„å®˜æ–¹æ–¹æ³•å®‰è£…æ—¶ï¼ŒBunkerWeb å¸¦æœ‰ä»¥ä¸‹ <code>IngressClass</code> å®šä¹‰ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IngressClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">controller</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.io/ingress-controller</span>
</code></pre></div>
<p>ä¸ºäº†é™åˆ¶ ingress æ§åˆ¶å™¨ç›‘æ§çš„ <code>Ingress</code> èµ„æºï¼Œæ‚¨å¯ä»¥å°† <code>KUBERNETES_INGRESS_CLASS</code> ç¯å¢ƒå˜é‡çš„å€¼è®¾ç½®ä¸º <code>bunkerweb</code>ã€‚ç„¶åï¼Œæ‚¨å¯ä»¥åœ¨æ‚¨çš„ <code>Ingress</code> å®šä¹‰ä¸­åˆ©ç”¨ <code>ingressClassName</code> æŒ‡ä»¤ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
</code></pre></div>
<h3 id="_23">è‡ªå®šä¹‰åŸŸå</h3>
<p>å¦‚æœæ‚¨ä¸ºæ‚¨çš„ Kubernetes é›†ç¾¤ä½¿ç”¨ä¸åŒäºé»˜è®¤ <code>kubernetes.local</code> çš„è‡ªå®šä¹‰åŸŸåï¼Œæ‚¨å¯ä»¥åœ¨è°ƒåº¦å™¨å®¹å™¨ä¸Šä½¿ç”¨ <code>KUBERNETES_DOMAIN_NAME</code> ç¯å¢ƒå˜é‡æ¥è®¾ç½®è¯¥å€¼ã€‚</p>
<h3 id="ingress_2">ä¸ç°æœ‰ ingress æ§åˆ¶å™¨ä¸€èµ·ä½¿ç”¨</h3>
<div class="admonition info">
<p class="admonition-title">åŒæ—¶ä¿ç•™ç°æœ‰ ingress æ§åˆ¶å™¨å’Œ BunkerWeb</p>
<p>è¿™æ˜¯ä¸€ä¸ªæ‚¨å¸Œæœ›ä¿ç•™ç°æœ‰ ingress æ§åˆ¶å™¨ï¼ˆä¾‹å¦‚ nginxï¼‰çš„ç”¨ä¾‹ã€‚å…¸å‹çš„æµé‡æµå°†æ˜¯ï¼šè´Ÿè½½å‡è¡¡å™¨ =&gt; Ingress æ§åˆ¶å™¨ =&gt; BunkerWeb =&gt; åº”ç”¨ç¨‹åºã€‚</p>
</div>
<h4 id="nginx-ingress">nginx ingress æ§åˆ¶å™¨å®‰è£…</h4>
<p>å®‰è£… ingress nginx helm ä»“åº“ï¼š</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>ingress-nginx<span class="w"> </span>https://kubernetes.github.io/ingress-nginx
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>ä½¿ç”¨é»˜è®¤å€¼å®‰è£… nginx ingress æ§åˆ¶å™¨ï¼ˆå¯èƒ½æ— æ³•åœ¨æ‚¨è‡ªå·±çš„é›†ç¾¤ä¸Šå¼€ç®±å³ç”¨ï¼Œè¯·æŸ¥çœ‹<a href="https://kubernetes.github.io/ingress-nginx/">æ–‡æ¡£</a>ï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>nginx<span class="w"> </span>--create-namespace<span class="w"> </span>nginx<span class="w"> </span>ingress-nginx/ingress-nginx
</code></pre></div>
<p>æå– LB çš„ IP åœ°å€ï¼š</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>nginx-ingress-nginx-controller<span class="w"> </span>-n<span class="w"> </span>nginx<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span>
</code></pre></div>
<p>è®¾ç½® DNS æ¡ç›®æŒ‡å‘ LB çš„ IPï¼ˆä¾‹å¦‚ <code>bunkerweb</code> å­åŸŸç”¨äº BW UIï¼Œ<code>myapp</code> ç”¨äºåº”ç”¨ç¨‹åºï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nslookup<span class="w"> </span>bunkerweb.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>bunkerweb.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4
$<span class="w"> </span>nslookup<span class="w"> </span>myapp.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>myapp.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div>
<p><strong>BunkerWeb å®‰è£…</strong></p>
<p>å®‰è£… BunkerWeb helm ä»“åº“ï¼š</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>åˆ›å»º <code>values.yaml</code> æ–‡ä»¶ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="c1"># è¿™é‡Œæˆ‘ä»¬å°†è®¾ç½®åœ¨ç°æœ‰ ingress æ§åˆ¶å™¨åé¢è®¾ç½® BunkerWeb æ‰€éœ€çš„å€¼</span>
<span class="c1"># å¸¦ BW çš„æµé‡æµï¼šLB =&gt; ç°æœ‰ Ingress æ§åˆ¶å™¨ =&gt; BunkerWeb =&gt; æœåŠ¡</span>
<span class="c1"># ä¸å¸¦ BW çš„æµé‡æµï¼šLB =&gt; ç°æœ‰ Ingress æ§åˆ¶å™¨ =&gt; æœåŠ¡</span>

<span class="c1"># å…¨å±€è®¾ç½®</span>
<span class="nt">settings</span><span class="p">:</span>
<span class="w">  </span><span class="nt">misc</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># æ›¿æ¢ä¸ºæ‚¨çš„ DNS è§£æå™¨</span>
<span class="w">    </span><span class="c1"># è·å–æ–¹æ³•ï¼šåœ¨ä»»æ„ pod ä¸­æ‰§è¡Œ kubectl execï¼Œç„¶å cat /etc/resolv.conf</span>
<span class="w">    </span><span class="c1"># å¦‚æœæ‚¨çš„ nameserver æ˜¯ä¸€ä¸ª IPï¼Œåˆ™æ‰§è¡Œåå‘ DNS æŸ¥æ‰¾ï¼šnslookup &lt;IP&gt;</span>
<span class="w">    </span><span class="c1"># å¤§å¤šæ•°æƒ…å†µä¸‹æ˜¯ coredns.kube-system.svc.cluster.local æˆ– kube-dns.kube-system.svc.cluster.local</span>
<span class="w">    </span><span class="nt">dnsResolvers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kube-dns.kube-system.svc.cluster.local&quot;</span>
<span class="w">  </span><span class="nt">kubernetes</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># æˆ‘ä»¬åªè€ƒè™‘å¸¦æœ‰ ingressClass bunkerweb çš„ Ingress èµ„æºï¼Œä»¥é¿å…ä¸ç°æœ‰ ingress æ§åˆ¶å™¨å†²çª</span>
<span class="w">    </span><span class="nt">ingressClass</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">    </span><span class="c1"># å¯é€‰ï¼šæ‚¨å¯ä»¥é€‰æ‹© BunkerWeb å°†ç›‘å¬ Ingress/ConfigMap æ›´æ”¹çš„å‘½åç©ºé—´</span>
<span class="w">    </span><span class="c1"># é»˜è®¤å€¼ï¼ˆç©ºç™½ï¼‰æ˜¯æ‰€æœ‰å‘½åç©ºé—´</span>
<span class="w">    </span><span class="nt">namespaces</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="c1"># è¦†ç›– bunkerweb-external æœåŠ¡ç±»å‹ä¸º ClusterIP</span>
<span class="c1"># å› ä¸ºæˆ‘ä»¬ä¸éœ€è¦å°†å…¶æš´éœ²ç»™å¤–éƒ¨ä¸–ç•Œ</span>
<span class="c1"># æˆ‘ä»¬å°†ä½¿ç”¨ç°æœ‰çš„ ingress æ§åˆ¶å™¨å°†æµé‡è·¯ç”±åˆ° BunkerWeb</span>
<span class="nt">service</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>

<span class="c1"># BunkerWeb è®¾ç½®</span>
<span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>

<span class="c1"># è°ƒåº¦å™¨è®¾ç½®</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># å¯ç”¨ real IP æ¨¡å—ä»¥è·å–å®¢æˆ·ç«¯çš„çœŸå® IP</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># æ§åˆ¶å™¨è®¾ç½®</span>
<span class="nt">controller</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>

<span class="c1"># UI è®¾ç½®</span>
<span class="nt">ui</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">testing</span>
</code></pre></div>
<p>ä½¿ç”¨è‡ªå®šä¹‰å€¼å®‰è£… BunkerWebï¼š</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>bunkerweb<span class="w"> </span>--create-namespace<span class="w"> </span>-f<span class="w"> </span>values.yaml<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>æ£€æŸ¥æ—¥å¿—å¹¶ç­‰å¾…ä¸€åˆ‡å°±ç»ªã€‚</p>
<p><strong>Web UI å®‰è£…</strong></p>
<p>è®¾ç½®ä»¥ä¸‹ ingressï¼ˆå‡è®¾å·²å®‰è£… nginx æ§åˆ¶å™¨ï¼‰ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ui-bunkerweb</span>
<span class="w">  </span><span class="c1"># å¦‚æœéœ€è¦ï¼Œæ›¿æ¢ä¸ºæ‚¨çš„ BW å‘½åç©ºé—´</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># å³ä½¿æµé‡æ˜¯å†…éƒ¨çš„ï¼ŒWeb UI ä¹Ÿå¿…é¡»ä½¿ç”¨ HTTPS</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/backend-protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;HTTPS&quot;</span>
<span class="w">    </span><span class="c1"># æˆ‘ä»¬å¿…é¡»è®¾ç½® SNIï¼Œä»¥ä¾¿ BW å¯ä»¥æä¾›æ­£ç¡®çš„è™šæ‹Ÿä¸»æœº</span>
<span class="w">    </span><span class="c1"># æ›¿æ¢ä¸ºæ‚¨çš„åŸŸå</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb.example.com&quot;</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-server-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;on&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ä»…ç”± nginx æ§åˆ¶å™¨æä¾›æœåŠ¡ï¼Œè€Œä¸æ˜¯ BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># å¦‚æœè¦ä½¿ç”¨è‡ªå·±çš„è¯ä¹¦ï¼Œè¯·å–æ¶ˆæ³¨é‡Šå¹¶è¿›è¡Œç¼–è¾‘</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - bunkerweb.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># æ›¿æ¢ä¸ºæ‚¨çš„åŸŸå</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># ç”± Helm chart åˆ›å»º</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="c1"># UI å¿…é¡»ä½¿ç”¨ HTTPS ç«¯å£</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
</code></pre></div>
<p>ç°åœ¨æ‚¨å¯ä»¥é€šè¿‡æµè§ˆ <code>https://bunkerweb.example.com/setup</code> è¿›å…¥è®¾ç½®å‘å¯¼ã€‚</p>
<p><strong>ä¿æŠ¤ç°æœ‰åº”ç”¨ç¨‹åº</strong></p>
<p><strong>é¦–å…ˆï¼Œæ‚¨éœ€è¦è¿›å…¥å…¨å±€é…ç½®ï¼Œé€‰æ‹© SSL æ’ä»¶ï¼Œç„¶åç¦ç”¨è‡ªåŠ¨å°† HTTP é‡å®šå‘åˆ° HTTPSã€‚è¯·æ³¨æ„ï¼Œæ‚¨åªéœ€è¦æ‰§è¡Œä¸€æ¬¡ã€‚</strong></p>
<p>å‡è®¾æ‚¨åœ¨ <code>myapp</code> å‘½åç©ºé—´ä¸­æœ‰ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¯¥åº”ç”¨ç¨‹åºå¯ä»¥é€šè¿‡ <code>myapp-service</code> æœåŠ¡åœ¨ç«¯å£ <code>5000</code> ä¸Šè®¿é—®ã€‚</p>
<p>æ‚¨éœ€è¦åœ¨ Web UI ä¸Šæ·»åŠ ä¸€ä¸ªæ–°æœåŠ¡å¹¶å¡«å†™æ‰€éœ€ä¿¡æ¯ï¼š</p>
<ul>
<li>æœåŠ¡å™¨åç§°ï¼šæ‚¨çš„åº”ç”¨ç¨‹åºçš„å…¬å…±åŸŸåï¼ˆä¾‹å¦‚ <code>myapp.example.com</code>ï¼‰</li>
<li>SSL/TLSï¼šæ‚¨çš„ ingress æ§åˆ¶å™¨è´Ÿè´£è¯¥éƒ¨åˆ†ï¼Œå› æ­¤ä¸è¦åœ¨ BunkerWeb ä¸Šå¯ç”¨å®ƒï¼Œå› ä¸ºæµé‡åœ¨é›†ç¾¤å†…éƒ¨</li>
<li>åå‘ä»£ç†ä¸»æœºï¼šæ‚¨åœ¨é›†ç¾¤å†…çš„åº”ç”¨ç¨‹åºçš„å®Œæ•´ URLï¼ˆä¾‹å¦‚ <code>http://myapp-service.myapp.svc.cluster.local:5000</code>ï¼‰</li>
</ul>
<p>æ·»åŠ æ–°æœåŠ¡åï¼Œæ‚¨ç°åœ¨å¯ä»¥ä¸ºè¯¥æœåŠ¡å£°æ˜ä¸€ä¸ª Ingress èµ„æºï¼Œå¹¶å°†å…¶è·¯ç”±åˆ° BunkerWeb æœåŠ¡çš„ HTTP ç«¯å£ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">  </span><span class="c1"># å¦‚æœéœ€è¦ï¼Œæ›¿æ¢ä¸ºæ‚¨çš„ BW å‘½åç©ºé—´</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ä»…ç”± nginx æ§åˆ¶å™¨æä¾›æœåŠ¡ï¼Œè€Œä¸æ˜¯ BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># å¦‚æœè¦ä½¿ç”¨è‡ªå·±çš„è¯ä¹¦ï¼Œè¯·å–æ¶ˆæ³¨é‡Šå¹¶è¿›è¡Œç¼–è¾‘</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - myapp.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># æ›¿æ¢ä¸ºæ‚¨çš„åŸŸå</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># ç”± Helm chart åˆ›å»º</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>æ‚¨å¯ä»¥è®¿é—® <code>http(s)://myapp.example.com</code>ï¼Œç°åœ¨å®ƒå·²å—åˆ° BunkerWeb çš„ä¿æŠ¤ ğŸ›¡ï¸</p>
<h2 id="swarm">Swarm</h2>
<figure>
<p><img align="center," alt="æ¦‚è¿°" src="../../assets/img/integration-swarm.svg" width="600" />
  </p>
<figcaption>Docker Swarm é›†æˆ</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">å·²å¼ƒç”¨</p>
<p>Swarm é›†æˆå·²å¼ƒç”¨ï¼Œå¹¶å°†åœ¨æœªæ¥ç‰ˆæœ¬ä¸­åˆ é™¤ã€‚è¯·è€ƒè™‘æ”¹ç”¨ <a href="#kubernetes">Kubernetes é›†æˆ</a>ã€‚</p>
</div>
<div class="admonition tip">
<p class="admonition-title">PRO æ”¯æŒ</p>
<p><strong>å¦‚æœæ‚¨éœ€è¦ Swarm æ”¯æŒ</strong>ï¼Œè¯·é€šè¿‡ <a href="mailto:contact@bunkerity.com">contact@bunkerity.com</a> æˆ–<a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">è”ç³»è¡¨å•</a>ä¸æˆ‘ä»¬è”ç³»ã€‚</p>
</div>
<div class="admonition info">
<p class="admonition-title">Docker è‡ªåŠ¨é…ç½®</p>
<p>Swarm é›†æˆä¸ Docker è‡ªåŠ¨é…ç½®é›†æˆç±»ä¼¼ï¼ˆä½†ä½¿ç”¨æœåŠ¡è€Œä¸æ˜¯å®¹å™¨ï¼‰ã€‚å¦‚æœéœ€è¦ï¼Œè¯·å…ˆé˜…è¯»<a href="#docker-autoconf">Docker è‡ªåŠ¨é…ç½®é›†æˆéƒ¨åˆ†</a>ã€‚</p>
</div>
<p>ä¸ºäº†å®ç° BunkerWeb å®ä¾‹çš„è‡ªåŠ¨é…ç½®ï¼Œ<strong>autoconf</strong> æœåŠ¡éœ€è¦è®¿é—® Docker APIã€‚è¯¥æœåŠ¡ç›‘å¬ Docker Swarm äº‹ä»¶ï¼Œä¾‹å¦‚æœåŠ¡çš„åˆ›å»ºæˆ–åˆ é™¤ï¼Œå¹¶å®æ—¶æ— ç¼åœ°é…ç½® <strong>BunkerWeb å®ä¾‹</strong>ï¼Œè€Œä¸ä¼šé€ æˆä»»ä½•åœæœºã€‚å®ƒè¿˜ç›‘æ§å…¶ä»– Swarm å¯¹è±¡ï¼Œä¾‹å¦‚ç”¨äºè‡ªå®šä¹‰é…ç½®çš„ <a href="https://docs.docker.com/engine/swarm/configs/">configs</a>ã€‚</p>
<p>ä¸ <a href="#docker-autoconf">Docker autoconf é›†æˆ</a>ç±»ä¼¼ï¼ŒWeb æœåŠ¡çš„é…ç½®æ˜¯ä½¿ç”¨ä»¥ <strong>bunkerweb</strong> å‰ç¼€å¼€å¤´çš„æ ‡ç­¾æ¥å®šä¹‰çš„ã€‚</p>
<p>ä¸ºäº†è·å¾—æœ€ä½³è®¾ç½®ï¼Œå»ºè®®å°† <strong>BunkerWeb æœåŠ¡</strong>è°ƒåº¦ä¸ºæ‰€æœ‰èŠ‚ç‚¹ä¸Šçš„<strong><em>å…¨å±€æœåŠ¡</em></strong>ï¼Œè€Œå°† <strong>autoconfã€scheduler å’Œ Docker API ä»£ç†æœåŠ¡</strong>è°ƒåº¦ä¸º<strong><em>å•ä¸ªå‰¯æœ¬çš„æœåŠ¡</em></strong>ã€‚è¯·æ³¨æ„ï¼ŒDocker API ä»£ç†æœåŠ¡éœ€è¦è°ƒåº¦åœ¨ç®¡ç†å™¨èŠ‚ç‚¹ä¸Šï¼Œé™¤éæ‚¨å°†å…¶é…ç½®ä¸ºä½¿ç”¨è¿œç¨‹ APIï¼ˆè¿™ä¸åœ¨æ–‡æ¡£çš„è®¨è®ºèŒƒå›´å†…ï¼‰ã€‚</p>
<p>ç”±äºè¿è¡Œç€å¤šä¸ª BunkerWeb å®ä¾‹ï¼Œå¿…é¡»åˆ›å»ºä¸€ä¸ªå…±äº«æ•°æ®å­˜å‚¨ï¼Œå®ç°ä¸º <a href="https://redis.io/">Redis</a> æˆ– <a href="https://valkey.io/">Valkey</a> æœåŠ¡ã€‚è¿™äº›å®ä¾‹å°†åˆ©ç”¨ Redis/Valkey æœåŠ¡æ¥ç¼“å­˜å’Œå…±äº«æ•°æ®ã€‚æœ‰å…³ Redis/Valkey è®¾ç½®çš„æ›´å¤šè¯¦ç»†ä¿¡æ¯ï¼Œè¯·å‚è§<a href="../features/#redis">æ­¤å¤„</a>ã€‚</p>
<p>è‡³äºæ•°æ®åº“å·ï¼Œæ–‡æ¡£å¹¶æœªæŒ‡å®šå…·ä½“çš„æ–¹æ³•ã€‚ä¸ºæ•°æ®åº“å·é€‰æ‹©å…±äº«æ–‡ä»¶å¤¹æˆ–ç‰¹å®šé©±åŠ¨ç¨‹åºå–å†³äºæ‚¨çš„ç‹¬ç‰¹ç”¨ä¾‹ï¼Œç•™ç»™è¯»è€…è‡ªè¡Œå†³å®šã€‚</p>
<div class="admonition info">
<p class="admonition-title">æ•°æ®åº“åç«¯</p>
<p>è¯·æ³¨æ„ï¼Œæˆ‘ä»¬çš„è¯´æ˜å‡è®¾æ‚¨æ­£åœ¨ä½¿ç”¨ MariaDB ä½œä¸ºé»˜è®¤çš„æ•°æ®åº“åç«¯ï¼Œè¿™æ˜¯ç”± <code>DATABASE_URI</code> è®¾ç½®é…ç½®çš„ã€‚ä½†æ˜¯ï¼Œæˆ‘ä»¬ç†è§£æ‚¨å¯èƒ½æ›´å–œæ¬¢ä¸ºæ‚¨çš„ Docker é›†æˆä½¿ç”¨å…¶ä»–åç«¯ã€‚å¦‚æœæ˜¯è¿™æ ·ï¼Œè¯·æ”¾å¿ƒï¼Œå…¶ä»–æ•°æ®åº“åç«¯ä»ç„¶æ˜¯å¯è¡Œçš„ã€‚æœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…ä»“åº“çš„ <a href="https://github.com/bunkerity/bunkerweb/tree/vtesting/misc/integrations">misc/integrations æ–‡ä»¶å¤¹</a>ä¸­çš„ docker-compose æ–‡ä»¶ã€‚</p>
<p>é›†ç¾¤æ•°æ®åº“åç«¯çš„è®¾ç½®è¶…å‡ºäº†æœ¬æ–‡æ¡£çš„èŒƒå›´ã€‚</p>
</div>
<p>è¿™æ˜¯æ‚¨å¯ä»¥ä½¿ç”¨ <code>docker stack deploy</code> éƒ¨ç½²çš„å †æ ˆæ ·æ¿ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># æˆ‘ä»¬ä½¿ç”¨ä¸€ä¸ªé”šç‚¹æ¥é¿å…åœ¨ä¸¤ä¸ªæœåŠ¡ä¸­é‡å¤ç›¸åŒçš„è®¾ç½®</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># autoconf æœåŠ¡è¯†åˆ« BunkerWeb å®ä¾‹çš„å¼ºåˆ¶æ€§æ ‡ç­¾</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># æˆ‘ä»¬ä¸éœ€è¦åœ¨è¿™é‡ŒæŒ‡å®š BunkerWeb å®ä¾‹ï¼Œå› ä¸ºå®ƒä»¬ç”± autoconf æœåŠ¡è‡ªåŠ¨æ£€æµ‹</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># æœåŠ¡å™¨åç§°å°†ç”±æœåŠ¡æ ‡ç­¾å¡«å……</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># autoconf çš„å¼ºåˆ¶æ€§è®¾ç½®</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># è®°å¾—ä¸ºæ•°æ®åº“è®¾ç½®ä¸€ä¸ªæ›´å¼ºçš„å¯†ç </span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># ç”¨äºæŒä¹…åŒ–ç¼“å­˜å’Œå¤‡ä»½ç­‰å…¶ä»–æ•°æ®</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># è®°å¾—ä¸ºæ•°æ®åº“è®¾ç½®ä¸€ä¸ªæ›´å¼ºçš„å¯†ç </span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># Docker å¥—æ¥å­—</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># æˆ‘ä»¬è®¾ç½®äº†æœ€å¤§å…è®¸çš„æ•°æ®åŒ…å¤§å°ä»¥é¿å…å¤§æŸ¥è¯¢çš„é—®é¢˜</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># è®°å¾—ä¸ºæ•°æ®åº“è®¾ç½®ä¸€ä¸ªæ›´å¼ºçš„å¯†ç </span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Swarm å¼ºåˆ¶è®¾ç½®</p>
<p>è¯·æ³¨æ„ï¼Œåœ¨ä½¿ç”¨ Swarm é›†æˆæ—¶ï¼Œ<code>SWARM_MODE: "yes"</code> ç¯å¢ƒå˜é‡æ˜¯å¼ºåˆ¶æ€§çš„ã€‚</p>
</div>
<h3 id="swarm_1">Swarm æœåŠ¡</h3>
<p>ä¸€æ—¦ BunkerWeb Swarm å †æ ˆè®¾ç½®å¹¶è¿è¡Œï¼ˆæœ‰å…³æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜… autoconf å’Œ scheduler æ—¥å¿—ï¼‰ï¼Œæ‚¨å°†èƒ½å¤Ÿåœ¨è¯¥é›†ç¾¤ä¸­éƒ¨ç½² Web åº”ç”¨ç¨‹åºï¼Œå¹¶ä½¿ç”¨æ ‡ç­¾æ¥åŠ¨æ€é…ç½® BunkerWebï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="namespaces_2">å‘½åç©ºé—´</h3>
<p>ä» <code>1.6.0</code> ç‰ˆæœ¬å¼€å§‹ï¼ŒBunkerWeb çš„è‡ªåŠ¨é…ç½®å †æ ˆç°åœ¨æ”¯æŒå‘½åç©ºé—´ã€‚æ­¤åŠŸèƒ½ä½¿æ‚¨èƒ½å¤Ÿåœ¨åŒä¸€ä¸ª Docker ä¸»æœºä¸Šç®¡ç†å¤šä¸ª BunkerWeb å®ä¾‹å’ŒæœåŠ¡çš„â€œ<em>é›†ç¾¤</em>â€ã€‚è¦åˆ©ç”¨å‘½åç©ºé—´ï¼Œåªéœ€åœ¨æ‚¨çš„æœåŠ¡ä¸Šè®¾ç½® <code>NAMESPACE</code> æ ‡ç­¾ã€‚è¿™æ˜¯ä¸€ä¸ªç¤ºä¾‹ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># ä¸ºæœåŠ¡è®¾ç½®å‘½åç©ºé—´</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">å‘½åç©ºé—´è¡Œä¸º</p>
<p>é»˜è®¤æƒ…å†µä¸‹ï¼Œæ‰€æœ‰è‡ªåŠ¨é…ç½®å †æ ˆéƒ½ç›‘å¬æ‰€æœ‰å‘½åç©ºé—´ã€‚å¦‚æœæ‚¨æƒ³å°†ä¸€ä¸ªå †æ ˆé™åˆ¶åœ¨ç‰¹å®šçš„å‘½åç©ºé—´ï¼Œå¯ä»¥åœ¨ <code>bw-autoconf</code> æœåŠ¡ä¸­è®¾ç½® <code>NAMESPACES</code> ç¯å¢ƒå˜é‡ï¼š</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:testing</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># ä¸º BunkerWeb å®ä¾‹è®¾ç½®å‘½åç©ºé—´</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:testing</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">NAMESPACES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># åªç›‘å¬è¿™äº›å‘½åç©ºé—´</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="nn">...</span>
</code></pre></div>
<p>è¯·è®°ä½ï¼Œ<code>NAMESPACES</code> ç¯å¢ƒå˜é‡æ˜¯ä¸€ä¸ªä»¥ç©ºæ ¼åˆ†éš”çš„å‘½åç©ºé—´åˆ—è¡¨ã€‚</p>
</div>
<div class="admonition warning">
<p class="admonition-title">å‘½åç©ºé—´è§„èŒƒ</p>
<p>æ¯ä¸ªå‘½åç©ºé—´åªèƒ½æœ‰<strong>ä¸€ä¸ªæ•°æ®åº“</strong>å’Œ<strong>ä¸€ä¸ªè°ƒåº¦å™¨</strong>ã€‚å¦‚æœæ‚¨å°è¯•åœ¨åŒä¸€ä¸ªå‘½åç©ºé—´ä¸­åˆ›å»ºå¤šä¸ªæ•°æ®åº“æˆ–è°ƒåº¦å™¨ï¼Œé…ç½®æœ€ç»ˆä¼šç›¸äº’å†²çªã€‚</p>
<p>è°ƒåº¦å™¨ä¸éœ€è¦ <code>NAMESPACE</code> æ ‡ç­¾å³å¯æ­£å¸¸å·¥ä½œã€‚å®ƒåªéœ€è¦æ­£ç¡®é…ç½® <code>DATABASE_URI</code> è®¾ç½®ï¼Œä»¥ä¾¿å®ƒå¯ä»¥è®¿é—®ä¸è‡ªåŠ¨é…ç½®æœåŠ¡ç›¸åŒçš„æ•°æ®åº“ã€‚</p>
</div>
<h2 id="microsoft-azure">Microsoft Azure</h2>
<figure>
<p><img align="center," alt="æ¦‚è¿°" src="../../assets/img/integration-azure.webp" width="600" />
  </p>
<figcaption>Azure é›†æˆ</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">æ¨èçš„è™šæ‹Ÿæœºå¤§å°</p>
<p>è¯·åœ¨é€‰æ‹©è™šæ‹Ÿæœºçš„ SKU æ—¶æ³¨æ„ã€‚æ‚¨å¿…é¡»é€‰æ‹©ä¸ Gen2 è™šæ‹Ÿæœºå…¼å®¹çš„ SKUï¼Œæˆ‘ä»¬å»ºè®®ä» B2s æˆ– Ds2 ç³»åˆ—å¼€å§‹ä»¥è·å¾—æœ€ä½³ä½¿ç”¨æ•ˆæœã€‚</p>
</div>
<p>æ‚¨å¯ä»¥è½»æ¾åœ°é€šè¿‡å¤šç§æ–¹å¼åœ¨æ‚¨çš„ Azure è®¢é˜…ä¸Šéƒ¨ç½² BunkerWebï¼š</p>
<ul>
<li>Cloud Shell ä¸­çš„ Azure CLI</li>
<li>Azure ARM æ¨¡æ¿</li>
<li>é€šè¿‡ Marketplace çš„ Azure é—¨æˆ·</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Cloud Shell</label><label for="__tabbed_2_2">ARM æ¨¡æ¿</label><label for="__tabbed_2_3">Marketplace</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>åˆ›å»ºä¸€ä¸ªèµ„æºç»„ã€‚æ›¿æ¢å€¼ <code>RG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span>
</code></pre></div>
<p>åœ¨èµ„æºç»„çš„ä½ç½®åˆ›å»ºä¸€ä¸ª <code>Standard_B2s</code> SKU çš„è™šæ‹Ÿæœºã€‚æ›¿æ¢å€¼ <code>RG_NAME</code>, <code>VM_NAME</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span>
</code></pre></div>
<p>å®Œæ•´å‘½ä»¤ã€‚æ›¿æ¢å€¼ <code>RG_NAME</code>, <code>VM_NAME</code>, <code>LOCATION</code>, <code>HOSTNAME</code>, <code>USERNAME</code>, <code>PUBLIC_IP</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code>, <code>NSG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--computer-name<span class="w"> </span><span class="s2">&quot;HOSTNAME&quot;</span><span class="w"> </span>--admin-username<span class="w"> </span><span class="s2">&quot;USERNAME&quot;</span><span class="w"> </span>--public-ip-address<span class="w"> </span><span class="s2">&quot;PUBLIC_IP&quot;</span><span class="w"> </span>--public-ip-address-allocation<span class="w"> </span>Static<span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--public-ip-sku<span class="w"> </span>Standard<span class="w"> </span>--os-disk-delete-option<span class="w"> </span>Delete<span class="w"> </span>--nic-delete-option<span class="w"> </span>Delete<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span><span class="w"> </span>--nsg<span class="w"> </span><span class="s2">&quot;NSG_NAME&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">æƒé™è¦æ±‚</p>
<p>è¦éƒ¨ç½² ARM æ¨¡æ¿ï¼Œæ‚¨éœ€è¦å¯¹æ‚¨æ­£åœ¨éƒ¨ç½²çš„èµ„æºå…·æœ‰å†™å…¥æƒé™ï¼Œå¹¶æœ‰æƒè®¿é—® Microsoft.Resources/deployments èµ„æºç±»å‹çš„æ‰€æœ‰æ“ä½œã€‚
è¦éƒ¨ç½²è™šæ‹Ÿæœºï¼Œæ‚¨éœ€è¦ Microsoft.Compute/virtualMachines/write å’Œ Microsoft.Resources/deployments/* æƒé™ã€‚what-if æ“ä½œå…·æœ‰ç›¸åŒçš„æƒé™è¦æ±‚ã€‚</p>
</div>
<p>éƒ¨ç½² ARM æ¨¡æ¿ï¼š</p>
<p><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fbunkerity%2Fbunkerweb%2Fmaster%2Fmisc%2Fintegrations%2Fazure-arm-template.json" target="_blank"><img alt="éƒ¨ç½²åˆ° Azure" src="../../assets/img/integration-azure-deploy.svg" /></a></p>
</div>
<div class="tabbed-block">
<p>ç™»å½•åˆ° <a href="https://portal.azure.com" target="_blank">Azure é—¨æˆ·</a>ã€‚</p>
<p>ä»<a href="https://portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/bunkerity.bunkerweb" target="_blank">åˆ›å»ºèµ„æºèœå•</a>è·å– BunkerWebã€‚</p>
<p>æ‚¨ä¹Ÿå¯ä»¥é€šè¿‡ <a href="https://azuremarketplace.microsoft.com/fr-fr/marketplace/apps/bunkerity.bunkerweb?tab=Overview" target="_blank">Marketplace</a>ã€‚</p>
</div>
</div>
</div>
<p>æ‚¨å¯ä»¥é€šè¿‡æµè§ˆè™šæ‹Ÿæœºçš„ <code>https://your-ip-address/setup</code> URI æ¥è®¿é—®è®¾ç½®å‘å¯¼ã€‚</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; <script>document.write(new Date().getFullYear())</script> Bunkerity
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://discord.com/invite/fTf46FmtyD" target="_blank" rel="noopener" title="discord.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/bunkerity" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/bunkerity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.reddit.com/r/BunkerWeb/" target="_blank" rel="noopener" title="www.reddit.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/bunkerweb/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M224.3 141a115 115 0 1 0-.6 230 115 115 0 1 0 .6-230m-.6 40.4a74.6 74.6 0 1 1 .6 149.2 74.6 74.6 0 1 1-.6-149.2m93.4-45.1a26.8 26.8 0 1 1 53.6 0 26.8 26.8 0 1 1-53.6 0m129.7 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M399 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bunkerity" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "\u5df2\u590d\u5236", "clipboard.copy": "\u590d\u5236", "search.result.more.one": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.more.other": "\u5728\u8be5\u9875\u4e0a\u8fd8\u6709 # \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.none": "\u6ca1\u6709\u627e\u5230\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.one": "\u627e\u5230 1 \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.other": "# \u4e2a\u7b26\u5408\u6761\u4ef6\u7684\u7ed3\u679c", "search.result.placeholder": "\u952e\u5165\u4ee5\u5f00\u59cb\u641c\u7d22", "search.result.term.missing": "\u7f3a\u5c11", "select.version": "\u9009\u62e9\u5f53\u524d\u7248\u672c"}, "version": {"provider": "mike", "version": "latest"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../assets/extra.js"></script>
      
        <script src="https://chatbot.bunkerweb.io/static/js/chatbot.js"></script>
      
        <script src="../../assets/preserve-version-on-language-switch.js"></script>
      
        <script src="../../assets/toc-dropdown.js"></script>
      
    
  </body>
</html>