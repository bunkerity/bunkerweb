国家/地区插件为您的网站启用地理封锁功能，允许您根据访问者的地理位置限制访问。此功能可帮助您遵守区域法规、防止通常与高风险地区相关的欺诈活动，并根据地理边界实施内容限制。

**工作原理：**

1.  当访问者访问您的网站时，BunkerWeb 会根据他们的 IP 地址确定他们的国家/地区。
2.  您的配置指定了白名单（允许的国家/地区）或黑名单（被阻止的国家/地区）。
3.  如果您设置了白名单，只有来自该列表中国家/地区的访问者才会被授予访问权限。
4.  如果您设置了黑名单，来自该列表中国家/地区的访问者将被拒绝访问。
5.  结果会被缓存，以提高来自同一 IP 地址的重复访问者的性能。

### 如何使用

请按照以下步骤配置和使用国家/地区功能：

1.  **定义您的策略：** 决定您是想使用白名单方法（仅允许特定国家/地区）还是黑名单方法（阻止特定国家/地区）。
2.  **配置国家/地区代码：** 将 ISO 3166-1 alpha-2 国家/地区代码（例如 US、GB、FR 等两位字母代码）添加到 `WHITELIST_COUNTRY` 或 `BLACKLIST_COUNTRY` 设置中。
3.  **应用设置：** 配置完成后，基于国家/地区的限制将适用于您网站的所有访问者。
4.  **监控有效性：** 查看 [web UI](web-ui.md) 以查看按国家/地区阻止的请求统计信息。

### 配置设置

| 设置                | 默认值 | 上下文    | 多个 | 描述                                                                                                    |
| ------------------- | ------ | --------- | ---- | ------------------------------------------------------------------------------------------------------- |
| `WHITELIST_COUNTRY` |        | multisite | 否   | **国家/地区白名单：** 以空格分隔的国家/地区代码（ISO 3166-1 alpha-2 格式）列表。只允许这些国家/地区。   |
| `BLACKLIST_COUNTRY` |        | multisite | 否   | **国家/地区黑名单：** 以空格分隔的国家/地区代码（ISO 3166-1 alpha-2 格式）列表。这些国家/地区将被阻止。 |

!!! tip "白名单与黑名单"
    选择最适合您需求的方法：

    - 当您想将访问限制在少数几个国家/地区时，请使用白名单。
    - 当您想阻止来自特定问题地区的访问，同时允许其他所有地区时，请使用黑名单。

!!! warning "优先规则"
    如果同时配置了白名单和黑名单，则白名单优先。这意味着系统首先检查一个国家/地区是否在白名单中；如果不在，无论黑名单配置如何，访问都将被拒绝。

!!! info "国家/地区检测"
    BunkerWeb 使用 [lite db-ip mmdb 数据库](https://db-ip.com/db/download/ip-to-country-lite)根据 IP 地址确定来源国家/地区。

### 示例配置

=== "仅白名单"

    仅允许来自美国、加拿大和英国的访问：

    ```yaml
    WHITELIST_COUNTRY: "US CA GB"
    ```

=== "仅黑名单"

    阻止来自特定国家/地区的访问，同时允许所有其他国家/地区：

    ```yaml
    BLACKLIST_COUNTRY: "RU CN KP"
    ```

=== "仅限欧盟访问"

    仅允许来自欧盟成员国的访问：

    ```yaml
    WHITELIST_COUNTRY: "AT BE BG HR CY CZ DK EE FI FR DE GR HU IE IT LV LT LU MT NL PL PT RO SK SI ES SE"
    ```

=== "高风险国家/地区被阻止"

    阻止来自通常与某些网络威胁相关的国家/地区的访问：

    ```yaml
    BLACKLIST_COUNTRY: "RU CN KP IR SY"
    ```
