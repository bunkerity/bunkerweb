
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Make your web services secure by default.">
      
      
      
        <link rel="canonical" href="https://docs.bunkerweb.io/1.4/security-tuning/">
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.2.3, mkdocs-material-8.2.5">
    
    
      
        <title>Security tuning - BunkerWeb</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.2d9f7617.min.css">
      
        
        <link rel="stylesheet" href="../assets/stylesheets/palette.e6a45f82.min.css">
        
      
    
    
<script
  async
  defer
  data-domain="docs.bunkerweb.io"
  src="https://data.bunkerity.com/js/script.js"
></script>

    
      
    
    
      <link rel="stylesheet" href="../assets/extra.css">
    
    <script>__md_scope=new URL("..",location),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    
    
    
    
    
    <body dir="ltr" data-md-color-scheme="" data-md-color-primary="none" data-md-color-accent="none">
  
    
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#security-tuning" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
             ðŸ“¢ Looking for tailored support, consulting or
development for BunkerWeb ? Contact us at
<a
  href="mailto:contact@bunkerity.com"
  style="color: #3f6ec6; text-decoration: underline"
  >contact@bunkerity.com</a
>
for enterprise offers ! 
          </div>
        </aside>
      
    </div>
    
      <div data-md-component="outdated" hidden>
        <aside class="md-banner md-banner--warning">
          
            <div class="md-banner__inner md-grid md-typeset">
               You're not viewing the
documentation for the current version.
<a href="../.."><strong>Click here to change.</strong></a> 
            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),outdated=__md_get("__outdated",sessionStorage);!0===outdated&&el&&(el.hidden=!1)</script>
          
        </aside>
      </div>
    
    
      

  

<header class="md-header md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="BunkerWeb" class="md-header__button md-logo" aria-label="BunkerWeb" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BunkerWeb
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Security tuning
            
          </span>
        </div>
      </div>
    </div>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5z"/></svg>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" aria-label="Clear" tabindex="-1">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/bunkerity/bunkerweb/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-tabs__inner md-grid">
    <ul class="md-tabs__list">
      
        
  
  


  <li class="md-tabs__item">
    <a href=".." class="md-tabs__link">
      Introduction
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../migrating/" class="md-tabs__link">
      Migrating from bunkerized
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../concepts/" class="md-tabs__link">
      Concepts
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../integrations/" class="md-tabs__link">
      Integrations
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../quickstart-guide/" class="md-tabs__link">
      Quickstart guide
    </a>
  </li>

      
        
  
  
    
  


  <li class="md-tabs__item">
    <a href="./" class="md-tabs__link md-tabs__link--active">
      Security tuning
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../settings/" class="md-tabs__link">
      Settings
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../web-ui/" class="md-tabs__link">
      Web UI
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../troubleshooting/" class="md-tabs__link">
      Troubleshooting
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../plugins/" class="md-tabs__link">
      Plugins
    </a>
  </li>

      
        
  
  


  <li class="md-tabs__item">
    <a href="../about/" class="md-tabs__link">
      About
    </a>
  </li>

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="BunkerWeb" class="md-nav__button md-logo" aria-label="BunkerWeb" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    BunkerWeb
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bunkerity/bunkerweb/" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        Introduction
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../migrating/" class="md-nav__link">
        Migrating from bunkerized
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        Concepts
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        Integrations
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-guide/" class="md-nav__link">
        Quickstart guide
      </a>
    </li>
  

    
      
      
      

  
  
    
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" data-md-toggle="toc" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          Security tuning
          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        Security tuning
      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#http-protocol" class="md-nav__link">
    HTTP protocol
  </a>
  
    <nav class="md-nav" aria-label="HTTP protocol">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#default-server" class="md-nav__link">
    Default server
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#allowed-methods" class="md-nav__link">
    Allowed methods
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#max-sizes" class="md-nav__link">
    Max sizes
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#serve-files" class="md-nav__link">
    Serve files
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#headers" class="md-nav__link">
    Headers
  </a>
  
    <nav class="md-nav" aria-label="Headers">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#remove-headers" class="md-nav__link">
    Remove headers
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#cookies" class="md-nav__link">
    Cookies
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#security-headers" class="md-nav__link">
    Security headers
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#https" class="md-nav__link">
    HTTPS
  </a>
  
    <nav class="md-nav" aria-label="HTTPS">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#lets-encrypt" class="md-nav__link">
    Let's Encrypt
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#custom-certificate" class="md-nav__link">
    Custom certificate
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#self-signed" class="md-nav__link">
    Self-signed
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#modsecurity" class="md-nav__link">
    ModSecurity
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bad-behavior" class="md-nav__link">
    Bad behavior
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#antibot" class="md-nav__link">
    Antibot
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#blacklisting-and-whitelisting" class="md-nav__link">
    Blacklisting and whitelisting
  </a>
  
    <nav class="md-nav" aria-label="Blacklisting and whitelisting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#blacklisting" class="md-nav__link">
    Blacklisting
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#whitelisting" class="md-nav__link">
    Whitelisting
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#bunkernet" class="md-nav__link">
    BunkerNet
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#dnsbl" class="md-nav__link">
    DNSBL
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#limiting" class="md-nav__link">
    Limiting
  </a>
  
    <nav class="md-nav" aria-label="Limiting">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#connections" class="md-nav__link">
    Connections
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#requests" class="md-nav__link">
    Requests
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#country" class="md-nav__link">
    Country
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#authentication" class="md-nav__link">
    Authentication
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../settings/" class="md-nav__link">
        Settings
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../web-ui/" class="md-nav__link">
        Web UI
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        Troubleshooting
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        Plugins
      </a>
    </li>
  

    
      
      
      

  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        About
      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          <div class="md-content" data-md-component="content">
            <article class="md-content__inner md-typeset">
              
                
<a href="https://github.com/bunkerity/bunkerweb/edit/master/docs/security-tuning.md" title="Edit this page" class="md-content__button md-icon">
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75L3 17.25z"/></svg>
</a>



<h1 id="security-tuning">Security tuning</h1>
<p>BunkerWeb offers many security features that you can configure with <a href="/1.4/settings">settings</a>. Even if the default values of settings ensure a minimal "security by default", we strongly recommend you to tune them. By doing so you will be able to ensure a security level of your choice but also manage false positives.</p>
<div class="admonition tip">
<p class="admonition-title">Other settings</p>
<p>This section only focuses on security tuning, see the <a href="/1.4/settings">settings section</a> of the documentation for other settings.</p>
</div>
<h2 id="http-protocol">HTTP protocol</h2>
<h3 id="default-server">Default server</h3>
<p>In the HTTP protocol, the Host header is used to determine which server the client wants to send the request to. That header is facultative and may be missing from the request or can be set as an unknown value. This is a common case, a lot of bots are scanning the Internet and are trying to exploit services or simply doing some fingerprinting.</p>
<p>You can disable any request containing undefined or unknown Host value by setting <code>DISABLE_DEFAULT_SERVER</code> to <code>yes</code> (default : <code>no</code>). Please note that clients won't even receive a response, the TCP connection will be closed (using the special 444 status code of NGINX).</p>
<h3 id="allowed-methods">Allowed methods</h3>
<p>You can control the allowed HTTP methods by listing them (separated with "|") in the <code>ALLOWED_METHODS</code> setting (default : <code>GET|POST|HEAD</code>). Clients sending a method which is not listed will get a "405 - Method Not Allowed".</p>
<h3 id="max-sizes">Max sizes</h3>
<p>You can control the maximum body size with the <code>MAX_CLIENT_SIZE</code> setting (default : <code>10m</code>). See <a href="https://nginx.org/en/docs/syntax.html">here</a> for accepted values. You can use the special value <code>0</code> to allow a body of infinite size (not recommended).</p>
<h3 id="serve-files">Serve files</h3>
<p>To disable serving files from the www folder, you can set <code>SERVE_FILES</code> to <code>no</code> (default : <code>yes</code>). The value <code>no</code> is recommended if you use BunkerWeb as a reverse proxy.</p>
<h3 id="headers">Headers</h3>
<p>Headers are very important when it comes to HTTP security. Not only some of them are too verbose but others can add some security, especially on the client-side.</p>
<h4 id="remove-headers">Remove headers</h4>
<p>You can automatically remove verbose headers in the HTTP responses by using the <code>REMOVE_HEADERS</code> setting (default : <code>Server X-Powered-By X-AspNet-Version X-AspNetMvc-Version</code>).</p>
<h4 id="cookies">Cookies</h4>
<p>When it comes to cookies security, we can use the following flags :</p>
<ul>
<li>HttpOnly : disable any access to the cookie from Javascript using document.cookie</li>
<li>SameSite : policy when requests come from third-party websites</li>
<li>Secure : only send cookies on HTTPS request</li>
</ul>
<p>Cookie flags can be overridden with values of your choice by using the <code>COOKIE_FLAGS</code> setting (default : <code>* HttpOnly SameSite=Lax</code>). See <a href="https://github.com/AirisX/nginx_cookie_flag_module">here</a> for accepted values.</p>
<p>The Secure flag can be automatically added if HTTPS is used by using the <code>COOKIE_AUTO_SECURE_FLAG</code> setting (default : <code>yes</code>). The value <code>no</code> is not recommended unless you know what you're doing.</p>
<h4 id="security-headers">Security headers</h4>
<p>Various security headers are available and most of them can be set using BunkerWeb settings. Here is the list of headers, the corresponding setting and default value :</p>
<table>
<thead>
<tr>
<th align="center">Header</th>
<th align="left">Setting</th>
<th align="center">Default</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>Content-Security-Policy</code></td>
<td align="left"><code>CONTENT_SECURITY_POLICY</code></td>
<td align="center"><code>object-src 'none'; frame-src 'self'; child-src 'self'; form-action 'self'; frame-ancestors 'self';</code></td>
</tr>
<tr>
<td align="center"><code>Strict-Transport-Security</code></td>
<td align="left"><code>STRICT_TRANSPORT_SECURITY</code></td>
<td align="center"><code>max-age=31536000</code></td>
</tr>
<tr>
<td align="center"><code>Referrer-Policy</code></td>
<td align="left"><code>REFERRER_POLICY</code></td>
<td align="center"><code>strict-origin-when-cross-origin</code></td>
</tr>
<tr>
<td align="center"><code>Permissions-Policy</code></td>
<td align="left"><code>PERMISSIONS_POLICY</code></td>
<td align="center"><code>accelerometer=(), ambient-light-sensor=(), autoplay=(), battery=(), camera=(), cross-origin-isolated=(), display-capture=(), document-domain=(), encrypted-media=(), execution-while-not-rendered=(), execution-while-out-of-viewport=(), fullscreen=(), geolocation=(), gyroscope=(), hid=(), idle-detection=(), magnetometer=(), microphone=(), midi=(), navigation-override=(), payment=(), picture-in-picture=(), publickey-credentials-get=(), screen-wake-lock=(), serial=(), usb=(), web-share=(), xr-spatial-tracking=()</code></td>
</tr>
<tr>
<td align="center"><code>Feature-Policy</code></td>
<td align="left"><code>FEATURE_POLICY</code></td>
<td align="center"><code>accelerometer 'none'; ambient-light-sensor 'none'; autoplay 'none'; battery 'none'; camera 'none'; display-capture 'none'; document-domain 'none'; encrypted-media 'none'; execution-while-not-rendered 'none'; execution-while-out-of-viewport 'none'; fullscreen 'none'; 'none'; geolocation 'none'; gyroscope 'none'; layout-animation 'none'; legacy-image-formats 'none'; magnetometer 'none'; microphone 'none'; midi 'none'; navigation-override 'none'; payment 'none'; picture-in-picture 'none'; publickey-credentials-get 'none'; speaker-selection 'none'; sync-xhr 'none'; unoptimized-images 'none'; unsized-media 'none'; usb 'none'; screen-wake-lock 'none'; web-share 'none'; xr-spatial-tracking 'none';</code></td>
</tr>
<tr>
<td align="center"><code>X-Frame-Options</code></td>
<td align="left"><code>X_FRAME_OPTIONS</code></td>
<td align="center"><code>SAMEORIGIN</code></td>
</tr>
<tr>
<td align="center"><code>X-Content-Type-Options</code></td>
<td align="left"><code>X_CONTENT_TYPE_OPTIONS</code></td>
<td align="center"><code>nosniff</code></td>
</tr>
<tr>
<td align="center"><code>X-XSS-Protection</code></td>
<td align="left"><code>X_XSS_PROTECTION</code></td>
<td align="center"><code>1; mode=block</code></td>
</tr>
</tbody>
</table>
<h2 id="https">HTTPS</h2>
<p>Besides the HTTPS configuration, the following settings related to HTTPS can be set :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>REDIRECT_HTTP_TO_HTTPS</code></td>
<td align="center"><code>no</code></td>
<td align="left">When set to <code>yes</code>, will redirect every HTTP request to HTTPS even if BunkerWeb is not configured with HTTPS.</td>
</tr>
<tr>
<td align="center"><code>AUTO_REDIRECT_HTTP_TO_HTTPS</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, will redirect every HTTP request to HTTPS only if BunkerWeb is configured with HTTPS.</td>
</tr>
<tr>
<td align="center"><code>HTTPS_PROTOCOLS</code></td>
<td align="center"><code>TLSv1.2 TLSv1.3</code></td>
<td align="left">List of supported SSL/TLS protocols when HTTPS is enabled.</td>
</tr>
<tr>
<td align="center"><code>HTTP2</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, will enable HTTP2 protocol support when using HTTPS.</td>
</tr>
<tr>
<td align="center"><code>LISTEN_HTTP</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>no</code>, BunkerWeb will not listen for HTTP requests. Useful if you want HTTPS only for example.</td>
</tr>
</tbody>
</table>
<h3 id="lets-encrypt">Let's Encrypt</h3>
<p>BunkerWeb comes with automatic Let's Encrypt certificate generation and renewal. This is the easiest way of getting HTTPS working out of the box for public-facing web applications. Please note that you will need to set up proper DNS A record(s) for each of your domains pointing to your public IP(s) where BunkerWeb is accessible.</p>
<p>Here is the list of related settings :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>AUTO_LETS_ENCRYPT</code></td>
<td align="center"><code>no</code></td>
<td align="left">When set to <code>yes</code>, HTTPS will be enabled with automatic certificate generation and renewal from Let's Encrypt.</td>
</tr>
<tr>
<td align="center"><code>EMAIL_LETS_ENCRYPT</code></td>
<td align="center"><code>contact@{FIRST_SERVER}</code></td>
<td align="left">Email to use when generating certificates. Let's Encrypt will send notifications to that email like certificate expiration.</td>
</tr>
<tr>
<td align="center"><code>USE_LETS_ENCRYPT_STAGING</code></td>
<td align="center"><code>no</code></td>
<td align="left">When set to <code>yes</code>, the staging server of Let's Encrypt will be used instead of the production one. Useful when doing tests to avoid being "blocked" due to limits.</td>
</tr>
</tbody>
</table>
<h3 id="custom-certificate">Custom certificate</h3>
<p>If you want to use your own certificates, here is the list of related settings :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_CUSTOM_HTTPS</code></td>
<td align="center"><code>no</code></td>
<td align="left">When set to <code>yes</code>, HTTPS will be enabled with custom certificates.</td>
</tr>
<tr>
<td align="center"><code>CUSTOM_HTTPS_CERT</code></td>
<td align="center"></td>
<td align="left">Full path to the certificate. If you have one or more intermediate certificate(s) in your chain of trust, you will need to provide the bundle (more info <a href="https://nginx.org/en/docs/http/configuring_https_servers.html#chains">here</a>).</td>
</tr>
<tr>
<td align="center"><code>CUSTOM_HTTPS_KEY</code></td>
<td align="center"></td>
<td align="left">Full path to the private key.</td>
</tr>
</tbody>
</table>
<p>When <code>USE_CUSTOM_HTTPS</code> is set to <code>yes</code>, BunkerWeb will check every day if the custom certificate specified in <code>CUSTOM_HTTPS_CERT</code> is modified and will reload NGINX if that's the case.</p>
<h3 id="self-signed">Self-signed</h3>
<p>If you want to quickly test HTTPS for staging/dev environment you can configure BunkerWeb to generate self-signed certificates, here is the list of related</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>GENERATE_SELF_SIGNED_SSL</code></td>
<td align="center"><code>no</code></td>
<td align="left">When set to <code>yes</code>, HTTPS will be enabled with automatic self-signed certificate generation and renewal from Let's Encrypt.</td>
</tr>
<tr>
<td align="center"><code>SELF_SIGNED_SSL_EXPIRY</code></td>
<td align="center"><code>365</code></td>
<td align="left">Number of days for the certificate expiration (<strong>-days</strong> value used with <strong>openssl</strong>).</td>
</tr>
<tr>
<td align="center"><code>SELF_SIGNED_SSL_SUBJ</code></td>
<td align="center"><code>/CN=www.example.com/</code></td>
<td align="left">Certificate subject to use (<strong>-subj</strong> value used with <strong>openssl</strong>).</td>
</tr>
</tbody>
</table>
<h2 id="modsecurity">ModSecurity</h2>
<p>ModSecurity is integrated and enabled by default alongside the OWASP Core Rule Set within BunkerWeb. Here is the list of related settings :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_MODSECURITY</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, ModSecurity will be enabled.</td>
</tr>
<tr>
<td align="center"><code>USE_MODSECURITY_CRS</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code> and <code>USE_MODSECURITY</code> is also set to <code>yes</code>, the OWASP Core Rule Set will be loaded.</td>
</tr>
</tbody>
</table>
<p>We strongly recommend keeping both ModSecurity and the OWASP Core Rule Set enabled. The only downsides are the false positives that may occur. But they can be fixed with some efforts and the CRS team maintains a list of exclusions for common applications (e.g., WordPress, Nextcloud, Drupal, Cpanel, ...).</p>
<p>Tuning ModSecurity and the CRS can be done using <a href="/1.4/quickstart-guide/#custom-configurations">custom configurations</a> :</p>
<ul>
<li>modsec-crs : before the OWASP Core Rule Set is loaded</li>
<li>modsec : after the OWASP Core Rule Set is loaded (also used if CRS is not loaded)</li>
</ul>
<p>For example, you can add a custom configuration with type <code>modsec-crs</code> to add CRS exclusions :</p>
<p><code>conf
SecAction \
 "id:900130,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.crs_exclusions_wordpress=1"</code></p>
<p>You can also add a custom configuration with type <code>modsec</code> to update loaded CRS rules :</p>
<p><code>conf
SecRule REQUEST_FILENAME "/wp-admin/admin-ajax.php" "id:1,ctl:ruleRemoveByTag=attack-xss,ctl:ruleRemoveByTag=attack-rce"
SecRule REQUEST_FILENAME "/wp-admin/options.php" "id:2,ctl:ruleRemoveByTag=attack-xss"
SecRule REQUEST_FILENAME "^/wp-json/yoast" "id:3,ctl:ruleRemoveById=930120"</code></p>
<h2 id="bad-behavior">Bad behavior</h2>
<p>When attackers search for and/or exploit vulnerabilities they might generate some "suspicious" HTTP status codes that a "regular" user wonâ€™t generate within a period of time. If we detect that kind of behavior we can ban the offending IP address and force the attacker to come up with a new one.</p>
<p>That kind of security measure is implemented and enabled by default in BunkerWeb and is called "Bad behavior". Here is the list of the related settings :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_BAD_BEHAVIOR</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, the Bad behavior feature will be enabled.</td>
</tr>
<tr>
<td align="center"><code>BAD_BEHAVIOR_STATUS_CODES</code></td>
<td align="center"><code>400 401 403 404 405 429 444</code></td>
<td align="left">List of HTTP status codes considered as "suspicious".</td>
</tr>
<tr>
<td align="center"><code>BAD_BEHAVIOR_BAN_TIME</code></td>
<td align="center"><code>86400</code></td>
<td align="left">The duration time (in seconds) of a ban when a client reached the threshold.</td>
</tr>
<tr>
<td align="center"><code>BAD_BEHAVIOR_THRESHOLD</code></td>
<td align="center"><code>10</code></td>
<td align="left">Maximum number of "suspicious" HTTP status codes within the time period.</td>
</tr>
<tr>
<td align="center"><code>BAD_BEHAVIOR_COUNT_TIME</code></td>
<td align="center"><code>60</code></td>
<td align="left">Period of time where we count "suspicious" HTTP status codes.</td>
</tr>
</tbody>
</table>
<p>In other words, with the default values, if a client generates more than <code>10</code> status codes from the list <code>400 401 403 404 405 429 444</code> within <code>60</code> seconds his IP address will be banned for <code>86400</code> seconds.</p>
<h2 id="antibot">Antibot</h2>
<p>Attackers will certainly use automated tools to exploit/find some vulnerabilities in your web applications. One countermeasure is to challenge the users to detect if they look like a bot. If the challenge is solved, we consider the client as "legitimate" and he can access the web application.</p>
<p>That kind of security is implemented but not enabled by default in BunkerWeb and is called "Antibot". Here is the list of supported challenges :</p>
<ul>
<li><strong>Cookie</strong> : send a cookie to the client, we expect to get the cookie back on other requests</li>
<li><strong>Javascript</strong> : force a client to solve a computation challenge using Javascript</li>
<li><strong>Captcha</strong> : force the client to solve a classical captcha (no external dependencies)</li>
<li><strong>hCaptcha</strong> : force the client to solve a captcha from hCaptcha</li>
<li><strong>reCAPTCHA</strong> : force the client to get a minimum score with Google reCAPTCHA</li>
</ul>
<p>Here is the list of related settings :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_ANTIBOT</code></td>
<td align="center"><code>no</code></td>
<td align="left">Accepted values to enable Antibot feature : <code>cookie</code>, <code>javascript</code>, <code>captcha</code>, <code>hcaptcha</code> and <code>recaptcha</code>.</td>
</tr>
<tr>
<td align="center"><code>ANTIBOT_URI</code></td>
<td align="center"><code>/challenge</code></td>
<td align="left">URI that clients will be redirected to in order to solve the challenge. Be sure that it isn't used in your web application.</td>
</tr>
<tr>
<td align="center"><code>ANTIBOT_SESSION_SECRET</code></td>
<td align="center"><code>random</code></td>
<td align="left">The secret used to encrypt cookies when using Antibot. The special value <code>random</code> will generate one for you. Be sure to set it when you use a clustered integration (32 chars).</td>
</tr>
<tr>
<td align="center"><code>ANTIBOT_HCAPTCHA_SITEKEY</code> and <code>ANTIBOT_RECAPTCHA_SITEKEY</code></td>
<td align="center"></td>
<td align="left">The Sitekey value to use when <code>USE_ANTIBOT</code> is set to <code>hcaptcha</code> or <code>recaptcha</code>.</td>
</tr>
<tr>
<td align="center"><code>ANTIBOT_HCAPTCHA_SECRET</code> and <code>ANTIBOT_RECAPTCHA_SECRET</code></td>
<td align="center"></td>
<td align="left">The Secret value to use when <code>USE_ANTIBOT</code> is set to <code>hcaptcha</code> or <code>recaptcha</code>.</td>
</tr>
<tr>
<td align="center"><code>ANTIBOT_RECAPTCHA_SCORE</code></td>
<td align="center"><code>0.7</code></td>
<td align="left">The minimum score that clients must have when <code>USE_ANTIBOT</code> is set to <code>recaptcha</code>.</td>
</tr>
</tbody>
</table>
<h2 id="blacklisting-and-whitelisting">Blacklisting and whitelisting</h2>
<p>The blacklisting security feature is very easy to understand : if a specific criteria is met, the client will be banned. As for the whitelisting, it's the exact opposite : if a specific criteria is met, the client will be allowed and no additional security check will be done.</p>
<p>You can configure blacklisting and whitelisting at the same time. If that's the case, note that whitelisting is executed before blacklisting : if a criteria is true for both, the client will be whitelisted.</p>
<h3 id="blacklisting">Blacklisting</h3>
<p>You can use the following settings to setup blacklisting :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_BLACKLIST</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, will enable blacklisting based on various criteria.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_IP</code></td>
<td align="center"></td>
<td align="left">List of IPs and networks to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_IP_URLS</code></td>
<td align="center"><code>https://www.dan.me.uk/torlist/?exit</code></td>
<td align="left">List of URL containing IP and network to blacklist. The default list contains TOR exit nodes.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_RDNS</code></td>
<td align="center"><code>.shodan.io .censys.io</code></td>
<td align="left">List of reverse DNS to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_RDNS_URLS</code></td>
<td align="center"></td>
<td align="left">List of URLs containing reverse DNS to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_ASN</code></td>
<td align="center"></td>
<td align="left">List of ASN to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_ASN_URLS</code></td>
<td align="center"></td>
<td align="left">List of URLs containing ASN to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_USER_AGENT</code></td>
<td align="center"></td>
<td align="left">List of User-Agents to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_USER_AGENT_URLS</code></td>
<td align="center"><code>https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list</code></td>
<td align="left">List of URLs containing User-Agent(s) to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_URI</code></td>
<td align="center"></td>
<td align="left">List of requests URI to blacklist.</td>
</tr>
<tr>
<td align="center"><code>BLACKLIST_URI_URLS</code></td>
<td align="center"></td>
<td align="left">List of URLs containing request URI to blacklist.</td>
</tr>
</tbody>
</table>
<h3 id="whitelisting">Whitelisting</h3>
<p>You can use the following settings to setup whitelisting :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_WHITELIST</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, will enable blacklisting based on various criteria.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_IP</code></td>
<td align="center"><code>20.191.45.212 40.88.21.235 40.76.173.151 40.76.163.7 20.185.79.47 52.142.26.175 20.185.79.15 52.142.24.149 40.76.162.208 40.76.163.23 40.76.162.191 40.76.162.247 54.208.102.37 107.21.1.8</code></td>
<td align="left">List of IP and network to whitelist. The default list contains IP from DuckDuckGo crawler.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_IP_URLS</code></td>
<td align="center">``</td>
<td align="left">List of URLs containing IP and network to whitelist.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_RDNS</code></td>
<td align="center"><code>.google.com .googlebot.com .yandex.ru .yandex.net .yandex.com .search.msn.com .baidu.com .baidu.jp .crawl.yahoo.net .fwd.linkedin.com .twitter.com .twttr.com .discord.com</code></td>
<td align="left">List of reverse DNS to whitelist. Default list contains various reverse DNS of search engines and social media crawlers.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_RDNS_URLS</code></td>
<td align="center"></td>
<td align="left">List of URLs containing reverse DNS to whitelist.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_ASN</code></td>
<td align="center"><code>32934</code></td>
<td align="left">List of ASN to whitelist. The default list contains the ASN of Facebook.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_ASN_URLS</code></td>
<td align="center"></td>
<td align="left">List of URL containing ASN to whitelist.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_USER_AGENT</code></td>
<td align="center"></td>
<td align="left">List of User-Agent to whitelist.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_USER_AGENT_URLS</code></td>
<td align="center"></td>
<td align="left">List of URLs containing User-Agent to whitelist.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_URI</code></td>
<td align="center"></td>
<td align="left">List of requests URI to whitelist.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_URI_URLS</code></td>
<td align="center"></td>
<td align="left">List of URLs containing request(s) URI to whitelist.</td>
</tr>
</tbody>
</table>
<h2 id="bunkernet">BunkerNet</h2>
<p>BunkerNet is a crowdsourced database of malicious requests shared between all BunkerWeb instances over the world.</p>
<p>If you enable BunkerNet, malicious requests will be sent to a remote server and will be analyzed by our systems. By doing so, we can extract malicious data from everyone's reports and give back the results to each BunkerWeb instances participating into BunkerNet.</p>
<p>At the moment, that feature should be considered in "beta". We only extract malicious IP and we are very strict about how we do it to avoid any "poisoning". We strongly recommend activating it (which is the default) because the more instances participate, the more data we have to improve the algorithm.</p>
<p>The setting used to enable or disable BunkerNet is <code>USE_BUNKERNET</code> (default : <code>yes</code>).</p>
<h2 id="dnsbl">DNSBL</h2>
<p>DNSBL or "DNS BlackList" is an external list of malicious IPs that you query using the DNS protocol. Automatic querying of that kind of blacklist is supported by BunkerWeb. If a remote DNSBL server of your choice says that the IP address of the client is in the blacklist, it will be banned.</p>
<p>Here is the list of settings related to DNSBL :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_DNSBL</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, will enable DNSBL checking.</td>
</tr>
<tr>
<td align="center"><code>DNSBL_LIST</code></td>
<td align="center"><code>bl.blocklist.de problems.dnsbl.sorbs.net sbl.spamhaus.org xbl.spamhaus.org</code></td>
<td align="left">List of DNSBL servers to ask.</td>
</tr>
</tbody>
</table>
<h2 id="limiting">Limiting</h2>
<p>BunkerWeb supports applying a limit policy to :</p>
<ul>
<li>Number of connections per IP</li>
<li>Number of requests per IP and URL within a time period</li>
</ul>
<p>Please note that it should not be considered as an effective solution against DoS or DDoS but rather an anti-bruteforce measure or rate limit policy for API.</p>
<p>In both cases (connections or requests) if the limit is reached, the client will receive the HTTP status "429 - Too Many Requests".</p>
<h3 id="connections">Connections</h3>
<p>The following settings are related to the Limiting connections feature :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_LIMIT_CONN</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, will limit the maximum number of concurrent connections for a given IP.</td>
</tr>
<tr>
<td align="center"><code>LIMIT_CONN_MAX_HTTP1</code></td>
<td align="center"><code>10</code></td>
<td align="left">Maximum number of concurrent connections when using HTTP1 protocol.</td>
</tr>
<tr>
<td align="center"><code>LIMIT_CONN_MAX_HTTP2</code></td>
<td align="center"><code>100</code></td>
<td align="left">Maximum number of concurrent streams when using HTTP2 protocol.</td>
</tr>
</tbody>
</table>
<h3 id="requests">Requests</h3>
<p>The following settings are related to the Limiting requests feature :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_LIMIT_REQ</code></td>
<td align="center"><code>yes</code></td>
<td align="left">When set to <code>yes</code>, will limit the number of requests for a given IP on each URL with a period of time.</td>
</tr>
<tr>
<td align="center"><code>LIMIT_REQ_URL</code></td>
<td align="center"><code>/</code></td>
<td align="left">The URL that will be limited. The special URL <code>/</code> will define a default limit for all URLs.</td>
</tr>
<tr>
<td align="center"><code>LIMIT_REQ_RATE</code></td>
<td align="center"><code>2r/s</code></td>
<td align="left">The limit to apply to the corresponding URL. Syntax is <code>Xr/Y</code> where <strong>X</strong> is the number of request(s) and <strong>Y</strong> the period of time (s for second, m for minute, h for hour and d for day).</td>
</tr>
</tbody>
</table>
<p>Please note that you can add different rate for different URLs by adding a number to suffix to the settings for example : <code>LIMIT_REQ_URL_1=/url1</code>, <code>LIMIT_REQ_RATE_1=5r/d</code>, <code>LIMIT_REQ_URL_2=/url2</code>, <code>LIMIT_REQ_RATE_2=1r/m</code>, ...</p>
<p>Another important thing to note is that <code>LIMIT_REQ_URL</code> accepts LUA patterns.</p>
<h2 id="country">Country</h2>
<p>The country security feature allows you to apply policy based on the country of the IP address of clients :</p>
<ul>
<li>Deny any access if the country is in a blacklist</li>
<li>Only allow access if the country is in a whitelist (other security checks will still be executed)</li>
</ul>
<p>Here is the list of related settings :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>BLACKLIST_COUNTRY</code></td>
<td align="center"></td>
<td align="left">List of 2 letters country code to blacklist.</td>
</tr>
<tr>
<td align="center"><code>WHITELIST_COUNTRY</code></td>
<td align="center"></td>
<td align="left">List of 2 letters country code to whitelist.</td>
</tr>
</tbody>
</table>
<p>Using both country blacklist and whitelist at the same time makes no sense. If you do please note that only the whitelist will be executed.</p>
<h2 id="authentication">Authentication</h2>
<p>You can quickly protect sensitive resources like the admin area for example by requiring HTTP basic authentication. Here is the list of related settings :</p>
<table>
<thead>
<tr>
<th align="center">Setting</th>
<th align="center">Default</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="center"><code>USE_AUTH_BASIC</code></td>
<td align="center"><code>no</code></td>
<td align="left">When set to <code>yes</code> HTTP auth basic will be enabled.</td>
</tr>
<tr>
<td align="center"><code>AUTH_BASIC_LOCATION</code></td>
<td align="center"><code>sitewide</code></td>
<td align="left">Location (URL) of the sensitive resource. Use special value <code>sitewide</code> to enable everywhere.</td>
</tr>
<tr>
<td align="center"><code>USE_AUTH_BASIC_USER</code></td>
<td align="center"><code>changeme</code></td>
<td align="left">The username required.</td>
</tr>
<tr>
<td align="center"><code>USE_AUTH_BASIC_PASSWORD</code></td>
<td align="center"><code>changeme</code></td>
<td align="left">The password required.</td>
</tr>
<tr>
<td align="center"><code>USE_AUTH_BASIC_TEXT</code></td>
<td align="center"><code>Restricted area</code></td>
<td align="left">Text to display in the auth prompt.</td>
</tr>
</tbody>
</table>

              
            </article>
          </div>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
    <nav class="md-footer__inner md-grid" aria-label="Footer">
      
        
        <a href="../quickstart-guide/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Quickstart guide" rel="prev">
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12z"/></svg>
          </div>
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Previous
              </span>
              Quickstart guide
            </div>
          </div>
        </a>
      
      
        
        <a href="../settings/" class="md-footer__link md-footer__link--next" aria-label="Next: Settings" rel="next">
          <div class="md-footer__title">
            <div class="md-ellipsis">
              <span class="md-footer__direction">
                Next
              </span>
              Settings
            </div>
          </div>
          <div class="md-footer__button md-icon">
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4z"/></svg>
          </div>
        </a>
      
    </nav>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2022 Bunkerity
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
      
      
    
    <a href="https://discord.com/invite/fTf46FmtyD" target="_blank" rel="noopener" title="discord.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485.065 485.065 0 0 0 404.081 32.03a1.816 1.816 0 0 0-1.923.91 337.461 337.461 0 0 0-14.9 30.6 447.848 447.848 0 0 0-134.426 0 309.541 309.541 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.689 483.689 0 0 0-119.688 37.107 1.712 1.712 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.016 2.016 0 0 0 .765 1.375 487.666 487.666 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348.2 348.2 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321.173 321.173 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251.047 251.047 0 0 0 9.109-7.137 1.819 1.819 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.812 1.812 0 0 1 1.924.233 234.533 234.533 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.407 301.407 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391.055 391.055 0 0 0 30.014 48.815 1.864 1.864 0 0 0 2.063.7A486.048 486.048 0 0 0 610.7 405.729a1.882 1.882 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541zM222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241zm195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://github.com/bunkerity" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://www.linkedin.com/company/bunkerity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3zM135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5zm282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9V416z"/></svg>
    </a>
  
    
    
      
      
    
    <a href="https://twitter.com/bunkerity" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.0.0 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2022 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    <script id="__config" type="application/json">{"base": "..", "features": ["navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate"], "translations": {"clipboard.copy": "Copy to clipboard", "clipboard.copied": "Copied to clipboard", "search.config.lang": "en", "search.config.pipeline": "trimmer, stopWordFilter", "search.config.separator": "[\\s\\-]+", "search.placeholder": "Search", "search.result.placeholder": "Type to start searching", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.term.missing": "Missing", "select.version.title": "Select version"}, "search": "../assets/javascripts/workers/search.bd0b6b67.min.js", "version": {"provider": "mike", "version": "latest"}}</script>
    
    
      <script src="../assets/javascripts/bundle.467223ff.min.js"></script>
      
    
  </body>
</html>