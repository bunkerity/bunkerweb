
<!doctype html>
<html lang="fr" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation of BunkerWeb, the open source and next generation WAF.">
      
      
      
        <link rel="canonical" href="https://docs.bunkerweb.io/latest/fr/integrations/">
      
      
        <link rel="prev" href="../concepts/">
      
      
        <link rel="next" href="../quickstart-guide/">
      
      
      <link rel="icon" href="../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.21">
    
    
      
        <title>Int√©grations - Documentation BunkerWeb</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.2a3383ac.min.css">
      
      


    
    
    <script async
            defer
            data-domain="docs.bunkerweb.io"
            src="https://data.bunkerity.com/js/script.js"></script>

    <script defer>
      window.addEventListener('DOMContentLoaded', (e) => {

        const customHeaders = document.querySelectorAll('[data-custom-header]')
        customHeaders.forEach(header => {
          const getHeaders = document.querySelectorAll(`#${header.getAttribute('id')}`);
          getHeaders.forEach(el => {

            if(!el.hasAttribute('data-custom-header')) el.remove()
        })})
      })
    </script>

    <script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script>

    <script defer>
  // Lazy load images and embed youtube videos
  window.addEventListener("load", () => {
    document.querySelectorAll("[data-src]").forEach((el) => {
      el.setAttribute("src", el.getAttribute("data-src"));
    });
  });
  // Add missing label
  try {
    document
      .querySelector('div.md-search[data-md-component="search"][role="dialog"]')
      .setAttribute("aria-label", "Search in documentation");
  } catch (err) {}
    </script>

    <script defer>
      window.addEventListener('DOMContentLoaded', () => {
        const bannerEl = document.querySelector('aside.md-banner');
        let defaultContent = [{ "content" : '<p>Get the most of BunkerWeb by upgrading to the PRO version. Click <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&utm_source=doc">here</a> and use the <strong>freetrial</strong> promo code to get started.</p>'},
        { "content" : '<p>Need premium support or tailored consulting around BunkerWeb ? Check out our <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc#services">professional services</a>.</p>'},
        { "content" : '<p>Be part of the Bunker community by joining the <a style="text-decoration:underline; color: white;" href="https://discord.bunkerweb.io">Discord chat</a> and following us on <a style="text-decoration:underline; color: white;" href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>.</p>'}
        ]

      function setBannerStyle() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        bannerEl.style.backgroundColor = "#2eac68";
        bannerItem.style.textAlign = "center";
        bannerItem.style.transition = "all 0.5s ease-out";
      }

      function setDefault() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        const clone = bannerItem.cloneNode(true);
        clone.innerHTML = defaultContent[0]["content"];
        bannerEl.replaceChild(clone, bannerItem);
      }

      function startBannerLoop() {
        const switchDelay = 7000;
        let i = 0;

        setInterval(() => {
          // Update or reset index
          if(i + 1 === defaultContent.length) {
            i = 0;
          } else {
            i++;
          }

          // Prepare data with next el with opacity 0 too
          const currItem = bannerEl.querySelector('.md-banner__inner');
          currItem.style.opacity = 0;
          const clone = currItem.cloneNode(true);
          clone.innerHTML = defaultContent[i]["content"];
          setTimeout(() => {
            bannerEl.replaceChild(clone, currItem);
            setTimeout(() => {
              const newItem = bannerEl.querySelector('.md-banner__inner');
              newItem.style.opacity = 1;
            }, 20);
          }, 600);

        }, switchDelay);
      }

      function runBanner() {
        startBannerLoop();
        // Try to get dynamic content
        // Else keep static ones
        // fetch("https://www.bunkerweb.io/api/bw-ui-news")
        // .then((res) => {
        //   return res.json();
        // })
        // .then((res) => {
        //   defaultContent = res.data[0].data;
        //   startBannerLoop();
        // })
        // .catch((e) => {
        //   startBannerLoop();
        // });
      }

        setBannerStyle();
        setDefault();
        runBanner()

      })
    </script>

    
      
    
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../css/print-site.css">
    
      <link rel="stylesheet" href="../../css/print-site-material.css">
    
      <link rel="stylesheet" href="../../assets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
      
        <meta  property="og:type"  content="website" >
      
        <meta  property="og:title"  content="Int√©grations - Documentation BunkerWeb" >
      
        <meta  property="og:description"  content="Documentation of BunkerWeb, the open source and next generation WAF." >
      
        <meta  property="og:image"  content="https://docs.bunkerweb.io/latest/assets/images/social/fr/integrations.png" >
      
        <meta  property="og:image:type"  content="image/png" >
      
        <meta  property="og:image:width"  content="1200" >
      
        <meta  property="og:image:height"  content="630" >
      
        <meta  property="og:url"  content="https://docs.bunkerweb.io/latest/fr/integrations/" >
      
        <meta  name="twitter:card"  content="summary_large_image" >
      
        <meta  name="twitter:title"  content="Int√©grations - Documentation BunkerWeb" >
      
        <meta  name="twitter:description"  content="Documentation of BunkerWeb, the open source and next generation WAF." >
      
        <meta  name="twitter:image"  content="https://docs.bunkerweb.io/latest/assets/images/social/fr/integrations.png" >
      
    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#integrations" class="md-skip">
          Aller au contenu
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
    üì¢ Looking for BunkerWeb CLOUD, PRO version, technical support or tailored services ? Visit the
    <a href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc"
       style="color: #3f6ec6;
              text-decoration: underline">BunkerWeb Panel</a>
    for more information on our enterprise offers.

          </div>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
    You're not viewing the
    documentation of the latest version.
    <a href="../../..">
        <strong>Click here to view latest.</strong>
    </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("../.."),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="En-t√™te">
    <a href="../" title="Documentation BunkerWeb" class="md-header__button md-logo" aria-label="Documentation BunkerWeb" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Documentation BunkerWeb
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Int√©grations
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
      <div class="md-header__option">
  <div class="md-select">
    
    <button class="md-header__button md-icon" aria-label="S√©lectionner la langue">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m12.87 15.07-2.54-2.51.03-.03A17.5 17.5 0 0 0 14.07 6H17V4h-7V2H8v2H1v2h11.17C11.5 7.92 10.44 9.75 9 11.35 8.07 10.32 7.3 9.19 6.69 8h-2c.73 1.63 1.73 3.17 2.98 4.56l-5.09 5.02L4 19l5-5 3.11 3.11zM18.5 10h-2L12 22h2l1.12-3h4.75L21 22h2zm-2.62 7 1.62-4.33L19.12 17z"/></svg>
    </button>
    <div class="md-select__inner">
      <ul class="md-select__list">
        
          <li class="md-select__item">
            <a href="../../integrations/" hreflang="en" class="md-select__link">
              English - üá¨üáß
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="./" hreflang="fr" class="md-select__link">
              Fran√ßais - üá´üá∑
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../de/integrations/" hreflang="de" class="md-select__link">
              Deutsch - üá©üá™
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../es/integrations/" hreflang="es" class="md-select__link">
              Espa√±ol - üá™üá∏
            </a>
          </li>
        
          <li class="md-select__item">
            <a href="../../zh/integrations/" hreflang="zh" class="md-select__link">
              ‰∏≠Êñá - üá®üá≥
            </a>
          </li>
        
      </ul>
    </div>
  </div>
</div>
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Rechercher" placeholder="Rechercher" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Recherche">
        
        <button type="reset" class="md-search__icon md-icon" title="Effacer" aria-label="Effacer" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initialisation de la recherche
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bunkerity/bunkerweb" title="Aller au d√©p√¥t" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Onglets" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../" class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../concepts/" class="md-tabs__link">
        
  
  
    
  
  Concepts

      </a>
    </li>
  

      
        
  
  
  
    
  
  
    <li class="md-tabs__item md-tabs__item--active">
      <a href="./" class="md-tabs__link">
        
  
  
    
  
  Int√©grations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart-guide/" class="md-tabs__link">
        
  
  
    
  
  Guide de d√©marrage rapide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../features/" class="md-tabs__link">
        
  
  
    
  
  Fonctionnalit√©s

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../advanced/" class="md-tabs__link">
        
  
  
    
  
  Utilisations avanc√©es

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../web-ui/" class="md-tabs__link">
        
  
  
    
  
  Interface Web

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../api/" class="md-tabs__link">
        
  
  
    
  
  API

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../upgrading/" class="md-tabs__link">
        
  
  
    
  
  Mise √† niveau

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../troubleshooting/" class="md-tabs__link">
        
  
  
    
  
  D√©pannage

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../plugins/" class="md-tabs__link">
        
  
  
    
  
  Plugins

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../professional-services/" class="md-tabs__link">
        
  
  
    
  
  Services professionnels

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
  
    
  
  √Ä propos

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../" title="Documentation BunkerWeb" class="md-nav__button md-logo" aria-label="Documentation BunkerWeb" data-md-component="logo">
      
  <img src="../../assets/logo.png" alt="logo">

    </a>
    Documentation BunkerWeb
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bunkerity/bunkerweb" title="Aller au d√©p√¥t" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M439.6 236.1 244 40.5c-5.4-5.5-12.8-8.5-20.4-8.5s-15 3-20.4 8.4L162.5 81l51.5 51.5c27.1-9.1 52.7 16.8 43.4 43.7l49.7 49.7c34.2-11.8 61.2 31 35.5 56.7-26.5 26.5-70.2-2.9-56-37.3L240.3 199v121.9c25.3 12.5 22.3 41.8 9.1 55-6.4 6.4-15.2 10.1-24.3 10.1s-17.8-3.6-24.3-10.1c-17.6-17.6-11.1-46.9 11.2-56v-123c-20.8-8.5-24.6-30.7-18.6-45L142.6 101 8.5 235.1C3 240.6 0 247.9 0 255.5s3 15 8.5 20.4l195.6 195.7c5.4 5.4 12.7 8.4 20.4 8.4s15-3 20.4-8.4l194.7-194.7c5.4-5.4 8.4-12.8 8.4-20.4s-3-15-8.4-20.4"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    Int√©grations
    
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    Int√©grations
    
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table des mati√®res">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table des mati√®res
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#bunkerweb-cloud" class="md-nav__link">
    <span class="md-ellipsis">
      BunkerWeb Cloud
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#image-tout-en-un-aio" class="md-nav__link">
    <span class="md-ellipsis">
      Image tout-en-un (AIO)
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Image tout-en-un (AIO)">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#deploiement" class="md-nav__link">
    <span class="md-ellipsis">
      D√©ploiement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#acces-a-lassistant-dinstallation" class="md-nav__link">
    <span class="md-ellipsis">
      Acc√®s √† l'assistant d'installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-redis" class="md-nav__link">
    <span class="md-ellipsis">
      Int√©gration Redis
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-crowdsec" class="md-nav__link">
    <span class="md-ellipsis">
      Int√©gration CrowdSec
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Int√©gration CrowdSec">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#collections-et-analyseurs-par-defaut" class="md-nav__link">
    <span class="md-ellipsis">
      Collections et analyseurs par d√©faut
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ajouter-des-collections-supplementaires" class="md-nav__link">
    <span class="md-ellipsis">
      Ajouter des collections suppl√©mentaires
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#desactiver-des-analyseurs-specifiques" class="md-nav__link">
    <span class="md-ellipsis">
      D√©sactiver des analyseurs sp√©cifiques
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#basculement-appsec" class="md-nav__link">
    <span class="md-ellipsis">
      Basculement AppSec
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#api-crowdsec-externe" class="md-nav__link">
    <span class="md-ellipsis">
      API CrowdSec externe
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker" class="md-nav__link">
    <span class="md-ellipsis">
      Docker
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#variables-denvironnement" class="md-nav__link">
    <span class="md-ellipsis">
      Variables d'environnement
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilisation-des-secrets-docker" class="md-nav__link">
    <span class="md-ellipsis">
      Utilisation des secrets Docker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#programmateur" class="md-nav__link">
    <span class="md-ellipsis">
      Programmateur
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#reseau" class="md-nav__link">
    <span class="md-ellipsis">
      R√©seau
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fichier-de-composition-complet" class="md-nav__link">
    <span class="md-ellipsis">
      Fichier de composition complet
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#construire-a-partir-de-la-source" class="md-nav__link">
    <span class="md-ellipsis">
      Construire √† partir de la source
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#linux" class="md-nav__link">
    <span class="md-ellipsis">
      Linux
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Linux">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#script-dinstallation-facile" class="md-nav__link">
    <span class="md-ellipsis">
      Script d'installation facile
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Script d&#39;installation facile">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#demarrage-rapide" class="md-nav__link">
    <span class="md-ellipsis">
      D√©marrage rapide
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#comment-ca-marche" class="md-nav__link">
    <span class="md-ellipsis">
      Comment √ßa marche
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interactive-installation" class="md-nav__link">
    <span class="md-ellipsis">
      Interactive Installation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#options-de-ligne-de-commande" class="md-nav__link">
    <span class="md-ellipsis">
      Options de ligne de commande
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-de-crowdsec-avec-le-script" class="md-nav__link">
    <span class="md-ellipsis">
      Int√©gration de CrowdSec avec le script
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#considerations-rhel" class="md-nav__link">
    <span class="md-ellipsis">
      Consid√©rations RHEL
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#apres-linstallation" class="md-nav__link">
    <span class="md-ellipsis">
      Apr√®s l'installation
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#installation-a-laide-du-gestionnaire-de-paquets" class="md-nav__link">
    <span class="md-ellipsis">
      Installation √† l'aide du gestionnaire de paquets
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#configuration-et-service" class="md-nav__link">
    <span class="md-ellipsis">
      Configuration et service
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#haute-disponibilite" class="md-nav__link">
    <span class="md-ellipsis">
      Haute disponibilit√©
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Haute disponibilit√©">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#manager" class="md-nav__link">
    <span class="md-ellipsis">
      Manager
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#worker" class="md-nav__link">
    <span class="md-ellipsis">
      Worker
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interface-utilisateur-web" class="md-nav__link">
    <span class="md-ellipsis">
      Interface utilisateur Web
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#docker-autoconf" class="md-nav__link">
    <span class="md-ellipsis">
      Docker autoconf
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Docker autoconf">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#les-services-dautoconf" class="md-nav__link">
    <span class="md-ellipsis">
      Les services d'Autoconf
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#espaces-de-noms" class="md-nav__link">
    <span class="md-ellipsis">
      Espaces de noms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#kubernetes" class="md-nav__link">
    <span class="md-ellipsis">
      Kubernetes
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Kubernetes">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#methodes-dinstallation" class="md-nav__link">
    <span class="md-ellipsis">
      M√©thodes d'installation
    </span>
  </a>
  
    <nav class="md-nav" aria-label="M√©thodes d&#39;installation">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#utilisation-du-graphique-de-barre-recommande" class="md-nav__link">
    <span class="md-ellipsis">
      Utilisation du graphique de barre (recommand√©)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fichiers-yaml-complets" class="md-nav__link">
    <span class="md-ellipsis">
      Fichiers YAML complets
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#ressources-dentree" class="md-nav__link">
    <span class="md-ellipsis">
      Ressources d'entr√©e
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#espaces-de-noms_1" class="md-nav__link">
    <span class="md-ellipsis">
      Espaces de noms
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#classe-dentree" class="md-nav__link">
    <span class="md-ellipsis">
      Classe d'entr√©e
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nom-de-domaine-personnalise" class="md-nav__link">
    <span class="md-ellipsis">
      Nom de domaine personnalis√©
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#utilisation-avec-le-controleur-dentree-existant" class="md-nav__link">
    <span class="md-ellipsis">
      Utilisation avec le contr√¥leur d'entr√©e existant
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Utilisation avec le contr√¥leur d&#39;entr√©e existant">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#installation-du-controleur-dentree-nginx" class="md-nav__link">
    <span class="md-ellipsis">
      Installation du contr√¥leur d'entr√©e nginx
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#swarm" class="md-nav__link">
    <span class="md-ellipsis">
      Swarm
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Swarm">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#services-swarm" class="md-nav__link">
    <span class="md-ellipsis">
      Services Swarm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#espaces-de-noms_2" class="md-nav__link">
    <span class="md-ellipsis">
      Espaces de noms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#microsoft-azure" class="md-nav__link">
    <span class="md-ellipsis">
      Microsoft Azure
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Guide de d√©marrage rapide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Fonctionnalit√©s
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Utilisations avanc√©es
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Interface Web
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../api/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    API
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Mise √† niveau
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    D√©pannage
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../professional-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Services professionnels
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    √Ä propos
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


  
  


<h1 id="integrations">Int√©grations</h1>
<h2 id="bunkerweb-cloud">BunkerWeb Cloud</h2>
<figure>
<p><img align="center," alt="Vue d'ensemble" src="../../assets/img/bunkerweb-cloud.webp" width="600" />
  </p>
<figcaption>BunkerWeb Cloud</figcaption>
</figure>
<p>BunkerWeb Cloud sera le moyen le plus simple de commencer avec BunkerWeb. Il vous offre un service BunkerWeb enti√®rement g√©r√© sans tracas. Consid√©rez-le comme un BunkerWeb-as-a-Service !</p>
<p>Essayez notre <a href="https://panel.bunkerweb.io/contact.php?language=french&amp;utm_campaign=self&amp;utm_source=doc">offre BunkerWeb Cloud</a> et acc√©dez √† :</p>
<ul>
<li>Une instance BunkerWeb enti√®rement g√©r√©e et h√©berg√©e dans notre cloud</li>
<li>Toutes les fonctionnalit√©s de BunkerWeb, y compris les fonctionnalit√©s PRO</li>
<li>Une plateforme de surveillance avec tableaux de bord et alertes</li>
<li>Support technique pour vous aider dans la configuration</li>
</ul>
<p>Si vous √™tes int√©ress√© par l'offre BunkerWeb Cloud, n'h√©sitez pas √† <a href="https://panel.bunkerweb.io/contact.php?language=french&amp;utm_campaign=self&amp;utm_source=doc">nous contacter</a> afin que nous puissions discuter de vos besoins.</p>
<h2 id="image-tout-en-un-aio">Image tout-en-un (AIO)</h2>
<figure>
<p><img align="center," alt="Architecture AIO Graph Placeholder" src="../../assets/img/aio-graph-placeholder.png" width="600" />
  </p>
<figcaption>Architecture tout-en-un (AIO) BunkerWeb</figcaption>
</figure>
<h3 id="deploiement">D√©ploiement</h3>
<p>Pour d√©ployer le conteneur tout-en-un, il vous suffit d'ex√©cuter la commande suivante :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.5
</code></pre></div>
<p>Par d√©faut, le conteneur expose :</p>
<ul>
<li>8080/tcp pour HTTP</li>
<li>8443/tcp pour HTTPS</li>
<li>8443/udp pour QUIC</li>
<li>7000/tcp pour l'acc√®s √† l'interface utilisateur web sans BunkerWeb en fa√ßade (non recommand√© pour la production)</li>
</ul>
<p>L'image tout-en-un est livr√©e avec plusieurs services int√©gr√©s, qui peuvent √™tre contr√¥l√©s √† l'aide de variables d'environnement :</p>
<ul>
<li><code>SERVICE_UI=yes</code> (par d√©faut) - Active le service d'interface utilisateur Web</li>
<li><code>SERVICE_SCHEDULER=yes</code> (par d√©faut) - Active le service Scheduler</li>
<li><code>AUTOCONF_MODE=no</code> (par d√©faut) - Active le service autoconf</li>
<li><code>USE_REDIS=yes</code> (par d√©faut) : active l' <a href="#redis-integration"> instance</a> Redis int√©gr√©e</li>
<li><code>USE_CROWDSEC=no</code> (par d√©faut) - <a href="#crowdsec-integration"> L'int√©gration CrowdSec</a> est d√©sactiv√©e par d√©faut</li>
</ul>
<h3 id="acces-a-lassistant-dinstallation">Acc√®s √† l'assistant d'installation</h3>
<p>Par d√©faut, l'assistant d'installation est lanc√© automatiquement lorsque vous ex√©cutez le conteneur AIO pour la premi√®re fois. Pour y acc√©der, proc√©dez comme suit :</p>
<ol>
<li><strong>D√©marrez le conteneur AIO</strong> comme <a href="#deployment">ci-dessus</a>, en vous assurant ( <code>SERVICE_UI=yes</code> par d√©faut).</li>
<li><strong>Acc√©dez √† l'interface utilisateur</strong> via votre point de terminaison BunkerWeb principal, par exemple <code>https://your-domain</code>.</li>
</ol>
<blockquote>
<p>Suivez les √©tapes suivantes du guide de <a href="../quickstart-guide/#complete-the-setup-wizard">d√©marrage rapide</a> pour configurer l'interface utilisateur Web.</p>
</blockquote>
<h3 id="integration-redis">Int√©gration Redis</h3>
<p>L'image <strong>BunkerWeb All-In-One</strong> inclut Redis pr√™t √† l'emploi pour la <a href="../advanced/#persistence-of-bans-and-reports">persistance des bannissements et des rapports</a>. Pour g√©rer Redis :</p>
<ul>
<li>Pour d√©sactiver Redis, d√©finissez <code>USE_REDIS=no</code> ou pointez <code>REDIS_HOST</code> vers un h√¥te externe.</li>
<li>Les journaux Redis apparaissent <code>[REDIS]</code> avec le pr√©fixe dans les journaux Docker et <code>/var/log/bunkerweb/redis.log</code>.</li>
</ul>
<h3 id="integration-crowdsec">Int√©gration CrowdSec</h3>
<p>L'image Docker tout-en-un** de BunkerWeb ** est livr√©e avec CrowdSec enti√®rement int√©gr√©, sans conteneurs suppl√©mentaires ni configuration manuelle requise. Suivez les √©tapes ci-dessous pour activer, configurer et √©tendre CrowdSec dans votre d√©ploiement.</p>
<p>Par d√©faut, CrowdSec est <strong>d√©sactiv√©</strong>. Pour l'activer, il suffit d'ajouter la <code>USE_CROWDSEC</code> variable d'environnement :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.5
</code></pre></div>
<ul>
<li>
<p>Lorsque <code>USE_CROWDSEC=yes</code>, le point d'entr√©e :</p>
<ol>
<li><strong>Inscrivez-vous</strong> et <strong>d√©marrez</strong> l'agent CrowdSec local (via <code>cscli</code>).</li>
<li><strong>Installez ou mettez √† niveau</strong> les collections et les analyseurs par d√©faut.</li>
<li><strong>Configurez</strong> le <code>crowdsec-bunkerweb-bouncer/v1.6</code> videur.</li>
</ol>
</li>
</ul>
<hr />
<h4 id="collections-et-analyseurs-par-defaut">Collections et analyseurs par d√©faut</h4>
<p>Au premier d√©marrage (ou apr√®s la mise √† niveau), les ressources suivantes sont automatiquement install√©es et maintenues √† jour :</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Nom</th>
<th>But</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Collection</strong></td>
<td><code>crowdsecurity/nginx</code></td>
<td>Prot√©gez les serveurs Nginx contre un large √©ventail d'attaques bas√©es sur HTTP, de la force brute aux tentatives d'injection.</td>
</tr>
<tr>
<td><strong>Collection</strong></td>
<td><code>crowdsecurity/appsec-virtual-patching</code></td>
<td>Fournit un ensemble de r√®gles de type WAF mis √† jour dynamiquement ciblant les CVE connues, automatiquement corrig√© quotidiennement pour prot√©ger les applications Web contre les vuln√©rabilit√©s nouvellement d√©couvertes.</td>
</tr>
<tr>
<td><strong>Collection</strong></td>
<td><code>crowdsecurity/appsec-generic-rules</code></td>
<td>Compl√©ments <code>crowdsecurity/appsec-virtual-patching</code> avec des heuristiques pour les mod√®les d'attaque g√©n√©riques de la couche application, tels que l'√©num√©ration, la travers√©e de chemin et les sondes automatis√©es, comblant les lacunes l√† o√π il n'existe pas encore de r√®gles sp√©cifiques √† CVE.</td>
</tr>
<tr>
<td><strong>Analyseur</strong></td>
<td><code>crowdsecurity/geoip-enrich</code></td>
<td>Enrichit les √©v√©nements avec le contexte GeoIP</td>
</tr>
</tbody>
</table>
<details>
<summary><strong>Comment √ßa marche en interne</strong></summary>

Le script entrypoint appelle :

<div class="highlight"><pre><span></span><code>cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/nginx
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-virtual-patching
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-generic-rules
cscli<span class="w"> </span>install<span class="w"> </span>parser<span class="w">     </span>crowdsecurity/geoip-enrich
</code></pre></div>

</details>

<hr />
<h4 id="ajouter-des-collections-supplementaires">Ajouter des collections suppl√©mentaires</h4>
<p>Vous avez besoin d'une couverture suppl√©mentaire¬†? D√©finissez <code>CROWDSEC_EXTRA_COLLECTIONS</code> √† l'aide d'une liste de collections Hubb s√©par√©es par des espaces :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_EXTRA_COLLECTIONS</span><span class="o">=</span><span class="s2">&quot;crowdsecurity/apache2 crowdsecurity/mysql&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.5
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Comment √ßa marche en interne</p>
<p>Le script parcourt chaque nom et installe ou met √† jour si n√©cessaire ‚Äî aucune intervention manuelle n'est requise.</p>
</div>
<hr />
<h4 id="desactiver-des-analyseurs-specifiques">D√©sactiver des analyseurs sp√©cifiques</h4>
<p>Si vous souhaitez conserver la configuration par d√©faut tout en d√©sactivant explicitement un ou plusieurs analyseurs, fournissez une liste s√©par√©e par des espaces via <code>CROWDSEC_DISABLED_PARSERS</code>¬†:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_DISABLED_PARSERS</span><span class="o">=</span><span class="s2">&quot;crowdsecurity/geoip-enrich foo/bar-parser&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.5
</code></pre></div>
<p>Notes¬†:
- La liste est appliqu√©e apr√®s l'installation/mise √† jour des √©l√©ments requis¬†; seuls les analyseurs indiqu√©s sont supprim√©s.
- Utilisez les slugs du hub tels qu'affich√©s par <code>cscli parsers list</code> (ex.¬†: <code>crowdsecurity/geoip-enrich</code>).</p>
<hr />
<h4 id="basculement-appsec">Basculement AppSec</h4>
<p>Les  fonctionnalit√©s <a href="https://docs.crowdsec.net/docs/appsec/intro/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">CrowdSec AppSec</a>, optimis√©es par les  collections <code>appsec-virtual-patching</code> et <code>appsec-generic-rules</code> , sont <strong>activ√©es par d√©faut</strong>.</p>
<p>Pour <strong>d√©sactiver</strong> toutes les fonctionnalit√©s AppSec (WAF/virtual-patching), d√©finissez :</p>
<div class="highlight"><pre><span></span><code>-e<span class="w"> </span><span class="nv">CROWDSEC_APPSEC_URL</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</code></pre></div>
<p>Cela d√©sactive effectivement le point de terminaison AppSec, de sorte qu'aucune r√®gle n'est appliqu√©e.</p>
<hr />
<h4 id="api-crowdsec-externe">API CrowdSec externe</h4>
<p>Si vous exploitez une instance CrowdSec distante, pointez le conteneur vers votre API :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_API</span><span class="o">=</span><span class="s2">&quot;https://crowdsec.example.com:8000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.5
</code></pre></div>
<ul>
<li><strong>L'enregistrement local</strong> est ignor√© lorsque n' <code>CROWDSEC_API</code> est pas <code>127.0.0.1</code> ou <code>localhost</code>.</li>
<li><strong>AppSec</strong> est d√©sactiv√© par d√©faut lors de l'utilisation d'une API externe. Pour l'activer, d√©finissez-le <code>CROWDSEC_APPSEC_URL</code> sur le point de terminaison de votre choix.</li>
<li>L'inscription du videur se produit toujours sur l'API distante.</li>
<li>Pour r√©utiliser une cl√© de videur existante, fournissez-la <code>CROWDSEC_API_KEY</code> avec votre jeton pr√©-g√©n√©r√©.</li>
</ul>
<hr />
<div class="admonition tip">
<p class="admonition-title">Plus d'options</p>
<p>Pour une couverture compl√®te de toutes les options CrowdSec (sc√©narios personnalis√©s, journaux, d√©pannage, etc.), consultez la <a href="../features/#crowdsec">documentation du plugin BunkerWeb CrowdSec</a> ou visitez le <a href="https://www.crowdsec.net/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">site officiel de CrowdSec</a>.</p>
</div>
<h2 id="docker">Docker</h2>
<figure>
<p><img align="center," alt="Vue d'ensemble" src="../../assets/img/integration-docker.svg" width="600" />
  </p>
<figcaption>Int√©gration Docker</figcaption>
</figure>
<p>L'utilisation de BunkerWeb en tant que <a href="https://www.docker.com/"> conteneur Docker</a> offre une approche pratique et simple pour tester et utiliser la solution, en particulier si vous √™tes d√©j√† familiaris√© avec la technologie Docker.</p>
<p>Pour faciliter votre d√©ploiement Docker, nous fournissons des images pr√©d√©finies facilement disponibles sur <a href="https://hub.docker.com/r/bunkerity/bunkerweb">Docker Hub</a>, prenant en charge plusieurs architectures. Ces images pr√©d√©finies sont optimis√©es et pr√©par√©es pour √™tre utilis√©es sur les architectures suivantes :</p>
<ul>
<li>x64 (64 bits)</li>
<li>x86</li>
<li>armv8 (ARM 64 bits)</li>
<li>armv7 (ARM 32 bits)</li>
</ul>
<p>En acc√©dant √† ces images pr√©d√©finies √† partir de Docker Hub, vous pouvez rapidement extraire et ex√©cuter BunkerWeb dans votre environnement Docker, √©liminant ainsi le besoin de processus de configuration ou d'installation √©tendus. Cette approche simplifi√©e vous permet de vous concentrer sur l'exploitation des capacit√©s de BunkerWeb sans complexit√©s inutiles.</p>
<p>Que vous effectuiez des tests, d√©veloppiez des applications ou d√©ployiez BunkerWeb en production, l'option de conteneurisation Docker offre flexibilit√© et facilit√© d'utilisation. L'adoption de cette m√©thode vous permet de tirer pleinement parti des fonctionnalit√©s de BunkerWeb tout en tirant parti des avantages de la technologie Docker.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb:1.6.5
</code></pre></div>
<p>Les images Docker sont √©galement disponibles sur <a href="https://github.com/orgs/bunkerity/packages?repo_name=bunkerweb">les packages GitHub</a> et peuvent √™tre t√©l√©charg√©es √† l'aide de l'adresse du <code>ghcr.io</code> d√©p√¥t :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/bunkerity/bunkerweb:1.6.5
</code></pre></div>
<p>Les concepts cl√©s de l'int√©gration Docker sont les suivants :</p>
<ul>
<li><strong>Variables d'environnement</strong>: Configurez facilement BunkerWeb √† l'aide de variables d'environnement. Ces variables vous permettent de personnaliser divers aspects du comportement de BunkerWeb, tels que les param√®tres r√©seau, les options de s√©curit√© et d'autres param√®tres.</li>
<li><strong>Conteneur du Scheduler</strong> : g√©rez la configuration et ex√©cutez les t√¢ches √† l'aide d'un conteneur d√©di√© appel√© <a href="../concepts/#scheduler">Scheduler</a>.</li>
<li><strong>R√©seaux</strong>: Les r√©seaux Docker jouent un r√¥le essentiel dans l'int√©gration de BunkerWeb. Ces r√©seaux ont deux objectifs principaux : exposer les ports aux clients et se connecter aux services Web en amont. En exposant les ports, BunkerWeb peut accepter les demandes entrantes des clients, leur permettant d'acc√©der aux services Web prot√©g√©s. De plus, en se connectant aux services Web en amont, BunkerWeb peut acheminer et g√©rer efficacement le trafic, offrant ainsi une s√©curit√© et des performances am√©lior√©es.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Backend de base de donn√©es</p>
<p>Veuillez noter que nos instructions supposent que vous utilisez SQLite comme backend de base de donn√©es par d√©faut, tel que configur√© par le <code>DATABASE_URI</code> param√®tre. Cependant, d'autres backends de base de donn√©es sont √©galement pris en charge. Pour plus d'informations, consultez les fichiers docker-compose dans le <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.5/misc/integrations">dossier misc/integrations</a> du d√©p√¥t.</p>
</div>
<h3 id="variables-denvironnement">Variables d'environnement</h3>
<p>Les param√®tres sont transmis au Scheduler √† l'aide de variables d'environnement Docker :</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MY_SETTING=value</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ANOTHER_SETTING=another value</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Liste compl√®te</p>
<p>Pour obtenir la liste compl√®te des variables d'environnement, consultez la <a href="../features/">section des param√®tres</a> de la documentation.</p>
</div>
<h3 id="utilisation-des-secrets-docker">Utilisation des secrets Docker</h3>
<p>Au lieu de transmettre des param√®tres sensibles via des variables d'environnement, vous pouvez les stocker en tant que secrets Docker. Pour chaque param√®tre que vous souhaitez s√©curiser, cr√©ez un secret Docker dont le nom correspond √† la cl√© de param√®tre (en majuscules). Les scripts d'entr√©e de BunkerWeb chargent automatiquement les secrets <code>/run/secrets</code> et les exportent en tant que variables d'environnement.</p>
<p>Exemple:
<div class="highlight"><pre><span></span><code><span class="c1"># Create a Docker secret for ADMIN_PASSWORD</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;S3cr3tP@ssw0rd&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>ADMIN_PASSWORD<span class="w"> </span>-
</code></pre></div></p>
<p>Montez les secrets lors du d√©ploiement :
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ADMIN_PASSWORD</span>
<span class="nn">...</span>
<span class="nt">secrets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div></p>
<p>Cela garantit que les param√®tres sensibles sont tenus √† l'√©cart de l'environnement et des journaux.</p>
<h3 id="programmateur">Programmateur</h3>
<p>Le <a href="../concepts/#scheduler">Scheduler</a> s'ex√©cute dans son propre conteneur, qui est √©galement disponible sur Docker Hub :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-scheduler:1.6.5
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Param√®tres BunkerWeb</p>
<p>Since version <code>1.6.0</code>, the Scheduler container is where you define the settings for BunkerWeb. The Scheduler then pushes the configuration to the BunkerWeb container.</p>
<p>‚ö† <strong>Important</strong>: Tous les param√®tres li√©s √† l'API (comme <code>API_HTTP_PORT</code>, <code>API_LISTEN_IP</code>, <code>API_SERVER_NAME</code>, <code>API_WHITELIST_IP</code>, et <code>API_TOKEN</code> si vous l'utilisez) <strong>doivent √©galement √™tre d√©finis dans le conteneur BunkerWeb</strong>. Les param√®tres doivent √™tre r√©pliqu√©s dans les deux conteneurs, sinon le conteneur BunkerWeb n'acceptera pas les requ√™tes API du Scheduler.</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">API_HTTP_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5000&quot;</span><span class="w"> </span><span class="c1"># Default value</span>
<span class="w">  </span><span class="nt">API_LISTEN_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.0.0.0&quot;</span><span class="w"> </span><span class="c1"># Default value</span>
<span class="w">  </span><span class="nt">API_SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bwapi&quot;</span><span class="w"> </span><span class="c1"># Default value</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Set this according to your network settings</span>
<span class="w">  </span><span class="c1"># Jeton optionnel ; si d√©fini, le Scheduler enverra Authorization: Bearer &lt;token&gt;</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># This will set the API settings for the BunkerWeb container</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># This will set the API settings for the Scheduler container</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<p>Un volume est n√©cessaire pour stocker la base de donn√©es SQLite et les sauvegardes utilis√©es par le Scheduler :</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.5</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Utilisation d'un dossier local pour les donn√©es persistantes</p>
<p>Le Scheduler s'ex√©cute en tant qu' <strong>utilisateur non privil√©gi√© avec UID 101 et GID 101</strong> √† l'int√©rieur du conteneur. Cela renforce la s√©curit√© : en cas d'exploitation d'une vuln√©rabilit√©, l'attaquant ne disposera pas des privil√®ges de root complet (UID/GID 0).</p>
<p>However, if you use a <strong>local folder for persistent data</strong>, you must <strong>set the correct permissions</strong> so the unprivileged user can write data to it. For example:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Alternatively, if the folder already exists:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>If you are using <a href="https://docs.docker.com/engine/security/rootless">Docker in rootless mode</a> or <a href="https://podman.io/">Podman</a>, UIDs and GIDs in the container will be mapped to different ones on the host. You will first need to check your initial subuid and subgid:</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>For example, if you have a value of <strong>100000</strong>, the mapped UID/GID will be <strong>100100</strong> (100000 + 100):</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Or if the folder already exists:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
</div>
<h3 id="reseau">R√©seau</h3>
<p>Par d√©faut, le conteneur BunkerWeb √©coute (√† l'int√©rieur du conteneur) les <strong>fichiers 8080/tcp</strong> pour <strong>HTTP,</strong> <strong>8443/tcp</strong> pour <strong>HTTPS</strong> et <strong>8443/udp</strong> pour <strong>QUIC</strong>.</p>
<p>!! avertissement "Ports privil√©gi√©s en mode rootless ou lors de l'utilisation de Podman"
    Si vous utilisez <a href="https://docs.docker.com/engine/security/rootless">Docker en mode rootless</a> et que vous souhaitez rediriger les ports privil√©gi√©s (&lt; 1024) tels que 80 et 443 vers BunkerWeb, veuillez vous r√©f√©rer aux pr√©requis <a href="https://docs.docker.com/engine/security/rootless/#exposing-privileged-ports">ici</a>.</p>
<pre><code>If you are using [Podman](https://podman.io/), you can lower the minimum number for unprivileged ports:
```shell
sudo sysctl net.ipv4.ip_unprivileged_port_start=1
```
</code></pre>
<p>La pile BunkerWeb typique lors de l'utilisation de l'int√©gration Docker contient les conteneurs suivants :</p>
<ul>
<li>BunkerWeb (en anglais)</li>
<li>Programmateur</li>
<li>Vos services</li>
</ul>
<p>√Ä des fins de d√©fense en profondeur, nous vous recommandons vivement de cr√©er au moins trois r√©seaux Docker diff√©rents :</p>
<ul>
<li><code>bw-services</code>: pour BunkerWeb et vos services web</li>
<li><code>bw-universe</code>: pour BunkerWeb et le Scheduler</li>
<li><code>bw-db</code>: pour la base de donn√©es (si vous en utilisez une)</li>
</ul>
<p>Pour s√©curiser la communication entre le Scheduler et l'API BunkerWeb, <strong>autorisez les appels d'API</strong>. Utilisez le param√®tre <code>API_WHITELIST_IP</code> pour sp√©cifier les adresses IP et sous-r√©seaux autoris√©s. Pour un niveau de protection sup√©rieur, d√©finissez <code>API_TOKEN</code> dans les deux conteneurs ; le Scheduler inclura automatiquement l'en-t√™te <code>Authorization: Bearer &lt;token&gt;</code>.</p>
<p><strong>Il est fortement recommand√© d'utiliser un sous-r√©seau statique pour le <code>bw-universe</code> r√©seau</strong> afin d'am√©liorer la s√©curit√©. En mettant en ≈ìuvre ces mesures, vous pouvez vous assurer que seules les sources autoris√©es peuvent acc√©der √† l'API BunkerWeb, r√©duisant ainsi le risque d'acc√®s non autoris√© ou d'activit√©s malveillantes :</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># Jeton API optionnel</span>
<span class="w">  </span><span class="c1"># Jeton API optionnel pour l&#39;acc√®s authentifi√© √† l&#39;API</span>
<span class="w">  </span><span class="nt">API_TOKEN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This setting is mandatory to specify the BunkerWeb instance</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Static subnet so only authorized sources can access the BunkerWeb API</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="fichier-de-composition-complet">Fichier de composition complet</h3>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.5</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This setting is mandatory to specify the BunkerWeb instance</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Static subnet so only authorized sources can access the BunkerWeb API</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="construire-a-partir-de-la-source">Construire √† partir de la source</h3>
<p>Sinon, si vous pr√©f√©rez une approche plus pratique, vous avez la possibilit√© de cr√©er l'image Docker directement √† partir de la <a href="https://github.com/bunkerity/bunkerweb">source</a>. La cr√©ation de l'image √† partir de la source vous offre un meilleur contr√¥le et une meilleure personnalisation du processus de d√©ploiement. Cependant, veuillez noter que cette m√©thode peut prendre un certain temps, en fonction de votre configuration mat√©rielle (vous pouvez prendre un caf√© ‚òï si n√©cessaire).</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw<span class="w"> </span>-f<span class="w"> </span>src/bw/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-scheduler<span class="w"> </span>-f<span class="w"> </span>src/scheduler/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-autoconf<span class="w"> </span>-f<span class="w"> </span>src/autoconf/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<h2 id="linux">Linux</h2>
<figure>
<p><img align="center," alt="Vue d'ensemble" src="../../assets/img/integration-linux.svg" width="600" />
  </p>
<figcaption>Int√©gration Linux</figcaption>
</figure>
<p>Les distributions Linux prises en charge par BunkerWeb (architectures amd64/x86_64 et arm64/aarch64) comprennent :</p>
<ul>
<li>Debian 12 "Rat de biblioth√®que"</li>
<li>Debian 13 "Trixie"</li>
<li>Ubuntu 22.04 "Jammy"</li>
<li>Ubuntu 24.04 "Noble"</li>
<li>Fedora 41 et 42</li>
<li>Red Hat Enterprise Linux (RHEL) 8, 9 et 10</li>
</ul>
<h3 id="script-dinstallation-facile">Script d'installation facile</h3>
<p>Pour une exp√©rience d'installation simplifi√©e, BunkerWeb fournit un script d'installation facile qui g√®re automatiquement l'ensemble du processus d'installation, y compris l'installation de NGINX, la configuration du r√©f√©rentiel et la configuration du service.</p>
<h4 id="demarrage-rapide">D√©marrage rapide</h4>
<p>Pour commencer, t√©l√©chargez le script d'installation et sa somme de contr√¥le, puis v√©rifiez l'int√©grit√© du script avant de l'ex√©cuter.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Download the script and its checksum</span>
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/v1.6.5/install-bunkerweb.sh
wget<span class="w"> </span>https://github.com/bunkerity/bunkerweb/releases/download/v1.6.5/install-bunkerweb.sh.sha256

<span class="c1"># Verify the checksum</span>
sha256sum<span class="w"> </span>-c<span class="w"> </span>install-bunkerweb.sh.sha256

<span class="c1"># If the check is successful, run the script</span>
chmod<span class="w"> </span>+x<span class="w"> </span>install-bunkerweb.sh
sudo<span class="w"> </span>./install-bunkerweb.sh
</code></pre></div>
<div class="admonition danger">
<p class="admonition-title">Avis de s√©curit√©</p>
<p><strong>V√©rifiez toujours l'int√©grit√© du script d'installation avant de l'ex√©cuter.</strong></p>
<p>T√©l√©chargez le fichier de somme de contr√¥le et utilisez un outil comme <code>sha256sum</code> pour confirmer que le script n'a pas √©t√© modifi√© ou alt√©r√©.</p>
<p>Si la v√©rification de la somme de contr√¥le √©choue, <strong>n'ex√©cutez pas le script</strong> ‚Äî il pourrait √™tre dangereux.</p>
</div>
<h4 id="comment-ca-marche">Comment √ßa marche</h4>
<p>Le script d'installation facile est un outil puissant con√ßu pour rationaliser l'installation de BunkerWeb sur un nouveau syst√®me Linux. Il automatise les √©tapes cl√©s suivantes :</p>
<ol>
<li><strong>Analyse du syst√®me</strong>: d√©tecte votre syst√®me d'exploitation et le compare √† la liste des distributions prises en charge.</li>
<li><strong>Personnalisation de l'installation</strong>: en mode interactif, il vous invite √† choisir un type d'installation (Tout en un, Manager, Worker, etc.) et √† d√©cider d'activer ou non l'assistant de configuration Web.</li>
<li><strong>Int√©grations facultatives</strong>: propose d'installer et de configurer automatiquement le <a href="#crowdsec-integration-with-the-script">moteur de s√©curit√© CrowdSec</a>.</li>
<li><strong>Gestion des </strong>d√©pendances : Installe la version correcte de NGINX requise par BunkerWeb √† partir de sources officielles et verrouille la version pour √©viter les mises √† niveau involontaires.</li>
<li><strong>Installation de BunkerWeb</strong>: Ajoute le r√©f√©rentiel de paquets BunkerWeb, installe les paquets n√©cessaires et verrouille la version.</li>
<li><strong>Configuration du service</strong> : Configure et active les <code>systemd</code> services correspondant au type d'installation que vous avez choisi.</li>
<li><strong>Conseils post-installation</strong>: Fournit des √©tapes suivantes claires pour vous aider √† d√©marrer avec votre nouvelle instance BunkerWeb.</li>
</ol>
<h4 id="interactive-installation">Interactive Installation</h4>
<p>Lorsqu'il est ex√©cut√© sans aucune option, le script passe en mode interactif qui vous guide tout au long du processus d'installation. Il vous sera demand√© de faire les choix suivants :</p>
<ol>
<li><strong>Type d'installation</strong>: s√©lectionnez les composants que vous souhaitez installer.<ul>
<li><strong>Full Stack (par d√©faut)</strong>: une installation tout-en-un comprenant BunkerWeb, le Scheduler et l'interface utilisateur Web.</li>
<li><strong>Manager</strong>: Installe le Scheduler et l'interface utilisateur Web, destin√©s √† g√©rer un ou plusieurs travailleurs BunkerWeb distants.</li>
<li><strong>Worker</strong>: Installe uniquement l'instance BunkerWeb, qui peut √™tre g√©r√©e par un gestionnaire distant.</li>
<li><strong>Planificateur uniquement</strong> : installe uniquement le composant Planificateur.</li>
<li><strong>Interface utilisateur Web uniquement</strong> : installe uniquement le composant Interface utilisateur Web.</li>
</ul>
</li>
<li><strong>Assistant d'installation</strong>: choisissez d'activer ou non l'assistant de configuration Web. Ceci est fortement recommand√© pour les nouveaux utilisateurs.</li>
<li><strong>Int√©gration CrowdSec</strong>: choisissez d'installer le moteur de s√©curit√© CrowdSec pour une protection avanc√©e et en temps r√©el contre les menaces.</li>
<li><strong>CrowdSec AppSec</strong>: si vous choisissez d'installer CrowdSec, vous pouvez √©galement activer le composant Application Security (AppSec), qui ajoute des fonctionnalit√©s WAF.</li>
<li><strong>Service API</strong>¬†: choisissez d'activer le service API BunkerWeb optionnel. Il est d√©sactiv√© par d√©faut sur les installations Linux.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Installations du gestionnaire et du Scheduler</p>
<p>Si vous choisissez le type d'installation <strong>Manager</strong> ou <strong>Scheduler Only</strong>, vous serez √©galement invit√© √† fournir les adresses IP ou les noms d'h√¥te de vos instances de travail BunkerWeb.</p>
</div>
<h4 id="options-de-ligne-de-commande">Options de ligne de commande</h4>
<p>Pour les configurations non interactives ou automatis√©es, le script peut √™tre contr√¥l√© √† l'aide d'indicateurs de ligne de commande :</p>
<p><strong>Options g√©n√©rales¬†:</strong></p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>-v, --version VERSION</code></td>
<td>Sp√©cifie la version de BunkerWeb √† installer (par exemple, <code>1.6.5</code>).</td>
</tr>
<tr>
<td><code>-w, --enable-wizard</code></td>
<td>Active l'assistant de configuration.</td>
</tr>
<tr>
<td><code>-n, --no-wizard</code></td>
<td>D√©sactive l'assistant d'installation.</td>
</tr>
<tr>
<td><code>--api</code>, <code>--enable-api</code></td>
<td>Active le service API (FastAPI) systemd (d√©sactiv√© par d√©faut).</td>
</tr>
<tr>
<td><code>--no-api</code></td>
<td>D√©sactive explicitement le service API.</td>
</tr>
<tr>
<td><code>-y, --yes</code></td>
<td>S'ex√©cute en mode non interactif en utilisant les r√©ponses par d√©faut pour toutes les invites.</td>
</tr>
<tr>
<td><code>-f, --force</code></td>
<td>Force l'installation √† se poursuivre m√™me sur une version du syst√®me d'exploitation non prise en charge.</td>
</tr>
<tr>
<td><code>-q, --quiet</code></td>
<td>Installation silencieuse (suppression de la sortie).</td>
</tr>
<tr>
<td><code>-h, --help</code></td>
<td>Affiche le message d'aide avec toutes les options disponibles.</td>
</tr>
<tr>
<td><code>--dry-run</code></td>
<td>Montrez ce qui serait install√© sans le faire.</td>
</tr>
</tbody>
</table>
<p><strong>Types d'installation :</strong></p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--full</code></td>
<td>Installation compl√®te de la pile (BunkerWeb, Scheduler, UI). Il s'agit de l'option par d√©faut.</td>
</tr>
<tr>
<td><code>--manager</code></td>
<td>Installe le Scheduler et l'interface utilisateur pour g√©rer les travailleurs √† distance.</td>
</tr>
<tr>
<td><code>--worker</code></td>
<td>Installe uniquement l'instance BunkerWeb.</td>
</tr>
<tr>
<td><code>--scheduler-only</code></td>
<td>Installe uniquement le composant Scheduler.</td>
</tr>
<tr>
<td><code>--ui-only</code></td>
<td>Installe uniquement le composant Interface utilisateur Web.</td>
</tr>
</tbody>
</table>
<p><strong>Int√©grations de s√©curit√© :</strong></p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--crowdsec</code></td>
<td>Installez et configurez le moteur de s√©curit√© CrowdSec.</td>
</tr>
<tr>
<td><code>--no-crowdsec</code></td>
<td>Ignorez l'installation de CrowdSec.</td>
</tr>
<tr>
<td><code>--crowdsec-appsec</code></td>
<td>Installez CrowdSec avec le composant AppSec (inclut les fonctionnalit√©s WAF).</td>
</tr>
</tbody>
</table>
<p><strong>Options avanc√©es :</strong></p>
<table>
<thead>
<tr>
<th>Option</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--instances "IP1 IP2"</code></td>
<td>Liste s√©par√©e par des espaces des instances BunkerWeb (requise pour les modes gestionnaire/Scheduler).</td>
</tr>
</tbody>
</table>
<p><strong>Exemple d'utilisation :</strong></p>
<div class="highlight"><pre><span></span><code><span class="c1"># Run in interactive mode (recommended for most users)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh

<span class="c1"># Non-interactive installation with defaults (full stack, wizard enabled)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--yes

<span class="c1"># Install a Worker node without the setup wizard</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--worker<span class="w"> </span>--no-wizard

<span class="c1"># Install a specific version</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--version<span class="w"> </span><span class="m">1</span>.6.5

<span class="c1"># Manager setup with remote worker instances (instances required)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--manager<span class="w"> </span>--instances<span class="w"> </span><span class="s2">&quot;192.168.1.10 192.168.1.11&quot;</span>

<span class="c1"># Full installation with CrowdSec and AppSec</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--crowdsec-appsec

<span class="c1"># Silent non-interactive installation</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--quiet<span class="w"> </span>--yes

<span class="c1"># Preview installation without executing</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--dry-run

<span class="c1"># Error: CrowdSec cannot be used with worker installations</span>
<span class="c1"># sudo ./install-bunkerweb.sh --worker --crowdsec  # This will fail</span>

<span class="c1"># Error: Instances required for manager in non-interactive mode</span>
<span class="c1"># sudo ./install-bunkerweb.sh --manager --yes  # This will fail without --instances</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Remarques importantes sur la compatibilit√© des options</p>
<p><strong>CrowdSec Limitations:</strong>
- Les options CrowdSec (<code>--crowdsec</code>, <code>--crowdsec-appsec</code>) ne sont compatibles qu'avec <code>--full</code> (par d√©faut) et <code>--manager</code> les types d'installation
- Ils ne peuvent pas √™tre utilis√©s avec <code>--worker</code>des installations , <code>--scheduler-only</code>, ou <code>--ui-only</code></p>
<p><strong>Exigences relatives aux instances :</strong>
- L <code>--instances</code> 'option n'est valable qu'avec <code>--manager</code> les types d <code>--scheduler-only</code> 'installation et
- Lors de l'utilisation <code>--manager</code> ou <code>--scheduler-only</code> avec <code>--yes</code> (mode non interactif), l' <code>--instances</code> option est obligatoire
- Format: <code>--instances "192.168.1.10 192.168.1.11 192.168.1.12"</code></p>
<p><strong>Interactif vs non interactif :</strong>
- Le mode interactif (par d√©faut) vous demandera les valeurs requises manquantes
- Le mode non interactif (<code>--yes</code>) n√©cessite que toutes les options n√©cessaires soient fournies via la ligne de commande</p>
</div>
<h4 id="integration-de-crowdsec-avec-le-script">Int√©gration de CrowdSec avec le script</h4>
<p>Si vous choisissez d'installer CrowdSec lors de la configuration interactive, le script automatise enti√®rement son int√©gration avec BunkerWeb :</p>
<ul>
<li>Il ajoute le d√©p√¥t officiel CrowdSec et installe l'agent.</li>
<li>Il cr√©e un nouveau fichier d'acquisition pour que CrowdSec analyse les journaux de BunkerWeb (<code>access.log</code>, <code>error.log</code>, et <code>modsec_audit.log</code>).</li>
<li>Il installe les collections essentielles (<code>crowdsecurity/nginx</code>) et les analyseurs syntaxiques (<code>crowdsecurity/geoip-enrich</code>).</li>
<li>Il enregistre un videur pour BunkerWeb et configure automatiquement la cl√© API dans <code>/etc/bunkerweb/variables.env</code>.</li>
<li>Si vous s√©lectionnez √©galement le <strong>composant AppSec</strong>, il installe les <code>appsec-virtual-patching</code> collections  et <code>appsec-generic-rules</code> configure  le point de terminaison AppSec pour BunkerWeb.</li>
</ul>
<p>Cela permet une int√©gration transparente et pr√™te √† l'emploi pour une pr√©vention puissante des intrusions.</p>
<h4 id="considerations-rhel">Consid√©rations RHEL</h4>
<div class="admonition warning">
<p class="admonition-title">Prise en charge des bases de donn√©es externes sur les syst√®mes bas√©s sur RHEL</p>
<p>Si vous envisagez d'utiliser une base de donn√©es externe (recommand√©e pour la production), installez le paquet client appropri√©:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Pour MariaDB</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mariadb

<span class="c1"># Pour MySQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql

<span class="c1"># Pour PostgreSQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>postgresql
</code></pre></div>
<p>Ceci est n√©cessaire pour que le Scheduler de BunkerWeb puisse se connecter √† votre base de donn√©es externe.</p>
</div>
<h4 id="apres-linstallation">Apr√®s l'installation</h4>
<p>En fonction de vos choix lors de l'installation :</p>
<p><strong>Avec l'assistant d'installation activ√© :</strong></p>
<ol>
<li>Acc√©dez √† l'assistant de configuration √† l'adresse suivante : <code>https://your-server-ip/setup</code></li>
<li>Suivez la configuration guid√©e pour configurer votre premier service prot√©g√©</li>
<li>Configurer les certificats SSL/TLS et d'autres param√®tres de s√©curit√©</li>
</ol>
<p><strong>Sans assistant d'installation :</strong></p>
<ol>
<li>Modifier <code>/etc/bunkerweb/variables.env</code> pour configurer BunkerWeb manuellement</li>
<li>Ajouter les param√®tres de votre serveur et les services prot√©g√©s</li>
<li>Red√©marrez le Scheduler : <code>sudo systemctl restart bunkerweb-scheduler</code></li>
</ol>
<h3 id="installation-a-laide-du-gestionnaire-de-paquets">Installation √† l'aide du gestionnaire de paquets</h3>
<p>Veuillez vous assurer que <strong>NGINX 1.28.0 est install√© avant d'installer BunkerWeb</strong>. Pour toutes les distributions, √† l'exception de Fedora, il est obligatoire d'utiliser des paquets pr√©construits √† partir du <a href="https://nginx.org/en/linux_packages.html">d√©p√¥t officiel NGINX</a>. La compilation de NGINX √† partir des sources ou l'utilisation de paquets provenant de diff√©rents d√©p√¥ts ne fonctionnera pas avec les paquets officiels pr√©construits de BunkerWeb. Cependant, vous avez la possibilit√© de construire BunkerWeb √† partir des sources.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><input id="__tabbed_1_3" name="__tabbed_1" type="radio" /><input id="__tabbed_1_4" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">Debian Bookworm/Trixie</label><label for="__tabbed_1_2">Ubuntu</label><label for="__tabbed_1_3">Fedora</label><label for="__tabbed_1_4">RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>La premi√®re √©tape consiste √† ajouter le d√©p√¥t officiel NGINX :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>debian-archive-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/debian `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>Vous devriez maintenant pouvoir installer NGINX 1.28.0 :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Version testing/dev</p>
<p>Si vous utilisez la version <code>testing</code> ou <code>dev</code>, vous devrez ajouter la directive <code>force-bad-version</code> √† votre fichier <code>/etc/dpkg/dpkg.cfg</code> avant d'installer BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">D√©sactiver l'assistant d'installation</p>
<p>Si vous ne souhaitez pas utiliser l'assistant de configuration de l'interface Web lors de l'installation de BunkerWeb, exportez la variable suivante :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Et enfin, installez BunkerWeb 1.6.5 :</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.5
</code></pre></div>
<p>Pour emp√™cher la mise √† jour des paquets NGINX et/ou BunkerWeb lors de l'ex√©cution de <code>apt upgrade</code>, vous pouvez utiliser la commande suivante :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La premi√®re √©tape consiste √† ajouter le d√©p√¥t officiel NGINX :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>ubuntu-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/ubuntu `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>Vous devriez maintenant pouvoir installer NGINX 1.28.0 :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Version testing/dev</p>
<p>Si vous utilisez la version <code>testing</code> ou <code>dev</code>, vous devrez ajouter la directive <code>force-bad-version</code> √† votre fichier <code>/etc/dpkg/dpkg.cfg</code> avant d'installer BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">D√©sactiver l'assistant d'installation</p>
<p>Si vous ne souhaitez pas utiliser l'assistant de configuration de l'interface Web lors de l'installation de BunkerWeb, exportez la variable suivante :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Et enfin, installez BunkerWeb 1.6.5 :</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.5
</code></pre></div>
<p>Pour emp√™cher la mise √† jour des paquets NGINX et/ou BunkerWeb lors de l'ex√©cution de <code>apt upgrade</code>, vous pouvez utiliser la commande suivante :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Fedora Update Testing</p>
<p>Si vous ne trouvez pas la version de NGINX r√©pertori√©e dans le d√©p√¥t stable, vous pouvez activer le d√©p√¥t <code>updates-testing</code> :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>setopt<span class="w"> </span>updates-testing.enabled<span class="o">=</span><span class="m">1</span>
</code></pre></div>
</div>
<p>Fedora fournit d√©j√† NGINX 1.28.0, que nous prenons en charge :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">D√©sactiver l'assistant d'installation</p>
<p>Si vous ne souhaitez pas utiliser l'assistant de configuration de l'interface Web lors de l'installation de BunkerWeb, exportez la variable suivante :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Et enfin, installez BunkerWeb 1.6.5 :</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-1.6.5
</code></pre></div>
<p>Pour emp√™cher la mise √† jour des paquets NGINX et/ou BunkerWeb lors de l'ex√©cution de <code>dnf upgrade</code>, vous pouvez utiliser la commande suivante :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>La premi√®re √©tape consiste √† ajouter le d√©p√¥t officiel NGINX. Cr√©ez le fichier suivant dans /etc/yum.repos.d/nginx.repo :</p>
<div class="highlight"><pre><span></span><code>[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true

[nginx-mainline]
name=nginx mainline repo
baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/
gpgcheck=1
enabled=0
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true
</code></pre></div>
<p>Vous devriez maintenant pouvoir installer NGINX 1.28.0 :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">D√©sactiver l'assistant d'installation</p>
<p>Si vous ne souhaitez pas utiliser l'assistant de configuration de l'interface Web lors de l'installation de BunkerWeb, exportez la variable suivante :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>Enfin, installez BunkerWeb 1.6.5 :</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>check-update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-1.6.5
</code></pre></div>
<p>Pour emp√™cher la mise √† jour des paquets NGINX et/ou BunkerWeb lors de l'ex√©cution de <code>dnf upgrade</code>, vous pouvez utiliser la commande suivante :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
</div>
</div>
<h3 id="configuration-et-service">Configuration et service</h3>
<p>La configuration manuelle de BunkerWeb se fait en √©ditant le <code>/etc/bunkerweb/variables.env</code> fichier :</p>
<div class="highlight"><pre><span></span><code>MY_SETTING_1=value1
MY_SETTING_2=value2
...
</code></pre></div>
<p>Une fois install√©, BunkerWeb est livr√© avec trois services <code>bunkerweb</code>, <code>bunkerweb-scheduler</code> et <code>bunkerweb-ui</code> que vous pouvez g√©rer √† l'aide <code>systemctl</code>de .</p>
<p>Si vous modifiez manuellement la configuration de BunkerWeb √† l'aide <code>/etc/bunkerweb/variables.env</code> d'un red√©marrage du <code>bunkerweb-scheduler</code> service, il suffira de g√©n√©rer et de recharger la configuration sans aucun temps d'arr√™t. Mais selon le cas (par exemple, en changeant de port d'√©coute), vous devrez peut-√™tre red√©marrer le <code>bunkerweb</code> service.</p>
<h3 id="haute-disponibilite">Haute disponibilit√©</h3>
<p>Le Scheduler peut √™tre d√©tach√© de l'instance BunkerWeb pour fournir une haute disponibilit√©. Dans ce cas, le Scheduler sera install√© sur un serveur s√©par√© et pourra g√©rer plusieurs instances BunkerWeb.</p>
<h4 id="manager">Manager</h4>
<p>Pour installer uniquement le Scheduler sur un serveur, vous pouvez exporter les variables suivantes avant d'ex√©cuter l'installation de BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">MANAGER_MODE</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
<p>Vous pouvez √©galement exporter les variables suivantes pour activer uniquement le Scheduler :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<h4 id="worker">Worker</h4>
<p>Sur un autre serveur, pour installer uniquement BunkerWeb, vous pouvez exporter les variables suivantes avant d'ex√©cuter l'installation de BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">WORKER_MODE</span><span class="o">=</span>yes
</code></pre></div>
<p>Alternativement, vous pouvez √©galement exporter les variables suivantes pour activer uniquement BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<h4 id="interface-utilisateur-web">Interface utilisateur Web</h4>
<p>L'interface utilisateur Web peut √™tre install√©e sur un serveur s√©par√© pour fournir une interface d√©di√©e √† la gestion des instances BunkerWeb. Pour installer uniquement l'interface utilisateur Web, vous pouvez exporter les variables suivantes avant d'ex√©cuter l'installation de BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>yes
</code></pre></div>
<h2 id="docker-autoconf">Docker autoconf</h2>
<figure>
<p><img align="center," alt="Vue d'ensemble" src="../../assets/img/integration-autoconf.svg" width="600" />
  </p>
<figcaption>Int√©gration de Docker autoconf</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Int√©gration Docker</p>
<p>L'int√©gration de Docker autoconf est une "√©volution" de celle de Docker. Veuillez d'abord lire la section sur l' <a href="#docker">int√©gration Docker</a> si n√©cessaire.</p>
</div>
<p>Une autre approche est disponible pour r√©soudre l'inconv√©nient de recr√©er le conteneur chaque fois qu'il y a une mise √† jour. En utilisant une autre image appel√©e <strong>autoconf</strong>, vous pouvez automatiser la reconfiguration en temps r√©el de BunkerWeb sans avoir besoin de recr√©er des conteneurs.</p>
<p>Pour tirer parti de cette fonctionnalit√©, au lieu de d√©finir des variables d'environnement pour le conteneur BunkerWeb, vous pouvez ajouter des <strong>√©tiquettes</strong> √† vos conteneurs d'application Web. L'image <strong>autoconf</strong> √©coutera alors les √©v√©nements Docker et g√©rera de mani√®re transparente les mises √† jour de configuration pour BunkerWeb.</p>
<p>Ce processus ¬´<em> automagique </em>¬ª simplifie la gestion des configurations BunkerWeb. En ajoutant des √©tiquettes √† vos conteneurs d'applications web, vous pouvez d√©l√©guer les t√¢ches de reconfiguration √† <strong>autoconf</strong> sans l'intervention manuelle de la recr√©ation de conteneurs. Cela simplifie le processus de mise √† jour et am√©liore la commodit√©.</p>
<p>En adoptant cette approche, vous pouvez profiter d'une reconfiguration en temps r√©el de BunkerWeb sans avoir √† vous soucier de la recr√©ation de conteneurs, ce qui le rend plus efficace et plus convivial.</p>
<div class="admonition info">
<p class="admonition-title">Mode multisite</p>
<p>L'int√©gration de Docker autoconf implique l'utilisation du <strong>mode multisite</strong>. Pour plus d'informations, reportez-vous √† la <a href="../concepts/#multisite-mode">section multisite</a> de la documentation.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Backend de base de donn√©es</p>
<p>Veuillez noter que nos instructions supposent que vous utilisez MariaDB comme backend de base de donn√©es par d√©faut, tel que configur√© par le <code>DATABASE_URI</code> param√®tre. Cependant, nous comprenons que vous pr√©f√©rerez peut-√™tre utiliser d'autres backends pour votre int√©gration Docker. Si c'est le cas, soyez assur√© que d'autres backends de base de donn√©es sont toujours possibles. Pour plus d'informations, consultez les fichiers docker-compose dans le <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.5/misc/integrations">dossier misc/integrations</a> du d√©p√¥t.</p>
</div>
<p>Pour activer les mises √† jour automatiques de la configuration, incluez un conteneur suppl√©mentaire appel√© <code>bw-autoconf</code> dans la pile. Ce conteneur h√©berge le service autoconf, qui g√®re les modifications de configuration dynamiques pour BunkerWeb.</p>
<p>Pour prendre en charge cette fonctionnalit√©, utilisez un "vrai" backend de base de donn√©es d√©di√© (par exemple, MariaDB, MySQL ou PostgreSQL) pour le stockage de configuration synchronis√©. En int√©grant <code>bw-autoconf</code> un backend de base de donn√©es appropri√©, vous √©tablissez l'infrastructure pour une gestion automatis√©e de la configuration sans faille dans BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory label for the autoconf service to identify the BunkerWeb instance</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># We don&#39;t need to specify the BunkerWeb instance here as they are automatically detected by the autoconf service</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># The server name will be filled with services labels</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory setting for autoconf</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.5</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># The Docker socket</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># We set the max allowed packet size to avoid issues with large queries</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Base de donn√©es dans le <code>bw-db</code> r√©seau</p>
<p>Le conteneur de base de donn√©es n'est intentionnellement pas inclus dans le <code>bw-universe</code> r√©seau. Il est utilis√© par les <code>bw-autoconf</code> <code>bw-scheduler</code> conteneurs et plut√¥t que directement par BunkerWeb. Par cons√©quent, le conteneur de base de donn√©es fait partie du <code>bw-db</code> r√©seau, ce qui renforce la s√©curit√© en rendant l'acc√®s externe √† la base de donn√©es plus difficile. <strong>Ce choix de conception d√©lib√©r√© permet de prot√©ger la base de donn√©es et de renforcer la perspective de s√©curit√© globale du syst√®me</strong>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Utilisation de Docker en mode rootless</p>
<p>Si vous utilisez <a href="https://docs.docker.com/engine/security/rootless">Docker en mode rootless</a>, vous devrez remplacer le support du socket docker par la valeur suivante : <code>$XDG_RUNTIME_DIR/docker.sock:/var/run/docker.sock:ro</code>.</p>
</div>
<h3 id="les-services-dautoconf">Les services d'Autoconf</h3>
<p>Une fois la pile configur√©e, vous pourrez cr√©er le conteneur de l'application web et ajouter les param√®tres sous forme d'√©tiquettes √† l'aide du pr√©fixe "bunkerweb." afin de configurer automatiquement BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="espaces-de-noms">Espaces de noms</h3>
<p>√Ä partir de la version <code>1.6.0</code>, les piles Autoconf de BunkerWeb supportent d√©sormais les espaces de noms. Cette fonctionnalit√© vous permet de g√©rer plusieurs ¬´<em> clusters </em>¬ª d'instances et de services BunkerWeb sur le m√™me h√¥te Docker. Pour tirer parti des espaces de noms, il vous suffit de d√©finir l' <code>NAMESPACE</code> √©tiquette sur vos services. Voici un exemple :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the service</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Comportement de l'espace de nommage</p>
<p>By default all Autoconf stacks listen to all namespaces. If you want to restrict a stack to specific namespaces, you can set the <code>NAMESPACES</code> environment variable in the <code>bw-autoconf</code> service:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the BunkerWeb instance so the autoconf service can detect it</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Only listen to these namespaces</span>
<span class="nn">...</span>
</code></pre></div>
<p>Keep in mind that the <code>NAMESPACES</code> environment variable is a space-separated list of namespaces.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Sp√©cifications de l'espace de nommage</p>
<p>There can only be <strong>one database</strong> and <strong>one Scheduler</strong> per namespace. If you try to create multiple databases or Schedulers in the same namespace, the configurations will end up conflicting with each other.</p>
<p>The Scheduler doesn't need the <code>NAMESPACE</code> label to work properly. It will only need the <code>DATABASE_URI</code> setting properly configured so that it can access the same database as the autoconf service.</p>
</div>
<h2 id="kubernetes">Kubernetes</h2>
<figure>
<p><img align="center," alt="Vue d'ensemble" src="../../assets/img/integration-kubernetes.svg" width="600" />
  </p>
<figcaption>Int√©gration Kubernetes</figcaption>
</figure>
<p>Pour automatiser la configuration des instances BunkerWeb dans un environnement Kubernetes, le service autoconf sert de <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/">contr√¥leur d'entr√©e</a>. Il configure les instances BunkerWeb en fonction des <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">ressources d'entr√©e</a> et surveille √©galement d'autres objets Kubernetes, tels que <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>, pour des configurations personnalis√©es.</p>
<p>Pour une configuration optimale, il est recommand√© de d√©finir BunkerWeb en tant que <strong><a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a></strong>, ce qui garantit qu'un pod est cr√©√© sur tous les n≈ìuds, tandis que l'<strong>autoconf et le scheduler</strong> sont d√©finis comme  un <strong>seul d√©ploiement<a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/"> r√©pliqu√©</a></strong>.</p>
<p>Compte tenu de la pr√©sence de plusieurs instances BunkerWeb, il est n√©cessaire d'√©tablir un magasin de donn√©es partag√© impl√©ment√© en tant que <a href="https://redis.io/"> service Redis</a> ou <a href="https://valkey.io/">Valkey</a>. Ce service sera utilis√© par les instances pour mettre en cache et partager des donn√©es entre elles. Vous trouverez de plus amples informations sur les param√®tres Redis/Valkey <a href="../features/#redis">ici</a>.</p>
<div class="admonition info">
<p class="admonition-title">Backend de base de donn√©es</p>
<p>Veuillez noter que nos instructions supposent que vous utilisez MariaDB comme backend de base de donn√©es par d√©faut, tel que configur√© par le <code>DATABASE_URI</code> param√®tre. Cependant, nous comprenons que vous pr√©f√©rerez peut-√™tre utiliser d'autres backends pour votre int√©gration Docker. Si c'est le cas, soyez assur√© que d'autres backends de base de donn√©es sont toujours possibles. Pour plus d'informations, consultez les fichiers docker-compose dans le <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.5/misc/integrations">dossier misc/integrations</a> du d√©p√¥t.</p>
<p>La configuration des backends de base de donn√©es en cluster est hors du p√©rim√®tre de cette documentation.</p>
</div>
<p>Assurez-vous que les services autoconf ont acc√®s √† l'API Kubernetes. Il est recommand√© d'utiliser l' <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">autorisation RBAC</a> √† cette fin.</p>
<div class="admonition warning">
<p class="admonition-title">Autorit√© de certification personnalis√©e pour l'API Kubernetes</p>
<p>Si vous utilisez une autorit√© de certification personnalis√©e pour votre API Kubernetes, vous pouvez monter un fichier de bundle contenant vos certificats interm√©diaires et racines sur le contr√¥leur d'entr√©e et d√©finir la <code>KUBERNETES_SSL_CA_CERT</code> valeur de l'environnement sur le chemin d'acc√®s du bundle √† l'int√©rieur du conteneur. Sinon, m√™me si cela n'est pas recommand√©, vous pouvez d√©sactiver la v√©rification du certificat en d√©finissant la <code>KUBERNETES_SSL_VERIFY</code> variable d'environnement du contr√¥leur d'entr√©e sur <code>no</code> (la valeur par d√©faut <code>yes</code>est ).</p>
</div>
<p>De plus, <strong>il est crucial de d√©finir la <code>KUBERNETES_MODE</code> variable d'environnement lors <code>yes</code> de  l'utilisation de l'int√©gration Kubernetes</strong>. Cette variable est obligatoire pour un bon fonctionnement.</p>
<h3 id="methodes-dinstallation">M√©thodes d'installation</h3>
<h4 id="utilisation-du-graphique-de-barre-recommande">Utilisation du graphique de barre (recommand√©)</h4>
<p>La m√©thode recommand√©e pour installer Kubernetes est d'utiliser le graphique Helm disponible √† l'adresse <code>https://repo.bunkerweb.io/charts</code>:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
</code></pre></div>
<p>Vous pouvez ensuite utiliser le tableau de bord de bunkerweb √† partir de ce d√©p√¥t :</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>-f<span class="w"> </span>myvalues.yaml<span class="w"> </span>mybunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>La liste compl√®te des valeurs est r√©pertori√©e dans le <a href="https://github.com/bunkerity/bunkerweb-helm/blob/main/charts/bunkerweb/values.yaml">fichier charts/bunkerweb/values.yaml</a> du <a href="https://github.com/bunkerity/bunkerweb-helm">d√©p√¥t bunkerity/bunkerweb-helm</a>.</p>
<h4 id="fichiers-yaml-complets">Fichiers YAML complets</h4>
<p>Au lieu d'utiliser le graphique helm, vous pouvez √©galement utiliser les mod√®les YAML dans le <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.5/misc/integrations">dossier misc/integrations</a> du r√©f√©rentiel GitHub. Veuillez noter que nous vous recommandons vivement d'utiliser le tableau de barre √† la place.</p>
<h3 id="ressources-dentree">Ressources d'entr√©e</h3>
<p>Une fois que la pile Kubernetes de BunkerWeb est correctement configur√©e et op√©rationnelle (reportez-vous aux journaux autoconf pour plus d'informations), vous pouvez proc√©der au d√©ploiement d'applications Web au sein du cluster et d√©clarer votre ressource d'entr√©e.</p>
<p>Il est important de noter que les param√®tres BunkerWeb doivent √™tre sp√©cifi√©s en tant qu'annotations pour la ressource Ingress. Pour la partie domaine, veuillez utiliser la valeur sp√©ciale <strong><code>bunkerweb.io</code></strong>. En incluant les annotations appropri√©es, vous pouvez configurer BunkerWeb en cons√©quence pour la ressource Ingress.</p>
<div class="admonition info">
<p class="admonition-title">Prise en charge TLS</p>
<p>Le contr√¥leur d'entr√©e BunkerWeb prend enti√®rement en charge les certificats HTTPS personnalis√©s √† l'aide de la sp√©cification tls, comme indiqu√© dans l'exemple. La configuration de solutions telles que <code>cert-manager</code> la g√©n√©ration automatique de secrets tls n'entre pas dans le cadre de cette documentation.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Will be applied to all host in this ingress</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="c1"># Will only be applied to the www.example.com host</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># TLS is optional, you can also use builtin Let&#39;s Encrypt for example</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1">#   - hosts:</span>
<span class="w">  </span><span class="c1">#       - www.example.com</span>
<span class="w">  </span><span class="c1">#     secretName: secret-example-tls</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="nn">...</span>
</code></pre></div>
<h3 id="espaces-de-noms_1">Espaces de noms</h3>
<p>√Ä partir de la version <code>1.6.0</code>, les piles autoconf de BunkerWeb prennent d√©sormais en charge les espaces de noms. Cette fonctionnalit√© vous permet de g√©rer plusieurs clusters d'instances et de services BunkerWeb sur le m√™me cluster Kubernetes. Pour tirer parti des espaces de noms, il suffit de d√©finir le <code>namespace</code> champ de m√©tadonn√©es sur vos instances et services BunkerWeb. Voici un exemple :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DaemonSet</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># Set the namespace for the BunkerWeb instance</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Comportement de l'espace de nommage</p>
<p>Par d√©faut, toutes les piles Autoconf √©coutent tous les namespaces. Si vous souhaitez restreindre une pile √† des namespaces sp√©cifiques, vous pouvez d√©finir la variable d'environnement <code>NAMESPACES</code> dans le d√©ploiement <code>bunkerweb-controller</code> :</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># Set the namespace for the Controller</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">strategy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Recreate</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sa-bunkerweb</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.5</span>
<span class="w">          </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Only listen to these namespaces</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
</code></pre></div>
<p>Gardez √† l'esprit que la variable d'environnement <code>NAMESPACES</code> est une liste de namespaces s√©par√©s par des espaces.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Sp√©cifications de l'espace de nommage</p>
<p>Il ne peut y avoir qu'une <strong>seule base de donn√©es</strong> et qu'un <strong>seul Scheduler</strong> par namespace. Si plusieurs bases de donn√©es ou plusieurs Schedulers sont cr√©√©s dans le m√™me namespace, les configurations entreront en conflit.</p>
<p>Le Scheduler n'a pas besoin de l'annotation <code>NAMESPACE</code> pour fonctionner correctement. Il suffit que le param√®tre <code>DATABASE_URI</code> soit correctement configur√© afin qu'il puisse acc√©der √† la m√™me base de donn√©es que le service autoconf.</p>
</div>
<h3 id="classe-dentree">Classe d'entr√©e</h3>
<p>Lorsqu'il est install√© en utilisant les m√©thodes officielles de la documentation, BunkerWeb est livr√© avec la d√©finition suivante <code>IngressClass</code> :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IngressClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">controller</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.io/ingress-controller</span>
</code></pre></div>
<p>Afin de limiter les <code>Ingress</code> ressources surveill√©es par le contr√¥leur d'entr√©e, vous pouvez d√©finir la <code>KUBERNETES_INGRESS_CLASS</code> variable d'environnement avec la valeur <code>bunkerweb</code>. Ensuite, vous pouvez utiliser la <code>ingressClassName</code> directive dans vos <code>Ingress</code> d√©finitions :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
</code></pre></div>
<h3 id="nom-de-domaine-personnalise">Nom de domaine personnalis√©</h3>
<p>Si vous utilisez un nom de domaine personnalis√© diff√©rent de celui par d√©faut pour votre cluster Kubernetes <code>kubernetes.local</code> , vous pouvez d√©finir la valeur √† l'aide de la <code>KUBERNETES_DOMAIN_NAME</code> variable d'environnement sur le conteneur du Scheduler.</p>
<h3 id="utilisation-avec-le-controleur-dentree-existant">Utilisation avec le contr√¥leur d'entr√©e existant</h3>
<div class="admonition info">
<p class="admonition-title">Conserver √† la fois le contr√¥leur d'entr√©e existant et BunkerWeb</p>
<p>Il s'agit d'un cas d'utilisation o√π vous souhaitez conserver un contr√¥leur d'entr√©e existant, tel que nginx. Le flux de trafic typique sera : √©quilibreur de charge =&gt; contr√¥leur d'entr√©e =&gt; BunkerWeb =&gt; application.</p>
</div>
<h4 id="installation-du-controleur-dentree-nginx">Installation du contr√¥leur d'entr√©e nginx</h4>
<p>Installez le d√©p√¥t helm nginx d'entr√©e :</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>ingress-nginx<span class="w"> </span>https://kubernetes.github.io/ingress-nginx
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>Installez le contr√¥leur d'entr√©e nginx avec les valeurs par d√©faut (il se peut qu'il ne fonctionne pas sur votre propre cluster pr√™t √† l'emploi, veuillez consulter la <a href="https://kubernetes.github.io/ingress-nginx/">documentation</a>) :</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>nginx<span class="w"> </span>--create-namespace<span class="w"> </span>nginx<span class="w"> </span>ingress-nginx/ingress-nginx
</code></pre></div>
<p>Extraire l'adresse IP de LB :</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>nginx-ingress-nginx-controller<span class="w"> </span>-n<span class="w"> </span>nginx<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span>
</code></pre></div>
<p>Configurez les entr√©es DNS sur l'adresse IP de LB (par exemple, <code>bunkerweb</code> le sous-domaine pour l'interface utilisateur BW et <code>myapp</code> pour l'application) :</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nslookup<span class="w"> </span>bunkerweb.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>bunkerweb.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4
$<span class="w"> </span>nslookup<span class="w"> </span>myapp.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>myapp.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div>
<p><strong>Installation de BunkerWeb</strong></p>
<p>Installez le d√©p√¥t helm de BunkerWeb :</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>Cr√©er un <code>values.yaml</code> fichier :</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Here we will setup the values needed to setup BunkerWeb behind an existing ingress controller</span>
<span class="c1"># Traffic flow with BW: LB =&gt; existing Ingress Controller =&gt; BunkerWeb =&gt; Service</span>
<span class="c1"># Traffic flow without BW: LB =&gt; existing Ingress Controller =&gt; Service</span>

<span class="c1"># Global settings</span>
<span class="nt">settings</span><span class="p">:</span>
<span class="w">  </span><span class="nt">misc</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Replace with your DNS resolver</span>
<span class="w">    </span><span class="c1"># to get it: kubectl exec in a random pod then cat /etc/resolv.conf</span>
<span class="w">    </span><span class="c1"># if you have an IP as nameserver then do a reverse DNS lookup: nslookup &lt;IP&gt;</span>
<span class="w">    </span><span class="c1"># most of the time it&#39;s coredns.kube-system.svc.cluster.local or kube-dns.kube-system.svc.cluster.local</span>
<span class="w">    </span><span class="nt">dnsResolvers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kube-dns.kube-system.svc.cluster.local&quot;</span>
<span class="w">  </span><span class="nt">kubernetes</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># We only consider Ingress resources with ingressClass bunkerweb to avoid conflicts with existing ingress controller</span>
<span class="w">    </span><span class="nt">ingressClass</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">    </span><span class="c1"># Optional: you can choose namespace(s) where BunkerWeb will listen for Ingress/ConfigMap changes</span>
<span class="w">    </span><span class="c1"># Default (blank value) is all namespaces</span>
<span class="w">    </span><span class="nt">namespaces</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="c1"># Override the bunkerweb-external service type to ClusterIP</span>
<span class="c1"># Since we don&#39;t need to expose it to the outside world</span>
<span class="c1"># We will use the existing ingress controller to route traffic to BunkerWeb</span>
<span class="nt">service</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>

<span class="c1"># BunkerWeb settings</span>
<span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.5</span>

<span class="c1"># Scheduler settings</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.5</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Enable real IP module to get real IP of clients</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Controller settings</span>
<span class="nt">controller</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.5</span>

<span class="c1"># UI settings</span>
<span class="nt">ui</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.5</span>
</code></pre></div>
<p>Installez BunkerWeb avec des valeurs personnalis√©es :</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>bunkerweb<span class="w"> </span>--create-namespace<span class="w"> </span>-f<span class="w"> </span>values.yaml<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>V√©rifiez les journaux et attendez que tout soit pr√™t.</p>
<p><strong>Installation de l'interface utilisateur Web</strong></p>
<p>Configurez l'entr√©e suivante (en supposant que le contr√¥leur nginx est install√©) :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ui-bunkerweb</span>
<span class="w">  </span><span class="c1"># Replace with your namespace of BW if needed</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># HTTPS is mandatory for web UI even if traffic is internal</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/backend-protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;HTTPS&quot;</span>
<span class="w">    </span><span class="c1"># We must set SNI so BW can serve the right vhost</span>
<span class="w">    </span><span class="c1"># Replace with your domain</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb.example.com&quot;</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-server-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;on&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Only served by nginx controller and not BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># Uncomment and edit if you want to use your own certificate</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - bunkerweb.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Replace with your domain</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># Created by Helm chart</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="c1"># Using HTTPS port is mandatory for UI</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
</code></pre></div>
<p>Et vous pouvez maintenant passer √† l'assistant de configuration en acc√©dant √† <code>https://bunkerweb.example.com/setup</code>.</p>
<p><strong>Protection de l'application existante</strong></p>
<p><strong>Tout d'abord, vous devrez vous rendre dans Global Config, s√©lectionner le plugin SSL, puis d√©sactiver la redirection automatique HTTP vers HTTPS. Veuillez noter que vous n'avez besoin de le faire qu'une seule fois.</strong></p>
<p>Supposons que vous ayez une application dans l'espace de <code>myapp</code> noms qui est accessible √† l'aide du <code>myapp-service</code> service sur le port <code>5000</code>.</p>
<p>Vous devrez ajouter un nouveau service sur l'interface utilisateur web et renseigner les informations requises :</p>
<ul>
<li>Nom du serveur : le domaine public de votre application (par ex. <code>myapp.example.com</code>)</li>
<li>SSL/TLS : votre contr√¥leur d'entr√©e s'occupe de cette partie, donc ne l'activez pas sur BunkerWeb car le trafic est interne au sein du cluster</li>
<li>H√¥te proxy inverse : l'URL compl√®te de votre application au sein du cluster (par exemple) <code>http://myapp-service.myapp.svc.cluster.local:5000</code></li>
</ul>
<p>Une fois le nouveau service ajout√©, vous pouvez maintenant d√©clarer une ressource Ingress pour ce service et l'acheminer vers le service BunkerWeb sur le port HTTP :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">  </span><span class="c1"># Replace with your namespace of BW if needed</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Only served by nginx controller and not BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># Uncomment and edit if you want to use your own certificate</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - myapp.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Replace with your domain</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># Created by Helm chart</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>Vous pouvez visiter <code>http(s)://myapp.example.com</code>, qui est maintenant prot√©g√© par BunkerWeb Ô∏è</p>
<h2 id="swarm">Swarm</h2>
<figure>
<p><img align="center," alt="Vue d'ensemble" src="../../assets/img/integration-swarm.svg" width="600" />
  </p>
<figcaption>Int√©gration de Docker Swarm</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Obsol√®te</p>
<p>L'int√©gration de Swarm est obsol√®te et sera supprim√©e dans une version ult√©rieure. Veuillez envisager d'utiliser l' <a href="#kubernetes">int√©gration Kubernetes</a> √† la place.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Support PRO</p>
<p><strong>Si vous avez besoin d'aide sur l'int√©gration Swarm</strong>, veuillez nous contacter au <a href="mailto:contact@bunkerity.com">contact@bunkerity.com</a> ou via le formulaire de <a href="https://panel.bunkerweb.io/contact.php?language=french&amp;utm_campaign=self&amp;utm_source=doc">contact</a>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Docker autoconf</p>
<p>L'int√©gration de Swarm est similaire √† celle de Docker autoconf (mais avec des services au lieu de conteneurs). Veuillez d'abord lire la section sur l <a href="#docker-autoconf">'int√©gration de Docker autoconf</a> si n√©cessaire.</p>
</div>
<p>Pour permettre la configuration automatique des instances BunkerWeb, le ** service autoconf<strong> n√©cessite l'acc√®s √† l'API Docker. Ce service est √† l'√©coute des √©v√©nements Docker Swarm, tels que la cr√©ation ou la suppression de services, et configure de mani√®re transparente les </strong>instances BunkerWeb** en temps r√©el sans aucun temps d'arr√™t. Il surveille √©galement d'autres objets Swarm, tels que <a href="https://docs.docker.com/engine/swarm/configs/">les configurations</a>, pour les configurations personnalis√©es.</p>
<p>Semblable √† l'<a href="#docker-autoconf">int√©gration Docker autoconf</a>, la configuration des services Web est d√©finie √† l'aide d'√©tiquettes qui commencent par le ** pr√©fixe **bunkerweb.</p>
<p>Pour une configuration optimale, il est recommand√© de planifier le <strong>service BunkerWeb</strong> en tant que <strong><em>service global</em></strong> sur tous les n≈ìuds, tandis que les <strong>services autoconf, scheduler et proxy Docker API</strong> doivent √™tre planifi√©s en tant que <strong><em>services r√©pliqu√©s uniques</em></strong>. Veuillez noter que le service proxy de l'API Docker doit √™tre planifi√© sur un n≈ìud de gestionnaire, sauf si vous le configurez pour utiliser une API distante (ce qui n'est pas couvert dans la documentation).</p>
<p>√âtant donn√© que plusieurs instances de BunkerWeb sont en cours d'ex√©cution, un magasin de donn√©es partag√© impl√©ment√© en tant que <a href="https://redis.io/"> service Redis</a> ou <a href="https://valkey.io/">Valkey</a> doit √™tre cr√©√©. Ces instances utiliseront le service Redis/Valkey pour mettre en cache et partager des donn√©es. Vous trouverez plus de d√©tails sur les param√®tres Redis/Valkey <a href="../features/#redis">ici</a>.</p>
<p>En ce qui concerne le volume de la base de donn√©es, la documentation ne sp√©cifie pas d'approche sp√©cifique. Le choix d'un dossier partag√© ou d'un pilote sp√©cifique pour le volume de base de donn√©es d√©pend de votre cas d'utilisation unique et est laiss√© √† la disposition du lecteur.</p>
<div class="admonition info">
<p class="admonition-title">Backend de base de donn√©es</p>
<p>Veuillez noter que nos instructions supposent que vous utilisez MariaDB comme backend de base de donn√©es par d√©faut, tel que configur√© par le <code>DATABASE_URI</code> param√®tre. Cependant, nous comprenons que vous pr√©f√©rerez peut-√™tre utiliser d'autres backends pour votre int√©gration Docker. Si c'est le cas, soyez assur√© que d'autres backends de base de donn√©es sont toujours possibles. Pour plus d'informations, consultez les fichiers docker-compose dans le <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.5/misc/integrations">dossier misc/integrations</a> du d√©p√¥t.</p>
<p>La configuration des backends de base de donn√©es en cluster est hors du p√©rim√®tre de cette documentation.</p>
</div>
<p>Voici le passe-partout de la pile que vous pouvez d√©ployer √† l'aide de <code>docker stack deploy</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both services</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory label for the autoconf service to identify the BunkerWeb instance</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># We don&#39;t need to specify the BunkerWeb instance here as they are automatically detected by the autoconf service</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># The server name will be filled with services labels</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory setting for autoconf</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.5</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># The Docker socket</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="c1"># We set the max allowed packet size to avoid issues with large queries</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--max-allowed-packet=67108864</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">R√©glage obligatoire de l'swarm</p>
<p>Veuillez noter que la <code>SWARM_MODE: "yes"</code> variable d'environnement est obligatoire lors de l'utilisation de l'int√©gration Swarm.</p>
</div>
<h3 id="services-swarm">Services Swarm</h3>
<p>Une fois que la pile BunkerWeb Swarm est configur√©e et en cours d'ex√©cution (voir les journaux autoconf et scheduler pour plus d'informations), vous pourrez d√©ployer des applications Web dans le cluster et utiliser des √©tiquettes pour configurer dynamiquement BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="espaces-de-noms_2">Espaces de noms</h3>
<p>√Ä partir de la version <code>1.6.0</code>, les piles Autoconf de BunkerWeb supportent d√©sormais les espaces de noms. Cette fonctionnalit√© vous permet de g√©rer plusieurs ¬´<em> clusters </em>¬ª d'instances et de services BunkerWeb sur le m√™me h√¥te Docker. Pour tirer parti des espaces de noms, il vous suffit de d√©finir l' <code>NAMESPACE</code> √©tiquette sur vos services. Voici un exemple :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the service</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Comportement de l'espace de nommage</p>
<p>Par d√©faut, toutes les piles Autoconf √©coutent tous les espaces de noms. Si vous souhaitez restreindre une pile √† des espaces de noms sp√©cifiques, vous pouvez d√©finir la variable d'environnement <code>NAMESPACES</code> dans le service <code>bw-autoconf</code> :</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.5</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">    </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">    </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the BunkerWeb instance</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.5</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">NAMESPACES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Only listen to these namespaces</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">    </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="nn">...</span>
</code></pre></div>
<p>Gardez √† l'esprit que la variable d'environnement <code>NAMESPACES</code> est une liste d'espaces de noms s√©par√©s par des espaces.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Sp√©cifications de l'espace de nommage</p>
<p>Il ne peut y avoir <strong>qu'une seule base de donn√©es</strong> et <strong>un seul Scheduler</strong> par espace de noms. Si vous tentez de cr√©er plusieurs bases de donn√©es ou plusieurs Schedulers dans le m√™me espace de noms, les configurations entreront en conflit.</p>
<p>Le Scheduler n'a pas besoin de l'√©tiquette <code>NAMESPACE</code> pour fonctionner correctement. Il a seulement besoin que le param√®tre <code>DATABASE_URI</code> soit correctement configur√© afin qu'il puisse acc√©der √† la m√™me base de donn√©es que le service autoconf.</p>
</div>
<h2 id="microsoft-azure">Microsoft Azure</h2>
<figure>
<p><img align="center," alt="Vue d'ensemble" src="../../assets/img/integration-azure.webp" width="600" />
  </p>
<figcaption>Int√©gration Azure</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Taille de machine virtuelle recommand√©e</p>
<p>Soyez vigilant lorsque vous choisissez la r√©f√©rence SKU de la machine virtuelle. Vous devez s√©lectionner une r√©f√©rence SKU compatible avec la machine virtuelle Gen2 et nous vous recommandons de commencer par la s√©rie B2s ou Ds2 pour une utilisation optimale.</p>
</div>
<p>Vous pouvez facilement d√©ployer BunkerWeb sur votre abonnement Azure de plusieurs mani√®res :</p>
<ul>
<li>Azure CLI dans Cloud Shell</li>
<li>Mod√®le Azure ARM</li>
<li>Portail Azure via la Place de march√©</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:3"><input checked="checked" id="__tabbed_2_1" name="__tabbed_2" type="radio" /><input id="__tabbed_2_2" name="__tabbed_2" type="radio" /><input id="__tabbed_2_3" name="__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="__tabbed_2_1">Cloud Shell</label><label for="__tabbed_2_2">Mod√®le ARM</label><label for="__tabbed_2_3">Marketplace</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Cr√©ez un groupe de ressources. Remplacez la valeur <code>RG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span>
</code></pre></div>
<p>Cr√©ez une machine virtuelle avec la taille (SKU) <code>Standard_B2s</code> dans la m√™me r√©gion que le groupe de ressources. Remplacez les valeurs <code>RG_NAME</code>, <code>VM_NAME</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span>
</code></pre></div>
<p>Commande compl√®te. Remplacez les valeurs <code>RG_NAME</code>, <code>VM_NAME</code>, <code>LOCATION</code>, <code>HOSTNAME</code>, <code>USERNAME</code>, <code>PUBLIC_IP</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code>, <code>NSG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--computer-name<span class="w"> </span><span class="s2">&quot;HOSTNAME&quot;</span><span class="w"> </span>--admin-username<span class="w"> </span><span class="s2">&quot;USERNAME&quot;</span><span class="w"> </span>--public-ip-address<span class="w"> </span><span class="s2">&quot;PUBLIC_IP&quot;</span><span class="w"> </span>--public-ip-address-allocation<span class="w"> </span>Static<span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--public-ip-sku<span class="w"> </span>Standard<span class="w"> </span>--os-disk-delete-option<span class="w"> </span>Delete<span class="w"> </span>--nic-delete-option<span class="w"> </span>Delete<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span><span class="w"> </span>--nsg<span class="w"> </span><span class="s2">&quot;NSG_NAME&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Exigences en mati√®re d'autorisations</p>
<p>Pour d√©ployer un mod√®le ARM, vous devez disposer d'un acc√®s en √©criture sur les ressources que vous d√©ployez ainsi que de l'acc√®s √† toutes les op√©rations sur le type de ressource Microsoft.Resources/deployments.
Pour d√©ployer une machine virtuelle, vous avez besoin des autorisations Microsoft.Compute/virtualMachines/write et Microsoft.Resources/deployments/*. L'op√©ration what-if requiert les m√™mes autorisations.</p>
</div>
<p>D√©ployer le mod√®le ARM :</p>
<p><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fbunkerity%2Fbunkerweb%2Fmaster%2Fmisc%2Fintegrations%2Fazure-arm-template.json" target="_blank"><img alt="D√©ployer sur Azure" src="../../assets/img/integration-azure-deploy.svg" /></a></p>
</div>
<div class="tabbed-block">
<p>Connectez-vous au <a href="https://portal.azure.com" target="_blank">portail Azure</a>.</p>
<p>Obtenez BunkerWeb depuis le menu <a href="https://portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/bunkerity.bunkerweb" target="_blank">Cr√©er une ressource</a>.</p>
<p>Vous pouvez √©galement passer par <a href="https://azuremarketplace.microsoft.com/fr-fr/marketplace/apps/bunkerity.bunkerweb?tab=Overview" target="_blank">le Marketplace</a>.</p>
</div>
</div>
</div>
<p>Vous pouvez acc√©der √† l'assistant d'installation en parcourant l' <code>https://your-ip-address/setup</code> URI de votre machine virtuelle.</p>







  
  






                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; <script>document.write(new Date().getFullYear())</script> Bunkerity
    </div>
  
  
</div>
      
        
<div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://discord.com/invite/fTf46FmtyD" target="_blank" rel="noopener" title="discord.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M492.5 69.8c-.2-.3-.4-.6-.8-.7-38.1-17.5-78.4-30-119.7-37.1-.4-.1-.8 0-1.1.1s-.6.4-.8.8c-5.5 9.9-10.5 20.2-14.9 30.6-44.6-6.8-89.9-6.8-134.4 0-4.5-10.5-9.5-20.7-15.1-30.6-.2-.3-.5-.6-.8-.8s-.7-.2-1.1-.2C162.5 39 122.2 51.5 84.1 69c-.3.1-.6.4-.8.7C7.1 183.5-13.8 294.6-3.6 404.2c0 .3.1.5.2.8s.3.4.5.6c44.4 32.9 94 58 146.8 74.2.4.1.8.1 1.1 0s.7-.4.9-.7c11.3-15.4 21.4-31.8 30-48.8.1-.2.2-.5.2-.8s0-.5-.1-.8-.2-.5-.4-.6-.4-.3-.7-.4c-15.8-6.1-31.2-13.4-45.9-21.9-.3-.2-.5-.4-.7-.6s-.3-.6-.3-.9 0-.6.2-.9.3-.5.6-.7c3.1-2.3 6.2-4.7 9.1-7.1.3-.2.6-.4.9-.4s.7 0 1 .1c96.2 43.9 200.4 43.9 295.5 0 .3-.1.7-.2 1-.2s.7.2.9.4c2.9 2.4 6 4.9 9.1 7.2.2.2.4.4.6.7s.2.6.2.9-.1.6-.3.9-.4.5-.6.6c-14.7 8.6-30 15.9-45.9 21.8-.2.1-.5.2-.7.4s-.3.4-.4.7-.1.5-.1.8.1.5.2.8c8.8 17 18.8 33.3 30 48.8.2.3.6.6.9.7s.8.1 1.1 0c52.9-16.2 102.6-41.3 147.1-74.2.2-.2.4-.4.5-.6s.2-.5.2-.8c12.3-126.8-20.5-236.9-86.9-334.5zm-302 267.7c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.4 59.2-52.8 59.2m195.4 0c-29 0-52.8-26.6-52.8-59.2s23.4-59.2 52.8-59.2c29.7 0 53.3 26.8 52.8 59.2 0 32.7-23.2 59.2-52.8 59.2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/bunkerity" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M173.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M252.8 8C114.1 8 8 113.3 8 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C436.2 457.8 504 362.9 504 252 504 113.3 391.5 8 252.8 8M105.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/bunkerity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zM102.2 96a38.5 38.5 0 1 1 0 77 38.5 38.5 0 1 1 0-77m282.1 320h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.reddit.com/r/BunkerWeb/" target="_blank" rel="noopener" title="www.reddit.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M0 256C0 114.6 114.6 0 256 0s256 114.6 256 256-114.6 256-256 256H37.1c-13.7 0-20.5-16.5-10.9-26.2L75 437C28.7 390.7 0 326.7 0 256m349.6-102.4c23.6 0 42.7-19.1 42.7-42.7s-19.1-42.7-42.7-42.7c-20.6 0-37.8 14.6-41.8 34-34.5 3.7-61.4 33-61.4 68.4v.2c-37.5 1.6-71.8 12.3-99 29.1-10.1-7.8-22.8-12.5-36.5-12.5-33 0-59.8 26.8-59.8 59.8 0 24 14.1 44.6 34.4 54.1 2 69.4 77.6 125.2 170.6 125.2s168.7-55.9 170.6-125.3c20.2-9.6 34.1-30.2 34.1-54 0-33-26.8-59.8-59.8-59.8-13.7 0-26.3 4.6-36.4 12.4-27.4-17-62.1-27.7-100-29.1v-.2c0-25.4 18.9-46.5 43.4-49.9 4.4 18.8 21.3 32.8 41.5 32.8zm-172.5 93.3c16.7 0 29.5 17.6 28.5 39.3s-13.5 29.6-30.3 29.6-31.4-8.8-30.4-30.5S160.3 247 177 247zm190.1 38.3c1 21.7-13.7 30.5-30.4 30.5s-29.3-7.9-30.3-29.6 11.8-39.3 28.5-39.3 31.2 16.6 32.1 38.3zm-48.1 56.7c-10.3 24.6-34.6 41.9-63 41.9s-52.7-17.3-63-41.9c-1.2-2.9.8-6.2 3.9-6.5 18.4-1.9 38.3-2.9 59.1-2.9s40.7 1 59.1 2.9c3.1.3 5.1 3.6 3.9 6.5"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/bunkerweb/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M224.3 141a115 115 0 1 0-.6 230 115 115 0 1 0 .6-230m-.6 40.4a74.6 74.6 0 1 1 .6 149.2 74.6 74.6 0 1 1-.6-149.2m93.4-45.1a26.8 26.8 0 1 1 53.6 0 26.8 26.8 0 1 1-53.6 0m129.7 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M399 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://x.com/bunkerity" target="_blank" rel="noopener" title="x.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 7.0.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2025 Fonticons, Inc.--><path d="M459.4 151.7c.3 4.5.3 9.1.3 13.6 0 138.7-105.6 298.6-298.6 298.6-59.5 0-114.7-17.2-161.1-47.1 8.4 1 16.6 1.3 25.3 1.3 49.1 0 94.2-16.6 130.3-44.8-46.1-1-84.8-31.2-98.1-72.8 6.5 1 13 1.6 19.8 1.6 9.4 0 18.8-1.3 27.6-3.6-48.1-9.7-84.1-52-84.1-103v-1.3c14 7.8 30.2 12.7 47.4 13.3-28.3-18.8-46.8-51-46.8-87.4 0-19.5 5.2-37.4 14.3-53C87.4 130.8 165 172.4 252.1 176.9c-1.6-7.8-2.6-15.9-2.6-24C249.5 95.1 296.3 48 354.4 48c30.2 0 57.5 12.7 76.7 33.1 23.7-4.5 46.5-13.3 66.6-25.3-7.8 24.4-24.4 44.8-46.1 57.8 21.1-2.3 41.6-8.1 60.4-16.2-14.3 20.8-32.2 39.3-52.6 54.3"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "../..", "features": ["navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "content.code.copy"], "search": "../../assets/javascripts/workers/search.973d3a69.min.js", "tags": null, "translations": {"clipboard.copied": "Copi\u00e9 dans le presse-papier", "clipboard.copy": "Copier dans le presse-papier", "search.result.more.one": "1 de plus sur cette page", "search.result.more.other": "# de plus sur cette page", "search.result.none": "Aucun document trouv\u00e9", "search.result.one": "1 document trouv\u00e9", "search.result.other": "# documents trouv\u00e9s", "search.result.placeholder": "Taper pour d\u00e9marrer la recherche", "search.result.term.missing": "Non trouv\u00e9", "select.version": "S\u00e9lectionner la version"}, "version": {"provider": "mike", "version": "latest"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.f55a23d4.min.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
        <script src="../../js/print-site.js"></script>
      
        <script src="../../assets/extra.js"></script>
      
        <script src="https://chatbot.bunkerweb.io/static/js/chatbot.js"></script>
      
        <script src="../../assets/preserve-version-on-language-switch.js"></script>
      
        <script src="../../assets/toc-dropdown.js"></script>
      
    
  </body>
</html>