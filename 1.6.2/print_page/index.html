
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Documentation of BunkerWeb, the open source and next generation WAF.">
      
      
      
        <link rel="canonical" href="https://docs.bunkerweb.io/latest/print_page/">
      
      
      
      
      <link rel="icon" href="../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.6.15">
    
    
      
        <title>Print Site - BunkerWeb documentation</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/main.342714a4.min.css">
      
      


    
    
    <script async
            defer
            data-domain="docs.bunkerweb.io"
            src="https://data.bunkerity.com/js/script.js"></script>

    <script defer>
      window.addEventListener('DOMContentLoaded', (e) => {

        const customHeaders = document.querySelectorAll('[data-custom-header]')
        customHeaders.forEach(header => {
          const getHeaders = document.querySelectorAll(`#${header.getAttribute('id')}`);
          getHeaders.forEach(el => {

            if(!el.hasAttribute('data-custom-header')) el.remove()
        })})
      })
    </script>

    <script src="https://cdn.jsdelivr.net/npm/medium-zoom/dist/medium-zoom.min.js"></script>

    <script defer>
  // Lazy load images and embed youtube videos
  window.addEventListener("load", () => {
    document.querySelectorAll("[data-src]").forEach((el) => {
      el.setAttribute("src", el.getAttribute("data-src"));
    });
  });
  // Add missing label
  try {
    document
      .querySelector('div.md-search[data-md-component="search"][role="dialog"]')
      .setAttribute("aria-label", "Search in documentation");
  } catch (err) {}
    </script>

    <script defer>
      window.addEventListener('DOMContentLoaded', () => {
        const bannerEl = document.querySelector('aside.md-banner');
        let defaultContent = [{ "content" : '<p>Get the most of BunkerWeb by upgrading to the PRO version. Click <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&utm_source=doc">here</a> and use the <strong>freetrial</strong> promo code to get started.</p>'},
        { "content" : '<p>Need premium support or tailored consulting around BunkerWeb ? Check out our <a style="text-decoration:underline; color :  white;" href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc#services">professional services</a>.</p>'},
        { "content" : '<p>Be part of the Bunker community by joining the <a style="text-decoration:underline; color: white;" href="https://discord.bunkerweb.io">Discord chat</a> and following us on <a style="text-decoration:underline; color: white;" href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>.</p>'}
        ]

      function setBannerStyle() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        bannerEl.style.backgroundColor = "#2eac68";
        bannerItem.style.textAlign = "center";
        bannerItem.style.transition = "all 0.5s ease-out";
      }

      function setDefault() {
        const bannerItem = bannerEl.querySelector('.md-banner__inner');
        const clone = bannerItem.cloneNode(true);
        clone.innerHTML = defaultContent[0]["content"];
        bannerEl.replaceChild(clone, bannerItem);
      }

      function startBannerLoop() {
        const switchDelay = 7000;
        let i = 0;

        setInterval(() => {
          // Update or reset index
          if(i + 1 === defaultContent.length) {
            i = 0;
          } else {
            i++;
          }

          // Prepare data with next el with opacity 0 too
          const currItem = bannerEl.querySelector('.md-banner__inner');
          currItem.style.opacity = 0;
          const clone = currItem.cloneNode(true);
          clone.innerHTML = defaultContent[i]["content"];
          setTimeout(() => {
            bannerEl.replaceChild(clone, currItem);
            setTimeout(() => {
              const newItem = bannerEl.querySelector('.md-banner__inner');
              newItem.style.opacity = 1;
            }, 20);
          }, 600);

        }, switchDelay);
      }

      function runBanner() {
        startBannerLoop();
        // Try to get dynamic content
        // Else keep static ones
        // fetch("https://www.bunkerweb.io/api/bw-ui-news")
        // .then((res) => {
        //   return res.json();
        // })
        // .then((res) => {
        //   defaultContent = res.data[0].data;
        //   startBannerLoop();
        // })
        // .catch((e) => {
        //   startBannerLoop();
        // });
      }

        setBannerStyle();
        setDefault();
        runBanner()

      })
    </script>

    
      
    
    
      <link rel="stylesheet" href="../css/print-site.css">
    
      <link rel="stylesheet" href="../css/print-site-material.css">
    
      <link rel="stylesheet" href="../assets/extra.css">
    
    <script>__md_scope=new URL("/latest",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  
        <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function () {
            remove_material_navigation();remove_mkdocs_theme_navigation();generate_toc();
        })
        </script>
        </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#index" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
        <aside class="md-banner">
          <div class="md-banner__inner md-grid md-typeset">
            
            
    📢 Looking for BunkerWeb PRO version, technical support or tailored services ? Visit the
    <a href="https://panel.bunkerweb.io/?utm_campaign=self&utm_source=doc"
       style="color: #3f6ec6;
              text-decoration: underline">BunkerWeb Panel</a>
    for more information on our enterprise offers.

          </div>
          
        </aside>
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
          <aside class="md-banner md-banner--warning">
            <div class="md-banner__inner md-grid md-typeset">
              
    You're not viewing the
    documentation of the latest version.
    <a href="..//latest">
        <strong>Click here to view latest.</strong>
    </a>

            </div>
            <script>var el=document.querySelector("[data-md-component=outdated]"),base=new URL("/latest"),outdated=__md_get("__outdated",sessionStorage,base);!0===outdated&&el&&(el.hidden=!1)</script>
          </aside>
        
      </div>
    
    
      

  

<header class="md-header md-header--shadow md-header--lifted" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href=".." title="BunkerWeb documentation" class="md-header__button md-logo" aria-label="BunkerWeb documentation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            BunkerWeb documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Print Site
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
      <div class="md-header__source">
        <a href="https://github.com/bunkerity/bunkerweb" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
    
      
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href=".." class="md-tabs__link">
        
  
  
    
  
  Introduction

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../concepts/" class="md-tabs__link">
        
  
  
    
  
  Concepts

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../integrations/" class="md-tabs__link">
        
  
  
    
  
  Integrations

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../quickstart-guide/" class="md-tabs__link">
        
  
  
    
  
  Quickstart guide

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../features/" class="md-tabs__link">
        
  
  
    
  
  Features

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../advanced/" class="md-tabs__link">
        
  
  
    
  
  Advanced usages

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../web-ui/" class="md-tabs__link">
        
  
  
    
  
  Web UI

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../upgrading/" class="md-tabs__link">
        
  
  
    
  
  Upgrading

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../troubleshooting/" class="md-tabs__link">
        
  
  
    
  
  Troubleshooting

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../plugins/" class="md-tabs__link">
        
  
  
    
  
  Plugins

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../professional-services/" class="md-tabs__link">
        
  
  
    
  
  Professional services

      </a>
    </li>
  

      
        
  
  
  
  
    <li class="md-tabs__item">
      <a href="../about/" class="md-tabs__link">
        
  
  
    
  
  About

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
    
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


  

<nav class="md-nav md-nav--primary md-nav--lifted md-nav--integrated" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href=".." title="BunkerWeb documentation" class="md-nav__button md-logo" aria-label="BunkerWeb documentation" data-md-component="logo">
      
  <img src="../assets/logo.png" alt="logo">

    </a>
    BunkerWeb documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/bunkerity/bunkerweb" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href=".." class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Introduction
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../concepts/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Concepts
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../integrations/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Integrations
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../quickstart-guide/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Quickstart guide
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../features/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Features
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../advanced/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Advanced usages
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../web-ui/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Web UI
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../upgrading/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Upgrading
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../troubleshooting/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Troubleshooting
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../plugins/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Plugins
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../professional-services/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    Professional services
    
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../about/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    About
    
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  



<div id="print-site-page" class="print-site-enumerate-headings print-site-enumerate-figures">
        <section class="print-page">
            <div id="print-page-toc" data-toc-depth="3">
                <nav role='navigation' class='print-page-toc-nav'>
                <h1 class='print-page-toc-title'>Table of Contents</h1>
                </nav>
            </div>
        </section>
        <section class="print-page" id="index" heading-number="1"><h1 id="index-introduction">Introduction</h1>
<h2 id="index-overview">Overview</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/intro-overview.svg" width="800" />
  </p>
<figcaption>Make your web services secure by default!</figcaption>
</figure>
<p>BunkerWeb is a next-generation, open-source Web Application Firewall (WAF).</p>
<p>As a full-featured web server (based on <a href="https://nginx.org/">NGINX</a> under the hood), it protects your web services to make them "secure by default." BunkerWeb integrates seamlessly into your existing environments (<a href="#integrations-linux">Linux</a>, <a href="#integrations-docker">Docker</a>, <a href="#integrations-swarm">Swarm</a>, <a href="#integrations-kubernetes">Kubernetes</a>, …) as a reverse proxy and is fully configurable (don't panic, there is an <a href="#web-ui">awesome web UI</a> if you don't like the CLI) to meet your specific use cases. In other words, cybersecurity is no longer a hassle.</p>
<p>BunkerWeb includes primary <a href="#advanced-security-tuning">security features</a> as part of the core but can be easily extended with additional ones thanks to a <a href="#plugins">plugin system</a>.</p>
<h2 id="index-why-bunkerweb">Why BunkerWeb?</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/oybLtyhWJIo" title="BunkerWeb overview" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<ul>
<li>
<p><strong>Easy integration into existing environments</strong>: Seamlessly integrate BunkerWeb into various environments such as Linux, Docker, Swarm, Kubernetes, and more. Enjoy a smooth transition and hassle-free implementation.</p>
</li>
<li>
<p><strong>Highly customizable</strong>: Tailor BunkerWeb to your specific requirements with ease. Enable, disable, and configure features effortlessly, allowing you to customize the security settings according to your unique use case.</p>
</li>
<li>
<p><strong>Secure by default</strong>: BunkerWeb provides out-of-the-box, hassle-free minimal security for your web services. Experience peace of mind and enhanced protection right from the start.</p>
</li>
<li>
<p><strong>Awesome web UI</strong>: Take control of BunkerWeb more efficiently with the exceptional web user interface (UI). Navigate settings and configurations effortlessly through a user-friendly graphical interface, eliminating the need for the command-line interface (CLI).</p>
</li>
<li>
<p><strong>Plugin system</strong>: Extend the capabilities of BunkerWeb to meet your own use cases. Seamlessly integrate additional security measures and customize the functionality of BunkerWeb according to your specific requirements.</p>
</li>
<li>
<p><strong>Free as in "freedom"</strong>: BunkerWeb is licensed under the free <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">AGPLv3 license</a>, embracing the principles of freedom and openness. Enjoy the freedom to use, modify, and distribute the software, backed by a supportive community.</p>
</li>
<li>
<p><strong>Professional services</strong>: Get technical support, tailored consulting, and custom development directly from the maintainers of BunkerWeb. Visit the <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">BunkerWeb Panel</a> for more information.</p>
</li>
</ul>
<h2 id="index-security-features">Security features</h2>
<p>Explore the impressive array of security features offered by BunkerWeb. While not exhaustive, here are some notable highlights:</p>
<ul>
<li>
<p><strong>HTTPS</strong> support with transparent <strong>Let's Encrypt</strong> automation: Easily secure your web services with automated Let's Encrypt integration, ensuring encrypted communication between clients and your server.</p>
</li>
<li>
<p><strong>State-of-the-art web security</strong>: Benefit from cutting-edge web security measures, including comprehensive HTTP security headers, prevention of data leaks, and TLS hardening techniques.</p>
</li>
<li>
<p>Integrated <strong>ModSecurity WAF</strong> with the <strong>OWASP Core Rule Set</strong>: Enjoy enhanced protection against web application attacks with the integration of ModSecurity, fortified by the renowned OWASP Core Rule Set.</p>
</li>
<li>
<p><strong>Automatic ban</strong> of strange behaviors based on HTTP status codes: BunkerWeb intelligently identifies and blocks suspicious activities by automatically banning behaviors that trigger abnormal HTTP status codes.</p>
</li>
<li>
<p>Apply <strong>connection and request limits</strong> for clients: Set limits on the number of connections and requests from clients, preventing resource exhaustion and ensuring fair usage of server resources.</p>
</li>
<li>
<p><strong>Block bots</strong> with <strong>challenge-based verification</strong>: Keep malicious bots at bay by challenging them to solve puzzles such as cookies, JavaScript tests, captchas, hCaptcha, reCAPTCHA, or Turnstile, effectively blocking unauthorized access.</p>
</li>
<li>
<p><strong>Block known bad IPs</strong> with external blacklists and DNSBL: Utilize external blacklists and DNS-based blackhole lists (DNSBL) to proactively block known malicious IP addresses, bolstering your defense against potential threats.</p>
</li>
<li>
<p><strong>And much more...</strong>: BunkerWeb is packed with a plethora of additional security features that go beyond this list, providing you with comprehensive protection and peace of mind.</p>
</li>
</ul>
<p>To delve deeper into the core security features, we invite you to explore the <a href="#advanced-security-tuning">security tuning</a> section of the documentation. Discover how BunkerWeb empowers you to fine-tune and optimize security measures according to your specific needs.</p>
<h2 id="index-demo">Demo</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/ZhYV-QELzA4" title="Fooling automated tools and scanners" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<p>A demo website protected with BunkerWeb is available at <a href="https://demo.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">demo.bunkerweb.io</a>. Feel free to visit it and perform some security tests.</p>
<h2 id="index-web-ui">Web UI</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/tGS3pzquEjY" title="BunkerWeb web UI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<p>BunkerWeb offers an optional <a href="#web-ui">user interface</a> to manage your instances and their configurations. An online read-only demo is available at <a href="https://demo-ui.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">demo-ui.bunkerweb.io</a>. Feel free to test it yourself.</p>
<h2 id="index-bunkerweb-cloud">BunkerWeb Cloud</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/bunkerweb-cloud.webp" width="600" />
  </p>
<figcaption>BunkerWeb Cloud</figcaption>
</figure>
<p>Don't want to self-host and manage your own BunkerWeb instance(s)? You might be interested in BunkerWeb Cloud, our fully managed SaaS offering for BunkerWeb.</p>
<p>Try our <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">BunkerWeb Cloud offer</a> and get access to:</p>
<ul>
<li>A fully managed BunkerWeb instance hosted in our cloud</li>
<li>All BunkerWeb features, including PRO ones</li>
<li>A monitoring platform with dashboards and alerts</li>
<li>Technical support to assist you with configuration</li>
</ul>
<p>If you are interested in the BunkerWeb Cloud offering, don't hesitate to <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contact us</a> so we can discuss your needs.</p>
<h2 id="index-pro-version">PRO version</h2>
<div class="admonition tip">
<p class="admonition-title">BunkerWeb PRO free trial</p>
<p>Want to quickly test BunkerWeb PRO for one month? Use the code <code>freetrial</code> when placing your order on the <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">BunkerWeb panel</a> or by clicking <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">here</a> to directly to apply the promo code (will be effective at checkout).</p>
</div>
<p>When using BunkerWeb, you have the choice of the version you want to use: open-source or PRO.</p>
<p>Whether it's enhanced security, an enriched user experience, or technical monitoring, the BunkerWeb PRO version allows you to fully benefit from BunkerWeb and meet your professional needs.</p>
<p>In the documentation or the user interface, PRO features are annotated with a crown <img src="../assets/img/pro-icon.svg" alt="crown pro icon" height="32px" width="32px"> to distinguish them from those integrated into the open-source version.</p>
<p>You can upgrade from the open-source version to the PRO one easily and at any time. The process is straightforward:</p>
<ul>
<li>Claim your <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">free trial on the BunkerWeb panel</a> by using the <code>freetrial</code> promo code at checkout</li>
<li>Once connected to the client area, copy your PRO license key</li>
<li>Paste your private key into BunkerWeb using the <a href="#web-ui-upgrade-to-pro">web UI</a> or <a href="#features-pro">specific setting</a></li>
</ul>
<p>Do not hesitate to visit the <a href="https://panel.bunkerweb.io/knowledgebase?utm_campaign=self&amp;utm_source=doc">BunkerWeb panel</a> or <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contact us</a> if you have any questions regarding the PRO version.</p>
<h2 id="index-professional-services">Professional services</h2>
<p>Get the most out of BunkerWeb by accessing professional services directly from the maintainers of the project. From technical support to tailored consulting and development, we are here to assist you in securing your web services.</p>
<p>You will find more information by visiting the <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">BunkerWeb Panel</a>, our dedicated platform for professional services.</p>
<p>Don't hesitate to <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contact us</a> if you have any questions. We will be more than happy to respond to your needs.</p>
<h2 id="index-ecosystem-community-and-resources">Ecosystem, community, and resources</h2>
<p>Official websites, tools, and resources about BunkerWeb:</p>
<ul>
<li><a href="https://www.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Website</strong></a>: Get more information, news, and articles about BunkerWeb.</li>
<li><a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Panel</strong></a>: A dedicated platform to order and manage professional services (e.g., technical support) around BunkerWeb.</li>
<li><a href="https://docs.bunkerweb.io"><strong>Documentation</strong></a>: Technical documentation of the BunkerWeb solution.</li>
<li><a href="https://demo.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Demo</strong></a>: Demonstration website of BunkerWeb. Don't hesitate to attempt attacks to test the robustness of the solution.</li>
<li><a href="https://demo-ui.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Web UI</strong></a>: Online read-only demo of the web UI of BunkerWeb.</li>
<li><a href="https://threatmap.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc"><strong>Threatmap</strong></a>: Live cyberattacks blocked by BunkerWeb instances all around the world.</li>
</ul>
<p>Community and social networks:</p>
<ul>
<li><a href="https://discord.com/invite/fTf46FmtyD"><strong>Discord</strong></a></li>
<li><a href="https://www.linkedin.com/company/bunkerity/"><strong>LinkedIn</strong></a></li>
<li><a href="https://twitter.com/bunkerity"><strong>Twitter</strong></a></li>
<li><a href="https://www.reddit.com/r/BunkerWeb/"><strong>Reddit</strong></a></li>
</ul></section><section class="print-page" id="concepts" heading-number="2"><h1 id="concepts-concepts">Concepts</h1>
<h2 id="concepts-architecture">Architecture</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/concepts.svg" width="600" /></p>
</figure>
<p>Within your infrastructure, BunkerWeb acts as a reverse proxy in front of your web services. The typical architecture involves accessing BunkerWeb from the Internet, which then forwards requests to the appropriate application service on a secure network.</p>
<p>Using BunkerWeb in this way (classical reverse proxy architecture) with TLS offloading and centralized security policies enhances performance by reducing encryption overhead on backend servers while ensuring consistent access control, threat mitigation, and compliance enforcement across all services.</p>
<h2 id="concepts-integrations">Integrations</h2>
<p>The first concept is the integration of BunkerWeb into the target environment. We prefer to use the word "integration" instead of "installation" because one of BunkerWeb's goals is to integrate seamlessly into existing environments.</p>
<p>The following integrations are officially supported:</p>
<ul>
<li><a href="#integrations-docker">Docker</a></li>
<li><a href="#integrations-linux">Linux</a></li>
<li><a href="#integrations-docker-autoconf">Docker autoconf</a></li>
<li><a href="#integrations-kubernetes">Kubernetes</a></li>
<li><a href="#integrations-swarm">Swarm</a></li>
</ul>
<p>If you think a new integration should be supported, do not hesitate to open a <a href="https://github.com/bunkerity/bunkerweb/issues">new issue</a> on the GitHub repository.</p>
<div class="admonition info">
<p class="admonition-title">Going further</p>
<p>The technical details of all BunkerWeb integrations are available in the <a href="#integrations">integrations section</a> of the documentation.</p>
</div>
<h2 id="concepts-settings">Settings</h2>
<div class="admonition tip">
<p class="admonition-title">BunkerWeb PRO settings</p>
<p>Some plugins are reserved for the <strong>PRO version</strong>. Want to quickly test BunkerWeb PRO for one month? Use the code <code>freetrial</code> when placing your order on the <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">BunkerWeb panel</a> or by clicking <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">here</a> to directly to apply the promo code (will be effective at checkout).</p>
</div>
<p>Once BunkerWeb is integrated into your environment, you will need to configure it to serve and protect your web applications.</p>
<p>The configuration of BunkerWeb is done using what we call "settings" or "variables." Each setting is identified by a name such as <code>AUTO_LETS_ENCRYPT</code> or <code>USE_ANTIBOT</code>. You can assign values to these settings to configure BunkerWeb.</p>
<p>Here is a dummy example of a BunkerWeb configuration:</p>
<div class="highlight"><pre><span></span><code>SERVER_NAME=www.example.com
AUTO_LETS_ENCRYPT=yes
USE_ANTIBOT=captcha
REFERRER_POLICY=no-referrer
USE_MODSECURITY=no
USE_GZIP=yes
USE_BROTLI=no
</code></pre></div>
<p>Please note that if you are using the web User Interface, the setting names are also displayed in addition to a "human-friendly" label:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/settings-ui1.png" width="800" />
  </p>
<figcaption>Settings name in the web UI</figcaption>
</figure>
<p>You can also use the search bar and directly specify a setting name:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/settings-ui2.png" width="600" />
  </p>
<figcaption>Settings search in the web UI</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Going further</p>
<p>The complete list of available settings with descriptions and possible values is available in the <a href="#features">settings section</a> of the documentation.</p>
</div>
<h2 id="concepts-multisite-mode">Multisite mode</h2>
<p>Understanding the multisite mode is essential when utilizing BunkerWeb. As our primary focus is safeguarding web applications, our solution is intricately linked to the concept of "virtual hosts" or "vhosts" (more info <a href="https://en.wikipedia.org/wiki/Virtual_hosting">here</a>). These virtual hosts enable the serving of multiple web applications from a single instance or cluster.</p>
<p>By default, BunkerWeb has the multisite mode disabled. This means that only one web application will be served, and all settings will be applied to it. This setup is ideal when you have a single application to protect, as you don't need to concern yourself with multisite configurations.</p>
<p>However, when the multisite mode is enabled, BunkerWeb becomes capable of serving and protecting multiple web applications. Each web application is identified by a unique server name and has its own set of settings. This mode proves beneficial when you have multiple applications to secure, and you prefer to utilize a single instance (or a cluster) of BunkerWeb.</p>
<p>The activation of the multisite mode is controlled by the <code>MULTISITE</code> setting, which can be set to <code>yes</code> to enable it or <code>no</code> to keep it disabled (the default value).</p>
<p>Each setting within BunkerWeb has a specific context that determines where it can be applied. If the context is set to "global," the setting can't be applied per server or site but is instead applied to the entire configuration as a whole. On the other hand, if the context is "multisite," the setting can be applied globally and per server. To define a multisite setting for a specific server, simply add the server name as a prefix to the setting name. For example, <code>app1.example.com_AUTO_LETS_ENCRYPT</code> or <code>app2.example.com_USE_ANTIBOT</code> are examples of setting names with server name prefixes. When a multisite setting is defined globally without a server prefix, all servers inherit that setting. However, individual servers can still override the setting if the same setting is defined with a server name prefix.</p>
<p>Understanding the intricacies of multisite mode and its associated settings allows you to tailor BunkerWeb's behavior to suit your specific requirements, ensuring optimal protection for your web applications.</p>
<p>Here's a dummy example of a multisite BunkerWeb configuration:</p>
<div class="highlight"><pre><span></span><code>MULTISITE=yes
SERVER_NAME=app1.example.com app2.example.com app3.example.com
AUTO_LETS_ENCRYPT=yes
USE_GZIP=yes
USE_BROTLI=yes
app1.example.com_USE_ANTIBOT=javascript
app1.example.com_USE_MODSECURITY=no
app2.example.com_USE_ANTIBOT=cookie
app2.example.com_WHITELIST_COUNTRY=FR
app3.example.com_USE_BAD_BEHAVIOR=no
</code></pre></div>
<p>Please note that multisite mode is implicit when using the web User Interface. You have the option to apply configurations directly to your services or to set a global configuration that will be applied to all your services (you can still apply exceptions directly to specific services):</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/ui-multisite.png" width="600" />
  </p>
<figcaption>Apply a setting to all services from the web UI</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Going further</p>
<p>You will find concrete examples of multisite mode in the <a href="#advanced">advanced usages</a> of the documentation and the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/examples">examples</a> directory of the repository.</p>
</div>
<h2 id="concepts-custom-configurations">Custom configurations</h2>
<p>To address unique challenges and cater to specific use cases, BunkerWeb offers the flexibility of custom configurations. While the provided settings and <a href="#plugins">external plugins</a> cover a wide range of scenarios, there may be situations that require additional customization.</p>
<p>BunkerWeb is built on the renowned NGINX web server, which provides a powerful configuration system. This means you can leverage NGINX's configuration capabilities to meet your specific needs. Custom NGINX configurations can be included in various <a href="https://docs.nginx.com/nginx/admin-guide/basic-functionality/managing-configuration-files/#contexts">contexts</a> such as HTTP or server, allowing you to fine-tune the behavior of BunkerWeb according to your requirements. Whether you need to customize global settings or apply configurations to specific server blocks, BunkerWeb empowers you to optimize its behavior to align perfectly with your use case.</p>
<p>Another integral component of BunkerWeb is the ModSecurity Web Application Firewall. With custom configurations, you have the flexibility to address false positives or add custom rules to further enhance the protection provided by ModSecurity. These custom configurations allow you to fine-tune the behavior of the firewall and ensure that it aligns with the specific requirements of your web applications.</p>
<p>By leveraging custom configurations, you unlock a world of possibilities to tailor BunkerWeb's behavior and security measures precisely to your needs. Whether it's adjusting NGINX configurations or fine-tuning ModSecurity, BunkerWeb provides the flexibility to meet your unique challenges effectively.</p>
<p>Managing custom configurations from the web User Interface is done through the <strong>Configs</strong> menu:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/configs-ui.png" width="800" />
  </p>
<figcaption>Manage custom configurations from the web UI</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Going further</p>
<p>You will find concrete examples of custom configurations in the <a href="#advanced-custom-configurations">advanced usages</a> of the documentation and the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/examples">examples</a> directory of the repository.</p>
</div>
<h2 id="concepts-database">Database</h2>
<p>BunkerWeb securely stores its current configuration in a backend database, which contains essential data for smooth operation. The following information is stored in the database:</p>
<ul>
<li>
<p><strong>Settings for all services</strong>: The database holds the defined settings for all the services provided by BunkerWeb. This ensures that your configurations and preferences are preserved and readily accessible.</p>
</li>
<li>
<p><strong>Custom configurations</strong>: Any custom configurations you create are also stored in the backend database. This includes personalized settings and modifications tailored to your specific requirements.</p>
</li>
<li>
<p><strong>BunkerWeb instances</strong>: Information about BunkerWeb instances, including their setup and relevant details, is stored in the database. This allows for easy management and monitoring of multiple instances if applicable.</p>
</li>
<li>
<p><strong>Metadata about job execution</strong>: The database stores metadata related to the execution of various jobs within BunkerWeb. This includes information about scheduled tasks, maintenance processes, and other automated activities.</p>
</li>
<li>
<p><strong>Cached files</strong>: BunkerWeb utilizes caching mechanisms for improved performance. The database holds cached files, ensuring efficient retrieval and delivery of frequently accessed resources.</p>
</li>
</ul>
<p>Under the hood, whenever you edit a setting or add a new configuration, BunkerWeb automatically stores the changes in the database, ensuring data persistence and consistency. BunkerWeb supports multiple backend database options, including SQLite, MariaDB, MySQL, and PostgreSQL.</p>
<p>Configuring the database is straightforward using the <code>DATABASE_URI</code> setting, which follows the specified formats for each supported database:</p>
<ul>
<li><strong>SQLite</strong>: <code>sqlite:///var/lib/bunkerweb/db.sqlite3</code></li>
<li><strong>MariaDB</strong>: <code>mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db</code></li>
<li><strong>MySQL</strong>: <code>mysql+pymysql://bunkerweb:changeme@bw-db:3306/db</code></li>
<li><strong>PostgreSQL</strong>: <code>postgresql://bunkerweb:changeme@bw-db:5432/db</code></li>
</ul>
<p>By specifying the appropriate database URI in the configuration, you can seamlessly integrate BunkerWeb with your preferred database backend, ensuring efficient and reliable storage of your configuration data.</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/bunkerweb_db.svg" width="800" />
  </p>
<figcaption>Database Schema</figcaption>
</figure>
<h2 id="concepts-scheduler">Scheduler</h2>
<p>For seamless coordination and automation, BunkerWeb employs a specialized service known as the scheduler. The scheduler plays a vital role in ensuring smooth operation by performing the following tasks:</p>
<ul>
<li>
<p><strong>Storing settings and custom configurations</strong>: The scheduler is responsible for storing all the settings and custom configurations within the backend database. This centralizes the configuration data, making it easily accessible and manageable.</p>
</li>
<li>
<p><strong>Executing various tasks (jobs)</strong>: The scheduler handles the execution of various tasks, referred to as jobs. These jobs encompass a range of activities, such as periodic maintenance, scheduled updates, or any other automated tasks required by BunkerWeb.</p>
</li>
<li>
<p><strong>Generating BunkerWeb configuration</strong>: The scheduler generates a configuration that is readily understood by BunkerWeb. This configuration is derived from the stored settings and custom configurations, ensuring that the entire system operates cohesively.</p>
</li>
<li>
<p><strong>Acting as an intermediary for other services</strong>: The scheduler acts as an intermediary, facilitating communication and coordination between different components of BunkerWeb. It interfaces with services such as the web UI or autoconf, ensuring a seamless flow of information and data exchange.</p>
</li>
</ul>
<p>In essence, the scheduler serves as the brain of BunkerWeb, orchestrating various operations and ensuring the smooth functioning of the system.</p>
<p>Depending on the integration approach, the execution environment of the scheduler may differ. In container-based integrations, the scheduler is executed within its dedicated container, providing isolation and flexibility. On the other hand, for Linux-based integrations, the scheduler is self-contained within the bunkerweb service, simplifying the deployment and management process.</p>
<p>By employing the scheduler, BunkerWeb streamlines the automation and coordination of essential tasks, enabling efficient and reliable operation of the entire system.</p>
<p>If you are using the web User Interface, you can manage scheduler jobs by clicking on <strong>Jobs</strong> from the menu:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/jobs-ui.png" width="800" />
  </p>
<figcaption>Manage jobs from the web UI</figcaption>
</figure>
<p><strong>Instances health check</strong></p>
<p>Since version 1.6.0, the scheduler possesses a built-in health check system that monitors the health of instances. If an instance becomes unhealthy, the scheduler will stop sending the configuration to it. If the instance becomes healthy again, the scheduler will resume sending the configuration.</p>
<p>The health check interval is set by the <code>HEALTHCHECK_INTERVAL</code> environment variable, with a default value of <code>30</code>, meaning the scheduler will check the health of the instances every 30 seconds.</p>
<h2 id="concepts-templates">Templates</h2>
<p>BunkerWeb leverages the power of templates to simplify the configuration process and enhance flexibility. Templates provide a structured and standardized approach to defining settings and custom configurations, ensuring consistency and ease of use.</p>
<ul>
<li>
<p><strong>Predefined templates</strong>: The community version offers three predefined templates that encapsulate common custom configurations and settings. These templates serve as a starting point for configuring BunkerWeb, enabling quick setup and deployment. The predefined templates are the following:</p>
<ul>
<li><strong>low</strong>: A basic template that provides essential settings for web application protection.</li>
<li><strong>medium</strong>: A balanced template that offers a mix of security features and performance optimizations.</li>
<li><strong>high</strong>: An advanced template that focuses on robust security measures and comprehensive protection.</li>
</ul>
</li>
<li>
<p><strong>Custom templates</strong>: In addition to predefined templates, BunkerWeb allows users to create custom templates tailored to their specific requirements. Custom templates enable fine-tuning of settings and custom configurations, ensuring that BunkerWeb aligns perfectly with the user's needs.</p>
</li>
</ul>
<p>With the web User Interface, templates are available through <strong>easy mode</strong> when you add or edit a service:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/templates-ui.png" width="800" />
  </p>
<figcaption>Templates usage from the web UI</figcaption>
</figure>
<p><strong>Creating custom templates</strong></p>
<p>Creating a custom template is a straightforward process that involves defining the desired settings, custom configurations, and steps in a structured format.</p>
<ul>
<li><strong>Template structure</strong>: A custom template consists of a name, a series of settings, custom configurations, and optional steps. The template structure is defined in a JSON file that adheres to the specified format. The key components of a custom template include:<ul>
<li><strong>Settings</strong>: A setting is defined with a name and corresponding value. This value will override the default value of the setting. <strong>Only multisite settings are supported.</strong></li>
<li><strong>Configs</strong>: A custom configuration is a path to an NGINX configuration file that will be included as a custom configuration. To know where to place the custom configuration file, refer to the example of a plugin's tree below. <strong>Only multisite configuration types are supported.</strong></li>
<li><strong>Steps</strong>: A step contains a title, subtitle, settings, and custom configurations. Each step represents a configuration step that the user can follow to set up BunkerWeb according to the custom template in the web UI.</li>
</ul>
</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Specifications about steps</p>
<p>If steps are declared, <strong>it is not mandatory to include all the settings and custom configurations in the settings and configs sections</strong>. Keep in mind that when a setting or a custom configuration is declared in a step, the user will be allowed to make edits to it in the web UI.</p>
</div>
<ul>
<li>
<p><strong>Template file</strong>: The custom template is defined in a JSON file in a <code>templates</code> folder inside the plugin directory that adheres to the specified structure. The template file contains a name, the settings, custom configurations, and steps required to configure BunkerWeb according to the user's preferences.</p>
</li>
<li>
<p><strong>Selecting a template</strong>: Once the custom template is defined, users can select it during the easy-mode configuration process of a service in the web UI. A template can also be selected with the <code>USE_TEMPLATE</code> setting in the configuration. The name of the template file (without the <code>.json</code> extension) should be specified as the value of the <code>USE_TEMPLATE</code> setting.</p>
</li>
</ul>
<p>Example of a custom template file:
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;template name&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="c1">// optional</span>
<span class="w">    </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;SETTING_1&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;SETTING_2&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;value&quot;</span>
<span class="w">    </span><span class="p">},</span>
<span class="w">    </span><span class="c1">// optional</span>
<span class="w">    </span><span class="nt">&quot;configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="s2">&quot;modsec/false_positives.conf&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;modsec/non_editable.conf&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="s2">&quot;modsec-crs/custom_rules.conf&quot;</span>
<span class="w">    </span><span class="p">],</span>
<span class="w">    </span><span class="c1">// optional</span>
<span class="w">    </span><span class="nt">&quot;steps&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Title 1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;subtitle&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subtitle 1&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;SETTING_1&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;modsec-crs/custom_rules.conf&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">},</span>
<span class="w">        </span><span class="p">{</span>
<span class="w">            </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Title 2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;subtitle&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;subtitle 2&quot;</span><span class="p">,</span>
<span class="w">            </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;SETTING_2&quot;</span>
<span class="w">            </span><span class="p">],</span>
<span class="w">            </span><span class="nt">&quot;configs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">                </span><span class="s2">&quot;modsec/false_positives.conf&quot;</span>
<span class="w">            </span><span class="p">]</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div></p>
<p>Example of a plugin's tree including custom templates:
<div class="highlight"><pre><span></span><code>.
├── plugin.json
└── templates
    ├── my_other_template.json
    ├── my_template
    │   └── configs
    │       ├── modsec
    │       │   ├── false_positives.conf
    │       │   └── non_editable.conf
    │       └── modsec-crs
    │           └── custom_rules.conf
    └── my_template.json
</code></pre></div></p></section><section class="print-page" id="integrations" heading-number="3"><h1 id="integrations-integrations">Integrations</h1>
<h2 id="integrations-bunkerweb-cloud">BunkerWeb Cloud</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/bunkerweb-cloud.webp" width="600" />
  </p>
<figcaption>BunkerWeb Cloud</figcaption>
</figure>
<p>BunkerWeb Cloud will be the easiest way to get started with BunkerWeb. It offers you a fully managed BunkerWeb service with no hassle. Think of it as a BunkerWeb-as-a-Service!</p>
<p>Try our <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">BunkerWeb Cloud offer</a> and get access to:</p>
<ul>
<li>A fully managed BunkerWeb instance hosted in our cloud</li>
<li>All BunkerWeb features, including PRO ones</li>
<li>A monitoring platform with dashboards and alerts</li>
<li>Technical support to assist you with configuration</li>
</ul>
<p>If you are interested in the BunkerWeb Cloud offering, don't hesitate to <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contact us</a> so we can discuss your needs.</p>
<h2 id="integrations-all-in-one-aio-image">All-In-One (AIO) Image</h2>
<figure>
<p><img align="center," alt="AIO Architecture Graph Placeholder" src="../assets/img/aio-graph-placeholder.png" width="600" />
  </p>
<figcaption>BunkerWeb All-In-One Architecture (AIO)</figcaption>
</figure>
<h3 id="integrations-deployment">Deployment</h3>
<p>To deploy the all-in-one container, all you have to do is run the following command:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>By default, the container exposes:</p>
<ul>
<li>8080/tcp for HTTP</li>
<li>8443/tcp for HTTPS</li>
<li>8443/udp for QUIC</li>
<li>7000/tcp for the web UI access without BunkerWeb in front (not recommended for production)</li>
</ul>
<p>The All-In-One image comes with several built-in services, which can be controlled using environment variables:</p>
<ul>
<li><code>SERVICE_UI=yes</code> (default) - Enables the web UI service</li>
<li><code>SERVICE_SCHEDULER=yes</code> (default) - Enables the Scheduler service</li>
<li><code>SERVICE_AUTOCONF=no</code> (default) - Enables the autoconf service</li>
<li><code>USE_REDIS=yes</code> (default) - Enables the built-in <a href="#integrations-redis-integration">Redis</a> instance</li>
<li><code>USE_CROWDSEC=no</code> (default) - <a href="#integrations-crowdsec-integration">CrowdSec</a> integration is disabled by default</li>
</ul>
<h3 id="integrations-accessing-the-setup-wizard">Accessing the Setup wizard</h3>
<p>By default, the setup wizard is automagically launched when you run the AIO container for the first time. To access it, follow these steps:</p>
<ol>
<li><strong>Start the AIO container</strong> as <a href="#integrations-deployment">above</a>, ensuring <code>SERVICE_UI=yes</code> (default).</li>
<li><strong>Access the UI</strong> via your main BunkerWeb endpoint, e.g. <code>https://your-domain</code>.</li>
</ol>
<blockquote>
<p>Follow the next steps in the <a href="#quickstart-guide-complete-the-setup-wizard">Quickstart guide</a> to set up the Web UI.</p>
</blockquote>
<h3 id="integrations-redis-integration">Redis Integration</h3>
<p>The BunkerWeb <strong>All-In-One</strong> image includes Redis out-of-the-box for the <a href="#advanced-persistence-of-bans-and-reports">persistence of bans and reports</a>. To manage Redis:</p>
<ul>
<li>To disable Redis, set <code>USE_REDIS=no</code> or point <code>REDIS_HOST</code> to an external host.</li>
<li>Redis logs appear with <code>[REDIS]</code> prefix in Docker logs and <code>/var/log/bunkerweb/redis.log</code>.</li>
</ul>
<h3 id="integrations-crowdsec-integration">CrowdSec Integration</h3>
<p>The BunkerWeb <strong>All-In-One</strong> Docker image comes with CrowdSec fully integrated—no extra containers or manual setup required. Follow the steps below to enable, configure, and extend CrowdSec in your deployment.</p>
<p>By default, CrowdSec is <strong>disabled</strong>. To turn it on, simply add the <code>USE_CROWDSEC</code> environment variable:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<ul>
<li>
<p>When <code>USE_CROWDSEC=yes</code>, the entrypoint will:</p>
<ol>
<li><strong>Register</strong> and <strong>start</strong> the local CrowdSec agent (via <code>cscli</code>).</li>
<li><strong>Install or upgrade</strong> default collections &amp; parsers.</li>
<li><strong>Configure</strong> the <code>crowdsec-bunkerweb-bouncer/v1.6</code> bouncer.</li>
</ol>
</li>
</ul>
<hr />
<h4 id="integrations-default-collections-parsers">Default Collections &amp; Parsers</h4>
<p>On first startup (or after upgrading), these assets are automatically installed and kept up to date:</p>
<table>
<thead>
<tr>
<th>Type</th>
<th>Name</th>
<th>Purpose</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Collection</strong></td>
<td><code>crowdsecurity/nginx</code></td>
<td>Defend Nginx servers against a broad array of HTTP-based attacks, from brute-force to injection attempts.</td>
</tr>
<tr>
<td><strong>Collection</strong></td>
<td><code>crowdsecurity/appsec-virtual-patching</code></td>
<td>Delivers a dynamically updated WAF-style rule set targeting known CVEs, automatically patched daily to shield web applications from newly discovered vulnerabilities.</td>
</tr>
<tr>
<td><strong>Collection</strong></td>
<td><code>crowdsecurity/appsec-generic-rules</code></td>
<td>Complements <code>crowdsecurity/appsec-virtual-patching</code> with heuristics for generic application-layer attack patterns—such as enumeration, path traversal, and automated probes—filling gaps where CVE-specific rules don’t yet exist.</td>
</tr>
<tr>
<td><strong>Parser</strong></td>
<td><code>crowdsecurity/geoip-enrich</code></td>
<td>Enriches events with GeoIP context</td>
</tr>
</tbody>
</table>
<details>
<summary><strong>How it works internally</strong></summary>

The entrypoint script invokes:

<div class="highlight"><pre><span></span><code>cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/nginx
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-virtual-patching
cscli<span class="w"> </span>install<span class="w"> </span>collection<span class="w"> </span>crowdsecurity/appsec-generic-rules
cscli<span class="w"> </span>install<span class="w"> </span>parser<span class="w">     </span>crowdsecurity/geoip-enrich
</code></pre></div>

</details>

<hr />
<h4 id="integrations-adding-extra-collections">Adding Extra Collections</h4>
<p>Need more coverage? Define <code>CROWDSEC_EXTRA_COLLECTIONS</code> with a space-separated list of Hubb collections:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_EXTRA_COLLECTIONS</span><span class="o">=</span><span class="s2">&quot;crowdsecurity/apache2 crowdsecurity/mysql&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">How it works internally</p>
<p>The script loops through each name and installs or upgrades as needed—no manual steps required.</p>
</div>
<hr />
<h4 id="integrations-appsec-toggle">AppSec Toggle</h4>
<p>CrowdSec <a href="https://docs.crowdsec.net/docs/appsec/intro/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">AppSec</a> features—powered by the <code>appsec-virtual-patching</code> and <code>appsec-generic-rules</code> collections—are <strong>enabled by default</strong>.</p>
<p>To <strong>disable</strong> all AppSec (WAF/virtual-patching) functionality, set:</p>
<div class="highlight"><pre><span></span><code>-e<span class="w"> </span><span class="nv">CROWDSEC_APPSEC_URL</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
</code></pre></div>
<p>This effectively turns off the AppSec endpoint so no rules are applied.</p>
<hr />
<h4 id="integrations-external-crowdsec-api">External CrowdSec API</h4>
<p>If you operate a remote CrowdSec instance, point the container to your API:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">USE_CROWDSEC</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">CROWDSEC_API</span><span class="o">=</span><span class="s2">&quot;https://crowdsec.example.com:8000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<ul>
<li><strong>Local registration</strong> is skipped when <code>CROWDSEC_API</code> is not <code>127.0.0.1</code> or <code>localhost</code>.</li>
<li><strong>AppSec</strong> is disabled by default when using an external API. To enable it, set <code>CROWDSEC_APPSEC_URL</code> to your desired endpoint.</li>
<li>Bouncer registration still occurs against the remote API.</li>
<li>To reuse an existing bouncer key, supply <code>CROWDSEC_API_KEY</code> with your pre-generated token.</li>
</ul>
<hr />
<div class="admonition tip">
<p class="admonition-title">More options</p>
<p>For full coverage of all CrowdSec options (custom scenarios, logs, troubleshooting, and more), see the <a href="#features-crowdsec">BunkerWeb CrowdSec plugin docs</a> or visit the <a href="https://www.crowdsec.net/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">official CrowdSec website</a>.</p>
</div>
<h2 id="integrations-docker">Docker</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/integration-docker.svg" width="600" />
  </p>
<figcaption>Docker integration</figcaption>
</figure>
<p>Using BunkerWeb as a <a href="https://www.docker.com/">Docker</a> container offers a convenient and straightforward approach for testing and utilizing the solution, particularly if you are already familiar with Docker technology.</p>
<p>To facilitate your Docker deployment, we provide readily available prebuilt images on <a href="https://hub.docker.com/r/bunkerity/bunkerweb">Docker Hub</a>, supporting multiple architectures. These prebuilt images are optimized and prepared for use on the following architectures:</p>
<ul>
<li>x64 (64-bit)</li>
<li>x86</li>
<li>armv8 (ARM 64-bit)</li>
<li>armv7 (ARM 32-bit)</li>
</ul>
<p>By accessing these prebuilt images from Docker Hub, you can quickly pull and run BunkerWeb within your Docker environment, eliminating the need for extensive configuration or setup processes. This streamlined approach allows you to focus on leveraging the capabilities of BunkerWeb without unnecessary complexities.</p>
<p>Whether you're conducting tests, developing applications, or deploying BunkerWeb in production, the Docker containerization option provides flexibility and ease of use. Embracing this method empowers you to take full advantage of BunkerWeb's features while leveraging the benefits of Docker technology.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb:1.6.2
</code></pre></div>
<p>Docker images are also available on <a href="https://github.com/orgs/bunkerity/packages?repo_name=bunkerweb">GitHub packages</a> and can be downloaded using the <code>ghcr.io</code> repository address:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>ghcr.io/bunkerity/bunkerweb:1.6.2
</code></pre></div>
<p>Key concepts for Docker integration include:</p>
<ul>
<li><strong>Environment variables</strong>: Configure BunkerWeb easily using environment variables. These variables allow you to customize various aspects of BunkerWeb's behavior, such as network settings, security options, and other parameters.</li>
<li><strong>Scheduler container</strong>: Manage configuration and execute jobs using a dedicated container called the <a href="#concepts-scheduler">scheduler</a>.</li>
<li><strong>Networks</strong>: Docker networks play a vital role in the integration of BunkerWeb. These networks serve two main purposes: exposing ports to clients and connecting to upstream web services. By exposing ports, BunkerWeb can accept incoming requests from clients, allowing them to access the protected web services. Additionally, by connecting to upstream web services, BunkerWeb can efficiently route and manage traffic, providing enhanced security and performance.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>Please note that our instructions assume you are using SQLite as the default database backend, as configured by the <code>DATABASE_URI</code> setting. However, other database backends are also supported. See the docker-compose files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository for more information.</p>
</div>
<h3 id="integrations-environment-variables">Environment variables</h3>
<p>Settings are passed to the Scheduler using Docker environment variables:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">MY_SETTING=value</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ANOTHER_SETTING=another value</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Full list</p>
<p>For the complete list of environment variables, see the <a href="#features">settings section</a> of the documentation.</p>
</div>
<h3 id="integrations-using-docker-secrets">Using Docker secrets</h3>
<p>Instead of passing sensitive settings via environment variables, you can store them as Docker secrets. For each setting you want to secure, create a Docker secret with the name matching the setting key (in uppercase). BunkerWeb's entrypoint scripts automatically load secrets from <code>/run/secrets</code> and export them as environment variables.</p>
<p>Example:
<div class="highlight"><pre><span></span><code><span class="c1"># Create a Docker secret for ADMIN_PASSWORD</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;S3cr3tP@ssw0rd&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>secret<span class="w"> </span>create<span class="w"> </span>ADMIN_PASSWORD<span class="w"> </span>-
</code></pre></div></p>
<p>Mount the secrets when deploying:
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">secrets</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ADMIN_PASSWORD</span>
<span class="nn">...</span>
<span class="nt">secrets</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div></p>
<p>This ensures sensitive settings are kept out of the environment and logs.</p>
<h3 id="integrations-scheduler">Scheduler</h3>
<p>The <a href="#concepts-scheduler">scheduler</a> runs in its own container, which is also available on Docker Hub:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-scheduler:1.6.2
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">BunkerWeb settings</p>
<p>Since version <code>1.6.0</code>, the Scheduler container is where you define the settings for BunkerWeb. The Scheduler then pushes the configuration to the BunkerWeb container.</p>
<p>⚠ <strong>Important</strong>: All API-related settings (like <code>API_HTTP_PORT</code>, <code>API_LISTEN_IP</code>, <code>API_SERVER_NAME</code>, and <code>API_WHITELIST_IP</code>) <strong>must also be defined in the BunkerWeb container</strong>. (The settings must be mirrored in both containers; otherwise, the BunkerWeb container will not accept API requests from the Scheduler).</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">API_HTTP_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5000&quot;</span><span class="w"> </span><span class="c1"># Default value</span>
<span class="w">  </span><span class="nt">API_LISTEN_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.0.0.0&quot;</span><span class="w"> </span><span class="c1"># Default value</span>
<span class="w">  </span><span class="nt">API_SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bwapi&quot;</span><span class="w"> </span><span class="c1"># Default value</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Set this according to your network settings</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># This will set the API settings for the BunkerWeb container</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># This will set the API settings for the Scheduler container</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<p>A volume is needed to store the SQLite database and backups used by the scheduler:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Using a local folder for persistent data</p>
<p>The scheduler runs as an <strong>unprivileged user with UID 101 and GID 101</strong> inside the container. This enhances security: in case a vulnerability is exploited, the attacker won't have full root (UID/GID 0) privileges.</p>
<p>However, if you use a <strong>local folder for persistent data</strong>, you must <strong>set the correct permissions</strong> so the unprivileged user can write data to it. For example:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Alternatively, if the folder already exists:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>If you are using <a href="https://docs.docker.com/engine/security/rootless">Docker in rootless mode</a> or <a href="https://podman.io/">Podman</a>, UIDs and GIDs in the container will be mapped to different ones on the host. You will first need to check your initial subuid and subgid:</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>For example, if you have a value of <strong>100000</strong>, the mapped UID/GID will be <strong>100100</strong> (100000 + 100):</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Or if the folder already exists:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
</div>
<h3 id="integrations-networks">Networks</h3>
<p>By default, the BunkerWeb container listens (inside the container) on <strong>8080/tcp</strong> for <strong>HTTP</strong>, <strong>8443/tcp</strong> for <strong>HTTPS</strong>, and <strong>8443/udp</strong> for <strong>QUIC</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Privileged ports in rootless mode or when using Podman</p>
<p>If you are using <a href="https://docs.docker.com/engine/security/rootless">Docker in rootless mode</a> and want to redirect privileged ports (&lt; 1024) like 80 and 443 to BunkerWeb, please refer to the prerequisites <a href="https://docs.docker.com/engine/security/rootless/#exposing-privileged-ports">here</a>.</p>
<p>If you are using <a href="https://podman.io/">Podman</a>, you can lower the minimum number for unprivileged ports:
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>sysctl<span class="w"> </span>net.ipv4.ip_unprivileged_port_start<span class="o">=</span><span class="m">1</span>
</code></pre></div></p>
</div>
<p>The typical BunkerWeb stack when using Docker integration contains the following containers:</p>
<ul>
<li>BunkerWeb</li>
<li>Scheduler</li>
<li>Your services</li>
</ul>
<p>For defense-in-depth purposes, we strongly recommend creating at least three different Docker networks:</p>
<ul>
<li><code>bw-services</code>: for BunkerWeb and your web services</li>
<li><code>bw-universe</code>: for BunkerWeb and the scheduler</li>
<li><code>bw-db</code>: for the database (if you are using one)</li>
</ul>
<p>To secure communication between the scheduler and the BunkerWeb API, <strong>it is important to authorize API calls</strong>. You can use the <code>API_WHITELIST_IP</code> setting to specify allowed IP addresses and subnets.</p>
<p><strong>It is strongly recommended to use a static subnet for the <code>bw-universe</code> network</strong> to enhance security. By implementing these measures, you can ensure that only authorized sources can access the BunkerWeb API, reducing the risk of unauthorized access or malicious activities:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This setting is mandatory to specify the BunkerWeb instance</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="nn">...</span>
<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Static subnet so only authorized sources can access the BunkerWeb API</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="integrations-full-compose-file">Full compose file</h3>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This setting is mandatory to specify the BunkerWeb instance</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Static subnet so only authorized sources can access the BunkerWeb API</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="integrations-build-from-source">Build from source</h3>
<p>Alternatively, if you prefer a more hands-on approach, you have the option to build the Docker image directly from the <a href="https://github.com/bunkerity/bunkerweb">source</a>. Building the image from source gives you greater control and customization over the deployment process. However, please note that this method may take some time to complete, depending on your hardware configuration (you can take a coffee ☕ if needed).</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw<span class="w"> </span>-f<span class="w"> </span>src/bw/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-scheduler<span class="w"> </span>-f<span class="w"> </span>src/scheduler/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-autoconf<span class="w"> </span>-f<span class="w"> </span>src/autoconf/Dockerfile<span class="w"> </span>.<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>bw-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<h2 id="integrations-linux">Linux</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/integration-linux.svg" width="600" />
  </p>
<figcaption>Linux integration</figcaption>
</figure>
<p>Supported Linux distributions for BunkerWeb (amd64/x86_64 and arm64/aarch64 architectures) include:</p>
<ul>
<li>Debian 12 "Bookworm"</li>
<li>Ubuntu 22.04 "Jammy"</li>
<li>Ubuntu 24.04 "Noble"</li>
<li>Fedora 40</li>
<li>Fedora 41</li>
<li>Fedora 42</li>
<li>Red Hat Enterprise Linux (RHEL) 8.10</li>
<li>Red Hat Enterprise Linux (RHEL) 9.6</li>
</ul>
<h3 id="integrations-easy-installation-script">Easy installation script</h3>
<p>For a simplified installation experience, BunkerWeb provides an easy install script that automatically handles the entire setup process, including NGINX installation, repository configuration, and service setup.</p>
<h4 id="integrations-quick-start">Quick start</h4>
<p>Download and run the installation script:</p>
<div class="highlight"><pre><span></span><code>wget<span class="w"> </span>https://raw.githubusercontent.com/bunkerity/bunkerweb/v1.6.2/misc/install-bunkerweb.sh
chmod<span class="w"> </span>+x<span class="w"> </span>install-bunkerweb.sh
sudo<span class="w"> </span>./install-bunkerweb.sh
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Security Notice</p>
<p>Before running any installation script, especially with elevated privileges, it's recommended to review the script content first.</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>install-bunkerweb.sh
</code></pre></div>
</div>
<h4 id="integrations-interactive-installation">Interactive installation</h4>
<p>By default, the script runs in interactive mode and will:</p>
<ol>
<li><strong>Detect your operating system</strong> and verify compatibility</li>
<li><strong>Ask about the setup wizard</strong> - choose whether to enable the web-based configuration interface</li>
<li><strong>Show RHEL database recommendations</strong> (if applicable) for external database support</li>
<li><strong>Install NGINX</strong> with the correct version for your distribution</li>
<li><strong>Install BunkerWeb</strong> and configure all services</li>
<li><strong>Provide next steps</strong> based on your configuration choices</li>
</ol>
<h4 id="integrations-command-line-options">Command line options</h4>
<p>The script supports various options for different installation scenarios:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Interactive installation (default)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh

<span class="c1"># Non-interactive with defaults (wizard enabled)</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--yes

<span class="c1"># Install without the setup wizard</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--no-wizard

<span class="c1"># Install a specific version</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--version<span class="w"> </span><span class="m">1</span>.6.0

<span class="c1"># Force installation on unsupported OS versions</span>
sudo<span class="w"> </span>./install-bunkerweb.sh<span class="w"> </span>--force

<span class="c1"># Show help</span>
./install-bunkerweb.sh<span class="w"> </span>--help
</code></pre></div>
<h4 id="integrations-what-the-script-does">What the script does</h4>
<p>The easy install script automatically:</p>
<ul>
<li><strong>Validates OS compatibility</strong> and warns about unsupported versions</li>
<li><strong>Installs NGINX</strong> from official repositories with the correct version</li>
<li><strong>Adds BunkerWeb repositories</strong> for your distribution</li>
<li><strong>Installs BunkerWeb packages</strong> and locks versions to prevent accidental upgrades</li>
<li><strong>Configures systemd services</strong> (bunkerweb, bunkerweb-scheduler, bunkerweb-ui)</li>
<li><strong>Sets up the setup wizard</strong> (if enabled) for easy web-based configuration</li>
<li><strong>Provides comprehensive next steps</strong> and resource links</li>
</ul>
<h4 id="integrations-rhelcentos-considerations">RHEL/CentOS considerations</h4>
<div class="admonition warning">
<p class="admonition-title">External database support on RHEL-based systems</p>
<p>If you plan to use an external database (recommended for production), you must install the appropriate database client package:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># For MariaDB</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mariadb

<span class="c1"># For MySQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql

<span class="c1"># For PostgreSQL</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>postgresql
</code></pre></div>
<p>This is required for the BunkerWeb Scheduler to connect to your external database.</p>
</div>
<h4 id="integrations-after-installation">After installation</h4>
<p>Depending on your choices during installation:</p>
<p><strong>With setup wizard enabled:</strong></p>
<ol>
<li>Access the setup wizard at: <code>https://your-server-ip/setup</code></li>
<li>Follow the guided configuration to set up your first protected service</li>
<li>Configure SSL/TLS certificates and other security settings</li>
</ol>
<p><strong>Without setup wizard:</strong></p>
<ol>
<li>Edit <code>/etc/bunkerweb/variables.env</code> to configure BunkerWeb manually</li>
<li>Add your server settings and protected services</li>
<li>Restart the scheduler: <code>sudo systemctl restart bunkerweb-scheduler</code></li>
</ol>
<h3 id="integrations-installation-using-package-manager">Installation using package manager</h3>
<p>Please ensure that you have <strong>NGINX 1.28.0 installed before installing BunkerWeb</strong>. For all distributions, except Fedora, it is mandatory to use prebuilt packages from the <a href="https://nginx.org/en/linux_packages.html">official NGINX repository</a>. For Fedora, as NGINX 1.28.0 is not yet available, we will use NGINX 1.26.3. Compiling NGINX from source or using packages from different repositories will not work with the official prebuilt packages of BunkerWeb. However, you have the option to build BunkerWeb from source.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:4"><input checked="checked" id="integrations-__tabbed_1_1" name="integrations-__tabbed_1" type="radio" /><input id="integrations-__tabbed_1_2" name="integrations-__tabbed_1" type="radio" /><input id="integrations-__tabbed_1_3" name="integrations-__tabbed_1" type="radio" /><input id="integrations-__tabbed_1_4" name="integrations-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="integrations-__tabbed_1_1">Debian</label><label for="integrations-__tabbed_1_2">Ubuntu</label><label for="integrations-__tabbed_1_3">Fedora</label><label for="integrations-__tabbed_1_4">RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The first step is to add NGINX official repository:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>debian-archive-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/debian `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>You should now be able to install NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Testing/dev version</p>
<p>If you use the <code>testing</code> or <code>dev</code> version, you will need to add the <code>force-bad-version</code> directive to your <code>/etc/dpkg/dpkg.cfg</code> file before installing BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Disable the setup wizard</p>
<p>If you don't want to use the setup wizard of the web UI when BunkerWeb is installed, export the following variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>apt upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The first step is to add NGINX official repository:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>ubuntu-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/ubuntu `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>You should now be able to install NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Testing/dev version</p>
<p>If you use the <code>testing</code> or <code>dev</code> version, you will need to add the <code>force-bad-version</code> directive to your <code>/etc/dpkg/dpkg.cfg</code> file before installing BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<div class="admonition example">
<p class="admonition-title">Disable the setup wizard</p>
<p>If you don't want to use the setup wizard of the web UI when BunkerWeb is installed, export the following variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>apt upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Fedora Update Testing</p>
<p>If you can't find the NGINX version listed in the stable repository, you can enable the <code>updates-testing</code> repository:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="integrations-__tabbed_2_1" name="integrations-__tabbed_2" type="radio" /><input id="integrations-__tabbed_2_2" name="integrations-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="integrations-__tabbed_2_1">Fedora 41/42</label><label for="integrations-__tabbed_2_2">Fedora 40</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>setopt<span class="w"> </span>updates-testing.enabled<span class="o">=</span><span class="m">1</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--set-enabled<span class="w"> </span>updates-testing
</code></pre></div>
</div>
</div>
</div>
</div>
<p>Fedora already provides NGINX 1.26.3 that we support (NGINX 1.28.0 is not yet available in Fedora repositories):</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.26.3
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Disable the setup wizard</p>
<p>If you don't want to use the setup wizard of the web UI when BunkerWeb is installed, export the following variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-1.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>dnf upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The first step is to add NGINX official repository. Create the following file at <code>/etc/yum.repos.d/nginx.repo</code>:</p>
<div class="highlight"><pre><span></span><code>[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true

[nginx-mainline]
name=nginx mainline repo
baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/
gpgcheck=1
enabled=0
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true
</code></pre></div>
<p>You should now be able to install NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>--allowerasing<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<div class="admonition example">
<p class="admonition-title">Disable the setup wizard</p>
<p>If you don't want to use the setup wizard of the web UI when BunkerWeb is installed, export the following variable:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
</div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>check-update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-1.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>dnf upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
</div>
</div>
<h3 id="integrations-configuration-and-service">Configuration and service</h3>
<p>Manual configuration of BunkerWeb is done by editing the <code>/etc/bunkerweb/variables.env</code> file:</p>
<div class="highlight"><pre><span></span><code>MY_SETTING_1=value1
MY_SETTING_2=value2
...
</code></pre></div>
<p>When installed, BunkerWeb comes with three services <code>bunkerweb</code>, <code>bunkerweb-scheduler</code> and <code>bunkerweb-ui</code> that you can manage using <code>systemctl</code>.</p>
<p>If you manually edit the BunkerWeb configuration using <code>/etc/bunkerweb/variables.env</code> a restart of the <code>bunkerweb-scheduler</code> service will be enough to generate and reload the configuration without any downtime. But depending on the case (such as changing listening ports) you might need to restart the <code>bunkerweb</code> service.</p>
<h3 id="integrations-high-availability">High availability</h3>
<p>The scheduler can be detached from the BunkerWeb instance to provide high availability. In this case, the scheduler will be installed on a separate server and will be able to manage multiple BunkerWeb instances.</p>
<p><strong>Manager</strong></p>
<p>To install only the scheduler on a server, you can export the following variables before executing the BunkerWeb installation:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">MANAGER_MODE</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">UI_WIZARD</span><span class="o">=</span>no
</code></pre></div>
<p>Alternatively, you can also export the following variables to only enable the scheduler:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<p><strong>Worker</strong></p>
<p>On another server, to install only BunkerWeb, you can export the following variables before executing the BunkerWeb installation:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">WORKER_MODE</span><span class="o">=</span>yes
</code></pre></div>
<p>Alternatively, you can also export the following variables to only enable BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>yes
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>no
</code></pre></div>
<p><strong>Web UI</strong></p>
<p>The Web UI can be installed on a separate server to provide a dedicated interface for managing BunkerWeb instances. To install only the Web UI, you can export the following variables before executing the BunkerWeb installation:</p>
<div class="highlight"><pre><span></span><code><span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_BUNKERWEB</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_SCHEDULER</span><span class="o">=</span>no
<span class="nb">export</span><span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span>yes
</code></pre></div>
<h2 id="integrations-docker-autoconf">Docker autoconf</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/integration-autoconf.svg" width="600" />
  </p>
<figcaption>Docker autoconf integration</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Docker integration</p>
<p>The Docker autoconf integration is an "evolution" of the Docker one. Please read the <a href="#integrations-docker">Docker integration section</a> first if needed.</p>
</div>
<p>An alternative approach is available to address the inconvenience of recreating the container every time there is an update. By utilizing another image called <strong>autoconf</strong>, you can automate the real-time reconfiguration of BunkerWeb without the need for container recreation.</p>
<p>To leverage this functionality, instead of defining environment variables for the BunkerWeb container, you can add <strong>labels</strong> to your web application containers. The <strong>autoconf</strong> image will then listen for Docker events and seamlessly handle the configuration updates for BunkerWeb.</p>
<p>This "<em>automagical</em>" process simplifies the management of BunkerWeb configurations. By adding labels to your web application containers, you can delegate the reconfiguration tasks to <strong>autoconf</strong> without the manual intervention of container recreation. This streamlines the update process and enhances convenience.</p>
<p>By adopting this approach, you can enjoy real-time reconfiguration of BunkerWeb without the hassle of container recreation, making it more efficient and user-friendly.</p>
<div class="admonition info">
<p class="admonition-title">Multisite mode</p>
<p>The Docker autoconf integration implies the use of <strong>multisite mode</strong>. Please refer to the <a href="#concepts-multisite-mode">multisite section</a> of the documentation for more information.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>Please be aware that our instructions assume you are using MariaDB as the default database backend, as configured by the <code>DATABASE_URI</code> setting. However, we understand that you may prefer to utilize alternative backends for your Docker integration. If that is the case, rest assured that other database backends are still possible. See docker-compose files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository for more information.</p>
</div>
<p>To enable automated configuration updates, include an additional container called <code>bw-autoconf</code> in the stack. This container hosts the autoconf service, which manages dynamic configuration changes for BunkerWeb.</p>
<p>To support this functionality, use a dedicated "real" database backend (e.g., MariaDB, MySQL, or PostgreSQL) for synchronized configuration storage. By integrating <code>bw-autoconf</code> and a suitable database backend, you establish the infrastructure for seamless automated configuration management in BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both containers</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory label for the autoconf service to identify the BunkerWeb instance</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># We don&#39;t need to specify the BunkerWeb instance here as they are automatically detected by the autoconf service</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># The server name will be filled with services labels</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory setting for autoconf</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># The Docker socket</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Database in the <code>bw-db</code> network</p>
<p>The database container is intentionally not included in the <code>bw-universe</code> network. It is used by the <code>bw-autoconf</code> and <code>bw-scheduler</code> containers rather than directly by BunkerWeb. Therefore, the database container is part of the <code>bw-db</code> network, which enhances security by making external access to the database more challenging. <strong>This deliberate design choice helps safeguard the database and strengthens the overall security perspective of the system</strong>.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Using Docker in rootless mode</p>
<p>If you are using <a href="https://docs.docker.com/engine/security/rootless">Docker in rootless mode</a>, you will need to replace the mount of the docker socket with the following value: <code>$XDG_RUNTIME_DIR/docker.sock:/var/run/docker.sock:ro</code>.</p>
</div>
<h3 id="integrations-autoconf-services">Autoconf services</h3>
<p>Once the stack is set up, you will be able to create the web application container and add the settings as labels using the "bunkerweb." prefix in order to automatically set up BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="integrations-namespaces">Namespaces</h3>
<p>Starting from version <code>1.6.0</code>, BunkerWeb's Autoconf stacks now support namespaces. This feature enables you to manage multiple "<em>clusters</em>" of BunkerWeb instances and services on the same Docker host. To take advantage of namespaces, simply set the <code>NAMESPACE</code> label on your services. Here's an example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the service</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Namespace behavior</p>
<p>By default all Autoconf stacks listen to all namespaces. If you want to restrict a stack to specific namespaces, you can set the <code>NAMESPACES</code> environment variable in the <code>bw-autoconf</code> service:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the BunkerWeb instance so the autoconf service can detect it</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Only listen to these namespaces</span>
<span class="nn">...</span>
</code></pre></div>
<p>Keep in mind that the <code>NAMESPACES</code> environment variable is a space-separated list of namespaces.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Namespace specifications</p>
<p>There can only be <strong>one database</strong> and <strong>one Scheduler</strong> per namespace. If you try to create multiple databases or Schedulers in the same namespace, the configurations will end up conflicting with each other.</p>
<p>The Scheduler doesn't need the <code>NAMESPACE</code> label to work properly. It will only need the <code>DATABASE_URI</code> setting properly configured so that it can access the same database as the autoconf service.</p>
</div>
<h2 id="integrations-kubernetes">Kubernetes</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/integration-kubernetes.svg" width="600" />
  </p>
<figcaption>Kubernetes integration</figcaption>
</figure>
<p>To automate the configuration of BunkerWeb instances in a Kubernetes environment, the autoconf service serves as an <a href="https://kubernetes.io/docs/concepts/services-networking/ingress-controllers/">Ingress controller</a>. It configures the BunkerWeb instances based on <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingress resources</a> and also monitors other Kubernetes objects, such as <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>, for custom configurations.</p>
<p>For an optimal setup, it is recommended to define BunkerWeb as a <strong><a href="https://kubernetes.io/docs/concepts/workloads/controllers/daemonset/">DaemonSet</a></strong>, which ensures that a pod is created on all nodes, while the <strong>autoconf and scheduler</strong> are defined as <strong>single replicated <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a></strong>.</p>
<p>Given the presence of multiple BunkerWeb instances, it is necessary to establish a shared data store implemented as a <a href="https://redis.io/">Redis</a> or <a href="https://valkey.io/">Valkey</a> service. This service will be utilized by the instances to cache and share data among themselves. Further information about the Redis/Valkey settings can be found <a href="#features-redis">here</a>.</p>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>Please be aware that our instructions assume you are using MariaDB as the default database backend, as configured by the <code>DATABASE_URI</code> setting. However, we understand that you may prefer to utilize alternative backends for your Docker integration. If that is the case, rest assured that other database backends are still possible. See docker-compose files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository for more information.</p>
<p>Clustered database backends setup are out-of-the-scope of this documentation.</p>
</div>
<p>Please ensure that the autoconf services have access to the Kubernetes API. It is recommended to utilize <a href="https://kubernetes.io/docs/reference/access-authn-authz/rbac/">RBAC authorization</a> for this purpose.</p>
<div class="admonition warn">
<p class="admonition-title">Custom CA for Kubernetes API</p>
<p>If you use a custom CA for your Kubernetes API, you can mount a bundle file containing your intermediate(s) and root certificates on the ingress controller and set the <code>KUBERNETES_SSL_CA_CERT</code> environment value to the path of the bundle inside the container. Alternatively, even if it's not recommended, you can disable certificate verification by setting the <code>KUBERNETES_SSL_VERIFY</code> environment variable of the ingress controller to <code>no</code> (default is <code>yes</code>).</p>
</div>
<p>Additionally, <strong>it is crucial to set the <code>KUBERNETES_MODE</code> environment variable to <code>yes</code> when utilizing the Kubernetes integration</strong>. This variable is mandatory for proper functionality.</p>
<h3 id="integrations-installation-methods">Installation methods</h3>
<h4 id="integrations-using-helm-chart-recommended">Using helm chart (recommended)</h4>
<p>The recommended way to install Kubernetes is to use the Helm chart available at <code>https://repo.bunkerweb.io/charts</code>:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
</code></pre></div>
<p>You can then use the bunkerweb helm chart from that repository:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>-f<span class="w"> </span>myvalues.yaml<span class="w"> </span>mybunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>The full list of values are listed in the <a href="https://github.com/bunkerity/bunkerweb-helm/blob/main/charts/bunkerweb/values.yaml">charts/bunkerweb/values.yaml file</a> of the <a href="https://github.com/bunkerity/bunkerweb-helm">bunkerity/bunkerweb-helm repository</a>.</p>
<h4 id="integrations-full-yaml-files">Full YAML files</h4>
<p>Instead of using the helm chart, you can also use the YAML boilerplates inside the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the GitHub repository. Please note that we highly recommend to use the helm chart instead.</p>
<h3 id="integrations-ingress-resources">Ingress resources</h3>
<p>Once the BunkerWeb Kubernetes stack is successfully set up and operational (refer to the autoconf logs for detailed information), you can proceed with deploying web applications within the cluster and declaring your Ingress resource.</p>
<p>It is important to note that the BunkerWeb settings need to be specified as annotations for the Ingress resource. For the domain part, please use the special value <strong><code>bunkerweb.io</code></strong>. By including the appropriate annotations, you can configure BunkerWeb accordingly for the Ingress resource.</p>
<div class="admonition info">
<p class="admonition-title">TLS support</p>
<p>BunkerWeb ingress controller fully supports custom HTTPS certificates using the tls spec as shown in the example. Configuring solutions such as <code>cert-manager</code> to automatically generate tls secrets is out of the scope of this documentation.</p>
</div>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Will be applied to all host in this ingress</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="c1"># Will only be applied to the www.example.com host</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># TLS is optional, you can also use builtin Let&#39;s Encrypt for example</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1">#   - hosts:</span>
<span class="w">  </span><span class="c1">#       - www.example.com</span>
<span class="w">  </span><span class="c1">#     secretName: secret-example-tls</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
<span class="nn">...</span>
</code></pre></div>
<h3 id="integrations-namespaces_1">Namespaces</h3>
<p>Starting from version <code>1.6.0</code>, BunkerWeb's autoconf stacks now support namespaces. This feature enables you to manage multiple clusters of BunkerWeb instances and services on the same Kubernetes cluster. To take advantage of namespaces, simply set the <code>namespace</code> metadata field on your BunkerWeb instances and services. Here's an example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DaemonSet</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># Set the namespace for the BunkerWeb instance</span>
<span class="nn">...</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Namespace behavior</p>
<p>By default all Autoconf stacks listen to all namespaces. If you want to restrict a stack to specific namespaces, you can set the <code>NAMESPACES</code> environment variable in the <code>bunkerweb-controller</code> deployment:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-namespace</span><span class="w"> </span><span class="c1"># Set the namespace for the Controller</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">strategy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Recreate</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sa-bunkerweb</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-controller</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">          </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NAMESPACES</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Only listen to these namespaces</span>
<span class="w">            </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
</code></pre></div>
<p>Keep in mind that the <code>NAMESPACES</code> environment variable is a space-separated list of namespaces.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Namespace specifications</p>
<p>There can only be <strong>one database</strong> and <strong>one Scheduler</strong> per namespace. If you try to create multiple databases or Schedulers in the same namespace, the configurations will end up conflicting with each other.</p>
<p>The Scheduler doesn't need the <code>NAMESPACE</code> annotation to work properly. It will only need the <code>DATABASE_URI</code> setting properly configured so that it can access the same database as the autoconf service.</p>
</div>
<h3 id="integrations-ingress-class">Ingress class</h3>
<p>When installed using the official methods in the documentation, BunkerWeb comes with the following <code>IngressClass</code> definition:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">IngressClass</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">controller</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.io/ingress-controller</span>
</code></pre></div>
<p>In order to restrict the <code>Ingress</code> resources monitored by the ingress controller, you can set the <code>KUBERNETES_INGRESS_CLASS</code> environment variable with the value <code>bunkerweb</code>. Then, you can leverage the <code>ingressClassName</code> directive in your <code>Ingress</code> definitions:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">my-ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="w">    </span><span class="nt">bunkerweb.io/www.example.com_MY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-my-app</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8000</span>
</code></pre></div>
<h3 id="integrations-custom-domain-name">Custom domain name</h3>
<p>If you use a custom domain name for your Kubernetes cluster different than the default <code>kubernetes.local</code> one, you can set the value using the <code>KUBERNETES_DOMAIN_NAME</code> environment variable on the scheduler container.</p>
<h3 id="integrations-use-with-existing-ingress-controller">Use with existing ingress controller</h3>
<div class="admonition info">
<p class="admonition-title">Keeping both existing ingress controller and BunkerWeb</p>
<p>This is a use-case where you want to keep an existing ingress controller such as the nginx one. Typical traffic flow will be: Load Balancer =&gt; Ingress Controller =&gt; BunkerWeb =&gt; Application.</p>
</div>
<p><strong>nginx ingress controller install</strong></p>
<p>Install ingress nginx helm repo:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>ingress-nginx<span class="w"> </span>https://kubernetes.github.io/ingress-nginx
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>Install nginx ingress controller with default values (might not work on your own cluster out-of-the-box, please check the <a href="https://kubernetes.github.io/ingress-nginx/">documentation</a>):</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>nginx<span class="w"> </span>--create-namespace<span class="w"> </span>nginx<span class="w"> </span>ingress-nginx/ingress-nginx
</code></pre></div>
<p>Extract IP address of LB:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>nginx-ingress-nginx-controller<span class="w"> </span>-n<span class="w"> </span>nginx<span class="w"> </span>-o<span class="w"> </span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span>
</code></pre></div>
<p>Setup DNS entries to IP of LB (e.g <code>bunkerweb</code> subdomain for BW UI and <code>myapp</code> for application):</p>
<div class="highlight"><pre><span></span><code>$<span class="w"> </span>nslookup<span class="w"> </span>bunkerweb.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>bunkerweb.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4
$<span class="w"> </span>nslookup<span class="w"> </span>myapp.example.com
Server:<span class="w">         </span><span class="m">172</span>.26.112.1
Address:<span class="w">        </span><span class="m">172</span>.26.112.1#53

Non-authoritative<span class="w"> </span>answer:
Name:<span class="w">   </span>myapp.example.com
Address:<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div>
<p><strong>BunkerWeb install</strong></p>
<p>Install BunkerWeb helm repo:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
helm<span class="w"> </span>repo<span class="w"> </span>update
</code></pre></div>
<p>Create <code>values.yaml</code> file:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Here we will setup the values needed to setup BunkerWeb behind an existing ingress controller</span>
<span class="c1"># Traffic flow with BW: LB =&gt; existing Ingress Controller =&gt; BunkerWeb =&gt; Service</span>
<span class="c1"># Traffic flow without BW: LB =&gt; existing Ingress Controller =&gt; Service</span>

<span class="c1"># Global settings</span>
<span class="nt">settings</span><span class="p">:</span>
<span class="w">  </span><span class="nt">misc</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Replace with your DNS resolver</span>
<span class="w">    </span><span class="c1"># to get it: kubectl exec in a random pod then cat /etc/resolv.conf</span>
<span class="w">    </span><span class="c1"># if you have an IP as nameserver then do a reverse DNS lookup: nslookup &lt;IP&gt;</span>
<span class="w">    </span><span class="c1"># most of the time it&#39;s coredns.kube-system.svc.cluster.local or kube-dns.kube-system.svc.cluster.local</span>
<span class="w">    </span><span class="nt">dnsResolvers</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;kube-dns.kube-system.svc.cluster.local&quot;</span>
<span class="w">  </span><span class="nt">kubernetes</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># We only consider Ingress resources with ingressClass bunkerweb to avoid conflicts with existing ingress controller</span>
<span class="w">    </span><span class="nt">ingressClass</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">    </span><span class="c1"># Optional: you can choose namespace(s) where BunkerWeb will listen for Ingress/ConfigMap changes</span>
<span class="w">    </span><span class="c1"># Default (blank value) is all namespaces</span>
<span class="w">    </span><span class="nt">namespaces</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>

<span class="c1"># Override the bunkerweb-external service type to ClusterIP</span>
<span class="c1"># Since we don&#39;t need to expose it to the outside world</span>
<span class="c1"># We will use the existing ingress controller to route traffic to BunkerWeb</span>
<span class="nt">service</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ClusterIP</span>

<span class="c1"># BunkerWeb settings</span>
<span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.2</span>

<span class="c1"># Scheduler settings</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.2</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># Enable real IP module to get real IP of clients</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Controller settings</span>
<span class="nt">controller</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.2</span>

<span class="c1"># UI settings</span>
<span class="nt">ui</span><span class="p">:</span>
<span class="w">  </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.6.2</span>
</code></pre></div>
<p>Install BunkerWeb with custom values:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>--namespace<span class="w"> </span>bunkerweb<span class="w"> </span>--create-namespace<span class="w"> </span>-f<span class="w"> </span>values.yaml<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb/bunkerweb
</code></pre></div>
<p>Check logs and wait until everything is ready.</p>
<p><strong>Web UI install</strong></p>
<p>Setup the following ingress (assuming nginx controller is installed):</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ui-bunkerweb</span>
<span class="w">  </span><span class="c1"># Replace with your namespace of BW if needed</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># HTTPS is mandatory for web UI even if traffic is internal</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/backend-protocol</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;HTTPS&quot;</span>
<span class="w">    </span><span class="c1"># We must set SNI so BW can serve the right vhost</span>
<span class="w">    </span><span class="c1"># Replace with your domain</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb.example.com&quot;</span>
<span class="w">    </span><span class="nt">nginx.ingress.kubernetes.io/proxy-ssl-server-name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;on&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Only served by nginx controller and not BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># Uncomment and edit if you want to use your own certificate</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - bunkerweb.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Replace with your domain</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># Created by Helm chart</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="c1"># Using HTTPS port is mandatory for UI</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
</code></pre></div>
<p>And you can now proceed to the setup wizard by browsing to <code>https://bunkerweb.example.com/setup</code>.</p>
<p><strong>Protecting existing application</strong></p>
<p><strong>First of all, you will need to go to Global Config, select the SSL plugin and then disable the Auto redirect HTTP to HTTPS. Please note that you only need to do it one time.</strong></p>
<p>Let's assume that you have an application in the <code>myapp</code> namespace which is accessible using the <code>myapp-service</code> service on port <code>5000</code>.</p>
<p>You will need to add a new service on the web UI and fill the required information:</p>
<ul>
<li>Server name: the public facing domain of your application (e.g. <code>myapp.example.com</code>)</li>
<li>SSL/TLS: your ingress controller takes care of that part so don't enable it on BunkerWeb since traffic is internal within the cluster</li>
<li>Reverse proxy host: the full URL of your application within the cluster (e.g. <code>http://myapp-service.myapp.svc.cluster.local:5000</code>)</li>
</ul>
<p>Once the new service has been added, you can now declare an Ingress resource for that service and route it to the BunkerWeb service on HTTP port:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp</span>
<span class="w">  </span><span class="c1"># Replace with your namespace of BW if needed</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Only served by nginx controller and not BW</span>
<span class="w">  </span><span class="nt">ingressClassName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
<span class="w">  </span><span class="c1"># Uncomment and edit if you want to use your own certificate</span>
<span class="w">  </span><span class="c1"># tls:</span>
<span class="w">  </span><span class="c1"># - hosts:</span>
<span class="w">  </span><span class="c1">#   - myapp.example.com</span>
<span class="w">  </span><span class="c1">#   secretName: tls-secret</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Replace with your domain</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp.example.com</span>
<span class="w">    </span><span class="nt">http</span><span class="p">:</span>
<span class="w">      </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">        </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">        </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">          </span><span class="nt">service</span><span class="p">:</span>
<span class="w">            </span><span class="c1"># Created by Helm chart</span>
<span class="w">            </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-external</span>
<span class="w">            </span><span class="nt">port</span><span class="p">:</span>
<span class="w">              </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
<p>You can visit <code>http(s)://myapp.example.com</code>, which is now protected with BunkerWeb 🛡️</p>
<h2 id="integrations-swarm">Swarm</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/integration-swarm.svg" width="600" />
  </p>
<figcaption>Docker Swarm integration</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#integrations-kubernetes">Kubernetes integration</a> instead.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">PRO support</p>
<p><strong>If you need Swarm support</strong>, please contact us at <a href="mailto:contact@bunkerity.com">contact@bunkerity.com</a> or via the <a href="https://panel.bunkerweb.io/contact.php">contact form</a>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Docker autoconf</p>
<p>The Swarm integration is similar to the Docker autoconf one (but with services instead of containers). Please read the <a href="#integrations-docker-autoconf">Docker autoconf integration section</a> first if needed.</p>
</div>
<p>To enable automatic configuration of BunkerWeb instances, the <strong>autoconf</strong> service requires access to the Docker API. This service listens for Docker Swarm events, such as service creation or deletion, and seamlessly configures the <strong>BunkerWeb instances</strong> in real-time without any downtime. It also monitors other Swarm objects, such as <a href="https://docs.docker.com/engine/swarm/configs/">configs</a>, for custom configurations.</p>
<p>Similar to the <a href="#integrations-docker-autoconf">Docker autoconf integration</a>, configuration for web services is defined using labels that start with the <strong>bunkerweb</strong>  prefix.</p>
<p>For an optimal setup, it is recommended to schedule the <strong>BunkerWeb service</strong> as a <strong><em>global service</em></strong> on all nodes, while the <strong>autoconf, scheduler, and Docker API proxy services</strong> should be scheduled as <strong><em>single replicated services</em></strong>. Please note that the Docker API proxy service needs to be scheduled on a manager node unless you configure it to use a remote API (which is not covered in the documentation).</p>
<p>Since multiple instances of BunkerWeb are running, a shared data store implemented as a <a href="https://redis.io/">Redis</a> or <a href="https://valkey.io/">Valkey</a> service must be created. These instances will utilize the Redis/Valkey service to cache and share data. Further details regarding the Redis/Valkey settings can be found <a href="#features-redis">here</a>.</p>
<p>As for the database volume, the documentation does not specify a specific approach. Choosing either a shared folder or a specific driver for the database volume is dependent on your unique use-case and is left as an exercise for the reader.</p>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>Please be aware that our instructions assume you are using MariaDB as the default database backend, as configured by the <code>DATABASE_URI</code> setting. However, we understand that you may prefer to utilize alternative backends for your Docker integration. If that is the case, rest assured that other database backends are still possible. See docker-compose files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository for more information.</p>
<p>Clustered database backends setup are out-of-the-scope of this documentation.</p>
</div>
<p>Here is the stack boilerplate that you can deploy using <code>docker stack deploy</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both services</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory label for the autoconf service to identify the BunkerWeb instance</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># We don&#39;t need to specify the BunkerWeb instance here as they are automatically detected by the autoconf service</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># The server name will be filled with services labels</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory setting for autoconf</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># The Docker socket</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Swarm mandatory setting</p>
<p>Please note that the <code>SWARM_MODE: "yes"</code> environment variable is mandatory when using the Swarm integration.</p>
</div>
<h3 id="integrations-swarm-services">Swarm services</h3>
<p>Once the BunkerWeb Swarm stack is set up and running (see autoconf and scheduler logs for more information), you will be able to deploy web applications in the cluster and use labels to dynamically configure BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<h3 id="integrations-namespaces_2">Namespaces</h3>
<p>Starting from version <code>1.6.0</code>, BunkerWeb's Autoconf stacks now support namespaces. This feature enables you to manage multiple "<em>clusters</em>" of BunkerWeb instances and services on the same Docker host. To take advantage of namespaces, simply set the <code>NAMESPACE</code> label on your services. Here's an example:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mywebapp:4.2</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the service</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_1=value1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.MY_SETTING_2=value2&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Namespace behavior</p>
<p>By default all Autoconf stacks listen to all namespaces. If you want to restrict a stack to specific namespaces, you can set the <code>NAMESPACES</code> environment variable in the <code>bw-autoconf</code> service:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.NAMESPACE=my-namespace&quot;</span><span class="w"> </span><span class="c1"># Set the namespace for the BunkerWeb instance</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">NAMESPACES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;my-namespace</span><span class="nv"> </span><span class="s">my-other-namespace&quot;</span><span class="w"> </span><span class="c1"># Only listen to these namespaces</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="nn">...</span>
</code></pre></div>
<p>Keep in mind that the <code>NAMESPACES</code> environment variable is a space-separated list of namespaces.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Namespace specifications</p>
<p>There can only be <strong>one database</strong> and <strong>one Scheduler</strong> per namespace. If you try to create multiple databases or Schedulers in the same namespace, the configurations will end up conflicting with each other.</p>
<p>The Scheduler doesn't need the <code>NAMESPACE</code> label to work properly. It will only need the <code>DATABASE_URI</code> setting properly configured so that it can access the same database as the autoconf service.</p>
</div>
<h2 id="integrations-microsoft-azure">Microsoft Azure</h2>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/integration-azure.webp" width="600" />
  </p>
<figcaption>Azure integration</figcaption>
</figure>
<div class="admonition info">
<p class="admonition-title">Recommended VM size</p>
<p>Please be aware while you choose the SKU of the VM. You must select a SKU compatible with Gen2 VM and we recommend starting at B2s or Ds2 series for optimal use.</p>
</div>
<p>You can easily deploy BunkerWeb on your Azure subscription in several ways:</p>
<ul>
<li>Azure CLI in Cloud Shell</li>
<li>Azure ARM Template</li>
<li>Azure portal via the Marketplace</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="3:3"><input checked="checked" id="integrations-__tabbed_3_1" name="integrations-__tabbed_3" type="radio" /><input id="integrations-__tabbed_3_2" name="integrations-__tabbed_3" type="radio" /><input id="integrations-__tabbed_3_3" name="integrations-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="integrations-__tabbed_3_1">Cloud Shell</label><label for="integrations-__tabbed_3_2">ARM Template</label><label for="integrations-__tabbed_3_3">Marketplace</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Create a resource group. Replace value <code>RG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>group<span class="w"> </span>create<span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span>
</code></pre></div>
<p>Create a VM with <code>Standard_B2s</code> SKU in the location of the resource group. Replace values <code>RG_NAME</code>, <code>VM_NAME</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span>
</code></pre></div>
<p>Full command. Replace values <code>RG_NAME</code>, <code>VM_NAME</code>, <code>LOCATION</code>, <code>HOSTNAME</code>, <code>USERNAME</code>, <code>PUBLIC_IP</code>, <code>VNET_NAME</code>, <code>SUBNET_NAME</code>, <code>NSG_NAME</code></p>
<div class="highlight"><pre><span></span><code>az<span class="w"> </span>vm<span class="w"> </span>create<span class="w"> </span>--resource-group<span class="w"> </span><span class="s2">&quot;RG_NAME&quot;</span><span class="w"> </span>--name<span class="w"> </span><span class="s2">&quot;VM_NAME&quot;</span><span class="w"> </span>--location<span class="w"> </span><span class="s2">&quot;LOCATION&quot;</span><span class="w"> </span>--image<span class="w"> </span>bunkerity:bunkerweb:bunkerweb:latest<span class="w"> </span>--accept-term<span class="w"> </span>--generate-ssh-keys<span class="w"> </span>--computer-name<span class="w"> </span><span class="s2">&quot;HOSTNAME&quot;</span><span class="w"> </span>--admin-username<span class="w"> </span><span class="s2">&quot;USERNAME&quot;</span><span class="w"> </span>--public-ip-address<span class="w"> </span><span class="s2">&quot;PUBLIC_IP&quot;</span><span class="w"> </span>--public-ip-address-allocation<span class="w"> </span>Static<span class="w"> </span>--size<span class="w"> </span>Standard_B2s<span class="w"> </span>--public-ip-sku<span class="w"> </span>Standard<span class="w"> </span>--os-disk-delete-option<span class="w"> </span>Delete<span class="w"> </span>--nic-delete-option<span class="w"> </span>Delete<span class="w"> </span>--vnet-name<span class="w"> </span><span class="s2">&quot;VNET_NAME&quot;</span><span class="w"> </span>--subnet<span class="w"> </span><span class="s2">&quot;SUBNET_NAME&quot;</span><span class="w"> </span>--nsg<span class="w"> </span><span class="s2">&quot;NSG_NAME&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Permissions requirement</p>
<p>To deploy a ARM template, you need write access on the resources you're deploying and access to all operations on the Microsoft.Resources/deployments resource type.
To deploy a virtual machine, you need Microsoft.Compute/virtualMachines/write and Microsoft.Resources/deployments/* permissions. The what-if operation has the same permission requirements.</p>
</div>
<p>Deploy the ARM Template:</p>
<p><a href="https://portal.azure.com/#create/Microsoft.Template/uri/https%3A%2F%2Fraw.githubusercontent.com%2Fbunkerity%2Fbunkerweb%2Fmaster%2Fmisc%2Fintegrations%2Fazure-arm-template.json" target="_blank"><img alt="Deploy to Azure" src="../assets/img/integration-azure-deploy.svg" /></a></p>
</div>
<div class="tabbed-block">
<p>Login in <a href="https://portal.azure.com" target="_blank">Azure portal</a>.</p>
<p>Get BunkerWeb from the <a href="https://portal.azure.com/#view/Microsoft_Azure_Marketplace/GalleryItemDetailsBladeNopdl/id/bunkerity.bunkerweb" target="_blank">Create resource menu</a>.</p>
<p>You can also go through the <a href="https://azuremarketplace.microsoft.com/fr-fr/marketplace/apps/bunkerity.bunkerweb?tab=Overview" target="_blank">Marketplace</a>.</p>
</div>
</div>
</div>
<p>You can access the setup wizard by browsing the <code>https://your-ip-address/setup</code> URI of your virtual machine.</p></section><section class="print-page" id="quickstart-guide" heading-number="4"><h1 id="quickstart-guide-quickstart-guide">Quickstart guide</h1>
<div class="admonition info">
<p class="admonition-title">Prerequisites</p>
<p>We expect that you're already familiar with the <a href="#concepts">core concepts</a> and have followed the <a href="#integrations">integrations instructions</a> for your environment.</p>
<p>This quickstart guide assumes that BunkerWeb is accessible from the Internet and that you have configured at least two domains: one for the web UI and one for your web service.</p>
<p><strong>System requirements</strong></p>
<p>The minimum recommended specifications for BunkerWeb are a machine with 2 (v)CPUs and 8 GB of RAM. Please note that this should be sufficient for testing environments or setups with very few services.</p>
<p>For production environments with many services to protect, we recommend at least 4 (v)CPUs and 16 GB of RAM. Resources should be adjusted based on your use case, network traffic, and potential DDoS attacks you may face.</p>
<p>It is highly recommended to enable global loading of CRS rules (by setting the <code>USE_MODSECURITY_GLOBAL_CRS</code> parameter to <code>yes</code>) if you are in environments with limited RAM or in production with many services. More details can be found in the <a href="#advanced-running-many-services-in-production">advanced usages</a> section of the documentation.</p>
</div>
<p>This quickstart guide will help you to quickly install BunkerWeb and secure a web service using the web User Interface.</p>
<p>Protecting existing web applications already accessible with the HTTP(S) protocol is the main goal of BunkerWeb: it will act as a classical <a href="https://en.wikipedia.org/wiki/Reverse_proxy">reverse proxy</a> with extra security features.</p>
<p>See the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/examples">examples folder</a> of the repository to get real-world examples.</p>
<h2 id="quickstart-guide-basic-setup">Basic setup</h2>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="checked" id="quickstart-guide-__tabbed_1_1" name="quickstart-guide-__tabbed_1" type="radio" /><input id="quickstart-guide-__tabbed_1_2" name="quickstart-guide-__tabbed_1" type="radio" /><input id="quickstart-guide-__tabbed_1_3" name="quickstart-guide-__tabbed_1" type="radio" /><input id="quickstart-guide-__tabbed_1_4" name="quickstart-guide-__tabbed_1" type="radio" /><input id="quickstart-guide-__tabbed_1_5" name="quickstart-guide-__tabbed_1" type="radio" /><input id="quickstart-guide-__tabbed_1_6" name="quickstart-guide-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="quickstart-guide-__tabbed_1_1">All-in-one</label><label for="quickstart-guide-__tabbed_1_2">Linux</label><label for="quickstart-guide-__tabbed_1_3">Docker</label><label for="quickstart-guide-__tabbed_1_4">Docker autoconf</label><label for="quickstart-guide-__tabbed_1_5">Kubernetes</label><label for="quickstart-guide-__tabbed_1_6">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>To deploy the all-in-one container, run the following command:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>By default, the container exposes:</p>
<ul>
<li>8080/tcp for HTTP</li>
<li>8443/tcp for HTTPS</li>
<li>8443/udp for QUIC</li>
<li>7000/tcp for the web UI access without BunkerWeb in front (not recommended for production)</li>
</ul>
<p>The All-In-One image comes with several built-in services, which can be controlled using environment variables. See the <a href="#integrations-all-in-one-aio-image">All-In-One (AIO) Image section</a> of the integrations page for more details.</p>
</div>
<div class="tabbed-block">
<p>Please ensure that you have <strong>NGINX 1.28.0 installed before installing BunkerWeb</strong>. For all distributions, except Fedora, it is mandatory to use prebuilt packages from the <a href="https://nginx.org/en/linux_packages.html">official NGINX repository</a>. For Fedora, as NGINX 1.28.0 is not yet available, we will use NGINX 1.26.3. Compiling NGINX from source or using packages from different repositories will not work with the official prebuilt packages of BunkerWeb. However, you have the option to build BunkerWeb from source.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="quickstart-guide-__tabbed_2_1" name="quickstart-guide-__tabbed_2" type="radio" /><input id="quickstart-guide-__tabbed_2_2" name="quickstart-guide-__tabbed_2" type="radio" /><input id="quickstart-guide-__tabbed_2_3" name="quickstart-guide-__tabbed_2" type="radio" /><input id="quickstart-guide-__tabbed_2_4" name="quickstart-guide-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="quickstart-guide-__tabbed_2_1">Debian</label><label for="quickstart-guide-__tabbed_2_2">Ubuntu</label><label for="quickstart-guide-__tabbed_2_3">Fedora</label><label for="quickstart-guide-__tabbed_2_4">RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The first step is to add the official NGINX repository:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>debian-archive-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/debian `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>You should now be able to install NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Testing/dev version</p>
<p>If you use the <code>testing</code> or <code>dev</code> version, you need to add the <code>force-bad-version</code> directive to your <code>/etc/dpkg/dpkg.cfg</code> file before installing BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>apt upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The first step is to add the official NGINX repository:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>curl<span class="w"> </span>gnupg2<span class="w"> </span>ca-certificates<span class="w"> </span>lsb-release<span class="w"> </span>ubuntu-keyring<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
curl<span class="w"> </span>https://nginx.org/keys/nginx_signing.key<span class="w"> </span><span class="p">|</span><span class="w"> </span>gpg<span class="w"> </span>--dearmor<span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/usr/share/keyrings/nginx-archive-keyring.gpg<span class="w"> </span>&gt;/dev/null<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;deb [signed-by=/usr/share/keyrings/nginx-archive-keyring.gpg] \</span>
<span class="s2">http://nginx.org/packages/ubuntu `lsb_release -cs` nginx&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>/etc/apt/sources.list.d/nginx.list
</code></pre></div>
<p>You should now be able to install NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">nginx</span><span class="o">=</span><span class="m">1</span>.28.0-1~<span class="k">$(</span>lsb_release<span class="w"> </span>-cs<span class="k">)</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Testing/dev version</p>
<p>If you use the <code>testing</code> or <code>dev</code> version, you need to add the <code>force-bad-version</code> directive to your <code>/etc/dpkg/dpkg.cfg</code> file before installing BunkerWeb.</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;force-bad-version&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dpkg/dpkg.cfg
</code></pre></div>
</div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.deb.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>apt upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>nginx<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Fedora Update Testing</p>
<p>If you cannot find the NGINX version listed in the stable repository, you can enable the <code>updates-testing</code> repository:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="quickstart-guide-__tabbed_3_1" name="quickstart-guide-__tabbed_3" type="radio" /><input id="quickstart-guide-__tabbed_3_2" name="quickstart-guide-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="quickstart-guide-__tabbed_3_1">Fedora 41/42</label><label for="quickstart-guide-__tabbed_3_2">Fedora 40</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>setopt<span class="w"> </span>updates-testing.enabled<span class="o">=</span><span class="m">1</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--set-enabled<span class="w"> </span>updates-testing
</code></pre></div>
</div>
</div>
</div>
</div>
<p>Fedora already provides NGINX 1.26.3 that we support (NGINX 1.28.0 is not yet available in Fedora repositories):</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>nginx-1.26.3
</code></pre></div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>bunkerweb-1.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>dnf upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The first step is to add the NGINX official repository. Create the following file at <code>/etc/yum.repos.d/nginx.repo</code>:</p>
<div class="highlight"><pre><span></span><code>[nginx-stable]
name=nginx stable repo
baseurl=http://nginx.org/packages/centos/$releasever/$basearch/
gpgcheck=1
enabled=1
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true

[nginx-mainline]
name=nginx mainline repo
baseurl=http://nginx.org/packages/mainline/centos/$releasever/$basearch/
gpgcheck=1
enabled=0
gpgkey=https://nginx.org/keys/nginx_signing.key
module_hotfixes=true
</code></pre></div>
<p>You should now be able to install NGINX 1.28.0:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>nginx-1.28.0
</code></pre></div>
<p>And finally install BunkerWeb 1.6.2:</p>
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-s<span class="w"> </span>https://repo.bunkerweb.io/install/script.rpm.sh<span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>bash<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>check-update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>-E<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>bunkerweb-1.6.2
</code></pre></div>
<p>To prevent upgrading NGINX and/or BunkerWeb packages when executing <code>dnf upgrade</code>, you can use the following command:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<p>Here is the full docker compose file that you can use; please note that we will later connect the web service to the <code>bw-services</code> network:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both services</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Make sure to set the correct IP range so the scheduler can send the configuration to the instance</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># This is the name that will be used to identify the instance in the Scheduler</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># For QUIC / HTTP3 support</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span><span class="w"> </span><span class="c1"># We use the anchor to avoid repeating the same settings for all services</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Make sure to set the correct instance name</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">UI_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># Change it if needed</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w"> </span><span class="c1"># Redis service for the persistence of reports/bans/stats</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">redis-server</span>
<span class="w">      </span><span class="no">--maxmemory 256mb</span>
<span class="w">      </span><span class="no">--maxmemory-policy allkeys-lru</span>
<span class="w">      </span><span class="no">--save 60 1000</span>
<span class="w">      </span><span class="no">--appendonly yes</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-data:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">redis-data</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Make sure to set the correct IP range so the scheduler can send the configuration to the instance</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Here is the full docker compose file that you can use; please note that we will later connect the web service to the <code>bw-services</code> network:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-ui-env</span>
<span class="w">  </span><span class="c1"># We anchor the environment variables to avoid duplication</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># For QUIC / HTTP3 support</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># We set the instance label to allow the autoconf to detect the instance</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">UI_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># Change it if needed</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">TOTP_SECRETS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger secret key (see the Prerequisites section)</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">redis</span><span class="p">:</span><span class="w"> </span><span class="c1"># Redis service for the persistence of reports/bans/stats</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">&gt;</span>
<span class="w">      </span><span class="no">redis-server</span>
<span class="w">      </span><span class="no">--maxmemory 256mb</span>
<span class="w">      </span><span class="no">--maxmemory-policy allkeys-lru</span>
<span class="w">      </span><span class="no">--save 60 1000</span>
<span class="w">      </span><span class="no">--appendonly yes</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis-data:/data</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">redis-data</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The recommended way to install Kubernetes is to use the Helm chart available at <code>https://repo.bunkerweb.io/charts</code>:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>repo<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span>https://repo.bunkerweb.io/charts
</code></pre></div>
<p>You can then use the <code>bunkerweb</code> helm chart from that repository:</p>
<div class="highlight"><pre><span></span><code>helm<span class="w"> </span>install<span class="w"> </span>mybw<span class="w"> </span>bunkerweb/bunkerweb<span class="w"> </span>--namespace<span class="w"> </span>bunkerweb<span class="w"> </span>--create-namespace
</code></pre></div>
<p>Once installed, you can get the IP address of the <code>LoadBalancer</code> to set up your domains:</p>
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>-n<span class="w"> </span>bunkerweb<span class="w"> </span>get<span class="w"> </span>svc<span class="w"> </span>mybw-external<span class="w"> </span>-o<span class="o">=</span><span class="nv">jsonpath</span><span class="o">=</span><span class="s1">&#39;{.status.loadBalancer.ingress[0].ip}&#39;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#integrations-kubernetes">Kubernetes integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>Here is the full docker compose stack file that you can use; please note that we will later connect the web service to the <code>bw-services</code> network:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-ui-env</span>
<span class="w">  </span><span class="c1"># We anchor the environment variables to avoid duplication</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># For QUIC / HTTP3 support</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">      </span><span class="nt">UI_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># Change it if needed</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">TOTP_SECRETS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger secret key (see the Prerequisites section)</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="quickstart-guide-complete-the-setup-wizard">Complete the setup wizard</h2>
<div class="admonition tip">
<p class="admonition-title">Accessing the setup wizard</p>
<p>You can access the setup wizard by browsing the <code>https://your-fqdn-or-ip-addresss/setup</code> URI of your server.</p>
</div>
<h3 id="quickstart-guide-create-an-administrator-account">Create an Administrator account</h3>
<p>You should see a setup page just like this one:</p>
<figure>
<p><img align="center" alt="Setup Wizard landing page" src="../assets/img/ui-wizard-step1.png" />
  </p>
<figcaption>Setup Wizard landing page</figcaption>
</figure>
<p>Once you're on the setup page, you can enter the <strong>administrator username, email, and password</strong> and click on the "Next" button.</p>
<h3 id="quickstart-guide-configure-the-reverse-proxy-and-https">Configure the Reverse Proxy and HTTPS</h3>
<p>The next step will ask you to enter the <strong>server name</strong> (domain/FQDN) that the web UI will use. You can also choose to enable <strong>Let's Encrypt</strong> or use a <strong>custom certificate</strong>.</p>
<figure>
<p><img align="center" alt="Setup Wizard step 2" src="../assets/img/ui-wizard-step2.png" />
  </p>
<figcaption>Setup Wizard step 2</figcaption>
</figure>
<h3 id="quickstart-guide-overview-of-your-settings">Overview of your settings</h3>
<p>The last step will give you an overview of the settings you've entered. You can click on the "Setup" button to complete the setup.</p>
<figure>
<p><img align="center" alt="Setup Wizard final step" src="../assets/img/ui-wizard-step3.png" />
  </p>
<figcaption>Setup Wizard final step</figcaption>
</figure>
<h2 id="quickstart-guide-accessing-the-web-interface">Accessing the web interface</h2>
<p>You can now access the web interface by browsing to the domain you configured in the previous step and the URI if you changed it (default is <code>https://your-domain/</code>).</p>
<figure>
<p><img align="center" alt="Web interface login page" src="../assets/img/ui-login.png" />
  </p>
<figcaption>Web interface login page</figcaption>
</figure>
<p>You can now log in with the administrator account you created during the setup wizard.</p>
<figure>
<p><img align="center" alt="Web interface home" src="../assets/img/ui-home.png" />
  </p>
<figcaption>Web interface home</figcaption>
</figure>
<h2 id="quickstart-guide-creating-a-new-service">Creating a new service</h2>
<div class="tabbed-set tabbed-alternate" data-tabs="4:7"><input checked="checked" id="quickstart-guide-__tabbed_4_1" name="quickstart-guide-__tabbed_4" type="radio" /><input id="quickstart-guide-__tabbed_4_2" name="quickstart-guide-__tabbed_4" type="radio" /><input id="quickstart-guide-__tabbed_4_3" name="quickstart-guide-__tabbed_4" type="radio" /><input id="quickstart-guide-__tabbed_4_4" name="quickstart-guide-__tabbed_4" type="radio" /><input id="quickstart-guide-__tabbed_4_5" name="quickstart-guide-__tabbed_4" type="radio" /><input id="quickstart-guide-__tabbed_4_6" name="quickstart-guide-__tabbed_4" type="radio" /><input id="quickstart-guide-__tabbed_4_7" name="quickstart-guide-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="quickstart-guide-__tabbed_4_1">Web UI</label><label for="quickstart-guide-__tabbed_4_2">All-in-one</label><label for="quickstart-guide-__tabbed_4_3">Linux variables.env file</label><label for="quickstart-guide-__tabbed_4_4">Docker</label><label for="quickstart-guide-__tabbed_4_5">Docker autoconf labels</label><label for="quickstart-guide-__tabbed_4_6">Kubernetes annotations</label><label for="quickstart-guide-__tabbed_4_7">Swarm labels</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>You can create a new service by navigating to the <code>Services</code> section of the web interface and clicking on the <code>➕ Create new service</code> button.</p>
<p>There are multiple ways of creating a service using the web interface:</p>
<ul>
<li>The <strong>Easy mode</strong> will guide you through the process of creating a new service.</li>
<li>The <strong>Advanced mode</strong> will allow you to configure the service with more options.</li>
<li>The <strong>Raw mode</strong> will allow you to enter the configuration directly like editing the <code>variables.env</code> file.</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Draft service</p>
<p>You can create a draft service to save your progress and come back to it later. Just click on the <code>🌐 Online</code> button to toggle the service to draft mode.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="quickstart-guide-__tabbed_5_1" name="quickstart-guide-__tabbed_5" type="radio" /><input id="quickstart-guide-__tabbed_5_2" name="quickstart-guide-__tabbed_5" type="radio" /><input id="quickstart-guide-__tabbed_5_3" name="quickstart-guide-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="quickstart-guide-__tabbed_5_1">Easy mode</label><label for="quickstart-guide-__tabbed_5_2">Advanced mode</label><label for="quickstart-guide-__tabbed_5_3">Raw mode</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>In this mode, you can choose among the available templates and fill in the required fields.</p>
<p><figure markdown>
  <img align="center" alt="Web interface create service easy" src="../assets/img/ui-create-service-easy.png" />
  <figcaption>Web interface create service easy</figcaption>
</figure></p>
<ul>
<li>To navigate between the different plugins, you can use the dropdown menu on the top left corner of the page.</li>
<li>Once you've selected the template, you can fill in the required fields and follow the instructions to create the service.</li>
<li>Once you're done configuring the service, you can click on the <code>💾 Save</code> button to save the configuration.</li>
</ul>
</div>
<div class="tabbed-block">
<p>In this mode, you can configure the service with more options while seeing all the available settings from all the different plugins.</p>
<p><figure markdown>
  <img align="center" alt="Web interface create service advanced" src="../assets/img/ui-create-service-advanced.png" />
  <figcaption>Web interface create service advanced</figcaption>
</figure></p>
<ul>
<li>To navigate between the different plugins, you can use the dropdown menu on the top left corner of the page.</li>
<li>Each setting has a small piece of information that will help you understand what it does.</li>
<li>Once you're done configuring the service, you can click on the <code>💾 Save</code> button to save the configuration.</li>
</ul>
</div>
<div class="tabbed-block">
<p>In this mode, you can enter the configuration directly like editing the <code>variables.env</code> file.</p>
<p><figure markdown>
  <img align="center" alt="Web interface create service RAW" src="../assets/img/ui-create-service-raw.png" />
  <figcaption>Web interface create service RAW</figcaption>
</figure></p>
<ul>
<li>Once you're done configuring the service, you can click on the <code>💾 Save</code> button to save the configuration.</li>
</ul>
</div>
</div>
</div>
<p>🚀 Once you've saved the configuration, you should see your new service in the list of services.</p>
<p><figure markdown>
  <img align="center" alt="Web interface services page" src="../assets/img/ui-services.png" />
  <figcaption>Web interface services page</figcaption>
</figure></p>
<p>If you wish to edit the service, you can click on the service name or the <code>📝 Edit</code> button.</p>
</div>
<div class="tabbed-block">
<p>When using the All-in-One image, new services are configured by adding environment variables to the <code>docker run</code> command for the <code>bunkerweb-aio</code> container. If the container is already running, you must stop and remove it, then re-run it with the updated environment variables.</p>
<p>Suppose you want to protect an application <code>myapp</code> (running in another container and accessible as <code>http://myapp:8080</code> from BunkerWeb) and make it available at <code>www.example.com</code>. You would add or modify the following environment variables in your <code>docker run</code> command:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># First, stop and remove the existing container if it&#39;s running:</span>
<span class="c1"># docker stop bunkerweb-aio</span>
<span class="c1"># docker rm bunkerweb-aio</span>

<span class="c1"># Then, re-run the bunkerweb-aio container with additional/updated environment variables:</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="c1"># --- Add/modify these environment variables for your new service ---</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">MULTISITE</span><span class="o">=</span>yes<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="nv">SERVER_NAME</span><span class="o">=</span><span class="s2">&quot;www.example.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;www.example.com_USE_REVERSE_PROXY=yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;www.example.com_REVERSE_PROXY_HOST=http://myapp:8080&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-e<span class="w"> </span><span class="s2">&quot;www.example.com_REVERSE_PROXY_URL=/&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">  </span><span class="c1"># --- Include any other existing environment variables for UI, Redis, CrowdSec, etc. ---</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>Your application container (<code>myapp</code>) and the <code>bunkerweb-aio</code> container must be on the same Docker network for BunkerWeb to reach it using the hostname <code>myapp</code>.</p>
<p><strong>Network Setup Example:</strong>
<div class="highlight"><pre><span></span><code><span class="c1"># 1. Create a custom Docker network (if you haven&#39;t already):</span>
docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>my-app-network

<span class="c1"># 2. Run your application container on this network:</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>myapp<span class="w"> </span>--network<span class="w"> </span>my-app-network<span class="w"> </span>your-app-image

<span class="c1"># 3. Add --network my-app-network to the bunkerweb-aio docker run command:</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>--network<span class="w"> </span>my-app-network<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">  </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="c1">#   ... (all other relevant environment variables as shown in the main example above) ...</span>
<span class="w">  </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div></p>
<p>Make sure to replace <code>myapp</code> with the actual name or IP of your application container and <code>http://myapp:8080</code> with its correct address and port.</p>
</div>
<div class="tabbed-block">
<p>We assume that you followed the <a href="#quickstart-guide-__tabbed_1_5">Basic setup</a> and that the Linux integration is running on your machine.</p>
<p>You can create a new service by editing the <code>variables.env</code> file located in the <code>/etc/bunkerweb/</code> directory.</p>
<div class="highlight"><pre><span></span><code>nano<span class="w"> </span>/etc/bunkerweb/variables.env
</code></pre></div>
<p>You can then add the following configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nv">SERVER_NAME</span><span class="o">=</span>www.example.com
<span class="nv">MULTISITE</span><span class="o">=</span>yes
www.example.com_USE_REVERSE_PROXY<span class="o">=</span>yes
www.example.com_REVERSE_PROXY_URL<span class="o">=</span>/
www.example.com_REVERSE_PROXY_HOST<span class="o">=</span>http://myapp:8080
</code></pre></div>
<p>You can then reload the <code>bunkerweb-scheduler</code> service to apply the changes.</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We assume that you followed the <a href="#quickstart-guide-__tabbed_1_1">Basic setup</a> and that the Docker integration is running on your machine.</p>
<p>You must have a network called <code>bw-services</code> so that you can connect your existing application and configure BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<p>After that, you can manually add the service in the docker compose file that you created in the previous step:</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">bw-scheduler</span><span class="p p-Indicator">:</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">environment</span><span class="p p-Indicator">:</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">SERVER_NAME</span><span class="p p-Indicator">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span><span class="w"> </span><span class="c1"># When using the Docker integration, you can set the configuration directly in the scheduler, make sure to set the correct domain name</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Enable multisite mode so you can add multiple services</span>
<span class="w">      </span><span class="nt">www.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://myapp:8080&quot;</span>
<span class="w">      </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>You can then restart the <code>bw-scheduler</code> service to apply the changes.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down<span class="w"> </span>bw-scheduler<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d<span class="w"> </span>bw-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>We assume that you followed the <a href="#quickstart-guide-__tabbed_1_2">Basic setup</a> and that the Docker autoconf integration is running on your machine.</p>
<p>You must have a network called <code>bw-services</code> so that you can connect your existing application and configure BunkerWeb with labels:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://myapp:8080&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
<p>Doing so will automatically create a new service with the provided labels as configuration.</p>
</div>
<div class="tabbed-block">
<p>We assume that you followed the <a href="#quickstart-guide-__tabbed_1_4">Basic setup</a> and that the Kubernetes stack is running on your cluster.</p>
<p>Let's assume that you have a typical Deployment with a Service to access the web application from within the cluster:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">        </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
</code></pre></div>
<p>Here is the corresponding Ingress definition to serve and protect the web application:</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/DUMMY_SETTING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;value&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">www.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app</span>
<span class="w">              </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#quickstart-guide-__tabbed_2_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>We assume that you followed the <a href="#quickstart-guide-__tabbed_1_3">Basic setup</a> and that the Swarm stack is running on your cluster and connected to a network called <code>bw-services</code> so that you can connect your existing application and configure BunkerWeb with labels:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://myapp:8080&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="quickstart-guide-going-further">Going further</h2>
<p>Congratulations! You have just installed BunkerWeb and secured your first web service. Please note that BunkerWeb offers much more, both in terms of security and integrations with other systems and solutions. Here's a list of resources and actions that may help you continue to deepen your knowledge of the solution:</p>
<ul>
<li>Join the Bunker community: <a href="https://discord.com/invite/fTf46FmtyD">Discord</a>, <a href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>, <a href="https://github.com/bunkerity">GitHub</a>, <a href="https://x.com/bunkerity">X</a></li>
<li>Check out the <a href="https://www.bunkerweb.io/blog?utm_campaign=self&amp;utm_source=doc">official blog</a></li>
<li>Explore <a href="#advanced">advanced use cases</a> in the documentation</li>
<li><a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">Get in touch with us</a> to discuss your organization's needs</li>
</ul></section><section class="print-page" id="features" heading-number="5"><h1 id="features-features">Features</h1>
<div class="admonition info">
<p class="admonition-title">Settings generator tool</p>
<p>To help you tune BunkerWeb, we have made an easy-to-use settings generator tool available at <a href="https://config.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">config.bunkerweb.io</a>.</p>
</div>
<p>This section contains the full list of settings supported by BunkerWeb. If you are not yet familiar with BunkerWeb, you should first read the <a href="#concepts">concepts</a> section of the documentation. Please follow the instructions for your own <a href="#integrations">integration</a> on how to apply the settings.</p>
<h2 id="features-global-settings">Global settings</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The General plugin provides the core configuration framework for BunkerWeb, allowing you to define essential settings that control how your web services are protected and delivered. This foundational plugin manages fundamental aspects like security modes, server defaults, logging behavior, and critical operational parameters for the entire BunkerWeb ecosystem.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When BunkerWeb starts, the General plugin loads and applies your core configuration settings.</li>
<li>Security modes are set either globally or per-site, determining the level of protection applied.</li>
<li>Default server settings establish fallback values for any unspecified multisite configurations.</li>
<li>Logging parameters control what information is recorded and how it's formatted.</li>
<li>These settings create the foundation upon which all other BunkerWeb plugins and functionality operate.</li>
</ol>
<h3 id="features-multisite-mode">Multisite Mode</h3>
<p>When <code>MULTISITE</code> is set to <code>yes</code>, BunkerWeb can host and protect multiple websites, each with its own unique configuration. This feature is particularly useful for scenarios such as:</p>
<ul>
<li>Hosting multiple domains with distinct configurations</li>
<li>Running multiple applications with varying security requirements</li>
<li>Applying tailored security policies to different services</li>
</ul>
<p>In multisite mode, each site is identified by a unique <code>SERVER_NAME</code>. To apply settings specific to a site, prepend the primary <code>SERVER_NAME</code> to the setting name. For example:</p>
<ul>
<li><code>www.example.com_USE_ANTIBOT=captcha</code> enables CAPTCHA for <code>www.example.com</code>.</li>
<li><code>myapp.example.com_USE_GZIP=yes</code> enables GZIP compression for <code>myapp.example.com</code>.</li>
</ul>
<p>This approach ensures that settings are applied to the correct site in a multisite environment.</p>
<h3 id="features-multiple-settings">Multiple Settings</h3>
<p>Some settings in BunkerWeb support multiple configurations for the same feature. To define multiple groups of settings, append a numeric suffix to the setting name. For example:</p>
<ul>
<li><code>REVERSE_PROXY_URL_1=/subdir</code> and <code>REVERSE_PROXY_HOST_1=http://myhost1</code> configure the first reverse proxy.</li>
<li><code>REVERSE_PROXY_URL_2=/anotherdir</code> and <code>REVERSE_PROXY_HOST_2=http://myhost2</code> configure the second reverse proxy.</li>
</ul>
<p>This pattern allows you to manage multiple configurations for features like reverse proxies, ports, or other settings that require distinct values for different use cases.</p>
<h3 id="features-security-modes">Security Modes</h3>
<p>The <code>SECURITY_MODE</code> setting determines how BunkerWeb handles detected threats. This flexible feature allows you to choose between monitoring or actively blocking suspicious activity, depending on your specific needs:</p>
<ul>
<li><strong><code>detect</code></strong>: Logs potential threats without blocking access. This mode is useful for identifying and analyzing false positives in a safe, non-disruptive manner.</li>
<li><strong><code>block</code></strong> (default): Actively blocks detected threats while logging incidents to prevent unauthorized access and protect your application.</li>
</ul>
<p>Switching to <code>detect</code> mode can help you identify and resolve potential false positives without disrupting legitimate clients. Once these issues are addressed, you can confidently switch back to <code>block</code> mode for full protection.</p>
<h3 id="features-configuration-settings">Configuration Settings</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:9"><input checked="checked" id="features-__tabbed_1_1" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_2" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_3" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_4" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_5" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_6" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_7" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_8" name="features-__tabbed_1" type="radio" /><input id="features-__tabbed_1_9" name="features-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_1_1">Core Settings</label><label for="features-__tabbed_1_2">API Settings</label><label for="features-__tabbed_1_3">Network &amp; Port Settings</label><label for="features-__tabbed_1_4">Stream Server Settings</label><label for="features-__tabbed_1_5">Worker Settings</label><label for="features-__tabbed_1_6">Memory Settings</label><label for="features-__tabbed_1_7">Logging Settings</label><label for="features-__tabbed_1_8">Integration Settings</label><label for="features-__tabbed_1_9">Nginx Settings</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SERVER_NAME</code></td>
<td><code>www.example.com</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Primary Domain:</strong> The main domain name for this site. Required in multisite mode.</td>
</tr>
<tr>
<td><code>BUNKERWEB_INSTANCES</code></td>
<td><code>127.0.0.1</code></td>
<td>global</td>
<td>No</td>
<td><strong>BunkerWeb Instances:</strong> List of BunkerWeb instances separated with spaces.</td>
</tr>
<tr>
<td><code>MULTISITE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Multiple Sites:</strong> Set to <code>yes</code> to enable hosting multiple websites with different configurations.</td>
</tr>
<tr>
<td><code>SECURITY_MODE</code></td>
<td><code>block</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Security Level:</strong> Controls the level of security enforcement. Options: <code>detect</code> or <code>block</code>.</td>
</tr>
<tr>
<td><code>SERVER_TYPE</code></td>
<td><code>http</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Server Type:</strong> Defines if the server is <code>http</code> or <code>stream</code> type.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_API</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>No</td>
<td><strong>Activate API:</strong> Activate the API to control BunkerWeb.</td>
</tr>
<tr>
<td><code>API_HTTP_PORT</code></td>
<td><code>5000</code></td>
<td>global</td>
<td>No</td>
<td><strong>API Port:</strong> Listen port number for the API.</td>
</tr>
<tr>
<td><code>API_LISTEN_IP</code></td>
<td><code>0.0.0.0</code></td>
<td>global</td>
<td>No</td>
<td><strong>API Listen IP:</strong> Listen IP address for the API.</td>
</tr>
<tr>
<td><code>API_SERVER_NAME</code></td>
<td><code>bwapi</code></td>
<td>global</td>
<td>No</td>
<td><strong>API Server Name:</strong> Server name (virtual host) for the API.</td>
</tr>
<tr>
<td><code>API_WHITELIST_IP</code></td>
<td><code>127.0.0.0/8</code></td>
<td>global</td>
<td>No</td>
<td><strong>API Whitelist IP:</strong> List of IP/network allowed to contact the API.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>HTTP_PORT</code></td>
<td><code>8080</code></td>
<td>global</td>
<td>Yes</td>
<td><strong>HTTP Port:</strong> Port number for HTTP traffic.</td>
</tr>
<tr>
<td><code>HTTPS_PORT</code></td>
<td><code>8443</code></td>
<td>global</td>
<td>Yes</td>
<td><strong>HTTPS Port:</strong> Port number for HTTPS traffic.</td>
</tr>
<tr>
<td><code>USE_IPV6</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>IPv6 Support:</strong> Enable IPv6 connectivity.</td>
</tr>
<tr>
<td><code>DNS_RESOLVERS</code></td>
<td><code>127.0.0.11</code></td>
<td>global</td>
<td>No</td>
<td><strong>DNS Resolvers:</strong> DNS addresses of resolvers to use.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LISTEN_STREAM</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>Listen Stream:</strong> Enable listening for non-ssl (passthrough).</td>
</tr>
<tr>
<td><code>LISTEN_STREAM_PORT</code></td>
<td><code>1337</code></td>
<td>multisite</td>
<td>Yes</td>
<td><strong>Stream Port:</strong> Listening port for non-ssl (passthrough).</td>
</tr>
<tr>
<td><code>LISTEN_STREAM_PORT_SSL</code></td>
<td><code>4242</code></td>
<td>multisite</td>
<td>Yes</td>
<td><strong>Stream SSL Port:</strong> Listening port for ssl (passthrough).</td>
</tr>
<tr>
<td><code>USE_TCP</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>TCP Listen:</strong> Enable TCP listening (stream).</td>
</tr>
<tr>
<td><code>USE_UDP</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>No</td>
<td><strong>UDP Listen:</strong> Enable UDP listening (stream).</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WORKER_PROCESSES</code></td>
<td><code>auto</code></td>
<td>global</td>
<td>No</td>
<td><strong>Worker Processes:</strong> Number of worker processes. Set to <code>auto</code> to use available cores.</td>
</tr>
<tr>
<td><code>WORKER_CONNECTIONS</code></td>
<td><code>1024</code></td>
<td>global</td>
<td>No</td>
<td><strong>Worker Connections:</strong> Maximum number of connections per worker.</td>
</tr>
<tr>
<td><code>WORKER_RLIMIT_NOFILE</code></td>
<td><code>2048</code></td>
<td>global</td>
<td>No</td>
<td><strong>File Descriptors Limit:</strong> Maximum number of open files per worker.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WORKERLOCK_MEMORY_SIZE</code></td>
<td><code>48k</code></td>
<td>global</td>
<td>No</td>
<td><strong>Workerlock Memory Size:</strong> Size of lua_shared_dict for initialization workers.</td>
</tr>
<tr>
<td><code>DATASTORE_MEMORY_SIZE</code></td>
<td><code>64m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Datastore Memory Size:</strong> Size of the internal datastore.</td>
</tr>
<tr>
<td><code>CACHESTORE_MEMORY_SIZE</code></td>
<td><code>64m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Cachestore Memory Size:</strong> Size of the internal cachestore.</td>
</tr>
<tr>
<td><code>CACHESTORE_IPC_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Cachestore IPC Memory Size:</strong> Size of the internal cachestore (ipc).</td>
</tr>
<tr>
<td><code>CACHESTORE_MISS_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Cachestore Miss Memory Size:</strong> Size of the internal cachestore (miss).</td>
</tr>
<tr>
<td><code>CACHESTORE_LOCKS_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>No</td>
<td><strong>Cachestore Locks Memory Size:</strong> Size of the internal cachestore (locks).</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LOG_FORMAT</code></td>
<td><code>$host $remote_addr - $remote_user [$time_local] \"$request\" $status $body_bytes_sent \"$http_referer\" \"$http_user_agent\"</code></td>
<td>global</td>
<td>No</td>
<td><strong>Log Format:</strong> The format to use for access logs.</td>
</tr>
<tr>
<td><code>LOG_LEVEL</code></td>
<td><code>notice</code></td>
<td>global</td>
<td>No</td>
<td><strong>Log Level:</strong> Verbosity level for error logs. Options: <code>debug</code>, <code>info</code>, <code>notice</code>, <code>warn</code>, <code>error</code>, <code>crit</code>, <code>alert</code>, <code>emerg</code>.</td>
</tr>
<tr>
<td><code>TIMERS_LOG_LEVEL</code></td>
<td><code>debug</code></td>
<td>global</td>
<td>No</td>
<td><strong>Timers Log Level:</strong> Log level for timers. Options: <code>debug</code>, <code>info</code>, <code>notice</code>, <code>warn</code>, <code>err</code>, <code>crit</code>, <code>alert</code>, <code>emerg</code>.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Logging Best Practices</p>
<ul>
<li>For production environments, use the <code>notice</code>, <code>warn</code>, or <code>error</code> log levels to minimize log volume.</li>
<li>For debugging issues, temporarily set the log level to <code>debug</code> to get more detailed information.</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AUTOCONF_MODE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Autoconf Mode:</strong> Enable Autoconf Docker integration.</td>
</tr>
<tr>
<td><code>SWARM_MODE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Swarm Mode:</strong> Enable Docker Swarm integration.</td>
</tr>
<tr>
<td><code>KUBERNETES_MODE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>No</td>
<td><strong>Kubernetes Mode:</strong> Enable Kubernetes integration.</td>
</tr>
<tr>
<td><code>USE_TEMPLATE</code></td>
<td>``</td>
<td>multisite</td>
<td>No</td>
<td><strong>Use Template:</strong> Config template to use that will override the default values of specific settings.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>NGINX_PREFIX</code></td>
<td><code>/etc/nginx/</code></td>
<td>global</td>
<td>No</td>
<td><strong>Nginx Prefix:</strong> Where nginx will search for configurations.</td>
</tr>
<tr>
<td><code>SERVER_NAMES_HASH_BUCKET_SIZE</code></td>
<td>``</td>
<td>global</td>
<td>No</td>
<td><strong>Server Names Hash Bucket Size:</strong> Value for the server_names_hash_bucket_size directive.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<h3 id="features-example-configurations">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="features-__tabbed_2_1" name="features-__tabbed_2" type="radio" /><input id="features-__tabbed_2_2" name="features-__tabbed_2" type="radio" /><input id="features-__tabbed_2_3" name="features-__tabbed_2" type="radio" /><input id="features-__tabbed_2_4" name="features-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_2_1">Basic Production Setup</label><label for="features-__tabbed_2_2">Development Mode</label><label for="features-__tabbed_2_3">Multisite Configuration</label><label for="features-__tabbed_2_4">Stream Server Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A standard configuration for a production site with strict security:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;block&quot;</span>
<span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;example.com&quot;</span>
<span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;notice&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for a development environment with extra logging:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;detect&quot;</span>
<span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dev.example.com&quot;</span>
<span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;debug&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for hosting multiple websites:</p>
<div class="highlight"><pre><span></span><code><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># First site</span>
<span class="nt">site1.example.com_SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;site1.example.com&quot;</span>
<span class="nt">site1.example.com_SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;block&quot;</span>

<span class="c1"># Second site</span>
<span class="nt">site2.example.com_SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;site2.example.com&quot;</span>
<span class="nt">site2.example.com_SECURITY_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;detect&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for a TCP/UDP server:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SERVER_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span>
<span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream.example.com&quot;</span>
<span class="nt">LISTEN_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1337&quot;</span>
<span class="nt">USE_TCP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_UDP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-anti-ddos-pro">Anti DDoS <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Provides enhanced protection against DDoS attacks by analyzing and filtering suspicious traffic.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIDDOS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable or disable anti DDoS protection to mitigate high traffic spikes.</td>
</tr>
<tr>
<td><code>ANTIDDOS_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Size of in-memory storage for DDoS metrics (e.g., 10M, 500k).</td>
</tr>
<tr>
<td><code>ANTIDDOS_THRESHOLD</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td>Maximum suspicious requests allowed from a single IP before blocking.</td>
</tr>
<tr>
<td><code>ANTIDDOS_WINDOW_TIME</code></td>
<td><code>10</code></td>
<td>global</td>
<td>no</td>
<td>Time window (seconds) to detect abnormal request patterns.</td>
</tr>
<tr>
<td><code>ANTIDDOS_STATUS_CODES</code></td>
<td><code>429 403 444</code></td>
<td>global</td>
<td>no</td>
<td>HTTP status codes treated as suspicious for DDoS analysis.</td>
</tr>
<tr>
<td><code>ANTIDDOS_DISTINCT_IP</code></td>
<td><code>5</code></td>
<td>global</td>
<td>no</td>
<td>Minimum distinct IP count before enabling anti DDoS measures.</td>
</tr>
</tbody>
</table>
<h2 id="features-antibot">Antibot</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Attackers often use automated tools (bots) to try and exploit your website. To protect against this, BunkerWeb includes an "Antibot" feature that challenges users to prove they are human. If a user successfully completes the challenge, they are granted access to your website. This feature is disabled by default.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a user visits your site, BunkerWeb checks if they've already passed the antibot challenge.</li>
<li>If not, the user is redirected to a challenge page.</li>
<li>The user must complete the challenge (e.g., solve a CAPTCHA, run JavaScript).</li>
<li>If the challenge is successful, the user is redirected back to the page they were originally trying to visit and can browse your website normally.</li>
</ol>
<h3 id="features-how-to-use">How to Use</h3>
<p>Follow these steps to enable and configure the Antibot feature:</p>
<ol>
<li><strong>Choose a challenge type:</strong> Decide which type of antibot challenge to use (e.g., <a href="#features-__tabbed_3_3">captcha</a>, <a href="#features-__tabbed_3_5">hcaptcha</a>, <a href="#features-__tabbed_3_2">javascript</a>).</li>
<li><strong>Enable the feature:</strong> Set the <code>USE_ANTIBOT</code> setting to your chosen challenge type in your BunkerWeb configuration.</li>
<li><strong>Configure the settings:</strong> Adjust the other <code>ANTIBOT_*</code> settings as needed. For reCAPTCHA, hCaptcha, Turnstile, and mCaptcha, you must create an account with the respective service and obtain API keys.</li>
<li><strong>Important:</strong> Ensure the <code>ANTIBOT_URI</code> is a unique URL on your site that is not in use.</li>
</ol>
<div class="admonition important">
<p class="admonition-title">About the <code>ANTIBOT_URI</code> Setting</p>
<p>Ensure the <code>ANTIBOT_URI</code> is a unique URL on your site that is not in use.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Session Configuration in Clustered Environments</p>
<p>The antibot feature uses cookies to track whether a user has completed the challenge. If you are running BunkerWeb in a clustered environment (multiple BunkerWeb instances), you <strong>must</strong> configure session management properly. This involves setting the <code>SESSIONS_SECRET</code> and <code>SESSIONS_NAME</code> settings to the <strong>same values</strong> across all BunkerWeb instances. If you don't do this, users may be repeatedly prompted to complete the antibot challenge. You can find more information about session configuration <a href="#features-sessions">here</a>.</p>
</div>
<h3 id="features-common-settings">Common Settings</h3>
<p>The following settings are shared across all challenge mechanisms:</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ANTIBOT_URI</code></td>
<td><code>/challenge</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Challenge URL:</strong> The URL where users will be redirected to complete the challenge. Make sure this URL is not used for anything else on your site.</td>
</tr>
<tr>
<td><code>ANTIBOT_TIME_RESOLVE</code></td>
<td><code>60</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Challenge Time Limit:</strong> The maximum time (in seconds) a user has to complete the challenge. After this time, a new challenge will be generated.</td>
</tr>
<tr>
<td><code>ANTIBOT_TIME_VALID</code></td>
<td><code>86400</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Challenge Validity:</strong> How long (in seconds) a completed challenge is valid. After this time, users will have to solve a new challenge.</td>
</tr>
</tbody>
</table>
<h3 id="features-excluding-traffic-from-challenges">Excluding Traffic from Challenges</h3>
<p>BunkerWeb allows you to specify certain users, IPs, or requests that should bypass the antibot challenge completely. This is useful for whitelisting trusted services, internal networks, or specific pages that should always be accessible without challenge:</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ANTIBOT_IGNORE_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Excluded URLs:</strong> List of URI regex patterns separated by spaces that should bypass the challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Excluded IPs:</strong> List of IP addresses or CIDR ranges separated by spaces that should bypass the challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_RDNS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Excluded Reverse DNS:</strong> List of reverse DNS suffixes separated by spaces that should bypass the challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_RDNS_GLOBAL</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Global IPs Only:</strong> If set to <code>yes</code>, only perform reverse DNS checks on public IP addresses.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Excluded ASNs:</strong> List of ASN numbers separated by spaces that should bypass the challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_IGNORE_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Excluded User Agents:</strong> List of User-Agent regex patterns separated by spaces that should bypass the challenge.</td>
</tr>
</tbody>
</table>
<p><strong>Examples:</strong></p>
<ul>
<li>
<p><code>ANTIBOT_IGNORE_URI: "^/api/ ^/webhook/ ^/assets/"</code>
  This will exclude all URIs starting with <code>/api/</code>, <code>/webhook/</code>, or <code>/assets/</code> from the antibot challenge.</p>
</li>
<li>
<p><code>ANTIBOT_IGNORE_IP: "192.168.1.0/24 10.0.0.1"</code>
  This will exclude the internal network <code>192.168.1.0/24</code> and the specific IP <code>10.0.0.1</code> from the antibot challenge.</p>
</li>
<li>
<p><code>ANTIBOT_IGNORE_RDNS: ".googlebot.com .bingbot.com"</code>
  This will exclude requests from hosts with reverse DNS ending with <code>googlebot.com</code> or <code>bingbot.com</code> from the antibot challenge.</p>
</li>
<li>
<p><code>ANTIBOT_IGNORE_ASN: "15169 8075"</code>
  This will exclude requests from ASN 15169 (Google) and ASN 8075 (Microsoft) from the antibot challenge.</p>
</li>
<li>
<p><code>ANTIBOT_IGNORE_USER_AGENT: "^Mozilla.+Chrome.+Safari"</code>
  This will exclude requests with User-Agents matching the specified regex pattern from the antibot challenge.</p>
</li>
</ul>
<h3 id="features-supported-challenge-mechanisms">Supported Challenge Mechanisms</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="3:7"><input checked="checked" id="features-__tabbed_3_1" name="features-__tabbed_3" type="radio" /><input id="features-__tabbed_3_2" name="features-__tabbed_3" type="radio" /><input id="features-__tabbed_3_3" name="features-__tabbed_3" type="radio" /><input id="features-__tabbed_3_4" name="features-__tabbed_3" type="radio" /><input id="features-__tabbed_3_5" name="features-__tabbed_3" type="radio" /><input id="features-__tabbed_3_6" name="features-__tabbed_3" type="radio" /><input id="features-__tabbed_3_7" name="features-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_3_1">Cookie</label><label for="features-__tabbed_3_2">JavaScript</label><label for="features-__tabbed_3_3">Captcha</label><label for="features-__tabbed_3_4">reCAPTCHA</label><label for="features-__tabbed_3_5">hCaptcha</label><label for="features-__tabbed_3_6">Turnstile</label><label for="features-__tabbed_3_7">mCaptcha</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The Cookie challenge is a lightweight mechanism that relies on setting a cookie in the user's browser. When a user accesses the site, the server sends a cookie to the client. On subsequent requests, the server checks for the presence of this cookie to verify that the user is legitimate. This method is simple and effective for basic bot protection without requiring additional user interaction.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>The server generates a unique cookie and sends it to the client.</li>
<li>The client must return the cookie in subsequent requests.</li>
<li>If the cookie is missing or invalid, the user is redirected to the challenge page.</li>
</ol>
<p><strong>Configuration Settings:</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Antibot:</strong> Set to <code>cookie</code> to enable the Cookie challenge.</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#features-common-settings">Common Settings</a> for additional configuration options.</p>
</div>
<div class="tabbed-block">
<p>The JavaScript challenge requires the client to solve a computational task using JavaScript. This mechanism ensures that the client has JavaScript enabled and can execute the required code, which is typically beyond the capability of most bots.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>The server sends a JavaScript script to the client.</li>
<li>The script performs a computational task (e.g., hashing) and submits the result back to the server.</li>
<li>The server verifies the result to confirm the client's legitimacy.</li>
</ol>
<p><strong>Key Features:</strong></p>
<ul>
<li>The challenge dynamically generates a unique task for each client.</li>
<li>The computational task involves hashing with specific conditions (e.g., finding a hash with a certain prefix).</li>
</ul>
<p><strong>Configuration Settings:</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Antibot:</strong> Set to <code>javascript</code> to enable the JavaScript challenge.</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#features-common-settings">Common Settings</a> for additional configuration options.</p>
</div>
<div class="tabbed-block">
<p>The Captcha challenge is a homemade mechanism that generates image-based challenges hosted entirely within your BunkerWeb environment. It tests users' ability to recognize and interpret randomized characters, ensuring automated bots are effectively blocked without relying on external services.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>The server generates a CAPTCHA image containing randomized characters.</li>
<li>The user must enter the characters displayed in the image into a text field.</li>
<li>The server validates the user's input against the generated CAPTCHA.</li>
</ol>
<p><strong>Key Features:</strong></p>
<ul>
<li>Fully self-hosted, eliminating the need for third-party APIs.</li>
<li>Dynamically generated challenges ensure uniqueness for each user session.</li>
</ul>
<p><strong>Configuration Settings:</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Antibot:</strong> Set to <code>captcha</code> to enable the Captcha challenge.</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#features-common-settings">Common Settings</a> for additional configuration options.</p>
</div>
<div class="tabbed-block">
<p>When enabled, reCAPTCHA runs in the background (v3) to assign a score based on user behavior. A score lower than the configured threshold will prompt further verification or block the request. For visible challenges (v2), users must interact with the reCAPTCHA widget before continuing.</p>
<p>To use reCAPTCHA with BunkerWeb, you need to obtain your site and secret keys from the <a href="https://www.google.com/recaptcha/admin">Google reCAPTCHA admin console</a>. Once you have the keys, you can configure BunkerWeb to use reCAPTCHA as an antibot mechanism.</p>
<p><strong>Configuration Settings:</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Antibot:</strong> Set to <code>recaptcha</code> to enable the reCAPTCHA challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>reCAPTCHA Site Key:</strong> Your reCAPTCHA site key (get this from Google).</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>reCAPTCHA Secret Key:</strong> Your reCAPTCHA secret key (get this from Google).</td>
</tr>
<tr>
<td><code>ANTIBOT_RECAPTCHA_SCORE</code></td>
<td><code>0.7</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>reCAPTCHA Minimum Score:</strong> The minimum score required for reCAPTCHA to pass a user (only for reCAPTCHA v3).</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#features-common-settings">Common Settings</a> for additional configuration options.</p>
</div>
<div class="tabbed-block">
<p>When enabled, hCaptcha provides an effective alternative to reCAPTCHA by verifying user interactions without relying on a scoring mechanism. It challenges users with a simple, interactive test to confirm their legitimacy.</p>
<p>To integrate hCaptcha with BunkerWeb, you must obtain the necessary credentials from the hCaptcha dashboard at <a href="https://www.hcaptcha.com">hCaptcha</a>. These credentials include a site key and a secret key.</p>
<p><strong>Configuration Settings:</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Antibot:</strong> Set to <code>hcaptcha</code> to enable the hCaptcha challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_HCAPTCHA_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>hCaptcha Site Key:</strong> Your hCaptcha site key (get this from hCaptcha).</td>
</tr>
<tr>
<td><code>ANTIBOT_HCAPTCHA_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>hCaptcha Secret Key:</strong> Your hCaptcha secret key (get this from hCaptcha).</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#features-common-settings">Common Settings</a> for additional configuration options.</p>
</div>
<div class="tabbed-block">
<p>Turnstile is a modern, privacy-friendly challenge mechanism that leverages Cloudflare’s technology to detect and block automated traffic. It validates user interactions in a seamless, background manner, reducing friction for legitimate users while effectively discouraging bots.</p>
<p>To integrate Turnstile with BunkerWeb, ensure you obtain the necessary credentials from <a href="https://www.cloudflare.com/turnstile">Cloudflare Turnstile</a>.</p>
<p><strong>Configuration Settings:</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Antibot:</strong> Set to <code>turnstile</code> to enable the Turnstile challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_TURNSTILE_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Turnstile Site Key:</strong> Your Turnstile site key (get this from Cloudflare).</td>
</tr>
<tr>
<td><code>ANTIBOT_TURNSTILE_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Turnstile Secret Key:</strong> Your Turnstile secret key (get this from Cloudflare).</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#features-common-settings">Common Settings</a> for additional configuration options.</p>
</div>
<div class="tabbed-block">
<p>mCaptcha is an alternative CAPTCHA challenge mechanism that verifies the legitimacy of users by presenting an interactive test similar to other antibot solutions. When enabled, it challenges users with a CAPTCHA provided by mCaptcha, ensuring that only genuine users bypass the automated security checks.</p>
<p>mCaptcha is designed with privacy in mind. It is fully GDPR compliant, ensuring that all user data involved in the challenge process adheres to strict data protection standards. Additionally, mCaptcha offers the flexibility to be self-hosted, allowing organizations to maintain full control over their data and infrastructure. This self-hosting capability not only enhances privacy but also optimizes performance and customization to suit specific deployment needs.</p>
<p>To integrate mCaptcha with BunkerWeb, you must obtain the necessary credentials from the <a href="https://mcaptcha.org/">mCaptcha</a> platform or your own provider. These credentials include a site key and a secret key for verification.</p>
<p><strong>Configuration Settings:</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIBOT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Antibot:</strong> Set to <code>mcaptcha</code> to enable the mCaptcha challenge.</td>
</tr>
<tr>
<td><code>ANTIBOT_MCAPTCHA_SITEKEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>mCaptcha Site Key:</strong> Your mCaptcha site key (get this from mCaptcha).</td>
</tr>
<tr>
<td><code>ANTIBOT_MCAPTCHA_SECRET</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>mCaptcha Secret Key:</strong> Your mCaptcha secret key (get this from mCaptcha).</td>
</tr>
<tr>
<td><code>ANTIBOT_MCAPTCHA_URL</code></td>
<td><code>https://demo.mcaptcha.org</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>mCaptcha Domain:</strong> The domain to use for the mCaptcha challenge.</td>
</tr>
</tbody>
</table>
<p>Refer to the <a href="#features-common-settings">Common Settings</a> for additional configuration options.</p>
</div>
</div>
</div>
<h3 id="features-example-configurations_1">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="4:7"><input checked="checked" id="features-__tabbed_4_1" name="features-__tabbed_4" type="radio" /><input id="features-__tabbed_4_2" name="features-__tabbed_4" type="radio" /><input id="features-__tabbed_4_3" name="features-__tabbed_4" type="radio" /><input id="features-__tabbed_4_4" name="features-__tabbed_4" type="radio" /><input id="features-__tabbed_4_5" name="features-__tabbed_4" type="radio" /><input id="features-__tabbed_4_6" name="features-__tabbed_4" type="radio" /><input id="features-__tabbed_4_7" name="features-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_4_1">Cookie Challenge</label><label for="features-__tabbed_4_2">JavaScript Challenge</label><label for="features-__tabbed_4_3">Captcha Challenge</label><label for="features-__tabbed_4_4">reCAPTCHA Challenge</label><label for="features-__tabbed_4_5">hCaptcha Challenge</label><label for="features-__tabbed_4_6">Turnstile Challenge</label><label for="features-__tabbed_4_7">mCaptcha Challenge</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Example configuration for enabling the Cookie challenge:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cookie&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling the JavaScript challenge:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;javascript&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling the Captcha challenge:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;captcha&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling the reCAPTCHA challenge:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;recaptcha&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_RECAPTCHA_SCORE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0.7&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling the hCaptcha challenge:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;hcaptcha&quot;</span>
<span class="nt">ANTIBOT_HCAPTCHA_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_HCAPTCHA_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling the Turnstile challenge:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;turnstile&quot;</span>
<span class="nt">ANTIBOT_TURNSTILE_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_TURNSTILE_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling the mCaptcha challenge:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mcaptcha&quot;</span>
<span class="nt">ANTIBOT_MCAPTCHA_SITEKEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-site-key&quot;</span>
<span class="nt">ANTIBOT_MCAPTCHA_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-secret-key&quot;</span>
<span class="nt">ANTIBOT_MCAPTCHA_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://demo.mcaptcha.org&quot;</span>
<span class="nt">ANTIBOT_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/challenge&quot;</span>
<span class="nt">ANTIBOT_TIME_RESOLVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">ANTIBOT_TIME_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-auth-basic">Auth basic</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The Auth Basic plugin provides HTTP basic authentication to protect your website or specific resources. This feature adds an extra layer of security by requiring users to enter a username and password before accessing protected content. This type of authentication is simple to implement and widely supported by browsers.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a user tries to access a protected area of your website, the server sends an authentication challenge.</li>
<li>The browser displays a login dialog box prompting the user for a username and password.</li>
<li>The user enters their credentials, which are sent to the server.</li>
<li>If the credentials are valid, the user is granted access to the requested content.</li>
<li>If the credentials are invalid, the user is served an error message with the 401 Unauthorized status code.</li>
</ol>
<h3 id="features-how-to-use_1">How to Use</h3>
<p>Follow these steps to enable and configure Auth Basic authentication:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>USE_AUTH_BASIC</code> setting to <code>yes</code> in your BunkerWeb configuration.</li>
<li><strong>Choose protection scope:</strong> Decide whether to protect your entire site or just specific URLs by configuring the <code>AUTH_BASIC_LOCATION</code> setting.</li>
<li><strong>Define credentials:</strong> Set up at least one username and password pair using the <code>AUTH_BASIC_USER</code> and <code>AUTH_BASIC_PASSWORD</code> settings.</li>
<li><strong>Customize the message:</strong> Optionally change the <code>AUTH_BASIC_TEXT</code> to display a custom message in the login prompt.</li>
</ol>
<h3 id="features-configuration-settings_1">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_AUTH_BASIC</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Auth Basic:</strong> Set to <code>yes</code> to enable basic authentication.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_LOCATION</code></td>
<td><code>sitewide</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Protection Scope:</strong> Set to <code>sitewide</code> to protect the entire site, or specify a URL path (e.g., <code>/admin</code>) to protect only specific areas.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_USER</code></td>
<td><code>changeme</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Username:</strong> The username required for authentication. You can define multiple username/password pairs.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_PASSWORD</code></td>
<td><code>changeme</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Password:</strong> The password required for authentication. Each password corresponds to a username.</td>
</tr>
<tr>
<td><code>AUTH_BASIC_TEXT</code></td>
<td><code>Restricted area</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Prompt Text:</strong> The message displayed in the authentication prompt shown to users.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<p>HTTP Basic Authentication transmits credentials encoded (not encrypted) in Base64. While this is acceptable when used over HTTPS, it should not be considered secure over plain HTTP. Always enable SSL/TLS when using basic authentication.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Using Multiple Credentials</p>
<p>You can configure multiple username/password pairs for access. Each <code>AUTH_BASIC_USER</code> setting should have a corresponding <code>AUTH_BASIC_PASSWORD</code> setting.</p>
</div>
<h3 id="features-example-configurations_2">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="features-__tabbed_5_1" name="features-__tabbed_5" type="radio" /><input id="features-__tabbed_5_2" name="features-__tabbed_5" type="radio" /><input id="features-__tabbed_5_3" name="features-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_5_1">Site-wide Protection</label><label for="features-__tabbed_5_2">Protecting Specific Areas</label><label for="features-__tabbed_5_3">Multiple Users</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>To protect your entire website with a single set of credentials:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_AUTH_BASIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">AUTH_BASIC_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sitewide&quot;</span>
<span class="nt">AUTH_BASIC_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secure_password&quot;</span>
<span class="nt">AUTH_BASIC_TEXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Admin</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Only&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>To only protect a specific path, such as an admin panel:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_AUTH_BASIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">AUTH_BASIC_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/admin/&quot;</span>
<span class="nt">AUTH_BASIC_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secure_password&quot;</span>
<span class="nt">AUTH_BASIC_TEXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Admin</span><span class="nv"> </span><span class="s">Access</span><span class="nv"> </span><span class="s">Only&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>To set up multiple users with different credentials:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_AUTH_BASIC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">AUTH_BASIC_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sitewide&quot;</span>
<span class="nt">AUTH_BASIC_TEXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Staff</span><span class="nv"> </span><span class="s">Area&quot;</span>

<span class="c1"># First user</span>
<span class="nt">AUTH_BASIC_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin_password&quot;</span>

<span class="c1"># Second user</span>
<span class="nt">AUTH_BASIC_USER_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;editor&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;editor_password&quot;</span>

<span class="c1"># Third user</span>
<span class="nt">AUTH_BASIC_USER_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;viewer&quot;</span>
<span class="nt">AUTH_BASIC_PASSWORD_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;viewer_password&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-backup">Backup</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Backup plugin provides an automated backup solution to protect your BunkerWeb data. This feature ensures the safety and availability of your important database by creating regular backups according to your preferred schedule. Backups are stored in a designated location and can be easily managed through both automated processes and manual commands.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>Your database is automatically backed up according to the schedule you set (daily, weekly, or monthly).</li>
<li>Backups are stored in a specified directory on your system.</li>
<li>Old backups are automatically rotated based on your retention settings.</li>
<li>You can manually create backups, list existing backups, or restore from a backup at any time.</li>
<li>Before any restore operation, the current state is automatically backed up as a safety measure.</li>
</ol>
<h3 id="features-how-to-use_2">How to Use</h3>
<p>Follow these steps to configure and use the Backup feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The backup feature is enabled by default. If needed, you can control this with the <code>USE_BACKUP</code> setting.</li>
<li><strong>Configure backup schedule:</strong> Choose how often backups should occur by setting the <code>BACKUP_SCHEDULE</code> parameter.</li>
<li><strong>Set retention policy:</strong> Specify how many backups to keep using the <code>BACKUP_ROTATION</code> setting.</li>
<li><strong>Define storage location:</strong> Choose where backups will be stored using the <code>BACKUP_DIRECTORY</code> setting.</li>
<li><strong>Use CLI commands:</strong> Manage backups manually with the <code>bwcli plugin backup</code> commands when needed.</li>
</ol>
<h3 id="features-configuration-settings_2">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BACKUP</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Enable Backup:</strong> Set to <code>yes</code> to enable automatic backups.</td>
</tr>
<tr>
<td><code>BACKUP_SCHEDULE</code></td>
<td><code>daily</code></td>
<td>global</td>
<td>no</td>
<td><strong>Backup Frequency:</strong> How often to perform backups. Options: <code>daily</code>, <code>weekly</code>, or <code>monthly</code>.</td>
</tr>
<tr>
<td><code>BACKUP_ROTATION</code></td>
<td><code>7</code></td>
<td>global</td>
<td>no</td>
<td><strong>Backup Retention:</strong> The number of backup files to keep. Older backups beyond this number will be automatically deleted.</td>
</tr>
<tr>
<td><code>BACKUP_DIRECTORY</code></td>
<td><code>/var/lib/bunkerweb/backups</code></td>
<td>global</td>
<td>no</td>
<td><strong>Backup Location:</strong> The directory where backup files will be stored.</td>
</tr>
</tbody>
</table>
<h3 id="features-command-line-interface">Command Line Interface</h3>
<p>The Backup plugin provides several CLI commands to manage your backups:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># List all available backups</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>list

<span class="c1"># Create a manual backup</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save

<span class="c1"># Create a backup in a custom location</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save<span class="w"> </span>--directory<span class="w"> </span>/path/to/custom/location

<span class="c1"># Restore from the most recent backup</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>restore

<span class="c1"># Restore from a specific backup file</span>
bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>restore<span class="w"> </span>/path/to/backup/backup-sqlite-2023-08-15_12-34-56.zip
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Safety First</p>
<p>Before any restore operation, the Backup plugin automatically creates a backup of your current database state in a temporary location. This provides an extra safeguard in case you need to revert the restore operation.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Database Compatibility</p>
<p>The Backup plugin supports SQLite, MySQL/MariaDB, and PostgreSQL databases. Oracle databases are not currently supported for backup and restore operations.</p>
</div>
<h3 id="features-example-configurations_3">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="6:3"><input checked="checked" id="features-__tabbed_6_1" name="features-__tabbed_6" type="radio" /><input id="features-__tabbed_6_2" name="features-__tabbed_6" type="radio" /><input id="features-__tabbed_6_3" name="features-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_6_1">Daily Backups with 7-Day Retention</label><label for="features-__tabbed_6_2">Weekly Backups with Extended Retention</label><label for="features-__tabbed_6_3">Monthly Backups to Custom Location</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Default configuration that creates daily backups and keeps the most recent 7 files:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BACKUP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BACKUP_SCHEDULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;daily&quot;</span>
<span class="nt">BACKUP_ROTATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;7&quot;</span>
<span class="nt">BACKUP_DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/lib/bunkerweb/backups&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for less frequent backups with longer retention:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BACKUP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BACKUP_SCHEDULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;weekly&quot;</span>
<span class="nt">BACKUP_ROTATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;12&quot;</span>
<span class="nt">BACKUP_DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/lib/bunkerweb/backups&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for monthly backups stored in a custom location:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BACKUP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BACKUP_SCHEDULE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;monthly&quot;</span>
<span class="nt">BACKUP_ROTATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;24&quot;</span>
<span class="nt">BACKUP_DIRECTORY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/mnt/backup-drive/bunkerweb-backups&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-backup-s3-pro">Backup S3 <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>Automatically backup your data to an S3 bucket</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BACKUP_S3</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable or disable the S3 backup feature</td>
</tr>
<tr>
<td><code>BACKUP_S3_SCHEDULE</code></td>
<td><code>daily</code></td>
<td>global</td>
<td>no</td>
<td>The frequency of the backup</td>
</tr>
<tr>
<td><code>BACKUP_S3_ROTATION</code></td>
<td><code>7</code></td>
<td>global</td>
<td>no</td>
<td>The number of backups to keep</td>
</tr>
<tr>
<td><code>BACKUP_S3_ENDPOINT</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 endpoint</td>
</tr>
<tr>
<td><code>BACKUP_S3_BUCKET</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 bucket</td>
</tr>
<tr>
<td><code>BACKUP_S3_DIR</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 directory</td>
</tr>
<tr>
<td><code>BACKUP_S3_REGION</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 region</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_ID</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 access key ID</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_SECRET</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The S3 access key secret</td>
</tr>
<tr>
<td><code>BACKUP_S3_COMP_LEVEL</code></td>
<td><code>6</code></td>
<td>global</td>
<td>no</td>
<td>The compression level of the backup zip file</td>
</tr>
</tbody>
</table>
<h2 id="features-bad-behavior">Bad behavior</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Bad Behavior plugin protects your website by automatically detecting and banning IP addresses that generate too many errors or "bad" HTTP status codes within a specified period of time. This helps defend against brute force attacks, web scrapers, vulnerability scanners, and other malicious activities that might generate numerous error responses.</p>
<p>Attackers often generate "suspicious" HTTP status codes when probing for or exploiting vulnerabilities—codes that a typical user is unlikely to trigger within a given time frame. By detecting this behavior, BunkerWeb can automatically ban the offending IP address, forcing the attacker to use a new IP address to continue their attempts.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>The plugin monitors HTTP responses from your site.</li>
<li>When a visitor receives a "bad" HTTP status code (like 400, 401, 403, 404, etc.), the counter for that IP address is incremented.</li>
<li>If an IP address exceeds the configured threshold of bad status codes within the specified time period, the IP is automatically banned.</li>
<li>Banned IPs can be blocked either at the service level (just for the specific site) or globally (across all sites), depending on your configuration.</li>
<li>Bans automatically expire after the configured ban duration, or remain permanent if configured with <code>0</code>.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Key benefits</p>
<ol>
<li><strong>Automatic Protection:</strong> Detects and blocks potentially malicious clients without requiring manual intervention.</li>
<li><strong>Customizable Rules:</strong> Fine-tune what constitutes "bad behavior" based on your specific needs.</li>
<li><strong>Resource Conservation:</strong> Prevents malicious actors from consuming server resources with repeated invalid requests.</li>
<li><strong>Flexible Scope:</strong> Choose whether bans should apply just to the current service or globally across all services.</li>
<li><strong>Ban Duration Control:</strong> Set temporary bans that automatically expire after the configured duration, or permanent bans that remain until manually removed.</li>
</ol>
</div>
<h3 id="features-how-to-use_3">How to Use</h3>
<p>Follow these steps to configure and use the Bad Behavior feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The Bad Behavior feature is enabled by default. If needed, you can control this with the <code>USE_BAD_BEHAVIOR</code> setting.</li>
<li><strong>Configure status codes:</strong> Define which HTTP status codes should be considered "bad" using the <code>BAD_BEHAVIOR_STATUS_CODES</code> setting.</li>
<li><strong>Set threshold values:</strong> Determine how many "bad" responses should trigger a ban using the <code>BAD_BEHAVIOR_THRESHOLD</code> setting.</li>
<li><strong>Configure time periods:</strong> Specify the duration for counting bad responses and the ban duration using the <code>BAD_BEHAVIOR_COUNT_TIME</code> and <code>BAD_BEHAVIOR_BAN_TIME</code> settings.</li>
<li><strong>Choose ban scope:</strong> Decide whether the bans should apply only to the current service or globally across all services using the <code>BAD_BEHAVIOR_BAN_SCOPE</code> setting.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Stream Mode</p>
<p>In <strong>stream mode</strong>, only the <code>444</code> status code is considered "bad" and will trigger this behavior.</p>
</div>
<h3 id="features-configuration-settings_3">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BAD_BEHAVIOR</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Bad Behavior:</strong> Set to <code>yes</code> to enable the bad behavior detection and banning feature.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_STATUS_CODES</code></td>
<td><code>400 401 403 404 405 429 444</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Bad Status Codes:</strong> List of HTTP status codes that will be counted as "bad" behavior when returned to a client.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_THRESHOLD</code></td>
<td><code>10</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Threshold:</strong> The number of "bad" status codes an IP can generate within the counting period before being banned.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_COUNT_TIME</code></td>
<td><code>60</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Count Period:</strong> The time window (in seconds) during which bad status codes are counted toward the threshold.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_BAN_TIME</code></td>
<td><code>86400</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ban Duration:</strong> How long (in seconds) an IP will remain banned after exceeding the threshold. Default is 24 hours (86400 seconds). Set to <code>0</code> for permanent bans that never expire.</td>
</tr>
<tr>
<td><code>BAD_BEHAVIOR_BAN_SCOPE</code></td>
<td><code>service</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ban Scope:</strong> Determines whether bans apply only to the current service (<code>service</code>) or to all services (<code>global</code>).</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">False Positives</p>
<p>Be careful when setting the threshold and count time. Setting these values too low may inadvertently ban legitimate users who encounter errors while browsing your site.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tuning Your Configuration</p>
<p>Start with conservative settings (higher threshold, shorter ban time) and adjust based on your specific needs and traffic patterns. Monitor your logs to ensure that legitimate users are not mistakenly banned.</p>
</div>
<h3 id="features-example-configurations_4">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="7:4"><input checked="checked" id="features-__tabbed_7_1" name="features-__tabbed_7" type="radio" /><input id="features-__tabbed_7_2" name="features-__tabbed_7" type="radio" /><input id="features-__tabbed_7_3" name="features-__tabbed_7" type="radio" /><input id="features-__tabbed_7_4" name="features-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_7_1">Default Configuration</label><label for="features-__tabbed_7_2">Strict Configuration</label><label for="features-__tabbed_7_3">Lenient Configuration</label><label for="features-__tabbed_7_4">Permanent Ban Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The default configuration provides a balanced approach suitable for most websites:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">444&quot;</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;service&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>For high-security applications where you want to be more aggressive in banning potential threats:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">444</span><span class="nv"> </span><span class="s">500</span><span class="nv"> </span><span class="s">502</span><span class="nv"> </span><span class="s">503&quot;</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;120&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;604800&quot;</span><span class="w">  </span><span class="c1"># 7 days</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;global&quot;</span><span class="w"> </span><span class="c1"># Ban across all services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>For sites with high legitimate traffic where you want to avoid false positives:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">429&quot;</span><span class="w">  </span><span class="c1"># Only count unauthorized, forbidden, and rate limited</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span><span class="w">  </span><span class="c1"># 1 hour</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;service&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>For scenarios where you want detected attackers permanently banned until manually unbanned:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BAD_BEHAVIOR</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BAD_BEHAVIOR_STATUS_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">444&quot;</span>
<span class="nt">BAD_BEHAVIOR_THRESHOLD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">BAD_BEHAVIOR_COUNT_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">BAD_BEHAVIOR_BAN_TIME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;0&quot;</span><span class="w">  </span><span class="c1"># Permanent ban (never expires)</span>
<span class="nt">BAD_BEHAVIOR_BAN_SCOPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;global&quot;</span><span class="w"> </span><span class="c1"># Ban across all services</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-blacklist">Blacklist</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Blacklist plugin provides robust protection for your website by blocking access based on various client attributes. This feature defends against known malicious entities, scanners, and suspicious visitors by denying access based on IP addresses, networks, reverse DNS entries, ASNs, user agents, and specific URI patterns.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>The plugin checks incoming requests against multiple blacklist criteria (IP addresses, networks, rDNS, ASN, User-Agent, or URI patterns).</li>
<li>Blacklists can be specified directly in your configuration or loaded from external URLs.</li>
<li>If a visitor matches any blacklist rule (and does not match any ignore rule), access is denied.</li>
<li>Blacklists are automatically updated on a regular schedule from configured URLs.</li>
<li>You can customize exactly which criteria are checked and ignored based on your specific security needs.</li>
</ol>
<h3 id="features-how-to-use_4">How to Use</h3>
<p>Follow these steps to configure and use the Blacklist feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The Blacklist feature is enabled by default. If needed, you can control this with the <code>USE_BLACKLIST</code> setting.</li>
<li><strong>Configure block rules:</strong> Define which IPs, networks, rDNS patterns, ASNs, User-Agents, or URIs should be blocked.</li>
<li><strong>Set up ignore rules:</strong> Specify any exceptions that should bypass the blacklist checks.</li>
<li><strong>Add external sources:</strong> Configure URLs for automatically downloading and updating blacklist data.</li>
<li><strong>Monitor effectiveness:</strong> Check the <a href="#web-ui">web UI</a> to see statistics on blocked requests.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">stream mode</p>
<p>When using stream mode, only IP, rDNS, and ASN checks will be performed.</p>
</div>
<h3 id="features-configuration-settings_4">Configuration Settings</h3>
<p><strong>General</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BLACKLIST</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Blacklist:</strong> Set to <code>yes</code> to enable the blacklist feature.</td>
</tr>
<tr>
<td><code>BLACKLIST_COMMUNITY_LISTS</code></td>
<td><code>ip:danmeuk-tor-exit ua:mitchellkrogza-bad-user-agents</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Community Blacklists:</strong> Select pre-configured community-maintained blacklists to include in blocking.</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="8:6"><input checked="checked" id="features-__tabbed_8_1" name="features-__tabbed_8" type="radio" /><input id="features-__tabbed_8_2" name="features-__tabbed_8" type="radio" /><input id="features-__tabbed_8_3" name="features-__tabbed_8" type="radio" /><input id="features-__tabbed_8_4" name="features-__tabbed_8" type="radio" /><input id="features-__tabbed_8_5" name="features-__tabbed_8" type="radio" /><input id="features-__tabbed_8_6" name="features-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_8_1">Community Blacklists</label><label for="features-__tabbed_8_2">IP Address</label><label for="features-__tabbed_8_3">Reverse DNS</label><label for="features-__tabbed_8_4">ASN</label><label for="features-__tabbed_8_5">User Agent</label><label for="features-__tabbed_8_6">URI</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>What this does:</strong> Enables you to quickly add well-maintained, community-sourced blacklists without having to manually configure URLs.</p>
<p>The <code>BLACKLIST_COMMUNITY_LISTS</code> setting allows you to select from curated blacklist sources. Available options include:</p>
<table>
<thead>
<tr>
<th>ID</th>
<th>Description</th>
<th>Source</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ip:laurent-minne-fr-be-agressive</code></td>
<td>Intelligence Blocklist (IPv4): Botnets, RaT, CVE's RCE, Scanners. DST = FR - BE</td>
<td><code>https://raw.githubusercontent.com/duggytuxy/Intelligence_IPv4_Blocklist/refs/heads/main/agressive_ips_dst_fr_be_blocklist.txt</code></td>
</tr>
<tr>
<td><code>ip:danmeuk-tor-exit</code></td>
<td>Tor Exit Nodes IPs (dan.me.uk)</td>
<td><code>https://www.dan.me.uk/torlist/?exit</code></td>
</tr>
<tr>
<td><code>ua:mitchellkrogza-bad-user-agents</code></td>
<td>Nginx Block Bad Bots, Spam Referrer Blocker, Vulnerability Scanners, User-Agents, Malware, Adware, Ransomware, Malicious Sites, with anti-DDOS, Wordpress Theme Detector Blocking and Fail2Ban Jail for Repeat Offenders</td>
<td><code>https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list</code></td>
</tr>
</tbody>
</table>
<p><strong>Configuration:</strong> Specify multiple lists separated by spaces. For example:
<div class="highlight"><pre><span></span><code><span class="nt">BLACKLIST_COMMUNITY_LISTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ip:danmeuk-tor-exit</span><span class="nv"> </span><span class="s">ua:mitchellkrogza-bad-user-agents&quot;</span>
</code></pre></div></p>
<div class="admonition tip">
<p class="admonition-title">Community vs Manual Configuration</p>
<p>Community blacklists provide a convenient way to get started with proven blacklist sources. You can use them alongside manual URL configurations for maximum flexibility.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Blocks visitors based on their IP address or network.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Blacklist:</strong> List of IP addresses or networks (CIDR notation) to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Ignore List:</strong> List of IP addresses or networks that should bypass IP blacklist checks.</td>
</tr>
<tr>
<td><code>BLACKLIST_IP_URLS</code></td>
<td><code>https://www.dan.me.uk/torlist/?exit</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Blacklist URLs:</strong> List of URLs containing IP addresses or networks to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_IP_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Ignore List URLs:</strong> List of URLs containing IP addresses or networks to ignore.</td>
</tr>
</tbody>
</table>
<p>The default <code>BLACKLIST_IP_URLS</code> setting includes a URL that provides a <strong>list of known Tor exit nodes</strong>. This is a common source of malicious traffic and is a good starting point for many sites.</p>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Blocks visitors based on their reverse domain name. This is useful for blocking known scanners and crawlers based on their organization domains.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_RDNS</code></td>
<td><code>.shodan.io .censys.io</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Blacklist:</strong> List of reverse DNS suffixes to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_RDNS_GLOBAL</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Global Only:</strong> Only perform rDNS checks on global IP addresses when set to <code>yes</code>.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_RDNS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Ignore List:</strong> List of reverse DNS suffixes that should bypass rDNS blacklist checks.</td>
</tr>
<tr>
<td><code>BLACKLIST_RDNS_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Blacklist URLs:</strong> List of URLs containing reverse DNS suffixes to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_RDNS_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Ignore List URLs:</strong> List of URLs containing reverse DNS suffixes to ignore.</td>
</tr>
</tbody>
</table>
<p>The default <code>BLACKLIST_RDNS</code> setting includes common scanner domains like <strong>Shodan</strong> and <strong>Censys</strong>. These are often used by security researchers and scanners to identify vulnerable sites.</p>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Blocks visitors from specific network providers. ASNs are like ZIP codes for the Internet—they identify which provider or organization an IP belongs to.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Blacklist:</strong> List of Autonomous System Numbers to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Ignore List:</strong> List of ASNs that should bypass ASN blacklist checks.</td>
</tr>
<tr>
<td><code>BLACKLIST_ASN_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Blacklist URLs:</strong> List of URLs containing ASNs to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_ASN_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Ignore List URLs:</strong> List of URLs containing ASNs to ignore.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Blocks visitors based on the browser or tool they claim to be using. This is effective against bots that honestly identify themselves (such as "ScannerBot" or "WebHarvestTool").</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Blacklist:</strong> List of User-Agent patterns (PCRE regex) to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Ignore List:</strong> List of User-Agent patterns that should bypass User-Agent blacklist checks.</td>
</tr>
<tr>
<td><code>BLACKLIST_USER_AGENT_URLS</code></td>
<td><code>https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Blacklist URLs:</strong> List of URLs containing User-Agent patterns to block.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_USER_AGENT_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Ignore List URLs:</strong> List of URLs containing User-Agent patterns to ignore.</td>
</tr>
</tbody>
</table>
<p>The default <code>BLACKLIST_USER_AGENT_URLS</code> setting includes a URL that provides a <strong>list of known bad user agents</strong>. These are often used by malicious bots and scanners to identify vulnerable sites.</p>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Blocks requests to specific URLs on your site. This is helpful for blocking attempts to access admin pages, login forms, or other sensitive areas that might be targeted.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>BLACKLIST_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Blacklist:</strong> List of URI patterns (PCRE regex) to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Ignore List:</strong> List of URI patterns that should bypass URI blacklist checks.</td>
</tr>
<tr>
<td><code>BLACKLIST_URI_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Blacklist URLs:</strong> List of URLs containing URI patterns to block, separated by spaces.</td>
</tr>
<tr>
<td><code>BLACKLIST_IGNORE_URI_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Ignore List URLs:</strong> List of URLs containing URI patterns to ignore.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="admonition info">
<p class="admonition-title">URL Format Support</p>
<p>All <code>*_URLS</code> settings support HTTP/HTTPS URLs as well as local file paths using the <code>file:///</code> prefix. Basic authentication is supported using the <code>http://user:pass@url</code> format.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Regular Updates</p>
<p>Blacklists from URLs are automatically downloaded and updated hourly to ensure your protection remains current against the latest threats.</p>
</div>
<h3 id="features-example-configurations_5">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="9:3"><input checked="checked" id="features-__tabbed_9_1" name="features-__tabbed_9" type="radio" /><input id="features-__tabbed_9_2" name="features-__tabbed_9" type="radio" /><input id="features-__tabbed_9_3" name="features-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_9_1">Basic IP and User-Agent Protection</label><label for="features-__tabbed_9_2">Advanced Protection with Custom Rules</label><label for="features-__tabbed_9_3">Using Local Files</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration that blocks known Tor exit nodes and common bad user agents using community blacklists:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BLACKLIST_COMMUNITY_LISTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ip:danmeuk-tor-exit</span><span class="nv"> </span><span class="s">ua:mitchellkrogza-bad-user-agents&quot;</span>
</code></pre></div>
<p>Alternatively, you can use manual URL configuration:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BLACKLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://www.dan.me.uk/torlist/?exit&quot;</span>
<span class="nt">BLACKLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A more comprehensive configuration with custom blacklist entries and exceptions:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Custom blacklist entries</span>
<span class="nt">BLACKLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.100</span><span class="nv"> </span><span class="s">203.0.113.0/24&quot;</span>
<span class="nt">BLACKLIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.shodan.io</span><span class="nv"> </span><span class="s">.censys.io</span><span class="nv"> </span><span class="s">.scanner.com&quot;</span>
<span class="nt">BLACKLIST_ASN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16509</span><span class="nv"> </span><span class="s">14618&quot;</span><span class="w">  </span><span class="c1"># AWS and Amazon ASNs</span>
<span class="nt">BLACKLIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)SemrushBot(?:\b)</span><span class="nv"> </span><span class="s">(?:\b)AhrefsBot(?:\b)&quot;</span>
<span class="nt">BLACKLIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/wp-login</span><span class="err">\</span><span class="s">.php$</span><span class="nv"> </span><span class="s">^/administrator/&quot;</span>

<span class="c1"># Custom ignore rules</span>
<span class="nt">BLACKLIST_IGNORE_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.200</span><span class="nv"> </span><span class="s">203.0.113.42&quot;</span>

<span class="c1"># External blacklist sources</span>
<span class="nt">BLACKLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://www.dan.me.uk/torlist/?exit</span><span class="nv"> </span><span class="s">https://www.spamhaus.org/drop/drop.txt&quot;</span>
<span class="nt">BLACKLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://raw.githubusercontent.com/mitchellkrogza/nginx-ultimate-bad-bot-blocker/master/_generator_lists/bad-user-agents.list&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using local files for blacklists:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BLACKLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BLACKLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/ip-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_RDNS_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/rdns-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_ASN_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/asn-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/user-agent-blacklist.txt&quot;</span>
<span class="nt">BLACKLIST_URI_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/uri-blacklist.txt&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-brotli">Brotli</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The Brotli plugin enables efficient compression of HTTP responses using the Brotli algorithm. This feature helps reduce bandwidth usage and improve page load times by compressing web content before it is sent to the client's browser.</p>
<p>Compared to other compression methods like gzip, Brotli typically achieves higher compression ratios, resulting in smaller file sizes and faster content delivery.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a client requests content from your website, BunkerWeb checks if the client supports Brotli compression.</li>
<li>If supported, BunkerWeb compresses the response using the Brotli algorithm at your configured compression level.</li>
<li>The compressed content is sent to the client with appropriate headers indicating Brotli compression.</li>
<li>The client's browser decompresses the content before rendering it to the user.</li>
<li>Both bandwidth usage and page load times are reduced, improving overall user experience.</li>
</ol>
<h3 id="features-how-to-use_5">How to Use</h3>
<p>Follow these steps to configure and use the Brotli compression feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The Brotli feature is disabled by default. Enable it by setting the <code>USE_BROTLI</code> setting to <code>yes</code>.</li>
<li><strong>Configure MIME types:</strong> Specify which content types should be compressed using the <code>BROTLI_TYPES</code> setting.</li>
<li><strong>Set minimum size:</strong> Define the minimum response size for compression with <code>BROTLI_MIN_LENGTH</code> to avoid compressing tiny files.</li>
<li><strong>Choose compression level:</strong> Select your preferred balance between speed and compression ratio with <code>BROTLI_COMP_LEVEL</code>.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, compression happens automatically for eligible responses.</li>
</ol>
<h3 id="features-configuration-settings_5">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BROTLI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Brotli:</strong> Set to <code>yes</code> to enable Brotli compression.</td>
</tr>
<tr>
<td><code>BROTLI_TYPES</code></td>
<td><code>application/atom+xml application/javascript application/json application/rss+xml application/vnd.ms-fontobject application/x-font-opentype application/x-font-truetype application/x-font-ttf application/x-javascript application/xhtml+xml application/xml font/eot font/opentype font/otf font/truetype image/svg+xml image/vnd.microsoft.icon image/x-icon image/x-win-bitmap text/css text/javascript text/plain text/xml</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>MIME Types:</strong> List of content types that will be compressed with Brotli.</td>
</tr>
<tr>
<td><code>BROTLI_MIN_LENGTH</code></td>
<td><code>1000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Minimum Size:</strong> The minimum response size (in bytes) for Brotli compression to be applied.</td>
</tr>
<tr>
<td><code>BROTLI_COMP_LEVEL</code></td>
<td><code>6</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Compression Level:</strong> Level of compression from 0 (no compression) to 11 (maximum compression). Higher values use more CPU.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimizing Compression Level</p>
<p>The default compression level (6) offers a good balance between compression ratio and CPU usage. For static content or when server CPU resources are plentiful, consider increasing to 9-11 for maximum compression. For dynamic content or when CPU resources are limited, you might want to use 4-5 for faster compression with reasonable size reduction.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Browser Support</p>
<p>Brotli is supported by all modern browsers including Chrome, Firefox, Edge, Safari, and Opera. Older browsers will automatically receive uncompressed content, ensuring compatibility.</p>
</div>
<h3 id="features-example-configurations_6">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="10:3"><input checked="checked" id="features-__tabbed_10_1" name="features-__tabbed_10" type="radio" /><input id="features-__tabbed_10_2" name="features-__tabbed_10" type="radio" /><input id="features-__tabbed_10_3" name="features-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_10_1">Basic Configuration</label><label for="features-__tabbed_10_2">Maximum Compression</label><label for="features-__tabbed_10_3">Balanced Performance</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A standard configuration that enables Brotli with default settings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BROTLI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BROTLI_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">application/xhtml+xml</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">BROTLI_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">BROTLI_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration optimized for maximum compression savings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BROTLI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BROTLI_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/atom+xml</span><span class="nv"> </span><span class="s">application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/rss+xml</span><span class="nv"> </span><span class="s">application/vnd.ms-fontobject</span><span class="nv"> </span><span class="s">application/x-font-opentype</span><span class="nv"> </span><span class="s">application/x-font-truetype</span><span class="nv"> </span><span class="s">application/x-font-ttf</span><span class="nv"> </span><span class="s">application/x-javascript</span><span class="nv"> </span><span class="s">application/xhtml+xml</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">font/eot</span><span class="nv"> </span><span class="s">font/opentype</span><span class="nv"> </span><span class="s">font/otf</span><span class="nv"> </span><span class="s">font/truetype</span><span class="nv"> </span><span class="s">image/svg+xml</span><span class="nv"> </span><span class="s">image/vnd.microsoft.icon</span><span class="nv"> </span><span class="s">image/x-icon</span><span class="nv"> </span><span class="s">image/x-win-bitmap</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">BROTLI_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">BROTLI_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;11&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration that balances compression ratio with CPU usage:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BROTLI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BROTLI_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain&quot;</span>
<span class="nt">BROTLI_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">BROTLI_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-bunkernet">BunkerNet</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The BunkerNet plugin enables collective threat intelligence sharing between BunkerWeb instances, creating a powerful network of protection against malicious actors. By participating in BunkerNet, your instance both benefits from and contributes to a global database of known threats, enhancing security for the entire BunkerWeb community.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>Your BunkerWeb instance automatically registers with the BunkerNet API to receive a unique identifier.</li>
<li>When your instance detects and blocks a malicious IP address or behavior, it anonymously reports the threat to BunkerNet.</li>
<li>BunkerNet aggregates threat intelligence from all participating instances and distributes the consolidated database.</li>
<li>Your instance regularly downloads an updated database of known threats from BunkerNet.</li>
<li>This collective intelligence allows your instance to proactively block IP addresses that have exhibited malicious behavior on other BunkerWeb instances.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Key benefits</p>
<ol>
<li><strong>Collective Defense:</strong> Leverage the security findings from thousands of other BunkerWeb instances globally.</li>
<li><strong>Proactive Protection:</strong> Block malicious actors before they can target your site based on their behavior elsewhere.</li>
<li><strong>Community Contribution:</strong> Help protect other BunkerWeb users by sharing anonymized threat data about attackers.</li>
<li><strong>Zero Configuration:</strong> Works out of the box with sensible defaults, requiring minimal setup.</li>
<li><strong>Privacy Focused:</strong> Only shares necessary threat information without compromising your or your users' privacy.</li>
</ol>
</div>
<h3 id="features-how-to-use_6">How to Use</h3>
<p>Follow these steps to configure and use the BunkerNet feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The BunkerNet feature is enabled by default. If needed, you can control this with the <code>USE_BUNKERNET</code> setting.</li>
<li><strong>Initial registration:</strong> Upon first startup, your instance will automatically register with the BunkerNet API and receive a unique identifier.</li>
<li><strong>Automatic updates:</strong> Your instance will automatically download the latest threat database on a regular schedule.</li>
<li><strong>Automatic reporting:</strong> When your instance blocks a malicious IP address, it will automatically contribute this data to the community.</li>
<li><strong>Monitor protection:</strong> Check the <a href="#web-ui">web UI</a> to see statistics on threats blocked by BunkerNet intelligence.</li>
</ol>
<h3 id="features-configuration-settings_6">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BUNKERNET</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable BunkerNet:</strong> Set to <code>yes</code> to enable the BunkerNet threat intelligence sharing.</td>
</tr>
<tr>
<td><code>BUNKERNET_SERVER</code></td>
<td><code>https://api.bunkerweb.io</code></td>
<td>global</td>
<td>no</td>
<td><strong>BunkerNet Server:</strong> The address of the BunkerNet API server for sharing threat intelligence.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Network Protection</p>
<p>When BunkerNet detects that an IP address has been involved in malicious activity across multiple BunkerWeb instances, it adds that IP to a collective blacklist. This provides a proactive defense layer, protecting your site from threats before they can target you directly.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Anonymous Reporting</p>
<p>When reporting threat information to BunkerNet, your instance only shares the necessary data to identify the threat: the IP address, the reason for blocking, and minimal contextual data. No personal information about your users or sensitive details about your site is shared.</p>
</div>
<h3 id="features-example-configurations_7">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="11:3"><input checked="checked" id="features-__tabbed_11_1" name="features-__tabbed_11" type="radio" /><input id="features-__tabbed_11_2" name="features-__tabbed_11" type="radio" /><input id="features-__tabbed_11_3" name="features-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_11_1">Default Configuration (Recommended)</label><label for="features-__tabbed_11_2">Disabled Configuration</label><label for="features-__tabbed_11_3">Custom Server Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The default configuration enables BunkerNet with the official BunkerWeb API server:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BUNKERNET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BUNKERNET_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://api.bunkerweb.io&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>If you prefer not to participate in the BunkerNet threat intelligence network:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BUNKERNET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>For organizations running their own BunkerNet server (uncommon):</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_BUNKERNET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">BUNKERNET_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://bunkernet.example.com&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="features-crowdsec-console-integration">CrowdSec Console integration</h3>
<p>If you aren’t already familiar with CrowdSec Console integration, <a href="https://www.crowdsec.net/?utm_campaign=bunkerweb&amp;utm_source=doc">CrowdSec</a> leverages crowdsourced intelligence to combat cyber threats. Think of it as the "Waze of cybersecurity"—when one server is attacked, other systems worldwide are alerted and protected from the same attackers. You can learn more about it <a href="https://www.crowdsec.net/about?utm_campaign=bunkerweb&amp;utm_source=blog">here</a>.</p>
<p>Through our partnership with CrowdSec, you can enroll your BunkerWeb instances into your <a href="https://app.crowdsec.net/signup?utm_source=external-blog&amp;utm_medium=cta&amp;utm_campaign=bunker-web-integration">CrowdSec Console</a>. This means that attacks blocked by BunkerWeb will be visible in your CrowdSec Console alongside attacks blocked by CrowdSec Security Engines, giving you a unified view of threats.</p>
<p>Importantly, CrowdSec does not need to be installed for this integration (though we highly recommend trying it out with the <a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/crowdsec">CrowdSec plugin for BunkerWeb</a> to further enhance the security of your web services). Additionally, you can enroll your CrowdSec Security Engines into the same Console account for even greater synergy.</p>
<p><strong>Step #1: Create your CrowdSec Console account</strong></p>
<p>Go to the <a href="https://app.crowdsec.net/signup?utm_source=external-blog&amp;utm_medium=cta&amp;utm_campaign=bunker-web-integration">CrowdSec Console</a> and register if you don’t already have an account. Once done, note the enroll key found under "Security Engines" after clicking on "Add Security Engine":</p>
<figure>
<p><img align="center" alt="Overview" src="../assets/img/crowdity1.png" />
  </p>
<figcaption>Get your Crowdsec Console enroll key</figcaption>
</figure>
<p><strong>Step #2: Get your BunkerNet ID</strong></p>
<p>Activating the BunkerNet feature (enabled by default) is mandatory if you want to enroll your BunkerWeb instance(s) in your CrowdSec Console. Enable it by setting <code>USE_BUNKERNET</code> to <code>yes</code>.</p>
<p>For Docker, get your BunkerNet ID using:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>my-bw-scheduler<span class="w"> </span>cat<span class="w"> </span>/var/cache/bunkerweb/bunkernet/instance.id
</code></pre></div>
<p>For Linux, use:</p>
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/var/cache/bunkerweb/bunkernet/instance.id
</code></pre></div>
<p><strong>Step #3: Enroll your instance using the Panel</strong></p>
<p>Once you have your BunkerNet ID and CrowdSec Console enroll key, <a href="https://panel.bunkerweb.io/store/bunkernet?utm_campaign=self&amp;utm_source=doc">order the free product "BunkerNet / CrowdSec" on the Panel</a>. You may be prompted to create an account if you haven’t already.</p>
<p>You can now select the "BunkerNet / CrowdSec" service and fill out the form by pasting your BunkerNet ID and CrowdSec Console enroll key:</p>
<figure>
<p><img align="center" alt="Overview" src="../assets/img/crowdity2.png" />
  </p>
<figcaption>Enroll your BunkerWeb instance into the CrowdSec Console</figcaption>
</figure>
<p><strong>Step #4: Accept the new security engine on the Console</strong></p>
<p>Then, go back to your CrowdSec Console and accept the new Security Engine:</p>
<figure>
<p><img align="center" alt="Overview" src="../assets/img/crowdity3.png" />
  </p>
<figcaption>Accept enroll into the CrowdSec Console</figcaption>
</figure>
<p><strong>Congratulations, your BunkerWeb instance is now enrolled in your CrowdSec Console!</strong></p>
<p>Pro tip: When viewing your alerts, click the "columns" option and check the "context" checkbox to access BunkerWeb-specific data.</p>
<figure>
<p><img align="center" alt="Overview" src="../assets/img/crowdity4.png" />
  </p>
<figcaption>BunkerWeb data shown in the context column</figcaption>
</figure>
<h2 id="features-cors">CORS</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The CORS plugin enables Cross-Origin Resource Sharing for your website, allowing controlled access to your resources from different domains. This feature helps you safely share your content with trusted third-party websites while maintaining security by explicitly defining which origins, methods, and headers are permitted.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a browser makes a cross-origin request to your website, it first sends a preflight request with the <code>OPTIONS</code> method.</li>
<li>BunkerWeb checks if the requesting origin is permitted based on your configuration.</li>
<li>If allowed, BunkerWeb responds with the appropriate CORS headers that define what the requesting site can do.</li>
<li>For non-permitted origins, the request can be either completely denied or served without CORS headers.</li>
<li>Additional cross-origin policies, such as <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Embedder-Policy">COEP</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Opener-Policy">COOP</a>, and <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Headers/Cross-Origin-Resource-Policy">CORP</a>, can be configured to further enhance security.</li>
</ol>
<h3 id="features-how-to-use_7">How to Use</h3>
<p>Follow these steps to configure and use the CORS feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The CORS feature is disabled by default. Set the <code>USE_CORS</code> setting to <code>yes</code> to enable it.</li>
<li><strong>Configure allowed origins:</strong> Specify which domains can access your resources using the <code>CORS_ALLOW_ORIGIN</code> setting.</li>
<li><strong>Set permitted methods:</strong> Define which HTTP methods are allowed for cross-origin requests with <code>CORS_ALLOW_METHODS</code>.</li>
<li><strong>Configure allowed headers:</strong> Specify which headers can be used in requests with <code>CORS_ALLOW_HEADERS</code>.</li>
<li><strong>Control credentials:</strong> Decide whether cross-origin requests can include credentials using <code>CORS_ALLOW_CREDENTIALS</code>.</li>
</ol>
<h3 id="features-configuration-settings_7">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CORS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable CORS:</strong> Set to <code>yes</code> to enable Cross-Origin Resource Sharing.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_ORIGIN</code></td>
<td><code>self</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Allowed Origins:</strong> PCRE regular expression representing allowed origins; use <code>*</code> for any origin, or <code>self</code> for same-origin only.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_METHODS</code></td>
<td><code>GET, POST, OPTIONS</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Allowed Methods:</strong> HTTP methods that can be used in cross-origin requests.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_HEADERS</code></td>
<td><code>DNT,User-Agent,X-Requested-With,If-Modified-Since,Cache-Control,Content-Type,Range</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Allowed Headers:</strong> HTTP headers that can be used in cross-origin requests.</td>
</tr>
<tr>
<td><code>CORS_ALLOW_CREDENTIALS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Allow Credentials:</strong> Set to <code>yes</code> to allow credentials (cookies, HTTP authentication) in CORS requests.</td>
</tr>
<tr>
<td><code>CORS_EXPOSE_HEADERS</code></td>
<td><code>Content-Length,Content-Range</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Exposed Headers:</strong> HTTP headers that browsers are permitted to access from cross-origin responses.</td>
</tr>
<tr>
<td><code>CROSS_ORIGIN_OPENER_POLICY</code></td>
<td><code>same-origin</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cross-Origin-Opener-Policy:</strong> Controls communication between browsing contexts.</td>
</tr>
<tr>
<td><code>CROSS_ORIGIN_EMBEDDER_POLICY</code></td>
<td><code>require-corp</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cross-Origin-Embedder-Policy:</strong> Controls whether a document can load resources from other origins.</td>
</tr>
<tr>
<td><code>CROSS_ORIGIN_RESOURCE_POLICY</code></td>
<td><code>same-site</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cross-Origin-Resource-Policy:</strong> Controls which websites can embed your resources.</td>
</tr>
<tr>
<td><code>CORS_MAX_AGE</code></td>
<td><code>86400</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Preflight Cache Duration:</strong> How long (in seconds) browsers should cache the preflight response.</td>
</tr>
<tr>
<td><code>CORS_DENY_REQUEST</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Deny Unauthorized Origins:</strong> When <code>yes</code>, requests from unauthorized origins are denied with an error code.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimizing Preflight Requests</p>
<p>The <code>CORS_MAX_AGE</code> setting determines how long browsers will cache the results of a preflight request. Setting this to a higher value (like the default 86400 seconds/24 hours) reduces the number of preflight requests, improving performance for frequently accessed resources.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<p>Be cautious when setting <code>CORS_ALLOW_ORIGIN</code> to <code>*</code> (all origins) or <code>CORS_ALLOW_CREDENTIALS</code> to <code>yes</code> because these configurations may introduce security risks if not properly managed. It's generally safer to explicitly list trusted origins and limit the allowed methods and headers.</p>
</div>
<h3 id="features-example-configurations_8">Example Configurations</h3>
<p>Here are examples of possible values for the <code>CORS_ALLOW_ORIGIN</code> setting, along with their behavior:</p>
<ul>
<li><strong><code>*</code></strong>: Allows requests from all origins.</li>
<li><strong><code>self</code></strong>: Automatically allows requests from the same origin as the configured server_name.</li>
<li><strong><code>^https://www\.example\.com$</code></strong>: Allows requests only from <code>https://www.example.com</code>.</li>
<li><strong><code>^https://.+\.example\.com$</code></strong>: Allows requests from any subdomain ending with <code>.example.com</code>.</li>
<li><strong><code>^https://(www\.example1\.com|www\.example2\.com)$</code></strong>: Allows requests from either <code>https://www.example1.com</code> or <code>https://www.example2.com</code>.</li>
<li><strong><code>^https?://www\.example\.com$</code></strong>: Allows requests from both <code>https://www.example.com</code> and <code>http://www.example.com</code>.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="12:5"><input checked="checked" id="features-__tabbed_12_1" name="features-__tabbed_12" type="radio" /><input id="features-__tabbed_12_2" name="features-__tabbed_12" type="radio" /><input id="features-__tabbed_12_3" name="features-__tabbed_12" type="radio" /><input id="features-__tabbed_12_4" name="features-__tabbed_12" type="radio" /><input id="features-__tabbed_12_5" name="features-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_12_1">Basic Configuration</label><label for="features-__tabbed_12_2">Public API Configuration</label><label for="features-__tabbed_12_3">Multiple Trusted Domains</label><label for="features-__tabbed_12_4">Subdomain Wildcard</label><label for="features-__tabbed_12_5">Multiple Domain Patterns</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration allowing cross-origin requests from the same domain:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;self&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for a public API that needs to be accessible from any origin:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">X-API-Key&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for allowing multiple specific domains with a single PCRE regular expression pattern:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^https://(app|api|dashboard)\\.example\\.com$&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">PUT,</span><span class="nv"> </span><span class="s">DELETE,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization,</span><span class="nv"> </span><span class="s">X-Requested-With&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_EXPOSE_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Length,</span><span class="nv"> </span><span class="s">Content-Range,</span><span class="nv"> </span><span class="s">X-RateLimit-Remaining&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration allowing all subdomains of a primary domain using a PCRE regular expression pattern:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^https://.*\\.example\\.com$&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration allowing requests from multiple domain patterns with alternation:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CORS_ALLOW_ORIGIN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^https://(.*\\.example\\.com|.*\\.trusted-partner\\.org|api\\.third-party\\.net)$&quot;</span>
<span class="nt">CORS_ALLOW_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET,</span><span class="nv"> </span><span class="s">POST,</span><span class="nv"> </span><span class="s">PUT,</span><span class="nv"> </span><span class="s">OPTIONS&quot;</span>
<span class="nt">CORS_ALLOW_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Content-Type,</span><span class="nv"> </span><span class="s">Authorization,</span><span class="nv"> </span><span class="s">X-Custom-Header&quot;</span>
<span class="nt">CORS_ALLOW_CREDENTIALS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">CORS_MAX_AGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">CORS_DENY_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-client-cache">Client cache</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The Client Cache plugin optimizes website performance by controlling how browsers cache static content. It reduces bandwidth usage, lowers server load, and improves page load times by instructing browsers to store and reuse static assets—such as images, CSS, and JavaScript files—locally instead of requesting them on every page visit.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When enabled, BunkerWeb adds Cache-Control headers to responses for static files.</li>
<li>These headers tell browsers how long they should cache the content locally.</li>
<li>For files with specified extensions (like images, CSS, JavaScript), BunkerWeb applies the configured caching policy.</li>
<li>Optional ETag support provides an additional validation mechanism to determine whether cached content is still fresh.</li>
<li>When visitors return to your site, their browsers can use locally cached files instead of downloading them again, resulting in faster page load times.</li>
</ol>
<h3 id="features-how-to-use_8">How to Use</h3>
<p>Follow these steps to configure and use the Client Cache feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The Client Cache feature is disabled by default; set the <code>USE_CLIENT_CACHE</code> setting to <code>yes</code> to enable it.</li>
<li><strong>Configure file extensions:</strong> Specify which file types should be cached using the <code>CLIENT_CACHE_EXTENSIONS</code> setting.</li>
<li><strong>Set cache control directives:</strong> Customize how clients should cache content using the <code>CLIENT_CACHE_CONTROL</code> setting.</li>
<li><strong>Configure ETag support:</strong> Decide whether to enable ETags for validating cache freshness with the <code>CLIENT_CACHE_ETAG</code> setting.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, caching headers are applied automatically to eligible responses.</li>
</ol>
<h3 id="features-configuration-settings_8">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CLIENT_CACHE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Client Cache:</strong> Set to <code>yes</code> to enable client-side caching of static files.</td>
</tr>
<tr>
<td><code>CLIENT_CACHE_EXTENSIONS</code></td>
<td><code>jpg                       | jpeg      | png      | bmp                                                                                            | ico | svg | tif | css | js | otf | ttf | eot | woff | woff2</code></td>
<td>global</td>
<td>no</td>
<td><strong>Cacheable Extensions:</strong> List of file extensions (separated by pipes) that should be cached by the client.</td>
</tr>
<tr>
<td><code>CLIENT_CACHE_CONTROL</code></td>
<td><code>public, max-age=15552000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache-Control Header:</strong> Value for the Cache-Control HTTP header to control caching behavior.</td>
</tr>
<tr>
<td><code>CLIENT_CACHE_ETAG</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable ETags:</strong> Set to <code>yes</code> to send the HTTP ETag header for static resources.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimizing Cache Settings</p>
<p>For frequently updated content, consider using shorter max-age values. For content that rarely changes (like versioned JavaScript libraries or logos), use longer cache times. The default value of 15552000 seconds (180 days) is appropriate for most static assets.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Browser Behavior</p>
<p>Different browsers implement caching slightly differently, but all modern browsers honor standard Cache-Control directives. ETags provide an additional validation mechanism that helps browsers determine if cached content is still valid.</p>
</div>
<h3 id="features-example-configurations_9">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="13:3"><input checked="checked" id="features-__tabbed_13_1" name="features-__tabbed_13" type="radio" /><input id="features-__tabbed_13_2" name="features-__tabbed_13" type="radio" /><input id="features-__tabbed_13_3" name="features-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_13_1">Basic Configuration</label><label for="features-__tabbed_13_2">Aggressive Caching</label><label for="features-__tabbed_13_3">Mixed Content Strategy</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration that enables caching for common static assets:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CLIENT_CACHE_EXTENSIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jpg|jpeg|png|gif|css|js|svg|woff|woff2&quot;</span>
<span class="nt">CLIENT_CACHE_CONTROL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;public,</span><span class="nv"> </span><span class="s">max-age=86400&quot;</span><span class="w">  </span><span class="c1"># 1 day</span>
<span class="nt">CLIENT_CACHE_ETAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration optimized for maximum caching, suitable for sites with infrequently updated static content:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CLIENT_CACHE_EXTENSIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jpg|jpeg|png|bmp|ico|svg|tif|gif|css|js|otf|ttf|eot|woff|woff2|pdf|xml|txt&quot;</span>
<span class="nt">CLIENT_CACHE_CONTROL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;public,</span><span class="nv"> </span><span class="s">max-age=31536000,</span><span class="nv"> </span><span class="s">immutable&quot;</span><span class="w">  </span><span class="c1"># 1 year</span>
<span class="nt">CLIENT_CACHE_ETAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>For sites with a mix of frequently and infrequently updated content, consider using file versioning in your application and a configuration like this:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CLIENT_CACHE_EXTENSIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;jpg|jpeg|png|bmp|ico|svg|tif|gif|css|js|otf|ttf|eot|woff|woff2&quot;</span>
<span class="nt">CLIENT_CACHE_CONTROL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;public,</span><span class="nv"> </span><span class="s">max-age=604800&quot;</span><span class="w">  </span><span class="c1"># 1 week</span>
<span class="nt">CLIENT_CACHE_ETAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-country">Country</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Country plugin enables geo-blocking functionality for your website, allowing you to restrict access based on the geographic location of your visitors. This feature helps you comply with regional regulations, prevent fraudulent activities often associated with high-risk regions, and implement content restrictions based on geographic boundaries.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a visitor accesses your website, BunkerWeb determines their country based on their IP address.</li>
<li>Your configuration specifies either a whitelist (allowed countries) or a blacklist (blocked countries).</li>
<li>If you've set up a whitelist, only visitors from countries on that list will be granted access.</li>
<li>If you've set up a blacklist, visitors from countries on that list will be denied access.</li>
<li>The result is cached to improve performance for repeat visitors from the same IP address.</li>
</ol>
<h3 id="features-how-to-use_9">How to Use</h3>
<p>Follow these steps to configure and use the Country feature:</p>
<ol>
<li><strong>Define your strategy:</strong> Decide whether you want to use a whitelist approach (allow only specific countries) or a blacklist approach (block specific countries).</li>
<li><strong>Configure country codes:</strong> Add the ISO 3166-1 alpha-2 country codes (two-letter codes like US, GB, FR) to either the <code>WHITELIST_COUNTRY</code> or <code>BLACKLIST_COUNTRY</code> setting.</li>
<li><strong>Apply settings:</strong> Once configured, the country-based restrictions will apply to all visitors to your site.</li>
<li><strong>Monitor effectiveness:</strong> Check the <a href="#web-ui">web UI</a> to see statistics on blocked requests by country.</li>
</ol>
<h3 id="features-configuration-settings_9">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WHITELIST_COUNTRY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Country Whitelist:</strong> List of country codes (ISO 3166-1 alpha-2 format) separated by spaces. Only these countries are allowed.</td>
</tr>
<tr>
<td><code>BLACKLIST_COUNTRY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Country Blacklist:</strong> List of country codes (ISO 3166-1 alpha-2 format) separated by spaces. These countries are blocked.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Whitelist vs. Blacklist</p>
<p>Choose the approach that best fits your needs:</p>
<ul>
<li>Use the whitelist when you want to restrict access to a small number of countries.</li>
<li>Use the blacklist when you want to block access from specific problematic regions while allowing everyone else.</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Precedence Rule</p>
<p>If both whitelist and blacklist are configured, the whitelist takes precedence. This means the system first checks if a country is whitelisted; if not, access is denied regardless of the blacklist configuration.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Country Detection</p>
<p>BunkerWeb uses the <a href="https://db-ip.com/db/download/ip-to-country-lite">lite db-ip mmdb database</a> to determine the country of origin based on IP addresses.</p>
</div>
<h3 id="features-example-configurations_10">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="14:4"><input checked="checked" id="features-__tabbed_14_1" name="features-__tabbed_14" type="radio" /><input id="features-__tabbed_14_2" name="features-__tabbed_14" type="radio" /><input id="features-__tabbed_14_3" name="features-__tabbed_14" type="radio" /><input id="features-__tabbed_14_4" name="features-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_14_1">Whitelist Only</label><label for="features-__tabbed_14_2">Blacklist Only</label><label for="features-__tabbed_14_3">EU Access Only</label><label for="features-__tabbed_14_4">High-Risk Countries Blocked</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Allow access only from the United States, Canada, and the United Kingdom:</p>
<div class="highlight"><pre><span></span><code><span class="nt">WHITELIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;US</span><span class="nv"> </span><span class="s">CA</span><span class="nv"> </span><span class="s">GB&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Block access from specific countries while allowing all others:</p>
<div class="highlight"><pre><span></span><code><span class="nt">BLACKLIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RU</span><span class="nv"> </span><span class="s">CN</span><span class="nv"> </span><span class="s">KP&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Allow access only from European Union member states:</p>
<div class="highlight"><pre><span></span><code><span class="nt">WHITELIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;AT</span><span class="nv"> </span><span class="s">BE</span><span class="nv"> </span><span class="s">BG</span><span class="nv"> </span><span class="s">HR</span><span class="nv"> </span><span class="s">CY</span><span class="nv"> </span><span class="s">CZ</span><span class="nv"> </span><span class="s">DK</span><span class="nv"> </span><span class="s">EE</span><span class="nv"> </span><span class="s">FI</span><span class="nv"> </span><span class="s">FR</span><span class="nv"> </span><span class="s">DE</span><span class="nv"> </span><span class="s">GR</span><span class="nv"> </span><span class="s">HU</span><span class="nv"> </span><span class="s">IE</span><span class="nv"> </span><span class="s">IT</span><span class="nv"> </span><span class="s">LV</span><span class="nv"> </span><span class="s">LT</span><span class="nv"> </span><span class="s">LU</span><span class="nv"> </span><span class="s">MT</span><span class="nv"> </span><span class="s">NL</span><span class="nv"> </span><span class="s">PL</span><span class="nv"> </span><span class="s">PT</span><span class="nv"> </span><span class="s">RO</span><span class="nv"> </span><span class="s">SK</span><span class="nv"> </span><span class="s">SI</span><span class="nv"> </span><span class="s">ES</span><span class="nv"> </span><span class="s">SE&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Block access from countries often associated with certain cyber threats:</p>
<div class="highlight"><pre><span></span><code><span class="nt">BLACKLIST_COUNTRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;RU</span><span class="nv"> </span><span class="s">CN</span><span class="nv"> </span><span class="s">KP</span><span class="nv"> </span><span class="s">IR</span><span class="nv"> </span><span class="s">SY&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-crowdsec">CrowdSec</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/crowdsec.svg" width="600" /></p>
</figure>
<p>The CrowdSec plugin integrates BunkerWeb with the CrowdSec security engine, providing an additional layer of protection against various cyber threats. This plugin acts as a <a href="https://crowdsec.net/?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">CrowdSec</a> bouncer, denying requests based on decisions from the CrowdSec API.</p>
<p>CrowdSec is a modern, open-source security engine that detects and blocks malicious IP addresses based on behavioral analysis and collective intelligence from its community. You can also configure <a href="https://docs.crowdsec.net/docs/concepts?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs#scenarios">scenarios</a> to automatically ban IP addresses based on suspicious behavior, benefiting from a crowdsourced blacklist.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>The CrowdSec engine analyzes logs and detects suspicious activities on your infrastructure.</li>
<li>When malicious activity is detected, CrowdSec creates a decision to block the offending IP address.</li>
<li>BunkerWeb, acting as a bouncer, queries the CrowdSec Local API for decisions about incoming requests.</li>
<li>If a client's IP address has an active block decision, BunkerWeb denies access to the protected services.</li>
<li>Optionally, the Application Security Component can perform deep request inspection for enhanced security.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Key benefits</p>
<ol>
<li><strong>Community-Powered Security:</strong> Benefit from threat intelligence shared across the CrowdSec user community.</li>
<li><strong>Behavioral Analysis:</strong> Detect sophisticated attacks based on behavior patterns, not just signatures.</li>
<li><strong>Lightweight Integration:</strong> Minimal performance impact on your BunkerWeb instance.</li>
<li><strong>Multi-Level Protection:</strong> Combine perimeter defense (IP blocking) with application security for in-depth protection.</li>
</ol>
</div>
<h3 id="features-setup">Setup</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="15:3"><input checked="checked" id="features-__tabbed_15_1" name="features-__tabbed_15" type="radio" /><input id="features-__tabbed_15_2" name="features-__tabbed_15" type="radio" /><input id="features-__tabbed_15_3" name="features-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_15_1">Docker</label><label for="features-__tabbed_15_2">Linux</label><label for="features-__tabbed_15_3">All-in-one</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Acquisition file</strong></p>
<p>You will need to run a CrowdSec instance and configure it to parse BunkerWeb logs. Since BunkerWeb is based on NGINX, you can use the <code>nginx</code> value for the <code>type</code> parameter in your acquisition file (assuming that BunkerWeb logs are stored as is without additional data):</p>
<div class="highlight"><pre><span></span><code><span class="nt">filenames</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bunkerweb.log</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</code></pre></div>
<p><strong>Application Security Component (<em>optional</em>)</strong></p>
<p>CrowdSec also provides an <a href="https://docs.crowdsec.net/docs/appsec/intro?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs">Application Security Component</a> that can be used to protect your application from attacks. If you want to use it, you must create another acquisition file for the AppSec Component:</p>
<div class="highlight"><pre><span></span><code><span class="nt">appsec_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crowdsecurity/appsec-default</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appsec</span>
<span class="nt">listen_addr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">0.0.0.0:7422</span>
<span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appsec</span>
</code></pre></div>
<p><strong>Syslog</strong></p>
<p>For container-based integrations, we recommend redirecting the logs of the BunkerWeb container to a syslog service so CrowdSec can access them easily. Here is an example configuration for syslog-ng that will store raw logs coming from BunkerWeb to a local <code>/var/log/bunkerweb.log</code> file:</p>
<div class="highlight"><pre><span></span><code>@version: 4.8

source s_net {
    udp(
        ip(&quot;0.0.0.0&quot;)
    );
};

template t_imp {
    template(&quot;$MSG\n&quot;);
    template_escape(no);
};

destination d_file {
    file(&quot;/var/log/bunkerweb.log&quot; template(t_imp));
};

log {
    source(s_net);
    destination(d_file);
};
</code></pre></div>
<p><strong>Docker Compose</strong></p>
<p>Here is the docker-compose boilerplate that you can use (don’t forget to update the bouncer key):</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for both services</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Make sure to set the correct IP range so the scheduler can send the configuration to the instance</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="c1"># This is the name that will be used to identify the instance in the Scheduler</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># For QUIC / HTTP3 support</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span><span class="w"> </span><span class="c1"># We use the anchor to avoid repeating the same settings for all services</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span><span class="w"> </span><span class="c1"># Send logs to syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># The IP address of the syslog service</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Make sure to set the correct instance name</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_CROWDSEC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">CROWDSEC_API</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:8080&quot;</span><span class="w"> </span><span class="c1"># This is the address of the CrowdSec container API in the same network</span>
<span class="w">      </span><span class="nt">CROWDSEC_APPSEC_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:7422&quot;</span><span class="w"> </span><span class="c1"># Comment if you don&#39;t want to use the AppSec Component</span>
<span class="w">      </span><span class="nt">CROWDSEC_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s3cr3tb0unc3rk3y&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger key for the bouncer</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">crowdsec</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crowdsecurity/crowdsec:v1.6.6</span><span class="w"> </span><span class="c1"># Use the latest version but always pin the version for a better stability/security</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cs-data:/var/lib/crowdsec/data</span><span class="w"> </span><span class="c1"># To persist the CrowdSec data</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log:ro</span><span class="w"> </span><span class="c1"># The logs of BunkerWeb for CrowdSec to parse</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./acquis.yaml:/etc/crowdsec/acquis.yaml</span><span class="w"> </span><span class="c1"># The acquisition file for BunkerWeb logs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./appsec.yaml:/etc/crowdsec/acquis.d/appsec.yaml</span><span class="w"> </span><span class="c1"># Comment if you don&#39;t want to use the AppSec Component</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">BOUNCER_KEY_bunkerweb</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;s3cr3tb0unc3rk3y&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger key for the bouncer</span>
<span class="w">      </span><span class="nt">COLLECTIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;crowdsecurity/nginx</span><span class="nv"> </span><span class="s">crowdsecurity/appsec-virtual-patching</span><span class="nv"> </span><span class="s">crowdsecurity/appsec-generic-rules&quot;</span>
<span class="w">      </span><span class="c1">#   COLLECTIONS: &quot;crowdsecurity/nginx&quot; # If you don&#39;t want to use the AppSec Component use this line instead</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">syslog</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balabit/syslog-ng:4.8.0</span>
<span class="w">    </span><span class="c1"># image: lscr.io/linuxserver/syslog-ng:4.8.1-r1-ls147 # For aarch64 architecture</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span><span class="w">  </span><span class="c1"># Bind to low ports</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BROADCAST</span><span class="w">  </span><span class="c1"># Send broadcasts</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_RAW</span><span class="w">  </span><span class="c1"># Use raw sockets</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_READ_SEARCH</span><span class="w">  </span><span class="c1"># Read files bypassing permissions</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_OVERRIDE</span><span class="w">  </span><span class="c1"># Override file permissions</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CHOWN</span><span class="w">  </span><span class="c1"># Change ownership</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SYSLOG</span><span class="w">  </span><span class="c1"># Write to system logs</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span><span class="w"> </span><span class="c1"># This is the volume used to store the logs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./syslog-ng.conf:/etc/syslog-ng/syslog-ng.conf</span><span class="w"> </span><span class="c1"># This is the syslog-ng configuration file</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">          </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.254</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-logs</span><span class="p">:</span>
<span class="w">  </span><span class="nt">cs-data</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span><span class="w"> </span><span class="c1"># Make sure to set the correct IP range so the scheduler can send the configuration to the instance</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>You need to install CrowdSec and configure it to parse BunkerWeb logs. Follow the <a href="https://doc.crowdsec.net/docs/getting_started/install_crowdsec?utm_source=external-docs&amp;utm_medium=cta&amp;utm_campaign=bunker-web-docs#scenarios">official documentation</a>.</p>
<p>To enable CrowdSec to parse BunkerWeb logs, add the following lines to your acquisition file located at <code>/etc/crowdsec/acquis.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">filenames</span><span class="p">:</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bunkerweb/access.log</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bunkerweb/error.log</span>
<span class="w">  </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/log/bunkerweb/modsec_audit.log</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginx</span>
</code></pre></div>
<p>Now, add your custom bouncer to the CrowdSec API using the <code>cscli</code> tool:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>cscli<span class="w"> </span>bouncers<span class="w"> </span>add<span class="w"> </span>crowdsec-bunkerweb-bouncer/v1.6
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">API key</p>
<p>Keep the key generated by the <code>cscli</code> command; you will need it later.</p>
</div>
<p>Then restart the CrowdSec service:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>crowdsec
</code></pre></div>
<p><strong>Application Security Component (<em>optional</em>)</strong></p>
<p>If you want to use the AppSec Component, you must create another acquisition file for it located at <code>/etc/crowdsec/acquis.d/appsec.yaml</code>:</p>
<div class="highlight"><pre><span></span><code><span class="nt">appsec_config</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">crowdsecurity/appsec-default</span>
<span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appsec</span>
<span class="nt">listen_addr</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">127.0.0.1:7422</span>
<span class="nt">source</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">appsec</span>
</code></pre></div>
<p>You will also need to install the AppSec Component's collections:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>cscli<span class="w"> </span>collections<span class="w"> </span>install<span class="w"> </span>crowdsecurity/appsec-virtual-patching
sudo<span class="w"> </span>cscli<span class="w"> </span>collections<span class="w"> </span>install<span class="w"> </span>crowdsecurity/appsec-generic-rules
</code></pre></div>
<p>Finally, restart the CrowdSec service:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>crowdsec
</code></pre></div>
<p><strong>Settings</strong></p>
<p>Configure the plugin by adding the following settings to your BunkerWeb configuration file:</p>
<div class="highlight"><pre><span></span><code>USE_CROWDSEC=yes
CROWDSEC_API=http://127.0.0.1:8080
CROWDSEC_API_KEY=&lt;The key provided by cscli&gt;
# Comment if you don&#39;t want to use the AppSec Component
CROWDSEC_APPSEC_URL=http://127.0.0.1:7422
</code></pre></div>
<p>Finally, reload the BunkerWeb service:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The BunkerWeb All-In-One (AIO) Docker image comes with CrowdSec fully integrated. You don't need to set up a separate CrowdSec instance or manually configure acquisition files for BunkerWeb logs when using the internal CrowdSec agent.</p>
<p>Refer to the <a href="#integrations-crowdsec-integration">All-In-One (AIO) Image integration documentation</a>.</p>
</div>
</div>
</div>
<h3 id="features-configuration-settings_10">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CROWDSEC</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable CrowdSec:</strong> Set to <code>yes</code> to enable the CrowdSec bouncer.</td>
</tr>
<tr>
<td><code>CROWDSEC_API</code></td>
<td><code>http://crowdsec:8080</code></td>
<td>global</td>
<td>no</td>
<td><strong>CrowdSec API URL:</strong> The address of the CrowdSec Local API service.</td>
</tr>
<tr>
<td><code>CROWDSEC_API_KEY</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>CrowdSec API Key:</strong> The API key for authenticating with the CrowdSec API, obtained using <code>cscli bouncers add</code>.</td>
</tr>
<tr>
<td><code>CROWDSEC_MODE</code></td>
<td><code>live</code></td>
<td>global</td>
<td>no</td>
<td><strong>Operation Mode:</strong> Either <code>live</code> (query API for each request) or <code>stream</code> (periodically cache all decisions).</td>
</tr>
<tr>
<td><code>CROWDSEC_ENABLE_INTERNAL</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Internal Traffic:</strong> Set to <code>yes</code> to check internal traffic against CrowdSec decisions.</td>
</tr>
<tr>
<td><code>CROWDSEC_REQUEST_TIMEOUT</code></td>
<td><code>1000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Request Timeout:</strong> Timeout in milliseconds for HTTP requests to the CrowdSec Local API in live mode.</td>
</tr>
<tr>
<td><code>CROWDSEC_EXCLUDE_LOCATION</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Excluded Locations:</strong> Comma-separated list of locations (URIs) to exclude from CrowdSec checks.</td>
</tr>
<tr>
<td><code>CROWDSEC_CACHE_EXPIRATION</code></td>
<td><code>1</code></td>
<td>global</td>
<td>no</td>
<td><strong>Cache Expiration:</strong> The cache expiration time in seconds for IP decisions in live mode.</td>
</tr>
<tr>
<td><code>CROWDSEC_UPDATE_FREQUENCY</code></td>
<td><code>10</code></td>
<td>global</td>
<td>no</td>
<td><strong>Update Frequency:</strong> How often (in seconds) to pull new/expired decisions from the CrowdSec API in stream mode.</td>
</tr>
</tbody>
</table>
<h4 id="features-application-security-component-settings">Application Security Component Settings</h4>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CROWDSEC_APPSEC_URL</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>AppSec URL:</strong> The URL of the CrowdSec Application Security Component. Leave empty to disable AppSec.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_FAILURE_ACTION</code></td>
<td><code>passthrough</code></td>
<td>global</td>
<td>no</td>
<td><strong>Failure Action:</strong> Action to take when AppSec returns an error. Can be <code>passthrough</code> or <code>deny</code>.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_CONNECT_TIMEOUT</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td><strong>Connect Timeout:</strong> The timeout in milliseconds for connecting to the AppSec Component.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_SEND_TIMEOUT</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td><strong>Send Timeout:</strong> The timeout in milliseconds for sending data to the AppSec Component.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_PROCESS_TIMEOUT</code></td>
<td><code>500</code></td>
<td>global</td>
<td>no</td>
<td><strong>Process Timeout:</strong> The timeout in milliseconds for processing the request in the AppSec Component.</td>
</tr>
<tr>
<td><code>CROWDSEC_ALWAYS_SEND_TO_APPSEC</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Always Send:</strong> Set to <code>yes</code> to always send requests to AppSec, even if there's an IP-level decision.</td>
</tr>
<tr>
<td><code>CROWDSEC_APPSEC_SSL_VERIFY</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>SSL Verify:</strong> Set to <code>yes</code> to verify the AppSec Component's SSL certificate.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">About Operation Modes</p>
<ul>
<li><strong>Live mode</strong> queries the CrowdSec API for each incoming request, providing real-time protection at the cost of higher latency.</li>
<li><strong>Stream mode</strong> periodically downloads all decisions from the CrowdSec API and caches them locally, reducing latency with a slight delay in applying new decisions.</li>
</ul>
</div>
<h3 id="features-example-configurations_11">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="features-__tabbed_16_1" name="features-__tabbed_16" type="radio" /><input id="features-__tabbed_16_2" name="features-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_16_1">Basic Configuration</label><label for="features-__tabbed_16_2">Advanced Configuration with AppSec</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>This is a simple configuration for when CrowdSec runs on the same host:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CROWDSEC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CROWDSEC_API</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:8080&quot;</span>
<span class="nt">CROWDSEC_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-api-key-here&quot;</span>
<span class="nt">CROWDSEC_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;live&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A more comprehensive configuration including the Application Security Component:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CROWDSEC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CROWDSEC_API</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:8080&quot;</span>
<span class="nt">CROWDSEC_API_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-api-key-here&quot;</span>
<span class="nt">CROWDSEC_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span>
<span class="nt">CROWDSEC_UPDATE_FREQUENCY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30&quot;</span>
<span class="nt">CROWDSEC_EXCLUDE_LOCATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/health,/metrics&quot;</span>

<span class="c1"># AppSec Configuration</span>
<span class="nt">CROWDSEC_APPSEC_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://crowdsec:7422&quot;</span>
<span class="nt">CROWDSEC_APPSEC_FAILURE_ACTION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;deny&quot;</span>
<span class="nt">CROWDSEC_ALWAYS_SEND_TO_APPSEC</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CROWDSEC_APPSEC_SSL_VERIFY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-custom-ssl-certificate">Custom SSL certificate</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Custom SSL certificate plugin allows you to use your own SSL/TLS certificates with BunkerWeb instead of the automatically generated ones. This feature is particularly useful if you have existing certificates from a trusted Certificate Authority (CA), need to use certificates with specific configurations, or want to maintain consistent certificate management across your infrastructure.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>You provide BunkerWeb with your certificate and private key files, either by specifying file paths or by providing the data in base64-encoded or plaintext PEM format.</li>
<li>BunkerWeb validates your certificate and key to ensure they are properly formatted and usable.</li>
<li>When a secure connection is established, BunkerWeb serves your custom certificate instead of the auto-generated one.</li>
<li>BunkerWeb automatically monitors your certificate's validity and displays warnings if it is approaching expiration.</li>
<li>You have full control over certificate management, allowing you to use certificates from any issuer you prefer.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Automatic Certificate Monitoring</p>
<p>When you enable custom SSL/TLS by setting <code>USE_CUSTOM_SSL</code> to <code>yes</code>, BunkerWeb automatically monitors the custom certificate specified in <code>CUSTOM_SSL_CERT</code>. It checks for changes daily and reloads NGINX if any modifications are detected, ensuring the latest certificate is always in use.</p>
</div>
<h3 id="features-how-to-use_10">How to Use</h3>
<p>Follow these steps to configure and use the Custom SSL certificate feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>USE_CUSTOM_SSL</code> setting to <code>yes</code> to enable custom certificate support.</li>
<li><strong>Choose a method:</strong> Decide whether to provide certificates via file paths or as base64-encoded/plaintext data, and set the priority using <code>CUSTOM_SSL_CERT_PRIORITY</code>.</li>
<li><strong>Provide certificate files:</strong> If using file paths, specify the locations of your certificate and private key files.</li>
<li><strong>Or provide certificate data:</strong> If using data, provide your certificate and key as either base64-encoded strings or plaintext PEM format.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, BunkerWeb automatically uses your custom certificates for all HTTPS connections.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Stream Mode Configuration</p>
<p>For stream mode, you must configure the <code>LISTEN_STREAM_PORT_SSL</code> setting to specify the SSL/TLS listening port. This step is essential for proper operation in stream mode.</p>
</div>
<h3 id="features-configuration-settings_11">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_CUSTOM_SSL</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Custom SSL:</strong> Set to <code>yes</code> to use your own certificate instead of the auto-generated one.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_CERT_PRIORITY</code></td>
<td><code>file</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificate Priority:</strong> Choose whether to prioritize the certificate from file path or from base64 data (<code>file</code> or <code>data</code>).</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_CERT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificate Path:</strong> Full path to your SSL certificate or certificate bundle file.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_KEY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Private Key Path:</strong> Full path to your SSL private key file.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_CERT_DATA</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificate Data:</strong> Your certificate encoded in base64 format or as plaintext PEM.</td>
</tr>
<tr>
<td><code>CUSTOM_SSL_KEY_DATA</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Private Key Data:</strong> Your private key encoded in base64 format or as plaintext PEM.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<p>When using custom certificates, ensure your private key is properly secured and has appropriate permissions. The files must be readable by the BunkerWeb scheduler.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Certificate Format</p>
<p>BunkerWeb expects certificates in PEM format. If your certificate is in a different format, you may need to convert it first.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Certificate Chains</p>
<p>If your certificate includes a chain (intermediates), you should provide the full certificate chain in the correct order, with your certificate first, followed by any intermediate certificates.</p>
</div>
<h3 id="features-example-configurations_12">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="17:4"><input checked="checked" id="features-__tabbed_17_1" name="features-__tabbed_17" type="radio" /><input id="features-__tabbed_17_2" name="features-__tabbed_17" type="radio" /><input id="features-__tabbed_17_3" name="features-__tabbed_17" type="radio" /><input id="features-__tabbed_17_4" name="features-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_17_1">Using File Paths</label><label for="features-__tabbed_17_2">Using Base64 Data</label><label for="features-__tabbed_17_3">Using Plaintext PEM Data</label><label for="features-__tabbed_17_4">Fallback Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A configuration using certificate and key files on disk:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file&quot;</span>
<span class="nt">CUSTOM_SSL_CERT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/path/to/your/certificate.pem&quot;</span>
<span class="nt">CUSTOM_SSL_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/path/to/your/private-key.pem&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration using base64-encoded certificate and key data:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;data&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR...base64</span><span class="nv"> </span><span class="s">encoded</span><span class="nv"> </span><span class="s">certificate...Cg==&quot;</span>
<span class="nt">CUSTOM_SSL_KEY_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSEV...base64</span><span class="nv"> </span><span class="s">encoded</span><span class="nv"> </span><span class="s">key...Cg==&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration using plaintext certificate and key data in PEM format:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;data&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_DATA</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">-----BEGIN CERTIFICATE-----</span>
<span class="w">  </span><span class="no">MIIDdzCCAl+gAwIBAgIUJH...certificate content...AAAA</span>
<span class="w">  </span><span class="no">-----END CERTIFICATE-----</span>
<span class="nt">CUSTOM_SSL_KEY_DATA</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">  </span><span class="no">-----BEGIN PRIVATE KEY-----</span>
<span class="w">  </span><span class="no">MIIEvQIBADAN...key content...AAAA</span>
<span class="w">  </span><span class="no">-----END PRIVATE KEY-----</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration that prioritizes files but falls back to base64 data if files are unavailable:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_CUSTOM_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_PRIORITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file&quot;</span>
<span class="nt">CUSTOM_SSL_CERT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/path/to/your/certificate.pem&quot;</span>
<span class="nt">CUSTOM_SSL_KEY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/path/to/your/private-key.pem&quot;</span>
<span class="nt">CUSTOM_SSL_CERT_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUR...base64</span><span class="nv"> </span><span class="s">encoded</span><span class="nv"> </span><span class="s">certificate...Cg==&quot;</span>
<span class="nt">CUSTOM_SSL_KEY_DATA</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;LS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tCk1JSEV...base64</span><span class="nv"> </span><span class="s">encoded</span><span class="nv"> </span><span class="s">key...Cg==&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-dnsbl">DNSBL</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The DNSBL (Domain Name System Blacklist) plugin provides protection against known malicious IP addresses by checking client IP addresses against external DNSBL servers. This feature helps guard your website against spam, botnets, and various types of cyber threats by leveraging community-maintained lists of problematic IP addresses.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a client connects to your website, BunkerWeb queries the DNSBL servers you have chosen using the DNS protocol.</li>
<li>The check is performed by sending a reverse DNS query to each DNSBL server with the client's IP address.</li>
<li>If any DNSBL server confirms that the client's IP address is listed as malicious, BunkerWeb will automatically ban the client, preventing potential threats from reaching your application.</li>
<li>Results are cached to improve performance for repeat visitors from the same IP address.</li>
<li>Lookups are performed efficiently using asynchronous queries to minimize impact on page load times.</li>
</ol>
<h3 id="features-how-to-use_11">How to Use</h3>
<p>Follow these steps to configure and use the DNSBL feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The DNSBL feature is disabled by default. Set the <code>USE_DNSBL</code> setting to <code>yes</code> to enable it.</li>
<li><strong>Configure DNSBL servers:</strong> Add the domain names of the DNSBL services you want to use to the <code>DNSBL_LIST</code> setting.</li>
<li><strong>Apply settings:</strong> Once configured, BunkerWeb will automatically check incoming connections against the specified DNSBL servers.</li>
<li><strong>Monitor effectiveness:</strong> Check the <a href="#web-ui">web UI</a> to see statistics on requests blocked by DNSBL checks.</li>
</ol>
<h3 id="features-configuration-settings_12">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_DNSBL</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable DNSBL:</strong> Set to <code>yes</code> to enable DNSBL checks for incoming connections.</td>
</tr>
<tr>
<td><code>DNSBL_LIST</code></td>
<td><code>bl.blocklist.de sbl.spamhaus.org xbl.spamhaus.org</code></td>
<td>global</td>
<td>no</td>
<td><strong>DNSBL Servers:</strong> List of DNSBL server domains to check, separated by spaces.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Choosing DNSBL Servers</p>
<p>Choose reputable DNSBL providers to minimize false positives. The default list includes well-established services that are suitable for most websites:</p>
<ul>
<li><strong>bl.blocklist.de:</strong> Lists IPs that have been detected attacking other servers.</li>
<li><strong>sbl.spamhaus.org:</strong> Focuses on spam sources and other malicious activities.</li>
<li><strong>xbl.spamhaus.org:</strong> Targets infected systems, such as compromised machines or open proxies.</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">How DNSBL Works</p>
<p>DNSBL servers work by responding to specially formatted DNS queries. When BunkerWeb checks an IP address, it reverses the IP and appends the DNSBL domain name. If the resulting DNS query returns a "success" response, the IP is considered blacklisted.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Performance Considerations</p>
<p>While BunkerWeb optimizes DNSBL lookups for performance, adding a large number of DNSBL servers could potentially impact response times. Start with a few reputable DNSBL servers and monitor performance before adding more.</p>
</div>
<h3 id="features-example-configurations_13">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="features-__tabbed_18_1" name="features-__tabbed_18" type="radio" /><input id="features-__tabbed_18_2" name="features-__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_18_1">Basic Configuration</label><label for="features-__tabbed_18_2">Minimal Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration using the default DNSBL servers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_DNSBL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">DNSBL_LIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bl.blocklist.de</span><span class="nv"> </span><span class="s">sbl.spamhaus.org</span><span class="nv"> </span><span class="s">xbl.spamhaus.org&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A minimal configuration focusing on the most reliable DNSBL services:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_DNSBL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">DNSBL_LIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;zen.spamhaus.org&quot;</span>
</code></pre></div>
<p>This configuration uses only:</p>
<ul>
<li><strong>zen.spamhaus.org</strong>: Spamhaus' combined list is often considered sufficient as a standalone solution due to its wide coverage and reputation for accuracy. It combines the SBL, XBL, and PBL lists in a single query, making it efficient and comprehensive.</li>
</ul>
</div>
</div>
</div>
<h2 id="features-database">Database</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Database plugin provides a robust database integration for BunkerWeb by enabling centralized storage and management of configuration data, logs, and other essential information.</p>
<p>This core component supports multiple database engines, including SQLite, PostgreSQL, MySQL/MariaDB, and Oracle, allowing you to choose the database solution that best fits your environment and requirements.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>BunkerWeb connects to your configured database using the provided URI in the SQLAlchemy format.</li>
<li>Critical configuration data, runtime information, and job logs are stored securely in the database.</li>
<li>Automatic maintenance processes optimize your database by managing data growth and cleaning up excess records.</li>
<li>For high-availability scenarios, you can configure a read-only database URI that serves both as a failover and as a method to offload read operations.</li>
<li>Database operations are logged according to your specified log level, providing appropriate visibility into database interactions.</li>
</ol>
<h3 id="features-how-to-use_12">How to Use</h3>
<p>Follow these steps to configure and use the Database feature:</p>
<ol>
<li><strong>Choose a database engine:</strong> Select from SQLite (default), PostgreSQL, MySQL/MariaDB, or Oracle based on your requirements.</li>
<li><strong>Configure the database URI:</strong> Set the <code>DATABASE_URI</code> to connect to your primary database using the SQLAlchemy format.</li>
<li><strong>Optional read-only database:</strong> For high-availability setups, configure a <code>DATABASE_URI_READONLY</code> as a fallback or for read operations.</li>
</ol>
<h3 id="features-configuration-settings_13">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DATABASE_URI</code></td>
<td><code>sqlite:////var/lib/bunkerweb/db.sqlite3</code></td>
<td>global</td>
<td>no</td>
<td><strong>Database URI:</strong> The primary database connection string in the SQLAlchemy format.</td>
</tr>
<tr>
<td><code>DATABASE_URI_READONLY</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Read-Only Database URI:</strong> Optional database for read-only operations or as a failover if the main database is down.</td>
</tr>
<tr>
<td><code>DATABASE_LOG_LEVEL</code></td>
<td><code>warning</code></td>
<td>global</td>
<td>no</td>
<td><strong>Log Level:</strong> The verbosity level for database logs. Options: <code>debug</code>, <code>info</code>, <code>warn</code>, <code>warning</code>, or <code>error</code>.</td>
</tr>
<tr>
<td><code>DATABASE_MAX_JOBS_RUNS</code></td>
<td><code>10000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Maximum Job Runs:</strong> The maximum number of job execution records to retain in the database before automatic cleanup.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Database Selection</p>
<ul>
<li><strong>SQLite</strong> (default): Ideal for single-node deployments or testing environments due to its simplicity and file-based nature.</li>
<li><strong>PostgreSQL</strong>: Recommended for production environments with multiple BunkerWeb instances due to its robustness and concurrency support.</li>
<li><strong>MySQL/MariaDB</strong>: A good alternative to PostgreSQL with similar production-grade capabilities.</li>
<li><strong>Oracle</strong>: Suitable for enterprise environments where Oracle is already the standard database platform.</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">SQLAlchemy URI Format</p>
<p>The database URI follows the SQLAlchemy format:</p>
<ul>
<li>SQLite: <code>sqlite:////path/to/database.sqlite3</code></li>
<li>PostgreSQL: <code>postgresql://username:password@hostname:port/database</code></li>
<li>MySQL/MariaDB: <code>mysql://username:password@hostname:port/database</code> or <code>mariadb://username:password@hostname:port/database</code></li>
<li>Oracle: <code>oracle://username:password@hostname:port/database</code></li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Database Maintenance</p>
<p>The plugin automatically runs a daily job that cleans up excess job runs based on the <code>DATABASE_MAX_JOBS_RUNS</code> setting. This prevents unbounded database growth while maintaining a useful history of job executions.</p>
</div>
<h2 id="features-errors">Errors</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The Errors plugin provides customizable error handling for your website, letting you configure how HTTP error responses appear to users. This feature helps you present user-friendly, branded error pages that enhance the user experience during error scenarios, rather than displaying default server error pages, which can seem technical and confusing to visitors.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a client encounters an HTTP error (for example, 400, 404, or 500), BunkerWeb intercepts the error response.</li>
<li>Instead of showing the default error page, BunkerWeb displays a custom, professionally designed error page.</li>
<li>Error pages are fully customizable through your configuration, allowing you to specify custom pages for specific error codes.</li>
<li>The default error pages provide clear explanations, helping users understand what went wrong and what they can do next.</li>
</ol>
<h3 id="features-how-to-use_13">How to Use</h3>
<p>Follow these steps to configure and use the Errors feature:</p>
<ol>
<li><strong>Define custom error pages:</strong> Specify which HTTP error codes should use custom error pages using the <code>ERRORS</code> setting.</li>
<li><strong>Configure your error pages:</strong> For each error code, you can use the default BunkerWeb error page or provide your own custom HTML page.</li>
<li><strong>Set intercepted error codes:</strong> Select which error codes should always be handled by BunkerWeb with the <code>INTERCEPTED_ERROR_CODES</code> setting.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, error handling occurs automatically for all specified error codes.</li>
</ol>
<h3 id="features-configuration-settings_14">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ERRORS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Custom Error Pages:</strong> Map specific error codes to custom HTML files using the format <code>ERROR_CODE=/path/to/file.html</code>.</td>
</tr>
<tr>
<td><code>INTERCEPTED_ERROR_CODES</code></td>
<td><code>400 401 403 404 405 413 429 500 501 502 503 504</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Intercepted Errors:</strong> List of HTTP error codes that BunkerWeb should handle with its default error page when no custom page is specified.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Error Page Design</p>
<p>The default BunkerWeb error pages are designed to be informative, user-friendly, and professional in appearance. They include:</p>
<ul>
<li>Clear error descriptions</li>
<li>Information about what might have caused the error</li>
<li>Suggested actions for users to resolve the issue</li>
<li>Visual indicators that help users understand whether the issue is on the client or the server side</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">Error Types</p>
<p>Error codes are categorized by type:</p>
<ul>
<li><strong>4xx errors (client-side):</strong> These indicate issues with the client's request, such as attempting to access non-existent pages or lacking proper authentication.</li>
<li><strong>5xx errors (server-side):</strong> These indicate issues with the server's ability to fulfill a valid request, such as internal server errors or temporary unavailability.</li>
</ul>
</div>
<h3 id="features-example-configurations_14">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="19:3"><input checked="checked" id="features-__tabbed_19_1" name="features-__tabbed_19" type="radio" /><input id="features-__tabbed_19_2" name="features-__tabbed_19" type="radio" /><input id="features-__tabbed_19_3" name="features-__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_19_1">Default Error Handling</label><label for="features-__tabbed_19_2">Custom Error Pages</label><label for="features-__tabbed_19_3">Selective Error Handling</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Let BunkerWeb handle common error codes with its default error pages:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INTERCEPTED_ERROR_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">413</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">500</span><span class="nv"> </span><span class="s">501</span><span class="nv"> </span><span class="s">502</span><span class="nv"> </span><span class="s">503</span><span class="nv"> </span><span class="s">504&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Use custom error pages for specific error codes:</p>
<div class="highlight"><pre><span></span><code><span class="nt">ERRORS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;404=/custom/404.html</span><span class="nv"> </span><span class="s">500=/custom/500.html&quot;</span>
<span class="nt">INTERCEPTED_ERROR_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;400</span><span class="nv"> </span><span class="s">401</span><span class="nv"> </span><span class="s">403</span><span class="nv"> </span><span class="s">404</span><span class="nv"> </span><span class="s">405</span><span class="nv"> </span><span class="s">413</span><span class="nv"> </span><span class="s">429</span><span class="nv"> </span><span class="s">500</span><span class="nv"> </span><span class="s">501</span><span class="nv"> </span><span class="s">502</span><span class="nv"> </span><span class="s">503</span><span class="nv"> </span><span class="s">504&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Only handle specific error codes with BunkerWeb:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INTERCEPTED_ERROR_CODES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;404</span><span class="nv"> </span><span class="s">500&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-greylist">Greylist</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Greylist plugin provides a flexible security approach that allows visitors access while still maintaining essential security features.</p>
<p>Unlike traditional <a href="#features-blacklist">blacklist</a>/<a href="#features-whitelist">whitelist</a> approaches—that completely block or allow access—greylisting creates a middle ground by granting access to certain visitors while still subjecting them to security checks.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>You define criteria for visitors to be greylisted (<em>IP addresses, networks, rDNS, ASN, User-Agent, or URI patterns</em>).</li>
<li>When a visitor matches any of these criteria, they are granted access to your site while the other security features remain active.</li>
<li>If a visitor does not match any greylist criteria, their access is denied.</li>
<li>Greylist data can be automatically updated from external sources on a regular schedule.</li>
</ol>
<h3 id="features-how-to-use_14">How to Use</h3>
<p>Follow these steps to configure and use the Greylist feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The Greylist feature is disabled by default. Set the <code>USE_GREYLIST</code> setting to <code>yes</code> to enable it.</li>
<li><strong>Configure greylist rules:</strong> Define which IPs, networks, rDNS patterns, ASNs, User-Agents, or URIs should be greylisted.</li>
<li><strong>Add external sources:</strong> Optionally, configure URLs for automatically downloading and updating greylist data.</li>
<li><strong>Monitor access:</strong> Check the <a href="#web-ui">web UI</a> to see which visitors are being allowed or denied.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Access Control Behavior</p>
<p>When the greylist feature is enabled with the <code>USE_GREYLIST</code> setting set to <code>yes</code>:</p>
<ol>
<li><strong>Greylisted visitors:</strong> Are allowed access but are still subject to all security checks.</li>
<li><strong>Non-greylisted visitors:</strong> Are completely denied access.</li>
</ol>
</div>
<div class="admonition info">
<p class="admonition-title">stream mode</p>
<p>When using stream mode, only IP, rDNS, and ASN checks are performed.</p>
</div>
<h3 id="features-configuration-settings_15">Configuration Settings</h3>
<p><strong>General</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_GREYLIST</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Greylist:</strong> Set to <code>yes</code> to enable greylisting.</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="20:5"><input checked="checked" id="features-__tabbed_20_1" name="features-__tabbed_20" type="radio" /><input id="features-__tabbed_20_2" name="features-__tabbed_20" type="radio" /><input id="features-__tabbed_20_3" name="features-__tabbed_20" type="radio" /><input id="features-__tabbed_20_4" name="features-__tabbed_20" type="radio" /><input id="features-__tabbed_20_5" name="features-__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_20_1">IP Address</label><label for="features-__tabbed_20_2">Reverse DNS</label><label for="features-__tabbed_20_3">ASN</label><label for="features-__tabbed_20_4">User Agent</label><label for="features-__tabbed_20_5">URI</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>What this does:</strong> Greylist visitors based on their IP address or network. These visitors gain access but remain subject to security checks.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GREYLIST_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Greylist:</strong> List of IP addresses or networks (in CIDR notation) to greylist, separated by spaces.</td>
</tr>
<tr>
<td><code>GREYLIST_IP_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Greylist URLs:</strong> List of URLs containing IP addresses or networks to greylist, separated by spaces.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Greylist visitors based on their domain name (in reverse). Useful for allowing conditional access to visitors from specific organizations or networks.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GREYLIST_RDNS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Greylist:</strong> List of reverse DNS suffixes to greylist, separated by spaces.</td>
</tr>
<tr>
<td><code>GREYLIST_RDNS_GLOBAL</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Global Only:</strong> Only perform rDNS greylist checks on global IP addresses when set to <code>yes</code>.</td>
</tr>
<tr>
<td><code>GREYLIST_RDNS_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Greylist URLs:</strong> List of URLs containing reverse DNS suffixes to greylist, separated by spaces.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Greylist visitors from specific network providers using Autonomous System Numbers. ASNs identify which provider or organization an IP belongs to.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GREYLIST_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Greylist:</strong> List of Autonomous System Numbers to greylist, separated by spaces.</td>
</tr>
<tr>
<td><code>GREYLIST_ASN_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Greylist URLs:</strong> List of URLs containing ASNs to greylist, separated by spaces.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Greylist visitors based on the browser or tool they claim to be using. This allows controlled access for specific tools while maintaining security checks.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GREYLIST_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Greylist:</strong> List of User-Agent patterns (PCRE regex) to greylist, separated by spaces.</td>
</tr>
<tr>
<td><code>GREYLIST_USER_AGENT_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Greylist URLs:</strong> List of URLs containing User-Agent patterns to greylist.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Greylist requests to specific URLs on your site. This allows conditional access to certain endpoints while maintaining security checks.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GREYLIST_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Greylist:</strong> List of URI patterns (PCRE regex) to greylist, separated by spaces.</td>
</tr>
<tr>
<td><code>GREYLIST_URI_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Greylist URLs:</strong> List of URLs containing URI patterns to greylist, separated by spaces.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="admonition info">
<p class="admonition-title">URL Format Support</p>
<p>All <code>*_URLS</code> settings support HTTP/HTTPS URLs as well as local file paths using the <code>file:///</code> prefix. Basic authentication is supported using the <code>http://user:pass@url</code> format.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Regular Updates</p>
<p>Greylists from URLs are automatically downloaded and updated hourly to ensure that your protection remains current with the latest trusted sources.</p>
</div>
<h3 id="features-example-configurations_15">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="21:4"><input checked="checked" id="features-__tabbed_21_1" name="features-__tabbed_21" type="radio" /><input id="features-__tabbed_21_2" name="features-__tabbed_21" type="radio" /><input id="features-__tabbed_21_3" name="features-__tabbed_21" type="radio" /><input id="features-__tabbed_21_4" name="features-__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_21_1">Basic Configuration</label><label for="features-__tabbed_21_2">Advanced Configuration</label><label for="features-__tabbed_21_3">Using Local Files</label><label for="features-__tabbed_21_4">Selective API Access</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration that applies greylisting to a company's internal network and crawler:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GREYLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">GREYLIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)CompanyCrawler(?:\b)&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A more comprehensive configuration with multiple greylist criteria:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Company assets and approved crawlers</span>
<span class="nt">GREYLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">203.0.113.0/24&quot;</span>
<span class="nt">GREYLIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.company.com</span><span class="nv"> </span><span class="s">.partner-company.org&quot;</span>
<span class="nt">GREYLIST_ASN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;12345</span><span class="nv"> </span><span class="s">67890&quot;</span><span class="w">  </span><span class="c1"># Company and partner ASNs</span>
<span class="nt">GREYLIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)GoodBot(?:\b)</span><span class="nv"> </span><span class="s">(?:\b)PartnerCrawler(?:\b)&quot;</span>
<span class="nt">GREYLIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/v1/&quot;</span>

<span class="c1"># External trusted sources</span>
<span class="nt">GREYLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-networks.txt&quot;</span>
<span class="nt">GREYLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-crawlers.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using local files for greylists:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GREYLIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/ip-greylist.txt&quot;</span>
<span class="nt">GREYLIST_RDNS_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/rdns-greylist.txt&quot;</span>
<span class="nt">GREYLIST_ASN_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/asn-greylist.txt&quot;</span>
<span class="nt">GREYLIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/user-agent-greylist.txt&quot;</span>
<span class="nt">GREYLIST_URI_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/uri-greylist.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration allowing access to specific API endpoints:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GREYLIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GREYLIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/v1/public/</span><span class="nv"> </span><span class="s">^/api/v1/status&quot;</span>
<span class="nt">GREYLIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;203.0.113.0/24&quot;</span><span class="w">  </span><span class="c1"># External partner network</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-gzip">Gzip</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The GZIP plugin enhances website performance by compressing HTTP responses using the GZIP algorithm. This feature reduces bandwidth usage and improves page load times by compressing web content before it is sent to the client's browser, resulting in faster delivery and an improved user experience.</p>
<h3 id="features-how-it-works">How It Works</h3>
<ol>
<li>When a client requests content from your website, BunkerWeb checks if the client supports GZIP compression.</li>
<li>If supported, BunkerWeb compresses the response using the GZIP algorithm at your configured compression level.</li>
<li>The compressed content is sent to the client with appropriate headers indicating GZIP compression.</li>
<li>The client's browser decompresses the content before rendering it.</li>
<li>Both bandwidth usage and page load times are reduced, enhancing overall site performance and user experience.</li>
</ol>
<h3 id="features-how-to-use_15">How to Use</h3>
<p>Follow these steps to configure and use the GZIP compression feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The GZIP feature is disabled by default. Enable it by setting the <code>USE_GZIP</code> setting to <code>yes</code>.</li>
<li><strong>Configure MIME types:</strong> Specify which content types should be compressed using the <code>GZIP_TYPES</code> setting.</li>
<li><strong>Set minimum size:</strong> Define the minimum response size required for compression with the <code>GZIP_MIN_LENGTH</code> setting to avoid compressing small files.</li>
<li><strong>Choose a compression level:</strong> Select your preferred balance between speed and compression ratio using the <code>GZIP_COMP_LEVEL</code> setting.</li>
<li><strong>Configure proxied requests:</strong> Specify which proxied requests should be compressed using the <code>GZIP_PROXIED</code> setting.</li>
</ol>
<h3 id="features-configuration-settings_16">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_GZIP</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable GZIP:</strong> Set to <code>yes</code> to enable GZIP compression.</td>
</tr>
<tr>
<td><code>GZIP_TYPES</code></td>
<td><code>application/atom+xml application/javascript application/json application/rss+xml application/vnd.ms-fontobject application/x-font-opentype application/x-font-truetype application/x-font-ttf application/x-javascript application/xhtml+xml application/xml font/eot font/opentype font/otf font/truetype image/svg+xml image/vnd.microsoft.icon image/x-icon image/x-win-bitmap text/css text/javascript text/plain text/xml</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>MIME Types:</strong> List of content types that will be compressed with GZIP.</td>
</tr>
<tr>
<td><code>GZIP_MIN_LENGTH</code></td>
<td><code>1000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Minimum Size:</strong> The minimum response size (in bytes) for GZIP compression to be applied.</td>
</tr>
<tr>
<td><code>GZIP_COMP_LEVEL</code></td>
<td><code>5</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Compression Level:</strong> Level of compression from 1 (minimum compression) to 9 (maximum compression). Higher values use more CPU.</td>
</tr>
<tr>
<td><code>GZIP_PROXIED</code></td>
<td><code>no-cache no-store private expired auth</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Proxied Requests:</strong> Specifies which proxied requests should be compressed based on response headers.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Optimizing Compression Level</p>
<p>The default compression level (5) offers a good balance between compression ratio and CPU usage. For static content or when server CPU resources are plentiful, consider increasing to 7-9 for maximum compression. For dynamic content or when CPU resources are limited, you might want to use 1-3 for faster compression with reasonable size reduction.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Browser Support</p>
<p>GZIP is supported by all modern browsers and has been the standard compression method for HTTP responses for many years, ensuring excellent compatibility across devices and browsers.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Compression vs. CPU Usage</p>
<p>While GZIP compression reduces bandwidth and improves load times, higher compression levels consume more CPU resources. For high-traffic sites, find the right balance between compression efficiency and server performance.</p>
</div>
<h3 id="features-example-configurations_16">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="22:4"><input checked="checked" id="features-__tabbed_22_1" name="features-__tabbed_22" type="radio" /><input id="features-__tabbed_22_2" name="features-__tabbed_22" type="radio" /><input id="features-__tabbed_22_3" name="features-__tabbed_22" type="radio" /><input id="features-__tabbed_22_4" name="features-__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_22_1">Basic Configuration</label><label for="features-__tabbed_22_2">Maximum Compression</label><label for="features-__tabbed_22_3">Balanced Performance</label><label for="features-__tabbed_22_4">Proxied Content Focus</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A standard configuration that enables GZIP with default settings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration optimized for maximum compression savings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/atom+xml</span><span class="nv"> </span><span class="s">application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">application/rss+xml</span><span class="nv"> </span><span class="s">application/vnd.ms-fontobject</span><span class="nv"> </span><span class="s">application/x-font-opentype</span><span class="nv"> </span><span class="s">application/x-font-truetype</span><span class="nv"> </span><span class="s">application/x-font-ttf</span><span class="nv"> </span><span class="s">application/x-javascript</span><span class="nv"> </span><span class="s">application/xhtml+xml</span><span class="nv"> </span><span class="s">application/xml</span><span class="nv"> </span><span class="s">font/eot</span><span class="nv"> </span><span class="s">font/opentype</span><span class="nv"> </span><span class="s">font/otf</span><span class="nv"> </span><span class="s">font/truetype</span><span class="nv"> </span><span class="s">image/svg+xml</span><span class="nv"> </span><span class="s">image/vnd.microsoft.icon</span><span class="nv"> </span><span class="s">image/x-icon</span><span class="nv"> </span><span class="s">image/x-win-bitmap</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain</span><span class="nv"> </span><span class="s">text/xml&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9&quot;</span>
<span class="nt">GZIP_PROXIED</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;any&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration that balances compression ratio with CPU usage:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript</span><span class="nv"> </span><span class="s">text/plain&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">GZIP_PROXIED</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no-cache</span><span class="nv"> </span><span class="s">no-store</span><span class="nv"> </span><span class="s">private</span><span class="nv"> </span><span class="s">expired&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration that focuses on properly handling compression for proxied content:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">GZIP_TYPES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;application/javascript</span><span class="nv"> </span><span class="s">application/json</span><span class="nv"> </span><span class="s">text/css</span><span class="nv"> </span><span class="s">text/html</span><span class="nv"> </span><span class="s">text/javascript&quot;</span>
<span class="nt">GZIP_MIN_LENGTH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">GZIP_COMP_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">GZIP_PROXIED</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;any&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-html-injection">HTML injection</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The HTML Injection plugin enables you to seamlessly add custom HTML code to your website's pages before either the closing <code>&lt;/body&gt;</code> or <code>&lt;/head&gt;</code> tags. This feature is particularly useful for adding analytics scripts, tracking pixels, custom JavaScript, CSS styles, or other third-party integrations without modifying your website's source code.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a page is served from your website, BunkerWeb examines the HTML response.</li>
<li>If you've configured body injection, BunkerWeb inserts your custom HTML code just before the closing <code>&lt;/body&gt;</code> tag.</li>
<li>If you've configured head injection, BunkerWeb inserts your custom HTML code just before the closing <code>&lt;/head&gt;</code> tag.</li>
<li>The insertion happens automatically for all HTML pages served by your website.</li>
<li>This allows you to add scripts, styles, or other elements without modifying your application's code.</li>
</ol>
<h3 id="features-how-to-use_16">How to Use</h3>
<p>Follow these steps to configure and use the HTML Injection feature:</p>
<ol>
<li><strong>Prepare your custom HTML:</strong> Decide what HTML code you want to inject into your pages.</li>
<li><strong>Choose injection locations:</strong> Determine whether you need to inject code in the <code>&lt;head&gt;</code> section, the <code>&lt;body&gt;</code> section, or both.</li>
<li><strong>Configure the settings:</strong> Add your custom HTML to the appropriate settings (<code>INJECT_HEAD</code> and/or <code>INJECT_BODY</code>).</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, the HTML will be automatically injected into all served HTML pages.</li>
</ol>
<h3 id="features-configuration-settings_17">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>INJECT_HEAD</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Head HTML Code:</strong> The HTML code to inject before the <code>&lt;/head&gt;</code> tag.</td>
</tr>
<tr>
<td><code>INJECT_BODY</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Body HTML Code:</strong> The HTML code to inject before the <code>&lt;/body&gt;</code> tag.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Best Practices</p>
<ul>
<li>For performance reasons, place JavaScript files at the end of the body to prevent render blocking.</li>
<li>Place CSS and critical JavaScript in the head section to avoid a flash of unstyled content.</li>
<li>Be careful with injected content that could potentially break your site's functionality.</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">Common Use Cases</p>
<ul>
<li>Adding analytics scripts (like Google Analytics, Matomo)</li>
<li>Integrating chat widgets or customer support tools</li>
<li>Including tracking pixels for marketing campaigns</li>
<li>Adding custom CSS styles or JavaScript functionality</li>
<li>Including third-party libraries without modifying your application code</li>
</ul>
</div>
<h3 id="features-example-configurations_17">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="23:4"><input checked="checked" id="features-__tabbed_23_1" name="features-__tabbed_23" type="radio" /><input id="features-__tabbed_23_2" name="features-__tabbed_23" type="radio" /><input id="features-__tabbed_23_3" name="features-__tabbed_23" type="radio" /><input id="features-__tabbed_23_4" name="features-__tabbed_23" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_23_1">Google Analytics</label><label for="features-__tabbed_23_2">Custom Styles</label><label for="features-__tabbed_23_3">Multiple Integrations</label><label for="features-__tabbed_23_4">Cookie Consent Banner</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Adding Google Analytics tracking to your website:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;script</span><span class="nv"> </span><span class="s">async</span><span class="nv"> </span><span class="s">src=\&quot;https://www.googletagmanager.com/gtag/js?id=G-XXXXXXXXXX\&quot;&gt;&lt;/script&gt;&lt;script&gt;window.dataLayer</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">window.dataLayer</span><span class="nv"> </span><span class="s">||</span><span class="nv"> </span><span class="s">[];function</span><span class="nv"> </span><span class="s">gtag(){dataLayer.push(arguments);}gtag(&#39;js&#39;,</span><span class="nv"> </span><span class="s">new</span><span class="nv"> </span><span class="s">Date());gtag(&#39;config&#39;,</span><span class="nv"> </span><span class="s">&#39;G-XXXXXXXXXX&#39;);&lt;/script&gt;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Adding custom CSS styles to your website:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;style&gt;body</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">font-family:</span><span class="nv"> </span><span class="s">&#39;Arial&#39;,</span><span class="nv"> </span><span class="s">sans-serif;</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">.custom-element</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">color:</span><span class="nv"> </span><span class="s">blue;</span><span class="nv"> </span><span class="s">}&lt;/style&gt;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Adding both custom styles and JavaScript:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;style&gt;body</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">font-family:</span><span class="nv"> </span><span class="s">&#39;Arial&#39;,</span><span class="nv"> </span><span class="s">sans-serif;</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">.notification-banner</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">background:</span><span class="nv"> </span><span class="s">#f8f9fa;</span><span class="nv"> </span><span class="s">padding:</span><span class="nv"> </span><span class="s">10px;</span><span class="nv"> </span><span class="s">text-align:</span><span class="nv"> </span><span class="s">center;</span><span class="nv"> </span><span class="s">}&lt;/style&gt;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;script</span><span class="nv"> </span><span class="s">src=\&quot;https://cdn.example.com/js/widget.js\&quot;&gt;&lt;/script&gt;&lt;script&gt;initializeWidget(&#39;your-api-key&#39;);&lt;/script&gt;&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Adding a simple cookie consent banner:</p>
<div class="highlight"><pre><span></span><code><span class="nt">INJECT_HEAD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;style&gt;.cookie-banner</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">position:</span><span class="nv"> </span><span class="s">fixed;</span><span class="nv"> </span><span class="s">bottom:</span><span class="nv"> </span><span class="s">0;</span><span class="nv"> </span><span class="s">left:</span><span class="nv"> </span><span class="s">0;</span><span class="nv"> </span><span class="s">right:</span><span class="nv"> </span><span class="s">0;</span><span class="nv"> </span><span class="s">background:</span><span class="nv"> </span><span class="s">#f1f1f1;</span><span class="nv"> </span><span class="s">padding:</span><span class="nv"> </span><span class="s">20px;</span><span class="nv"> </span><span class="s">text-align:</span><span class="nv"> </span><span class="s">center;</span><span class="nv"> </span><span class="s">z-index:</span><span class="nv"> </span><span class="s">1000;</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">.cookie-banner</span><span class="nv"> </span><span class="s">button</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">background:</span><span class="nv"> </span><span class="s">#4CAF50;</span><span class="nv"> </span><span class="s">border:</span><span class="nv"> </span><span class="s">none;</span><span class="nv"> </span><span class="s">color:</span><span class="nv"> </span><span class="s">white;</span><span class="nv"> </span><span class="s">padding:</span><span class="nv"> </span><span class="s">10px</span><span class="nv"> </span><span class="s">20px;</span><span class="nv"> </span><span class="s">cursor:</span><span class="nv"> </span><span class="s">pointer;</span><span class="nv"> </span><span class="s">}&lt;/style&gt;&quot;</span>
<span class="nt">INJECT_BODY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&lt;div</span><span class="nv"> </span><span class="s">id=\&quot;cookie-banner\&quot;</span><span class="nv"> </span><span class="s">class=\&quot;cookie-banner\&quot;&gt;This</span><span class="nv"> </span><span class="s">website</span><span class="nv"> </span><span class="s">uses</span><span class="nv"> </span><span class="s">cookies</span><span class="nv"> </span><span class="s">to</span><span class="nv"> </span><span class="s">ensure</span><span class="nv"> </span><span class="s">you</span><span class="nv"> </span><span class="s">get</span><span class="nv"> </span><span class="s">the</span><span class="nv"> </span><span class="s">best</span><span class="nv"> </span><span class="s">experience.</span><span class="nv"> </span><span class="s">&lt;button</span><span class="nv"> </span><span class="s">onclick=\&quot;acceptCookies()\&quot;&gt;Accept&lt;/button&gt;&lt;/div&gt;&lt;script&gt;function</span><span class="nv"> </span><span class="s">acceptCookies()</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">document.getElementById(&#39;cookie-banner&#39;).style.display</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">localStorage.setItem(&#39;cookies-accepted&#39;,</span><span class="nv"> </span><span class="s">&#39;true&#39;);</span><span class="nv"> </span><span class="s">}</span><span class="nv"> </span><span class="s">if(localStorage.getItem(&#39;cookies-accepted&#39;)</span><span class="nv"> </span><span class="s">===</span><span class="nv"> </span><span class="s">&#39;true&#39;)</span><span class="nv"> </span><span class="s">{</span><span class="nv"> </span><span class="s">document.getElementById(&#39;cookie-banner&#39;).style.display</span><span class="nv"> </span><span class="s">=</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">}&lt;/script&gt;&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-headers">Headers</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Headers play a crucial role in HTTP security. The Headers plugin provides robust management of both standard and custom HTTP headers—enhancing security and functionality. It dynamically applies security measures, such as <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Strict-Transport-Security">HSTS</a>, <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy">CSP</a> (including a reporting mode), and custom header injection, while preventing information leakage.</p>
<p><strong>How it works</strong></p>
<ol>
<li>When a client requests content from your website, BunkerWeb processes the response headers.</li>
<li>Security headers are applied in accordance with your configuration.</li>
<li>Custom headers can be added to provide additional information or functionality to clients.</li>
<li>Unwanted headers that might reveal server information are automatically removed.</li>
<li>Cookies are modified to include appropriate security flags based on your settings.</li>
<li>Headers from upstream servers can be selectively preserved when needed.</li>
</ol>
<h3 id="features-how-to-use_17">How to Use</h3>
<p>Follow these steps to configure and use the Headers feature:</p>
<ol>
<li><strong>Configure security headers:</strong> Set values for common headers.</li>
<li><strong>Add custom headers:</strong> Define any custom headers using the <code>CUSTOM_HEADER</code> setting.</li>
<li><strong>Remove unwanted headers:</strong> Use <code>REMOVE_HEADERS</code> to ensure headers that could expose server details are stripped out.</li>
<li><strong>Set cookie security:</strong> Enable robust cookie security by configuring <code>COOKIE_FLAGS</code> and setting <code>COOKIE_AUTO_SECURE_FLAG</code> to <code>yes</code> so that the Secure flag is automatically added on HTTPS connections.</li>
<li><strong>Preserve upstream headers:</strong> Specify which upstream headers to retain by using <code>KEEP_UPSTREAM_HEADERS</code>.</li>
<li><strong>Leverage conditional header application:</strong> If you wish to test policies without disruption, enable <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/Content-Security-Policy-Report-Only">CSP Report-Only</a> mode via <code>CONTENT_SECURITY_POLICY_REPORT_ONLY</code>.</li>
</ol>
<h3 id="features-configuration-guide">Configuration Guide</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="24:3"><input checked="checked" id="features-__tabbed_24_1" name="features-__tabbed_24" type="radio" /><input id="features-__tabbed_24_2" name="features-__tabbed_24" type="radio" /><input id="features-__tabbed_24_3" name="features-__tabbed_24" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_24_1">Security Headers</label><label for="features-__tabbed_24_2">Cookie Settings</label><label for="features-__tabbed_24_3">Custom Headers</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Overview</strong></p>
<p>Security headers enforce secure communication, restrict resource loading, and prevent attacks like clickjacking and injection. Properly configured headers create a robust defensive layer for your website.</p>
<div class="admonition success">
<p class="admonition-title">Benefits of Security Headers</p>
<ul>
<li><strong>HSTS:</strong> Ensures all connections are encrypted, protecting against protocol downgrade attacks.</li>
<li><strong>CSP:</strong> Prevents malicious scripts from executing, reducing the risk of XSS attacks.</li>
<li><strong>X-Frame-Options:</strong> Blocks clickjacking attempts by controlling iframe embedding.</li>
<li><strong>Referrer Policy:</strong> Limits sensitive information leakage through referrer headers.</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>STRICT_TRANSPORT_SECURITY</code></td>
<td><code>max-age=63072000; includeSubDomains; preload</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HSTS:</strong> Enforces secure HTTPS connections, reducing risks of man-in-the-middle attacks.</td>
</tr>
<tr>
<td><code>CONTENT_SECURITY_POLICY</code></td>
<td><code>object-src 'none'; form-action 'self'; frame-ancestors 'self';</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>CSP:</strong> Restricts resource loading to trusted sources, mitigating cross-site scripting and data injection attacks.</td>
</tr>
<tr>
<td><code>CONTENT_SECURITY_POLICY_REPORT_ONLY</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>CSP Report Mode:</strong> Reports violations without blocking content, helping in testing security policies while capturing logs.</td>
</tr>
<tr>
<td><code>X_FRAME_OPTIONS</code></td>
<td><code>SAMEORIGIN</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>X-Frame-Options:</strong> Prevents clickjacking by controlling whether your site can be framed.</td>
</tr>
<tr>
<td><code>X_CONTENT_TYPE_OPTIONS</code></td>
<td><code>nosniff</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>X-Content-Type-Options:</strong> Prevents browsers from MIME-sniffing, protecting against drive-by download attacks.</td>
</tr>
<tr>
<td><code>X_DNS_PREFETCH_CONTROL</code></td>
<td><code>off</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>X-DNS-Prefetch-Control:</strong> Regulates DNS prefetching to reduce unintentional network requests and enhance privacy.</td>
</tr>
<tr>
<td><code>REFERRER_POLICY</code></td>
<td><code>strict-origin-when-cross-origin</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Referrer Policy:</strong> Controls the amount of referrer information sent, safeguarding user privacy.</td>
</tr>
<tr>
<td><code>PERMISSIONS_POLICY</code></td>
<td><code>accelerometer=(), ambient-light-sensor=(), attribution-reporting=(), autoplay=(), battery=(), ...</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Permissions Policy:</strong> Restricts browser feature access, reducing potential attack vectors.</td>
</tr>
<tr>
<td><code>KEEP_UPSTREAM_HEADERS</code></td>
<td><code>Content-Security-Policy Permissions-Policy X-Frame-Options</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Keep Headers:</strong> Preserves selected upstream headers, aiding legacy integration while maintaining security.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Best Practices</p>
<ul>
<li>Regularly review and update your security headers to align with evolving security standards.</li>
<li>Use tools like <a href="https://observatory.mozilla.org/">Mozilla Observatory</a> to validate your header configuration.</li>
<li>Test CSP in <code>Report-Only</code> mode before enforcing it to avoid breaking functionality.</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><strong>Overview</strong></p>
<p>Proper cookie settings ensure secure user sessions by preventing hijacking, fixation, and cross-site scripting. Secure cookies maintain session integrity over HTTPS and enhance overall user data protection.</p>
<div class="admonition success">
<p class="admonition-title">Benefits of Secure Cookies</p>
<ul>
<li><strong>HttpOnly Flag:</strong> Prevents client-side scripts from accessing cookies, mitigating XSS risks.</li>
<li><strong>SameSite Flag:</strong> Reduces CSRF attacks by restricting cross-origin cookie usage.</li>
<li><strong>Secure Flag:</strong> Ensures cookies are transmitted only over encrypted HTTPS connections.</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>COOKIE_FLAGS</code></td>
<td><code>* HttpOnly SameSite=Lax</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Cookie Flags:</strong> Automatically adds security flags such as HttpOnly and SameSite, protecting cookies from client-side script access and CSRF attacks.</td>
</tr>
<tr>
<td><code>COOKIE_AUTO_SECURE_FLAG</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Auto Secure Flag:</strong> Ensures cookies are only sent over secure HTTPS connections by appending the Secure flag automatically.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Best Practices</p>
<ul>
<li>Use <code>SameSite=Strict</code> for sensitive cookies to prevent cross-origin access.</li>
<li>Regularly audit your cookie settings to ensure compliance with security and privacy regulations.</li>
<li>Avoid setting cookies without the Secure flag in production environments.</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><strong>Overview</strong></p>
<p>Custom headers allow you to add specific HTTP headers to meet application or performance requirements. They offer flexibility but must be carefully configured to avoid exposing sensitive server details.</p>
<div class="admonition success">
<p class="admonition-title">Benefits of Custom Headers</p>
<ul>
<li>Enhance security by removing unnecessary headers that may leak server details.</li>
<li>Add application-specific headers to improve functionality or debugging.</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>CUSTOM_HEADER</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Custom Header:</strong> Provides a means to add user-defined headers in the format HeaderName: HeaderValue for specialized security or performance enhancements.</td>
</tr>
<tr>
<td><code>REMOVE_HEADERS</code></td>
<td><code>Server Expect-CT X-Powered-By X-AspNet-Version X-AspNetMvc-Version Public-Key-Pins</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Remove Headers:</strong> Specifies headers to remove, decreasing the chance of exposing internal server details and known vulnerabilities.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<ul>
<li>Avoid exposing sensitive information through custom headers.</li>
<li>Regularly review and update custom headers to align with your application's requirements.</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">Best Practices</p>
<ul>
<li>Use <code>REMOVE_HEADERS</code> to strip out headers like <code>Server</code> and <code>X-Powered-By</code> to reduce fingerprinting risks.</li>
<li>Test custom headers in a staging environment before deploying them to production.</li>
</ul>
</div>
</div>
</div>
</div>
<h3 id="features-example-configurations_18">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="25:4"><input checked="checked" id="features-__tabbed_25_1" name="features-__tabbed_25" type="radio" /><input id="features-__tabbed_25_2" name="features-__tabbed_25" type="radio" /><input id="features-__tabbed_25_3" name="features-__tabbed_25" type="radio" /><input id="features-__tabbed_25_4" name="features-__tabbed_25" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_25_1">Basic Security Headers</label><label for="features-__tabbed_25_2">Enhanced Cookie Security</label><label for="features-__tabbed_25_3">Custom Headers for API</label><label for="features-__tabbed_25_4">Content Security Policy - Reporting Mode</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A standard configuration with essential security headers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">STRICT_TRANSPORT_SECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;max-age=63072000;</span><span class="nv"> </span><span class="s">includeSubDomains;</span><span class="nv"> </span><span class="s">preload&quot;</span>
<span class="nt">CONTENT_SECURITY_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">script-src</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">object-src</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">frame-ancestors</span><span class="nv"> </span><span class="s">&#39;self&#39;&quot;</span>
<span class="nt">X_FRAME_OPTIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;SAMEORIGIN&quot;</span>
<span class="nt">X_CONTENT_TYPE_OPTIONS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;nosniff&quot;</span>
<span class="nt">REFERRER_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;strict-origin-when-cross-origin&quot;</span>
<span class="nt">REMOVE_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Server</span><span class="nv"> </span><span class="s">X-Powered-By</span><span class="nv"> </span><span class="s">X-AspNet-Version&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with robust cookie security settings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">COOKIE_FLAGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;*</span><span class="nv"> </span><span class="s">HttpOnly</span><span class="nv"> </span><span class="s">SameSite=Strict&quot;</span>
<span class="nt">COOKIE_FLAGS_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;session_cookie</span><span class="nv"> </span><span class="s">Secure</span><span class="nv"> </span><span class="s">HttpOnly</span><span class="nv"> </span><span class="s">SameSite=Strict&quot;</span>
<span class="nt">COOKIE_FLAGS_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;auth_cookie</span><span class="nv"> </span><span class="s">Secure</span><span class="nv"> </span><span class="s">HttpOnly</span><span class="nv"> </span><span class="s">SameSite=Strict</span><span class="nv"> </span><span class="s">Max-Age=3600&quot;</span>
<span class="nt">COOKIE_AUTO_SECURE_FLAG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for an API service with custom headers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">CUSTOM_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;API-Version:</span><span class="nv"> </span><span class="s">1.2.3&quot;</span>
<span class="nt">CUSTOM_HEADER_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Access-Control-Max-Age:</span><span class="nv"> </span><span class="s">86400&quot;</span>
<span class="nt">CONTENT_SECURITY_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">frame-ancestors</span><span class="nv"> </span><span class="s">&#39;none&#39;&quot;</span>
<span class="nt">REMOVE_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;Server</span><span class="nv"> </span><span class="s">X-Powered-By</span><span class="nv"> </span><span class="s">X-AspNet-Version</span><span class="nv"> </span><span class="s">X-Runtime&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration to test CSP without breaking functionality:</p>
<div class="highlight"><pre><span></span><code><span class="nt">CONTENT_SECURITY_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;default-src</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">script-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">https://trusted-cdn.example.com;</span><span class="nv"> </span><span class="s">img-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">data:</span><span class="nv"> </span><span class="s">https://*.example.com;</span><span class="nv"> </span><span class="s">style-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">&#39;unsafe-inline&#39;</span><span class="nv"> </span><span class="s">https://trusted-cdn.example.com;</span><span class="nv"> </span><span class="s">connect-src</span><span class="nv"> </span><span class="s">&#39;self&#39;</span><span class="nv"> </span><span class="s">https://api.example.com;</span><span class="nv"> </span><span class="s">object-src</span><span class="nv"> </span><span class="s">&#39;none&#39;;</span><span class="nv"> </span><span class="s">frame-ancestors</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">form-action</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">base-uri</span><span class="nv"> </span><span class="s">&#39;self&#39;;</span><span class="nv"> </span><span class="s">report-uri</span><span class="nv"> </span><span class="s">https://example.com/csp-reports&quot;</span>
<span class="nt">CONTENT_SECURITY_POLICY_REPORT_ONLY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-lets-encrypt">Let's Encrypt</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Let's Encrypt plugin simplifies SSL/TLS certificate management by automating the creation, renewal, and configuration of free certificates from Let's Encrypt. This feature enables secure HTTPS connections for your websites without the complexity of manual certificate management, reducing both cost and administrative overhead.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When enabled, BunkerWeb automatically detects the domains configured for your website.</li>
<li>BunkerWeb requests free SSL/TLS certificates from Let's Encrypt's certificate authority.</li>
<li>Domain ownership is verified through either HTTP challenges (proving you control the website) or DNS challenges (proving you control your domain's DNS).</li>
<li>Certificates are automatically installed and configured for your domains.</li>
<li>BunkerWeb handles certificate renewals in the background before expiration, ensuring continuous HTTPS availability.</li>
<li>The entire process is fully automated, requiring minimal intervention after the initial setup.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">Prerequisites</p>
<p>To use this feature, ensure that proper DNS <strong>A records</strong> are configured for each domain, pointing to the public IP(s) where BunkerWeb is accessible. Without correct DNS configuration, the domain verification process will fail.</p>
</div>
<h3 id="features-how-to-use_18">How to Use</h3>
<p>Follow these steps to configure and use the Let's Encrypt feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>AUTO_LETS_ENCRYPT</code> setting to <code>yes</code> to enable automatic certificate issuance and renewal.</li>
<li><strong>Provide contact email:</strong> Enter your email address using the <code>EMAIL_LETS_ENCRYPT</code> setting to receive important notifications about your certificates.</li>
<li><strong>Choose challenge type:</strong> Select either <code>http</code> or <code>dns</code> verification with the <code>LETS_ENCRYPT_CHALLENGE</code> setting.</li>
<li><strong>Configure DNS provider:</strong> If using DNS challenges, specify your DNS provider and credentials.</li>
<li><strong>Select certificate profile:</strong> Choose your preferred certificate profile using the <code>LETS_ENCRYPT_PROFILE</code> setting (classic, tlsserver, or shortlived).</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, certificates are automatically issued, installed, and renewed as needed.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Certificate Profiles</p>
<p>Let's Encrypt provides different certificate profiles for different use cases:
- <strong>classic</strong>: General-purpose certificates with 90-day validity (default)
- <strong>tlsserver</strong>: Optimized for TLS server authentication with 90-day validity and smaller payload
- <strong>shortlived</strong>: Enhanced security with 7-day validity for automated environments
- <strong>custom</strong>: If your ACME server supports a different profile, set it using <code>LETS_ENCRYPT_CUSTOM_PROFILE</code>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Profile Availability</p>
<p>Note that the <code>tlsserver</code> and <code>shortlived</code> profiles may not be available in all environments or with all ACME clients at this time. The <code>classic</code> profile has the widest compatibility and is recommended for most users. If a selected profile is not available, the system will automatically fall back to the <code>classic</code> profile.</p>
</div>
<h3 id="features-configuration-settings_18">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>AUTO_LETS_ENCRYPT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Let's Encrypt:</strong> Set to <code>yes</code> to enable automatic certificate issuance and renewal.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_PASSTHROUGH</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Pass Through Let's Encrypt:</strong> Set to <code>yes</code> to pass through Let's Encrypt requests to the web server. This is useful when BunkerWeb is behind another reverse proxy handling SSL.</td>
</tr>
<tr>
<td><code>EMAIL_LETS_ENCRYPT</code></td>
<td><code>contact@{FIRST_SERVER}</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Contact Email:</strong> Email address that is used for Let's Encrypt notifications and is included in certificates.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_CHALLENGE</code></td>
<td><code>http</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Challenge Type:</strong> Method used to verify domain ownership. Options: <code>http</code> or <code>dns</code>.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_DNS_PROVIDER</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>DNS Provider:</strong> When using DNS challenges, the DNS provider to use (e.g., cloudflare, route53, digitalocean).</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_DNS_PROPAGATION</code></td>
<td><code>default</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>DNS Propagation:</strong> The time to wait for DNS propagation in seconds. If no value is provided, the provider's default propagation time is used.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Credential Item:</strong> Configuration items for DNS provider authentication (e.g., <code>cloudflare_api_token 123456</code>). Values can be raw text, base64 encoded, or a JSON object.</td>
</tr>
<tr>
<td><code>USE_LETS_ENCRYPT_WILDCARD</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Wildcard Certificates:</strong> When set to <code>yes</code>, creates wildcard certificates for all domains. Only available with DNS challenges.</td>
</tr>
<tr>
<td><code>USE_LETS_ENCRYPT_STAGING</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Use Staging:</strong> When set to <code>yes</code>, uses Let's Encrypt's staging environment for testing. Staging has higher rate limits but produces certificates that are not trusted by browsers.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_CLEAR_OLD_CERTS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Clear Old Certificates:</strong> When set to <code>yes</code>, removes old certificates that are no longer needed during renewal.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_PROFILE</code></td>
<td><code>classic</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificate Profile:</strong> Select the certificate profile to use. Options: <code>classic</code> (general-purpose), <code>tlsserver</code> (optimized for TLS servers), or <code>shortlived</code> (7-day certificates).</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_CUSTOM_PROFILE</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Custom Certificate Profile:</strong> Enter a custom certificate profile if your ACME server supports non-standard profiles. This overrides <code>LETS_ENCRYPT_PROFILE</code> if set.</td>
</tr>
<tr>
<td><code>LETS_ENCRYPT_MAX_RETRIES</code></td>
<td><code>3</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Maximum Retries:</strong> Number of times to retry certificate generation on failure. Set to <code>0</code> to disable retries. Useful for handling temporary network issues or API rate limits.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Information and behavior</p>
<ul>
<li>The <code>LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</code> setting is a multiple setting and can be used to set multiple items for the DNS provider. The items will be saved as a cache file, and Certbot will read the credentials from it.</li>
<li>If no <code>LETS_ENCRYPT_DNS_PROPAGATION</code> setting is provided, the provider's default propagation time is used.</li>
<li>Full Let's Encrypt automation using the <code>http</code> challenge works in stream mode as long as you open the <code>80/tcp</code> port from the outside. Use the <code>LISTEN_STREAM_PORT_SSL</code> setting to choose your listening SSL/TLS port.</li>
<li>If <code>LETS_ENCRYPT_PASSTHROUGH</code> is set to <code>yes</code>, BunkerWeb will not handle the ACME challenge requests itself but will pass them to the backend web server. This is useful in scenarios where BunkerWeb is acting as a reverse proxy in front of another server that is configured to handle Let's Encrypt challenges</li>
</ul>
</div>
<div class="admonition tip">
<p class="admonition-title">HTTP vs. DNS Challenges</p>
<p><strong>HTTP Challenges</strong> are easier to set up and work well for most websites:</p>
<ul>
<li>Requires your website to be publicly accessible on port 80</li>
<li>Automatically configured by BunkerWeb</li>
<li>Cannot be used for wildcard certificates</li>
</ul>
<p><strong>DNS Challenges</strong> offer more flexibility and are required for wildcard certificates:</p>
<ul>
<li>Works even when your website is not publicly accessible</li>
<li>Requires DNS provider API credentials</li>
<li>Required for wildcard certificates (e.g., *.example.com)</li>
<li>Useful when port 80 is blocked or unavailable</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Wildcard certificates</p>
<p>Wildcard certificates are only available with DNS challenges. If you want to use them, you must set the <code>USE_LETS_ENCRYPT_WILDCARD</code> setting to <code>yes</code> and properly configure your DNS provider credentials.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Rate Limits</p>
<p>Let's Encrypt imposes rate limits on certificate issuance. When testing configurations, use the staging environment by setting <code>USE_LETS_ENCRYPT_STAGING</code> to <code>yes</code> to avoid hitting production rate limits. Staging certificates are not trusted by browsers but are useful for validating your setup.</p>
</div>
<h3 id="features-supported-dns-providers">Supported DNS Providers</h3>
<p>The Let's Encrypt plugin supports a wide range of DNS providers for DNS challenges. Each provider requires specific credentials that must be provided using the <code>LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</code> setting.</p>
<table>
<thead>
<tr>
<th>Provider</th>
<th>Description</th>
<th>Mandatory Settings</th>
<th>Optional Settings</th>
<th>Documentation</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>cloudflare</code></td>
<td>Cloudflare</td>
<td>either <code>api_token</code><br>or <code>email</code> and <code>api_key</code></td>
<td></td>
<td><a href="https://certbot-dns-cloudflare.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>desec</code></td>
<td>deSEC</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://github.com/desec-io/certbot-dns-desec/blob/main/README.md">Documentation</a></td>
</tr>
<tr>
<td><code>digitalocean</code></td>
<td>DigitalOcean</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://certbot-dns-digitalocean.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>dnsimple</code></td>
<td>DNSimple</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://certbot-dns-dnsimple.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>dnsmadeeasy</code></td>
<td>DNS Made Easy</td>
<td><code>api_key</code><br><code>secret_key</code></td>
<td></td>
<td><a href="https://certbot-dns-dnsmadeeasy.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>gehirn</code></td>
<td>Gehirn DNS</td>
<td><code>api_token</code><br><code>api_secret</code></td>
<td></td>
<td><a href="https://certbot-dns-gehirn.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>google</code></td>
<td>Google Cloud</td>
<td><code>project_id</code><br><code>private_key_id</code><br><code>private_key</code><br><code>client_email</code><br><code>client_id</code><br><code>client_x509_cert_url</code></td>
<td><code>type</code> (default: <code>service_account</code>)<br><code>auth_uri</code> (default: <code>https://accounts.google.com/o/oauth2/auth</code>)<br><code>token_uri</code> (default: <code>https://accounts.google.com/o/oauth2/token</code>)<br><code>auth_provider_x509_cert_url</code> (default: <code>https://www.googleapis.com/oauth2/v1/certs</code>)</td>
<td><a href="https://certbot-dns-google.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>infomaniak</code></td>
<td>Infomaniak</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://github.com/infomaniak/certbot-dns-infomaniak">Documentation</a></td>
</tr>
<tr>
<td><code>ionos</code></td>
<td>IONOS</td>
<td><code>prefix</code><br><code>secret</code></td>
<td><code>endpoint</code> (default: <code>https://api.hosting.ionos.com</code>)</td>
<td><a href="https://github.com/helgeerbe/certbot-dns-ionos/blob/master/README.md">Documentation</a></td>
</tr>
<tr>
<td><code>linode</code></td>
<td>Linode</td>
<td><code>key</code></td>
<td></td>
<td><a href="https://certbot-dns-linode.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>luadns</code></td>
<td>LuaDNS</td>
<td><code>email</code><br><code>token</code></td>
<td></td>
<td><a href="https://certbot-dns-luadns.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>njalla</code></td>
<td>Njalla</td>
<td><code>token</code></td>
<td></td>
<td><a href="https://github.com/chaptergy/certbot-dns-njalla">Documentation</a></td>
</tr>
<tr>
<td><code>nsone</code></td>
<td>NS1</td>
<td><code>api_key</code></td>
<td></td>
<td><a href="https://certbot-dns-nsone.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>ovh</code></td>
<td>OVH</td>
<td><code>application_key</code><br><code>application_secret</code><br><code>consumer_key</code></td>
<td><code>endpoint</code> (default: <code>ovh-eu</code>)</td>
<td><a href="https://certbot-dns-ovh.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>rfc2136</code></td>
<td>RFC 2136</td>
<td><code>server</code><br><code>name</code><br><code>secret</code></td>
<td><code>port</code> (default: <code>53</code>)<br><code>algorithm</code> (default: <code>HMAC-SHA512</code>)<br><code>sign_query</code> (default: <code>false</code>)</td>
<td><a href="https://certbot-dns-rfc2136.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>route53</code></td>
<td>Amazon Route 53</td>
<td><code>access_key_id</code><br><code>secret_access_key</code></td>
<td></td>
<td><a href="https://certbot-dns-route53.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>sakuracloud</code></td>
<td>Sakura Cloud</td>
<td><code>api_token</code><br><code>api_secret</code></td>
<td></td>
<td><a href="https://certbot-dns-sakuracloud.readthedocs.io/en/stable/">Documentation</a></td>
</tr>
<tr>
<td><code>scaleway</code></td>
<td>Scaleway</td>
<td><code>application_token</code></td>
<td></td>
<td><a href="https://github.com/vanonox/certbot-dns-scaleway/blob/main/README.rst">Documentation</a></td>
</tr>
</tbody>
</table>
<h3 id="features-example-configurations_19">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="26:6"><input checked="checked" id="features-__tabbed_26_1" name="features-__tabbed_26" type="radio" /><input id="features-__tabbed_26_2" name="features-__tabbed_26" type="radio" /><input id="features-__tabbed_26_3" name="features-__tabbed_26" type="radio" /><input id="features-__tabbed_26_4" name="features-__tabbed_26" type="radio" /><input id="features-__tabbed_26_5" name="features-__tabbed_26" type="radio" /><input id="features-__tabbed_26_6" name="features-__tabbed_26" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_26_1">Basic HTTP Challenge</label><label for="features-__tabbed_26_2">Cloudflare DNS with Wildcard</label><label for="features-__tabbed_26_3">AWS Route53 Configuration</label><label for="features-__tabbed_26_4">Testing with Staging Environment and Retries</label><label for="features-__tabbed_26_5">DigitalOcean with Custom Propagation Time</label><label for="features-__tabbed_26_6">Google Cloud DNS</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Simple configuration using HTTP challenges for a single domain:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for wildcard certificates using Cloudflare DNS:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;cloudflare&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns_cloudflare_api_token</span><span class="nv"> </span><span class="s">YOUR_API_TOKEN&quot;</span>
<span class="nt">USE_LETS_ENCRYPT_WILDCARD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using Amazon Route53 for DNS challenges:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;route53&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;aws_access_key_id</span><span class="nv"> </span><span class="s">YOUR_ACCESS_KEY&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;aws_secret_access_key</span><span class="nv"> </span><span class="s">YOUR_SECRET_KEY&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for testing setup with the staging environment and enhanced retry settings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http&quot;</span>
<span class="nt">USE_LETS_ENCRYPT_STAGING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LETS_ENCRYPT_MAX_RETRIES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using DigitalOcean DNS with a longer propagation wait time:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;digitalocean&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns_digitalocean_token</span><span class="nv"> </span><span class="s">YOUR_API_TOKEN&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROPAGATION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;120&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using Google Cloud DNS with service account credentials:</p>
<div class="highlight"><pre><span></span><code><span class="nt">AUTO_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">EMAIL_LETS_ENCRYPT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;admin@example.com&quot;</span>
<span class="nt">LETS_ENCRYPT_CHALLENGE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dns&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_PROVIDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;google&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;project_id</span><span class="nv"> </span><span class="s">your-project-id&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;private_key_id</span><span class="nv"> </span><span class="s">your-private-key-id&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;private_key</span><span class="nv"> </span><span class="s">your-private-key&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_4</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;client_email</span><span class="nv"> </span><span class="s">your-service-account-email&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_5</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;client_id</span><span class="nv"> </span><span class="s">your-client-id&quot;</span>
<span class="nt">LETS_ENCRYPT_DNS_CREDENTIAL_ITEM_6</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;client_x509_cert_url</span><span class="nv"> </span><span class="s">your-cert-url&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-limit">Limit</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Limit plugin in BunkerWeb provides robust capabilities to enforce limiting policies on your website, ensuring fair usage and protecting your resources from abuse, denial-of-service attacks, and excessive resource consumption. These policies include:</p>
<ul>
<li><strong>Number of connections per IP address</strong> (STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" />)</li>
<li><strong>Number of requests per IP address and URL within a specific time period</strong> (STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" />)</li>
</ul>
<h3 id="features-how-it-works_1">How it Works</h3>
<ol>
<li><strong>Rate Limiting:</strong> Tracks the number of requests from each client IP address to specific URLs. If a client exceeds the configured rate limit, subsequent requests are temporarily denied.</li>
<li><strong>Connection Limiting:</strong> Monitors and restricts the number of concurrent connections from each client IP address. Different connection limits can be applied based on the protocol used (HTTP/1, HTTP/2, HTTP/3, or stream).</li>
<li>In both cases, clients that exceed the defined limits receive an HTTP status code <strong>"429 - Too Many Requests"</strong>, which helps prevent server overload.</li>
</ol>
<h3 id="features-steps-to-use">Steps to Use</h3>
<ol>
<li><strong>Enable Request Rate Limiting:</strong> Use <code>USE_LIMIT_REQ</code> to enable request rate limiting and define URL patterns along with their corresponding rate limits.</li>
<li><strong>Enable Connection Limiting:</strong> Use <code>USE_LIMIT_CONN</code> to enable connection limiting and set the maximum number of concurrent connections for different protocols.</li>
<li><strong>Apply Granular Control:</strong> Create multiple rate limit rules for different URLs to provide varying levels of protection across your site.</li>
<li><strong>Monitor Effectiveness:</strong> Use the <a href="#web-ui">web UI</a> to view statistics on limited requests and connections.</li>
</ol>
<h3 id="features-configuration-settings_19">Configuration Settings</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="27:2"><input checked="checked" id="features-__tabbed_27_1" name="features-__tabbed_27" type="radio" /><input id="features-__tabbed_27_2" name="features-__tabbed_27" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_27_1">Request Rate Limiting</label><label for="features-__tabbed_27_2">Connection Limiting</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_LIMIT_REQ</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Request Limiting:</strong> Set to <code>yes</code> to enable the request rate limiting feature.</td>
</tr>
<tr>
<td><code>LIMIT_REQ_URL</code></td>
<td><code>/</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>URL Pattern:</strong> URL pattern (PCRE regex) to which the rate limit will be applied; use <code>/</code> to apply for all requests.</td>
</tr>
<tr>
<td><code>LIMIT_REQ_RATE</code></td>
<td><code>2r/s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Rate Limit:</strong> Maximum request rate in the format <code>Nr/t</code>, where N is the number of requests and t is the time unit: s (second), m (minute), h (hour), or d (day).</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Rate Limiting Format</p>
<p>The rate limit format is specified as <code>Nr/t</code> where:</p>
<ul>
<li><code>N</code> is the number of requests allowed</li>
<li><code>r</code> is a literal 'r' (for 'requests')</li>
<li><code>/</code> is a literal slash</li>
<li><code>t</code> is the time unit: <code>s</code> (second), <code>m</code> (minute), <code>h</code> (hour), or <code>d</code> (day)</li>
</ul>
<p>For example, <code>5r/m</code> means that 5 requests per minute are allowed from each IP address.</p>
</div>
</div>
<div class="tabbed-block">
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_LIMIT_CONN</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Connection Limiting:</strong> Set to <code>yes</code> to enable the connection limiting feature.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_HTTP1</code></td>
<td><code>10</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP/1.X Connections:</strong> Maximum number of concurrent HTTP/1.X connections per IP address.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_HTTP2</code></td>
<td><code>100</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP/2 Streams:</strong> Maximum number of concurrent HTTP/2 streams per IP address.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_HTTP3</code></td>
<td><code>100</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP/3 Streams:</strong> Maximum number of concurrent HTTP/3 streams per IP address.</td>
</tr>
<tr>
<td><code>LIMIT_CONN_MAX_STREAM</code></td>
<td><code>10</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Stream Connections:</strong> Maximum number of concurrent stream connections per IP address.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="admonition info">
<p class="admonition-title">Connection vs. Request Limiting</p>
<ul>
<li><strong>Connection limiting</strong> restricts the number of simultaneous connections that a single IP address can maintain.</li>
<li><strong>Request rate limiting</strong> restricts the number of requests an IP address can make within a defined period of time.</li>
</ul>
<p>Using both methods provides comprehensive protection against various types of abuse.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Setting Appropriate Limits</p>
<p>Setting limits too restrictively may impact legitimate users, especially for HTTP/2 and HTTP/3 where browsers often use multiple streams. The default values are balanced for most use cases, but consider adjusting them based on your application's needs and user behavior.</p>
</div>
<h3 id="features-example-configurations_20">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="28:4"><input checked="checked" id="features-__tabbed_28_1" name="features-__tabbed_28" type="radio" /><input id="features-__tabbed_28_2" name="features-__tabbed_28" type="radio" /><input id="features-__tabbed_28_3" name="features-__tabbed_28" type="radio" /><input id="features-__tabbed_28_4" name="features-__tabbed_28" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_28_1">Basic Protection</label><label for="features-__tabbed_28_2">Protecting Specific Endpoints</label><label for="features-__tabbed_28_3">High-Traffic Site Configuration</label><label for="features-__tabbed_28_4">API Server Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration using default settings to protect your entire site:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2r/s&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with different rate limits for various endpoints:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Default rule for all requests</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10r/s&quot;</span>

<span class="c1"># Stricter limit for login page</span>
<span class="nt">LIMIT_REQ_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/login&quot;</span>
<span class="nt">LIMIT_REQ_RATE_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1r/s&quot;</span>

<span class="c1"># Stricter limit for API</span>
<span class="nt">LIMIT_REQ_URL_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/&quot;</span>
<span class="nt">LIMIT_REQ_RATE_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5r/s&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration tuned for high-traffic sites with more permissive limits:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># General limit</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30r/s&quot;</span>

<span class="c1"># Admin area protection</span>
<span class="nt">LIMIT_REQ_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/admin/&quot;</span>
<span class="nt">LIMIT_REQ_RATE_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5r/s&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;50&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;200&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;200&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;30&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration optimized for an API server with rate limits expressed in requests per minute:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_LIMIT_REQ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Public API endpoints</span>
<span class="nt">LIMIT_REQ_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/public/&quot;</span>
<span class="nt">LIMIT_REQ_RATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;120r/m&quot;</span>

<span class="c1"># Private API endpoints</span>
<span class="nt">LIMIT_REQ_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/private/&quot;</span>
<span class="nt">LIMIT_REQ_RATE_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300r/m&quot;</span>

<span class="c1"># Authentication endpoint</span>
<span class="nt">LIMIT_REQ_URL_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/auth&quot;</span>
<span class="nt">LIMIT_REQ_RATE_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10r/m&quot;</span>

<span class="nt">USE_LIMIT_CONN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100&quot;</span>
<span class="nt">LIMIT_CONN_MAX_STREAM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-load-balancer-pro">Load Balancer <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Provides load balancing feature to group of upstreams with optional healthchecks.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_DICT_SIZE</code></td>
<td><code>10m</code></td>
<td>global</td>
<td>no</td>
<td>Shared dict size (datastore for all healthchecks).</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_NAME</code></td>
<td></td>
<td>global</td>
<td>yes</td>
<td>Name of the upstream (used in REVERSE_PROXY_HOST).</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_SERVERS</code></td>
<td></td>
<td>global</td>
<td>yes</td>
<td>List of servers/IPs in the server group.</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_MODE</code></td>
<td><code>round-robin</code></td>
<td>global</td>
<td>yes</td>
<td>Load balancing mode (round-robin or sticky).</td>
</tr>
<tr>
<td><code>LOADBALANCER_UPSTREAM_RESOLVE</code></td>
<td><code>no</code></td>
<td>global</td>
<td>yes</td>
<td>Dynamically resolve upstream hostnames.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_URL</code></td>
<td><code>/status</code></td>
<td>global</td>
<td>yes</td>
<td>The healthcheck URL.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_INTERVAL</code></td>
<td><code>2000</code></td>
<td>global</td>
<td>yes</td>
<td>Healthcheck interval in milliseconds.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_TIMEOUT</code></td>
<td><code>1000</code></td>
<td>global</td>
<td>yes</td>
<td>Healthcheck timeout in milliseconds.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_FALL</code></td>
<td><code>3</code></td>
<td>global</td>
<td>yes</td>
<td>Number of failed healthchecks before marking the server as down.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_RISE</code></td>
<td><code>1</code></td>
<td>global</td>
<td>yes</td>
<td>Number of successful healthchecks before marking the server as up.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_VALID_STATUSES</code></td>
<td><code>200</code></td>
<td>global</td>
<td>yes</td>
<td>HTTP status considered valid in healthchecks.</td>
</tr>
<tr>
<td><code>LOADBALANCER_HEALTHCHECK_CONCURRENCY</code></td>
<td><code>10</code></td>
<td>global</td>
<td>yes</td>
<td>Maximum number of concurrent healthchecks.</td>
</tr>
</tbody>
</table>
<h2 id="features-metrics">Metrics</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Metrics plugin provides comprehensive monitoring and data collection capabilities for your BunkerWeb instance. This feature enables you to track various performance indicators, security events, and system statistics, giving you valuable insights into the behavior and health of your protected websites and services.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>BunkerWeb collects key metrics during the processing of requests and responses.</li>
<li>These metrics include counters for blocked requests, performance measurements, and various security-related statistics.</li>
<li>The data is stored efficiently in memory, with configurable limits to prevent excessive resource usage.</li>
<li>For multi-instance setups, Redis can be used to centralize and aggregate metrics data.</li>
<li>The collected metrics can be accessed through the API or visualized in the <a href="#web-ui">web UI</a>.</li>
<li>This information helps you identify security threats, troubleshoot issues, and optimize your configuration.</li>
</ol>
<h3 id="features-technical-implementation">Technical Implementation</h3>
<p>The metrics plugin works by:</p>
<ul>
<li>Using shared dictionaries in NGINX, where <code>metrics_datastore</code> is used for HTTP and <code>metrics_datastore_stream</code> for TCP/UDP traffic</li>
<li>Leveraging an LRU cache for efficient in-memory storage</li>
<li>Periodically synchronizing data between workers using timers</li>
<li>Storing detailed information about blocked requests, including the client IP address, country, timestamp, request details, and block reason</li>
<li>Supporting plugin-specific metrics through a common metrics collection interface</li>
<li>Providing API endpoints for querying collected metrics</li>
</ul>
<h3 id="features-how-to-use_19">How to Use</h3>
<p>Follow these steps to configure and use the Metrics feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Metrics collection is enabled by default. You can control this with the <code>USE_METRICS</code> setting.</li>
<li><strong>Configure memory allocation:</strong> Set the amount of memory to allocate for metrics storage using the <code>METRICS_MEMORY_SIZE</code> setting.</li>
<li><strong>Set storage limits:</strong> Define how many blocked requests to store per worker and in Redis with the respective settings.</li>
<li><strong>Access the data:</strong> View the collected metrics through the <a href="#web-ui">web UI</a> or API endpoints.</li>
<li><strong>Analyze the information:</strong> Use the gathered data to identify patterns, detect security issues, and optimize your configuration.</li>
</ol>
<h3 id="features-collected-metrics">Collected Metrics</h3>
<p>The metrics plugin collects the following information:</p>
<ol>
<li>
<p><strong>Blocked Requests</strong>: For each blocked request, the following data is stored:</p>
<ul>
<li>Request ID and timestamp</li>
<li>Client IP address and country (when available)</li>
<li>HTTP method and URL</li>
<li>HTTP status code</li>
<li>User agent</li>
<li>Block reason and security mode</li>
<li>Server name</li>
<li>Additional data related to the block reason</li>
</ul>
</li>
<li>
<p><strong>Plugin Counters</strong>: Various plugin-specific counters that track activities and events.</p>
</li>
</ol>
<h3 id="features-api-access">API Access</h3>
<p>Metrics data can be accessed via BunkerWeb's internal API endpoints:</p>
<ul>
<li><strong>Endpoint</strong>: <code>/metrics/{filter}</code></li>
<li><strong>Method</strong>: GET</li>
<li><strong>Description</strong>: Retrieves metrics data based on the specified filter</li>
<li><strong>Response Format</strong>: JSON object containing the requested metrics</li>
</ul>
<p>For example, <code>/metrics/requests</code> returns information about blocked requests.</p>
<div class="admonition info">
<p class="admonition-title">API Access Configuration</p>
<p>To access metrics via the API, you must ensure that:</p>
<ol>
<li>The API feature is enabled with <code>USE_API: "yes"</code> (enabled by default)</li>
<li>Your client IP is included in the <code>API_WHITELIST_IP</code> setting (default is <code>127.0.0.0/8</code>)</li>
<li>You are accessing the API on the configured port (default is <code>5000</code> via the <code>API_HTTP_PORT</code> setting)</li>
<li>You are using the correct <code>API_SERVER_NAME</code> value in the Host header (default is <code>bwapi</code>)</li>
</ol>
<p>A typical API request would look like:
<div class="highlight"><pre><span></span><code>curl -H &quot;Host: bwapi&quot; http://your-bunkerweb-instance:5000/metrics/requests
</code></pre></div></p>
<p>If you have customized the <code>API_SERVER_NAME</code> to something other than the default <code>bwapi</code>, use that value in the Host header instead.</p>
<p>For secure production environments, make sure to restrict API access to trusted IPs only.</p>
</div>
<h3 id="features-configuration-settings_20">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_METRICS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Metrics:</strong> Set to <code>yes</code> to enable collection and retrieval of metrics.</td>
</tr>
<tr>
<td><code>METRICS_MEMORY_SIZE</code></td>
<td><code>16m</code></td>
<td>global</td>
<td>no</td>
<td><strong>Memory Size:</strong> Size of the internal storage for metrics (e.g., <code>16m</code>, <code>32m</code>).</td>
</tr>
<tr>
<td><code>METRICS_MAX_BLOCKED_REQUESTS</code></td>
<td><code>1000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Max Blocked Requests:</strong> Maximum number of blocked requests to store per worker.</td>
</tr>
<tr>
<td><code>METRICS_MAX_BLOCKED_REQUESTS_REDIS</code></td>
<td><code>100000</code></td>
<td>global</td>
<td>no</td>
<td><strong>Max Redis Blocked Requests:</strong> Maximum number of blocked requests to store in Redis.</td>
</tr>
<tr>
<td><code>METRICS_SAVE_TO_REDIS</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Save Metrics to Redis:</strong> Set to <code>yes</code> to save metrics (counters and tables) to Redis for cluster-wide aggregation.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Sizing Memory Allocation</p>
<p>The <code>METRICS_MEMORY_SIZE</code> setting should be adjusted based on your traffic volume and the number of instances. For high-traffic sites, consider increasing this value to ensure all metrics are captured without data loss.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Redis Integration</p>
<p>When BunkerWeb is configured to use <a href="#features-redis">Redis</a>, the metrics plugin will automatically synchronize blocked request data to the Redis server. This provides a centralized view of security events across multiple BunkerWeb instances.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Performance Considerations</p>
<p>Setting very high values for <code>METRICS_MAX_BLOCKED_REQUESTS</code> or <code>METRICS_MAX_BLOCKED_REQUESTS_REDIS</code> can increase memory usage. Monitor your system resources and adjust these values according to your actual needs and available resources.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Worker-Specific Storage</p>
<p>Each NGINX worker maintains its own metrics in memory. When accessing metrics through the API, data from all workers is automatically aggregated to provide a complete view.</p>
</div>
<h3 id="features-example-configurations_21">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="29:4"><input checked="checked" id="features-__tabbed_29_1" name="features-__tabbed_29" type="radio" /><input id="features-__tabbed_29_2" name="features-__tabbed_29" type="radio" /><input id="features-__tabbed_29_3" name="features-__tabbed_29" type="radio" /><input id="features-__tabbed_29_4" name="features-__tabbed_29" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_29_1">Basic Configuration</label><label for="features-__tabbed_29_2">Low-Resource Environment</label><label for="features-__tabbed_29_3">High-Traffic Environment</label><label for="features-__tabbed_29_4">Metrics Disabled</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Default configuration suitable for most deployments:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">METRICS_MEMORY_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;16m&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;100000&quot;</span>
<span class="nt">METRICS_SAVE_TO_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration optimized for environments with limited resources:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">METRICS_MEMORY_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;8m&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10000&quot;</span>
<span class="nt">METRICS_SAVE_TO_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for high-traffic websites that need to track more security events:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">METRICS_MEMORY_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;64m&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5000&quot;</span>
<span class="nt">METRICS_MAX_BLOCKED_REQUESTS_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500000&quot;</span>
<span class="nt">METRICS_SAVE_TO_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with metrics collection disabled:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_METRICS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-migration-pro">Migration <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>Migration of BunkerWeb configuration between instances made easy via the web UI</p>
<h2 id="features-miscellaneous">Miscellaneous</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Miscellaneous plugin provides <strong>essential baseline settings</strong> that help maintain the security and functionality of your website. This core component offers comprehensive controls for:</p>
<ul>
<li><strong>Server behavior</strong> - Configure how your server responds to various requests</li>
<li><strong>HTTP settings</strong> - Manage methods, request sizes, and protocol options</li>
<li><strong>File management</strong> - Control static file serving and optimize delivery</li>
<li><strong>Protocol support</strong> - Enable modern HTTP protocols for better performance</li>
<li><strong>System configurations</strong> - Extend functionality and improve security</li>
</ul>
<p>Whether you need to restrict HTTP methods, manage request sizes, optimize file caching, or control how your server responds to various requests, this plugin gives you the tools to <strong>fine-tune your web service's behavior</strong> while optimizing both performance and security.</p>
<h3 id="features-key-features">Key Features</h3>
<table>
<thead>
<tr>
<th>Feature Category</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>HTTP Method Control</strong></td>
<td>Define which HTTP methods are acceptable for your application</td>
</tr>
<tr>
<td><strong>Default Server Protection</strong></td>
<td>Prevent unauthorized access through hostname mismatches and enforce SNI for secure connections</td>
</tr>
<tr>
<td><strong>Request Size Management</strong></td>
<td>Set limits for client request bodies and file uploads</td>
</tr>
<tr>
<td><strong>Static File Serving</strong></td>
<td>Configure and optimize delivery of static content from custom root folders</td>
</tr>
<tr>
<td><strong>File Caching</strong></td>
<td>Improve performance through advanced file descriptor caching mechanisms with customizable settings</td>
</tr>
<tr>
<td><strong>Protocol Support</strong></td>
<td>Configure modern HTTP protocol options (HTTP2/HTTP3) and Alt-Svc port settings</td>
</tr>
<tr>
<td><strong>Anonymous Reporting</strong></td>
<td>Optional usage statistics reporting to help improve BunkerWeb</td>
</tr>
<tr>
<td><strong>External Plugin Support</strong></td>
<td>Extend functionality by integrating external plugins through URLs</td>
</tr>
<tr>
<td><strong>HTTP Status Control</strong></td>
<td>Configure how your server responds when denying requests (including connection termination)</td>
</tr>
</tbody>
</table>
<h3 id="features-configuration-guide_1">Configuration Guide</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="30:8"><input checked="checked" id="features-__tabbed_30_1" name="features-__tabbed_30" type="radio" /><input id="features-__tabbed_30_2" name="features-__tabbed_30" type="radio" /><input id="features-__tabbed_30_3" name="features-__tabbed_30" type="radio" /><input id="features-__tabbed_30_4" name="features-__tabbed_30" type="radio" /><input id="features-__tabbed_30_5" name="features-__tabbed_30" type="radio" /><input id="features-__tabbed_30_6" name="features-__tabbed_30" type="radio" /><input id="features-__tabbed_30_7" name="features-__tabbed_30" type="radio" /><input id="features-__tabbed_30_8" name="features-__tabbed_30" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_30_1">Default Server Security</label><label for="features-__tabbed_30_2">Deny HTTP Status</label><label for="features-__tabbed_30_3">HTTP Methods</label><label for="features-__tabbed_30_4">Request Size Limits</label><label for="features-__tabbed_30_5">Protocol Support</label><label for="features-__tabbed_30_6">Static File Serving</label><label for="features-__tabbed_30_7">System Settings</label><label for="features-__tabbed_30_8">File Caching</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Default Server Controls</strong></p>
<p>In HTTP, the <code>Host</code> header specifies the target server, but it may be missing or unknown, often due to bots scanning for vulnerabilities.</p>
<p>To block such requests:</p>
<ul>
<li>Set <code>DISABLE_DEFAULT_SERVER</code> to <code>yes</code> to silently deny such requests using <a href="https://http.dev/444">NGINX's <code>444</code> status code</a>.</li>
<li>For stricter security, enable <code>DISABLE_DEFAULT_SERVER_STRICT_SNI</code> to reject SSL/TLS connections without valid SNI.</li>
</ul>
<div class="admonition success">
<p class="admonition-title">Security Benefits</p>
<ul>
<li>Blocks Host header manipulation and virtual host scanning</li>
<li>Mitigates HTTP request smuggling risks</li>
<li>Removes the default server as an attack vector</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DISABLE_DEFAULT_SERVER</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Default Server:</strong> Set to <code>yes</code> to disable the default server when no hostname matches the request.</td>
</tr>
<tr>
<td><code>DISABLE_DEFAULT_SERVER_STRICT_SNI</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Strict SNI:</strong> When set to <code>yes</code>, requires SNI for HTTPS connections and rejects connections without valid SNI.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">SNI Enforcement</p>
<p>Enabling strict SNI validation provides stronger security but may cause issues if BunkerWeb is behind a reverse proxy that forwards HTTPS requests without preserving SNI information. Test thoroughly before enabling in production environments.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>HTTP Status Control</strong></p>
<p>The first step in handling denied client access is defining the appropriate action. This can be configured using the <code>DENY_HTTP_STATUS</code> setting. When BunkerWeb denies a request, you can control its response using this setting. By default, it returns a <code>403 Forbidden</code> status, displaying a web page or custom content to the client.</p>
<p>Alternatively, setting it to <code>444</code> closes the connection immediately without sending any response. This <a href="https://http.dev/444">non-standard status code</a>, specific to NGINX, is useful for silently dropping unwanted requests.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>DENY_HTTP_STATUS</code></td>
<td><code>403</code></td>
<td>global</td>
<td>no</td>
<td><strong>Deny HTTP Status:</strong> HTTP status code to send when request is denied (403 or 444). Code 444 closes the connection.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">444 Status Code considerations</p>
<p>Since clients receive no feedback, troubleshooting can be more challenging. Setting <code>444</code> is recommended only if you have thoroughly addressed false positives, are experienced with BunkerWeb, and require a higher level of security.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Stream mode</p>
<p>In <strong>stream mode</strong>, this setting is always enforced as <code>444</code>, meaning the connection will be closed, regardless of the configured value.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>HTTP Method Control</strong></p>
<p>Restricting HTTP methods to only those required by your application is a fundamental security measure that adheres to the principle of least privilege. By explicitly defining acceptable HTTP methods, you can minimize the risk of exploitation through unused or dangerous methods.</p>
<p>This feature is configured using the <code>ALLOWED_METHODS</code> setting, where methods are listed and separated by a <code>|</code> (default: <code>GET|POST|HEAD</code>). If a client attempts to use a method not listed, the server will respond with a <strong>405 - Method Not Allowed</strong> status.</p>
<p>For most websites, the default <code>GET|POST|HEAD</code> is sufficient. If your application uses RESTful APIs, you may need to include methods like <code>PUT</code> and <code>DELETE</code>.</p>
<div class="admonition success">
<p class="admonition-title">Security Benefits</p>
<ul>
<li>Prevents exploitation of unused or unnecessary HTTP methods</li>
<li>Reduces the attack surface by disabling potentially harmful methods</li>
<li>Blocks HTTP method enumeration techniques used by attackers</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>ALLOWED_METHODS</code></td>
<td><code>GET    | POST    | HEAD</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP Methods:</strong> List of HTTP methods that are allowed, separated by pipe characters.</td>
</tr>
</tbody>
</table>
<div class="admonition abstract">
<p class="admonition-title">CORS and Pre-flight Requests</p>
<p>If your application supports <a href="#features-cors">Cross-Origin Resource Sharing (CORS)</a>, you should include the <code>OPTIONS</code> method in the <code>ALLOWED_METHODS</code> setting to handle pre-flight requests. This ensures proper functionality for browsers making cross-origin requests.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Security Considerations</p>
<ul>
<li><strong>Avoid enabling <code>TRACE</code> or <code>CONNECT</code>:</strong> These methods are rarely needed and can introduce significant security risks, such as enabling Cross-Site Tracing (XST) or tunneling attacks.</li>
<li><strong>Regularly review allowed methods:</strong> Periodically audit the <code>ALLOWED_METHODS</code> setting to ensure it aligns with your application's current requirements.</li>
<li><strong>Test thoroughly before deployment:</strong> Changes to HTTP method restrictions can impact application functionality. Validate your configuration in a staging environment before applying it to production.</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><strong>Request Size Limits</strong></p>
<p>The maximum request body size can be controlled using the <code>MAX_CLIENT_SIZE</code> setting (default: <code>10m</code>). Accepted values follow the syntax described <a href="https://nginx.org/en/docs/syntax.html">here</a>.</p>
<div class="admonition success">
<p class="admonition-title">Security Benefits</p>
<ul>
<li>Protects against denial-of-service attacks caused by excessive payload sizes</li>
<li>Mitigates buffer overflow vulnerabilities</li>
<li>Prevents file upload attacks</li>
<li>Reduces the risk of server resource exhaustion</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>MAX_CLIENT_SIZE</code></td>
<td><code>10m</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Maximum Request Size:</strong> The maximum allowed size for client request bodies (e.g., file uploads).</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Request Size Configuration Best Practices</p>
<p>If you need to allow a request body of unlimited size, you can set the <code>MAX_CLIENT_SIZE</code> value to <code>0</code>. However, this is <strong>not recommended</strong> due to potential security and performance risks.</p>
<p><strong>Best Practices:</strong></p>
<ul>
<li>Always configure <code>MAX_CLIENT_SIZE</code> to the smallest value that meets your application's legitimate requirements.</li>
<li>Regularly review and adjust this setting to align with your application's evolving needs.</li>
<li>Avoid setting <code>0</code> unless absolutely necessary, as it can expose your server to denial-of-service attacks and resource exhaustion.</li>
</ul>
<p>By carefully managing this setting, you can ensure optimal security and performance for your application.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>HTTP Protocol Settings</strong></p>
<p>Modern HTTP protocols like HTTP/2 and HTTP/3 improve performance and security. BunkerWeb allows easy configuration of these protocols.</p>
<div class="admonition success">
<p class="admonition-title">Security and Performance Benefits</p>
<ul>
<li><strong>Security Advantages:</strong> Modern protocols like HTTP/2 and HTTP/3 enforce TLS/HTTPS by default, reduce susceptibility to certain attacks, and improve privacy through encrypted headers (HTTP/3).</li>
<li><strong>Performance Benefits:</strong> Features like multiplexing, header compression, server push, and binary data transfer enhance speed and efficiency.</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>LISTEN_HTTP</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP Listen:</strong> Respond to (insecure) HTTP requests when set to <code>yes</code>.</td>
</tr>
<tr>
<td><code>HTTP2</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP2:</strong> Support HTTP2 protocol when HTTPS is enabled.</td>
</tr>
<tr>
<td><code>HTTP3</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP3:</strong> Support HTTP3 protocol when HTTPS is enabled.</td>
</tr>
<tr>
<td><code>HTTP3_ALT_SVC_PORT</code></td>
<td><code>443</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP3 Alt-Svc Port:</strong> Port to use in the Alt-Svc header for HTTP3.</td>
</tr>
</tbody>
</table>
<div class="admonition example">
<p class="admonition-title">About HTTP/3</p>
<p>HTTP/3, the latest version of the Hypertext Transfer Protocol, uses QUIC over UDP instead of TCP, addressing issues like head-of-line blocking for faster, more reliable connections.</p>
<p>NGINX introduced experimental support for HTTP/3 and QUIC starting with version 1.25.0. However, this feature is still experimental, and caution is advised for production use. For more details, see <a href="https://nginx.org/en/docs/quic.html">NGINX's official documentation</a>.</p>
<p>Thorough testing is recommended before enabling HTTP/3 in production environments.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>File Serving Configuration</strong></p>
<p>BunkerWeb can serve static files directly or act as a reverse proxy to an application server. By default, files are served from <code>/var/www/html/{server_name}</code>.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SERVE_FILES</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Serve Files:</strong> When set to <code>yes</code>, BunkerWeb will serve static files from the configured root folder.</td>
</tr>
<tr>
<td><code>ROOT_FOLDER</code></td>
<td><code>/var/www/html/{server_name}</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Root Folder:</strong> The directory from which to serve static files. Empty means use the default location.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Best Practices for Static File Serving</p>
<ul>
<li><strong>Direct Serving:</strong> Enable file serving (<code>SERVE_FILES=yes</code>) when BunkerWeb is responsible for serving static files directly.</li>
<li><strong>Reverse Proxy:</strong> If BunkerWeb acts as a reverse proxy, <strong>deactivate file serving</strong> (<code>SERVE_FILES=no</code>) to reduce the attack surface and avoid exposing unnecessary directories.</li>
<li><strong>Permissions:</strong> Ensure proper file permissions and path configurations to prevent unauthorized access.</li>
<li><strong>Security:</strong> Avoid exposing sensitive directories or files through misconfigurations.</li>
</ul>
<p>By carefully managing static file serving, you can optimize performance while maintaining a secure environment.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>Plugin and System Management</strong></p>
<p>These settings manage BunkerWeb's interaction with external systems and contribute to improving the product through optional anonymous usage statistics.</p>
<p><strong>Anonymous Reporting</strong></p>
<p>Anonymous reporting provides the BunkerWeb team with insights into how the software is being used. This helps identify areas for improvement and prioritize feature development. The reports are strictly statistical and do not include any sensitive or personally identifiable information. They cover:</p>
<ul>
<li>Enabled features</li>
<li>General configuration patterns</li>
</ul>
<p>You can disable this feature if desired by setting <code>SEND_ANONYMOUS_REPORT</code> to <code>no</code>.</p>
<p><strong>External Plugins</strong></p>
<p>External plugins enable you to extend BunkerWeb's functionality by integrating third-party modules. This allows for additional customization and advanced use cases.</p>
<div class="admonition danger">
<p class="admonition-title">External Plugin Security</p>
<p><strong>External plugins can introduce security risks if not properly vetted.</strong> Follow these best practices to minimize potential threats:</p>
<ul>
<li>Only use plugins from trusted sources.</li>
<li>Verify plugin integrity using checksums when available.</li>
<li>Regularly review and update plugins to ensure security and compatibility.</li>
</ul>
<p>For more details, refer to the <a href="#plugins">Plugins documentation</a>.</p>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SEND_ANONYMOUS_REPORT</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Anonymous Reports:</strong> Send anonymous usage reports to BunkerWeb maintainers.</td>
</tr>
<tr>
<td><code>EXTERNAL_PLUGIN_URLS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>External Plugins:</strong> URLs for external plugins to download (space-separated).</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>File Cache Optimization</strong></p>
<p>The open file cache improves performance by storing file descriptors and metadata in memory, reducing the need for repeated file system operations.</p>
<div class="admonition success">
<p class="admonition-title">Benefits of File Caching</p>
<ul>
<li><strong>Performance:</strong> Reduces filesystem I/O, decreases latency, and lowers CPU usage for file operations.</li>
<li><strong>Security:</strong> Mitigates timing attacks by caching error responses and reduces the impact of DoS attacks targeting the filesystem.</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_OPEN_FILE_CACHE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Cache:</strong> Enable caching of file descriptors and metadata to improve performance.</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE</code></td>
<td><code>max=1000 inactive=20s</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Configuration:</strong> Configure the open file cache (e.g., maximum entries and inactive timeout).</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE_ERRORS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Errors:</strong> Cache file descriptor lookup errors as well as successful lookups.</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE_MIN_USES</code></td>
<td><code>2</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Minimum Uses:</strong> Minimum number of accesses during the inactive period for a file to remain cached.</td>
</tr>
<tr>
<td><code>OPEN_FILE_CACHE_VALID</code></td>
<td><code>30s</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Validity:</strong> Time after which cached elements are revalidated.</td>
</tr>
</tbody>
</table>
<p><strong>Configuration Guide</strong></p>
<p>To enable and configure file caching:
1. Set <code>USE_OPEN_FILE_CACHE</code> to <code>yes</code> to activate the feature.
2. Adjust <code>OPEN_FILE_CACHE</code> parameters to define the maximum number of cached entries and their inactive timeout.
3. Use <code>OPEN_FILE_CACHE_ERRORS</code> to cache both successful and failed lookups, reducing repeated filesystem operations.
4. Set <code>OPEN_FILE_CACHE_MIN_USES</code> to specify the minimum number of accesses required for a file to remain cached.
5. Define the cache validity period with <code>OPEN_FILE_CACHE_VALID</code> to control how often cached elements are revalidated.</p>
<div class="admonition tip">
<p class="admonition-title">Best Practices</p>
<ul>
<li>Enable file caching for websites with many static files to improve performance.</li>
<li>Regularly review and fine-tune cache settings to balance performance and resource usage.</li>
<li>In dynamic environments where files change frequently, consider reducing the cache validity period or disabling the feature to ensure content freshness.</li>
</ul>
</div>
</div>
</div>
</div>
<h3 id="features-example-configurations_22">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="31:7"><input checked="checked" id="features-__tabbed_31_1" name="features-__tabbed_31" type="radio" /><input id="features-__tabbed_31_2" name="features-__tabbed_31" type="radio" /><input id="features-__tabbed_31_3" name="features-__tabbed_31" type="radio" /><input id="features-__tabbed_31_4" name="features-__tabbed_31" type="radio" /><input id="features-__tabbed_31_5" name="features-__tabbed_31" type="radio" /><input id="features-__tabbed_31_6" name="features-__tabbed_31" type="radio" /><input id="features-__tabbed_31_7" name="features-__tabbed_31" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_31_1">Default Server Security</label><label for="features-__tabbed_31_2">Deny HTTP Status</label><label for="features-__tabbed_31_3">HTTP Methods</label><label for="features-__tabbed_31_4">Request Size Limits</label><label for="features-__tabbed_31_5">Protocol Support</label><label for="features-__tabbed_31_6">Static File Serving</label><label for="features-__tabbed_31_7">File Caching</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Example configuration for disabling the default server and enforcing strict SNI:</p>
<div class="highlight"><pre><span></span><code><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">DISABLE_DEFAULT_SERVER_STRICT_SNI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for silently dropping unwanted requests:</p>
<div class="highlight"><pre><span></span><code><span class="nt">DENY_HTTP_STATUS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;444&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for restricting HTTP methods to only those required by a RESTful API:</p>
<div class="highlight"><pre><span></span><code><span class="nt">ALLOWED_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET|POST|PUT|DELETE&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for limiting the maximum request body size:</p>
<div class="highlight"><pre><span></span><code><span class="nt">MAX_CLIENT_SIZE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5m&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling HTTP/2 and HTTP/3 with a custom Alt-Svc port:</p>
<div class="highlight"><pre><span></span><code><span class="nt">HTTP2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">HTTP3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">HTTP3_ALT_SVC_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;443&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for serving static files from a custom root folder:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SERVE_FILES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">ROOT_FOLDER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/custom-folder&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Example configuration for enabling and optimizing file caching:</p>
<p>```yaml
USE_OPEN_FILE_CACHE: "yes"
OPEN_FILE_CACHE: "max=2000 inactive=30s"
OPEN_FILE_CACHE_ERRORS: "yes"
OPEN_FILE_CACHE_MIN_USES: "3"
OPEN_FILE_CACHE_VALID: "60s"</p>
</div>
</div>
</div>
<h2 id="features-modsecurity">ModSecurity</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The ModSecurity plugin integrates the powerful <a href="https://modsecurity.org">ModSecurity</a> Web Application Firewall (WAF) into BunkerWeb. This integration delivers robust protection against a wide range of web attacks by leveraging the <a href="https://coreruleset.org">OWASP Core Rule Set (CRS)</a> to detect and block threats such as SQL injection, cross-site scripting (XSS), local file inclusion, and more.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a request is received, ModSecurity evaluates it against the active rule set.</li>
<li>The OWASP Core Rule Set inspects headers, cookies, URL parameters, and body content.</li>
<li>Each detected violation contributes to an overall anomaly score.</li>
<li>If this score exceeds the configured threshold, the request is blocked.</li>
<li>Detailed logs are created to help diagnose which rules were triggered and why.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Key benefits</p>
<ol>
<li><strong>Industry Standard Protection:</strong> Utilizes the widely used open-source ModSecurity firewall.</li>
<li><strong>OWASP Core Rule Set:</strong> Employs community-maintained rules covering the OWASP Top Ten and more.</li>
<li><strong>Configurable Security Levels:</strong> Adjust paranoia levels to balance security with potential false positives.</li>
<li><strong>Detailed Logging:</strong> Provides thorough audit logs for attack analysis.</li>
<li><strong>Plugin Support:</strong> Extend protection with optional CRS plugins tailored to your applications.</li>
</ol>
</div>
<h3 id="features-how-to-use_20">How to Use</h3>
<p>Follow these steps to configure and use ModSecurity:</p>
<ol>
<li><strong>Enable the feature:</strong> ModSecurity is enabled by default. This can be controlled using the <code>USE_MODSECURITY</code> setting.</li>
<li><strong>Select a CRS version:</strong> Choose a version of the OWASP Core Rule Set (v3, v4, or nightly).</li>
<li><strong>Add plugins:</strong> Optionally activate CRS plugins to enhance rule coverage.</li>
<li><strong>Monitor and tune:</strong> Use logs and the <a href="#web-ui">web UI</a> to identify false positives and adjust settings.</li>
</ol>
<h3 id="features-configuration-settings_21">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_MODSECURITY</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable ModSecurity:</strong> Turn on ModSecurity Web Application Firewall protection.</td>
</tr>
<tr>
<td><code>USE_MODSECURITY_CRS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Use Core Rule Set:</strong> Enable the OWASP Core Rule Set for ModSecurity.</td>
</tr>
<tr>
<td><code>MODSECURITY_CRS_VERSION</code></td>
<td><code>4</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>CRS Version:</strong> The version of the OWASP Core Rule Set to use. Options: <code>3</code>, <code>4</code>, or <code>nightly</code>.</td>
</tr>
<tr>
<td><code>MODSECURITY_SEC_RULE_ENGINE</code></td>
<td><code>On</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Rule Engine:</strong> Control whether rules are enforced. Options: <code>On</code>, <code>DetectionOnly</code>, or <code>Off</code>.</td>
</tr>
<tr>
<td><code>MODSECURITY_SEC_AUDIT_ENGINE</code></td>
<td><code>RelevantOnly</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Audit Engine:</strong> Control how audit logging works. Options: <code>On</code>, <code>Off</code>, or <code>RelevantOnly</code>.</td>
</tr>
<tr>
<td><code>MODSECURITY_SEC_AUDIT_LOG_PARTS</code></td>
<td><code>ABIJDEFHZ</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Audit Log Parts:</strong> Which parts of requests/responses to include in audit logs.</td>
</tr>
<tr>
<td><code>MODSECURITY_REQ_BODY_NO_FILES_LIMIT</code></td>
<td><code>131072</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Request Body Limit:</strong> Maximum size (in bytes) for request bodies that don't include file uploads.</td>
</tr>
<tr>
<td><code>USE_MODSECURITY_CRS_PLUGINS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable CRS Plugins:</strong> Enable additional plugin rule sets for the Core Rule Set.</td>
</tr>
<tr>
<td><code>MODSECURITY_CRS_PLUGINS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>CRS Plugins List:</strong> Space-separated list of plugins to download and install (<code>plugin-name[/tag]</code> or URL).</td>
</tr>
<tr>
<td><code>USE_MODSECURITY_GLOBAL_CRS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Global CRS:</strong> When enabled, applies CRS rules globally at the HTTP level rather than per server.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">ModSecurity and the OWASP Core Rule Set</p>
<p><strong>We strongly recommend keeping both ModSecurity and the OWASP Core Rule Set (CRS) enabled</strong> to provide robust protection against common web vulnerabilities. While occasional false positives may occur, they can be resolved with some effort by fine-tuning rules or using predefined exclusions.</p>
<p>The CRS team actively maintains a list of exclusions for popular applications such as WordPress, Nextcloud, Drupal, and Cpanel, making it easier to integrate without impacting functionality. The security benefits far outweigh the minimal configuration effort required to address false positives.</p>
</div>
<h3 id="features-available-crs-versions">Available CRS Versions</h3>
<p>Select a CRS version to best match your security needs:</p>
<ul>
<li><strong><code>3</code></strong>: Stable <a href="https://github.com/coreruleset/coreruleset/releases/tag/v3.3.7">v3.3.7</a>.</li>
<li><strong><code>4</code></strong>: Stable <a href="https://github.com/coreruleset/coreruleset/releases/tag/v4.16.0">v4.16.0</a> (<strong>default</strong>).</li>
<li><strong><code>nightly</code></strong>: <a href="https://github.com/coreruleset/coreruleset/releases/tag/nightly">Nightly build</a> offering the latest rule updates.</li>
</ul>
<div class="admonition example">
<p class="admonition-title">Nightly Build</p>
<p>The <strong>nightly build</strong> contains the most up-to-date rules, offering the latest protections against emerging threats. However, since it is updated daily and may include experimental or untested changes, it is recommended to first use the nightly build in a <strong>staging environment</strong> before deploying it in production.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Paranoia Levels</p>
<p>The OWASP Core Rule Set uses "paranoia levels" (PL) to control rule strictness:</p>
<ul>
<li><strong>PL1 (default):</strong> Basic protection with minimal false positives</li>
<li><strong>PL2:</strong> Tighter security with more strict pattern matching</li>
<li><strong>PL3:</strong> Enhanced security with stricter validation</li>
<li><strong>PL4:</strong> Maximum security with very strict rules (may cause many false positives)</li>
</ul>
<p>You can set the paranoia level by adding a custom configuration file in <code>/etc/bunkerweb/configs/modsec-crs/</code>.</p>
</div>
<h3 id="features-custom-configurations">Custom Configurations</h3>
<p>Tuning ModSecurity and the OWASP Core Rule Set (CRS) can be achieved through custom configurations. These configurations allow you to customize behavior at specific stages of the security rules processing:</p>
<ul>
<li><strong><code>modsec-crs</code></strong>: Applied <strong>before</strong> the OWASP Core Rule Set is loaded.</li>
<li><strong><code>modsec</code></strong>: Applied <strong>after</strong> the OWASP Core Rule Set is loaded. This is also used if the CRS is not loaded at all.</li>
<li><strong><code>crs-plugins-before</code></strong>: Applied <strong>before</strong> the CRS plugins are loaded.</li>
<li><strong><code>crs-plugins-after</code></strong>: Applied <strong>after</strong> the CRS plugins are loaded.</li>
</ul>
<p>This structure provides flexibility, allowing you to fine-tune ModSecurity and CRS settings to suit your application's specific needs while maintaining a clear configuration flow.</p>
<h4 id="features-adding-crs-exclusions-with-modsec-crs">Adding CRS Exclusions with <code>modsec-crs</code></h4>
<p>You can use a custom configuration of type <code>modsec-crs</code> to add exclusions for specific use cases, such as enabling predefined exclusions for WordPress:</p>
<div class="highlight"><pre><span></span><code>SecAction \
 &quot;id:900130,\
  phase:1,\
  nolog,\
  pass,\
  t:none,\
  setvar:tx.crs_exclusions_wordpress=1&quot;
</code></pre></div>
<p>In this example:</p>
<ul>
<li>The action is executed in <strong>Phase 1</strong> (early in the request lifecycle).</li>
<li>It enables WordPress-specific CRS exclusions by setting the variable <code>tx.crs_exclusions_wordpress</code>.</li>
</ul>
<h4 id="features-updating-crs-rules-with-modsec">Updating CRS Rules with <code>modsec</code></h4>
<p>To fine-tune the loaded CRS rules, you can use a custom configuration of type <code>modsec</code>. For example, you can remove specific rules or tags for certain request paths:</p>
<div class="highlight"><pre><span></span><code>SecRule REQUEST_FILENAME &quot;/wp-admin/admin-ajax.php&quot; &quot;id:1,ctl:ruleRemoveByTag=attack-xss,ctl:ruleRemoveByTag=attack-rce&quot;
SecRule REQUEST_FILENAME &quot;/wp-admin/options.php&quot; &quot;id:2,ctl:ruleRemoveByTag=attack-xss&quot;
SecRule REQUEST_FILENAME &quot;^/wp-json/yoast&quot; &quot;id:3,ctl:ruleRemoveById=930120&quot;
</code></pre></div>
<p>In this example:</p>
<ul>
<li><strong>Rule 1</strong>: Removes rules tagged as <code>attack-xss</code> and <code>attack-rce</code> for requests to <code>/wp-admin/admin-ajax.php</code>.</li>
<li><strong>Rule 2</strong>: Removes rules tagged as <code>attack-xss</code> for requests to <code>/wp-admin/options.php</code>.</li>
<li><strong>Rule 3</strong>: Removes a specific rule (ID <code>930120</code>) for requests matching <code>/wp-json/yoast</code>.</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Order of execution</p>
<p>The execution order for ModSecurity in BunkerWeb is as follows, ensuring a clear and logical progression of rule application:</p>
<ol>
<li><strong>OWASP CRS Configuration</strong>: Base configuration for the OWASP Core Rule Set.</li>
<li><strong>Custom Plugins Configuration (<code>crs-plugins-before</code>)</strong>: Settings specific to plugins, applied before any CRS rules.</li>
<li><strong>Custom Plugin Rules (Before CRS Rules) (<code>crs-plugins-before</code>)</strong>: Custom rules for plugins executed prior to CRS rules.</li>
<li><strong>Downloaded Plugins Configuration</strong>: Configuration for externally downloaded plugins.</li>
<li><strong>Downloaded Plugin Rules (Before CRS Rules)</strong>: Rules for downloaded plugins executed before CRS rules.</li>
<li><strong>Custom CRS Rules (<code>modsec-crs</code>)</strong>: User-defined rules applied before loading the CRS rules.</li>
<li><strong>OWASP CRS Rules</strong>: The core set of security rules provided by OWASP.</li>
<li><strong>Custom Plugin Rules (After CRS Rules) (<code>crs-plugins-after</code>)</strong>: Custom plugin rules executed after CRS rules.</li>
<li><strong>Downloaded Plugin Rules (After CRS Rules)</strong>: Rules for downloaded plugins executed after CRS rules.</li>
<li><strong>Custom Rules (<code>modsec</code>)</strong>: User-defined rules applied after all CRS and plugin rules.</li>
</ol>
<p><strong>Key Notes</strong>:</p>
<ul>
<li><strong>Pre-CRS customizations</strong> (<code>crs-plugins-before</code>, <code>modsec-crs</code>) allow you to define exceptions or preparatory rules before the core CRS rules are loaded.</li>
<li><strong>Post-CRS customizations</strong> (<code>crs-plugins-after</code>, <code>modsec</code>) are ideal for overriding or extending rules after CRS and plugin rules have been applied.</li>
<li>This structure provides maximum flexibility, enabling precise control over rule execution and customization while maintaining a strong security baseline.</li>
</ul>
</div>
<h3 id="features-owasp-crs-plugins">OWASP CRS Plugins</h3>
<p>The OWASP Core Rule Set also supports a range of <strong>plugins</strong> designed to extend its functionality and improve compatibility with specific applications or environments. These plugins can help fine-tune the CRS for use with popular platforms such as WordPress, Nextcloud, and Drupal, or even custom setups. For more information and a list of available plugins, refer to the <a href="https://github.com/coreruleset/plugin-registry">OWASP CRS plugin registry</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Plugin download</p>
<p>The <code>MODSECURITY_CRS_PLUGINS</code> setting allows you to download and install plugins to extend the functionality of the OWASP Core Rule Set (CRS). This setting accepts a list of plugin names with optional tags or URLs, making it easy to integrate additional security features tailored to your specific needs.</p>
<p>Here's a non-exhaustive list of accepted values for the <code>MODSECURITY_CRS_PLUGINS</code> setting:</p>
<ul>
<li><code>fake-bot</code> - Download the latest release of the plugin.</li>
<li><code>wordpress-rule-exclusions/v1.0.0</code> - Download the version 1.0.0 of the plugin.</li>
<li><code>https://github.com/coreruleset/dos-protection-plugin-modsecurity/archive/refs/heads/main.zip</code> - Download the plugin directly from the URL.</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">False Positives</p>
<p>Higher security settings may block legitimate traffic. Start with the default settings and monitor logs before increasing security levels. Be prepared to add exclusion rules for your specific application needs.</p>
</div>
<h3 id="features-example-configurations_23">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="32:6"><input checked="checked" id="features-__tabbed_32_1" name="features-__tabbed_32" type="radio" /><input id="features-__tabbed_32_2" name="features-__tabbed_32" type="radio" /><input id="features-__tabbed_32_3" name="features-__tabbed_32" type="radio" /><input id="features-__tabbed_32_4" name="features-__tabbed_32" type="radio" /><input id="features-__tabbed_32_5" name="features-__tabbed_32" type="radio" /><input id="features-__tabbed_32_6" name="features-__tabbed_32" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_32_1">Basic Configuration</label><label for="features-__tabbed_32_2">Detection-Only Mode</label><label for="features-__tabbed_32_3">Advanced Configuration with Plugins</label><label for="features-__tabbed_32_4">Legacy Configuration</label><label for="features-__tabbed_32_5">Global ModSecurity</label><label for="features-__tabbed_32_6">Nightly Build with Custom Plugins</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A standard configuration with ModSecurity and CRS v4 enabled:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for monitoring potential threats without blocking:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DetectionOnly&quot;</span>
<span class="nt">MODSECURITY_SEC_AUDIT_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
<span class="nt">MODSECURITY_SEC_AUDIT_LOG_PARTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ABIJDEFHZ&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with CRS v4 and plugins enabled for additional protection:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
<span class="nt">USE_MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;wordpress-rule-exclusions</span><span class="nv"> </span><span class="s">fake-bot&quot;</span>
<span class="nt">MODSECURITY_REQ_BODY_NO_FILES_LIMIT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;262144&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using CRS v3 for compatibility with older setups:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">MODSECURITY_SEC_RULE_ENGINE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;On&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration applying ModSecurity globally across all HTTP connections:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;4&quot;</span>
<span class="nt">USE_MODSECURITY_GLOBAL_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using the nightly build of CRS with custom plugins:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_MODSECURITY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">USE_MODSECURITY_CRS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_VERSION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;nightly&quot;</span>
<span class="nt">USE_MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">MODSECURITY_CRS_PLUGINS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;wordpress-rule-exclusions/v1.0.0</span><span class="nv"> </span><span class="s">https://github.com/coreruleset/dos-protection-plugin-modsecurity/archive/refs/heads/main.zip&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-monitoring-pro">Monitoring <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>BunkerWeb monitoring pro system. This plugin is a prerequisite for some other plugins.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_MONITORING</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td>Enable monitoring of BunkerWeb.</td>
</tr>
<tr>
<td><code>MONITORING_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Size of the dict to store monitoring metrics.</td>
</tr>
<tr>
<td><code>MONITORING_IGNORE_URLS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>List of URLs to ignore when monitoring separated with spaces (e.g. /health)</td>
</tr>
</tbody>
</table>
<h2 id="features-php">PHP</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The PHP plugin provides seamless integration with PHP-FPM for BunkerWeb, enabling dynamic PHP processing for your websites. This feature supports both local PHP-FPM instances running on the same machine and remote PHP-FPM servers, giving you flexibility in how you configure your PHP environment.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a client requests a PHP file from your website, BunkerWeb routes the request to the configured PHP-FPM instance.</li>
<li>For local PHP-FPM, BunkerWeb communicates with the PHP interpreter through a Unix socket file.</li>
<li>For remote PHP-FPM, BunkerWeb forwards requests to the specified host and port using the FastCGI protocol.</li>
<li>PHP-FPM processes the script and returns the generated content to BunkerWeb, which then delivers it to the client.</li>
<li>URL rewriting is automatically configured to support common PHP frameworks and applications that use "pretty URLs".</li>
</ol>
<h3 id="features-how-to-use_21">How to Use</h3>
<p>Follow these steps to configure and use the PHP feature:</p>
<ol>
<li><strong>Choose your PHP-FPM setup:</strong> Decide whether you'll use a local or remote PHP-FPM instance.</li>
<li><strong>Configure the connection:</strong> For local PHP, specify the socket path; for remote PHP, provide the hostname and port.</li>
<li><strong>Set the document root:</strong> Configure the root folder that contains your PHP files using the appropriate path setting.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, BunkerWeb automatically routes PHP requests to your PHP-FPM instance.</li>
</ol>
<h3 id="features-configuration-settings_22">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REMOTE_PHP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Remote PHP Host:</strong> Hostname of the remote PHP-FPM instance. Leave empty to use local PHP.</td>
</tr>
<tr>
<td><code>REMOTE_PHP_PATH</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Remote Path:</strong> Root folder containing files in the remote PHP-FPM instance.</td>
</tr>
<tr>
<td><code>REMOTE_PHP_PORT</code></td>
<td><code>9000</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Remote Port:</strong> Port of the remote PHP-FPM instance.</td>
</tr>
<tr>
<td><code>LOCAL_PHP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Local PHP Socket:</strong> Path to the PHP-FPM socket file. Leave empty to use a remote PHP-FPM instance.</td>
</tr>
<tr>
<td><code>LOCAL_PHP_PATH</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Local Path:</strong> Root folder containing files in the local PHP-FPM instance.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Local vs. Remote PHP-FPM</p>
<p>Choose the setup that best fits your infrastructure:</p>
<ul>
<li><strong>Local PHP-FPM</strong> offers better performance due to socket-based communication and is ideal when PHP runs on the same machine as BunkerWeb.</li>
<li><strong>Remote PHP-FPM</strong> provides more flexibility and scalability by allowing PHP processing to occur on separate servers.</li>
</ul>
</div>
<div class="admonition warning">
<p class="admonition-title">Path Configuration</p>
<p>The <code>REMOTE_PHP_PATH</code> or <code>LOCAL_PHP_PATH</code> must match the actual filesystem path where your PHP files are stored; otherwise, a "File not found" error will occur.</p>
</div>
<div class="admonition info">
<p class="admonition-title">URL Rewriting</p>
<p>The PHP plugin automatically configures URL rewriting to support modern PHP applications. Requests for non-existent files will be directed to <code>index.php</code> with the original request URI available as a query parameter.</p>
</div>
<h3 id="features-example-configurations_24">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="33:4"><input checked="checked" id="features-__tabbed_33_1" name="features-__tabbed_33" type="radio" /><input id="features-__tabbed_33_2" name="features-__tabbed_33" type="radio" /><input id="features-__tabbed_33_3" name="features-__tabbed_33" type="radio" /><input id="features-__tabbed_33_4" name="features-__tabbed_33" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_33_1">Local PHP-FPM Configuration</label><label for="features-__tabbed_33_2">Remote PHP-FPM Configuration</label><label for="features-__tabbed_33_3">Custom Port Configuration</label><label for="features-__tabbed_33_4">WordPress Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Configuration for using a local PHP-FPM instance:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LOCAL_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/run/php/php8.1-fpm.sock&quot;</span>
<span class="nt">LOCAL_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for using a remote PHP-FPM instance:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;php-server.example.com&quot;</span>
<span class="nt">REMOTE_PHP_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9000&quot;</span>
<span class="nt">REMOTE_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for using PHP-FPM on a non-standard port:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;php-server.example.com&quot;</span>
<span class="nt">REMOTE_PHP_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9001&quot;</span>
<span class="nt">REMOTE_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration optimized for WordPress:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LOCAL_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/run/php/php8.1-fpm.sock&quot;</span>
<span class="nt">LOCAL_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/var/www/html/wordpress&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-pro">Pro</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The Pro plugin bundles advanced features and enhancements for enterprise deployments of BunkerWeb. It unlocks additional capabilities, premium plugins, and extended functionality that complement the core BunkerWeb platform. It delivers enhanced security, performance, and management options for enterprise-grade deployments.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>With a valid Pro license key, BunkerWeb connects to the Pro API server to validate your subscription.</li>
<li>Once authenticated, the plugin automatically downloads and installs Pro-exclusive plugins and extensions.</li>
<li>Your Pro status is periodically verified to ensure continued access to premium features.</li>
<li>Premium plugins are seamlessly integrated with your existing BunkerWeb configuration.</li>
<li>All Pro features work harmoniously with the open-source core, enhancing rather than replacing functionality.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Key benefits</p>
<ol>
<li><strong>Premium Extensions:</strong> Access to exclusive plugins and features not available in the community edition.</li>
<li><strong>Enhanced Performance:</strong> Optimized configurations and advanced caching mechanisms.</li>
<li><strong>Enterprise Support:</strong> Priority assistance and dedicated support channels.</li>
<li><strong>Seamless Integration:</strong> Pro features work alongside community features without configuration conflicts.</li>
<li><strong>Automatic Updates:</strong> Premium plugins are automatically downloaded and kept current.</li>
</ol>
</div>
<h3 id="features-how-to-use_22">How to Use</h3>
<p>Follow these steps to configure and use the Pro features:</p>
<ol>
<li><strong>Obtain a license key:</strong> Purchase a Pro license from the <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">BunkerWeb Panel</a>.</li>
<li><strong>Configure your license key:</strong> Use the <code>PRO_LICENSE_KEY</code> setting to configure your license.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured with a valid license, Pro plugins are automatically downloaded and activated.</li>
<li><strong>Monitor your Pro status:</strong> Check the health indicators in the <a href="#web-ui">web UI</a> to confirm your Pro subscription status.</li>
</ol>
<h3 id="features-configuration-settings_23">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>PRO_LICENSE_KEY</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Pro License Key:</strong> Your BunkerWeb Pro license key for authentication.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">License Management</p>
<p>Your Pro license is tied to your specific deployment environment. If you need to transfer your license or have questions about your subscription, please contact support through the <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">BunkerWeb Panel</a>.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Pro Features</p>
<p>The specific Pro features available may evolve over time as new capabilities are added. The Pro plugin automatically handles the installation and configuration of all available features.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Network Requirements</p>
<p>The Pro plugin requires outbound internet access to connect to the BunkerWeb API for license verification and to download premium plugins. Ensure your firewall allows connections to <code>api.bunkerweb.io</code> on port 443 (HTTPS).</p>
</div>
<h3 id="features-frequently-asked-questions">Frequently Asked Questions</h3>
<p><strong>Q: What happens if my Pro license expires?</strong></p>
<p>A: If your Pro license expires, access to premium features and plugins will be disabled. However, your BunkerWeb installation will continue to operate with all community edition features intact. To regain access to Pro features, simply renew your license.</p>
<p><strong>Q: Will Pro features disrupt my existing configuration?</strong></p>
<p>A: No, Pro features are designed to integrate seamlessly with your current BunkerWeb setup. They enhance functionality without altering or interfering with your existing configuration, ensuring a smooth and reliable experience.</p>
<p><strong>Q: Can I try Pro features before committing to a purchase?</strong></p>
<p>A: Absolutely! BunkerWeb offers two Pro plans to suit your needs:</p>
<ul>
<li><strong>BunkerWeb PRO Standard:</strong> Full access to Pro features without technical support.</li>
<li><strong>BunkerWeb PRO Enterprise:</strong> Full access to Pro features with dedicated technical support.</li>
</ul>
<p>You can explore Pro features with a free 1-month trial by using the promo code <code>freetrial</code>. Visit the <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">BunkerWeb Panel</a> to activate your trial and learn more about flexible pricing options based on the number of services protected by BunkerWeb PRO.</p>
<h2 id="features-prometheus-exporter-pro">Prometheus exporter <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Prometheus exporter for BunkerWeb internal metrics.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_PROMETHEUS_EXPORTER</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable the Prometheus export.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_IP</code></td>
<td><code>0.0.0.0</code></td>
<td>global</td>
<td>no</td>
<td>Listening IP of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_PORT</code></td>
<td><code>9113</code></td>
<td>global</td>
<td>no</td>
<td>Listening port of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_URL</code></td>
<td><code>/metrics</code></td>
<td>global</td>
<td>no</td>
<td>HTTP URL of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_ALLOW_IP</code></td>
<td><code>127.0.0.0/8 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16</code></td>
<td>global</td>
<td>no</td>
<td>List of IP/networks allowed to contact the Prometheus exporter endpoint.</td>
</tr>
</tbody>
</table>
<h2 id="features-real-ip">Real IP</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Real IP plugin ensures that BunkerWeb correctly identifies the client’s IP address even when behind proxies. This is essential for applying security rules, rate limiting, and logging properly; without it, all requests would appear to come from your proxy's IP rather than the client's actual IP.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When enabled, BunkerWeb examines incoming requests for specific headers (like <a href="https://developer.mozilla.org/en-US/docs/Web/HTTP/Reference/Headers/X-Forwarded-For"><code>X-Forwarded-For</code></a>) that contain the client's original IP address.</li>
<li>BunkerWeb checks if the incoming IP is in your trusted proxy list (<code>REAL_IP_FROM</code>), ensuring that only legitimate proxies can pass client IPs.</li>
<li>The original client IP is extracted from the specified header (<code>REAL_IP_HEADER</code>) and used for all security evaluations and logging.</li>
<li>For recursive IP chains, BunkerWeb can trace through multiple proxy hops to determine the originating client IP.</li>
<li>Additionally, <a href="https://netnut.io/what-is-proxy-protocol-and-how-does-it-work/">PROXY protocol</a> support can be enabled to receive client IPs directly from compatible proxies such as <a href="https://www.haproxy.org/">HAProxy</a>.</li>
<li>Trusted proxy IP lists can be automatically downloaded and updated from external sources via URLs.</li>
</ol>
<h3 id="features-how-to-use_23">How to Use</h3>
<p>Follow these steps to configure and use the Real IP feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>USE_REAL_IP</code> setting to <code>yes</code> to enable real IP detection.</li>
<li><strong>Define trusted proxies:</strong> List the IP addresses or networks of your trusted proxies using the <code>REAL_IP_FROM</code> setting.</li>
<li><strong>Specify the header:</strong> Configure which header contains the real IP using the <code>REAL_IP_HEADER</code> setting.</li>
<li><strong>Configure recursion:</strong> Decide whether to trace IP chains recursively with the <code>REAL_IP_RECURSIVE</code> setting.</li>
<li><strong>Optional URL sources:</strong> Set up automatic downloads of trusted proxy lists with <code>REAL_IP_FROM_URLS</code>.</li>
<li><strong>PROXY protocol:</strong> For direct proxy communication, enable with <code>USE_PROXY_PROTOCOL</code> if your upstream supports it.</li>
</ol>
<div class="admonition danger">
<p class="admonition-title">PROXY Protocol Warning</p>
<p>Enabling <code>USE_PROXY_PROTOCOL</code> without properly configuring your upstream proxy to send PROXY protocol headers will <strong>break your application</strong>. Only enable this setting if you are certain that your upstream proxy is properly configured to send PROXY protocol information. If your proxy is not sending PROXY protocol headers, all connections to BunkerWeb will fail with protocol errors.</p>
</div>
<h3 id="features-configuration-settings_24">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REAL_IP</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Real IP:</strong> Set to <code>yes</code> to enable retrieving client's real IP from headers or PROXY protocol.</td>
</tr>
<tr>
<td><code>REAL_IP_FROM</code></td>
<td><code>192.168.0.0/16 172.16.0.0/12 10.0.0.0/8</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Trusted Proxies:</strong> List of trusted IP addresses or networks where proxied requests come from, separated by spaces.</td>
</tr>
<tr>
<td><code>REAL_IP_HEADER</code></td>
<td><code>X-Forwarded-For</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Real IP Header:</strong> HTTP header containing the real IP or special value <code>proxy_protocol</code> for PROXY protocol.</td>
</tr>
<tr>
<td><code>REAL_IP_RECURSIVE</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Recursive Search:</strong> When set to <code>yes</code>, performs a recursive search in header containing multiple IP addresses.</td>
</tr>
<tr>
<td><code>REAL_IP_FROM_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP List URLs:</strong> URLs containing trusted proxy IPs/networks to download, separated by spaces. Supports file:// URLs.</td>
</tr>
<tr>
<td><code>USE_PROXY_PROTOCOL</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>PROXY Protocol:</strong> Set to <code>yes</code> to enable PROXY protocol support for direct proxy-to-BunkerWeb communication.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Cloud Provider Networks</p>
<p>If you're using a cloud provider like AWS, GCP, or Azure, consider adding their load balancer IP ranges to your <code>REAL_IP_FROM</code> setting to ensure proper client IP identification.</p>
</div>
<div class="admonition danger">
<p class="admonition-title">Security Considerations</p>
<p>Only include trusted proxy IPs in your configuration. Adding untrusted sources could allow IP spoofing attacks, where malicious actors could forge the client IP by manipulating headers.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Multiple IP Addresses</p>
<p>When <code>REAL_IP_RECURSIVE</code> is enabled and a header contains multiple IPs (e.g., <code>X-Forwarded-For: client, proxy1, proxy2</code>), BunkerWeb will identify the leftmost IP not in your trusted proxy list as the client IP.</p>
</div>
<h3 id="features-example-configurations_25">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="34:6"><input checked="checked" id="features-__tabbed_34_1" name="features-__tabbed_34" type="radio" /><input id="features-__tabbed_34_2" name="features-__tabbed_34" type="radio" /><input id="features-__tabbed_34_3" name="features-__tabbed_34" type="radio" /><input id="features-__tabbed_34_4" name="features-__tabbed_34" type="radio" /><input id="features-__tabbed_34_5" name="features-__tabbed_34" type="radio" /><input id="features-__tabbed_34_6" name="features-__tabbed_34" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_34_1">Basic Configuration</label><label for="features-__tabbed_34_2">Cloud Load Balancer</label><label for="features-__tabbed_34_3">PROXY Protocol</label><label for="features-__tabbed_34_4">Multiple Proxy Sources with URLs</label><label for="features-__tabbed_34_5">CDN Configuration</label><label for="features-__tabbed_34_6">Behind Cloudflare</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration for a site behind a reverse proxy:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">10.0.0.5&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for a site behind a cloud load balancer:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.0.0/16</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using PROXY protocol with a compatible load balancer:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Advanced configuration with automatically updated proxy IP lists:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.0.0/16</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Real-IP&quot;</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/proxy-ips.txt</span><span class="nv"> </span><span class="s">file:///etc/bunkerweb/custom-proxies.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for a website behind a CDN:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.0.0/16</span><span class="nv"> </span><span class="s">172.16.0.0/12</span><span class="nv"> </span><span class="s">10.0.0.0/8&quot;</span>
<span class="nt">REAL_IP_FROM_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://cdn-provider.com/ip-ranges.txt&quot;</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CF-Connecting-IP&quot;</span><span class="w">  </span><span class="c1"># Example for Cloudflare</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span><span class="w">  </span><span class="c1"># Not needed with single IP headers</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for a website behind Cloudflare:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># We only trust Cloudflare IPs</span>
<span class="nt">REAL_IP_FROM_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://www.cloudflare.com/ips-v4/</span><span class="nv"> </span><span class="s">https://www.cloudflare.com/ips-v6/&quot;</span><span class="w"> </span><span class="c1"># Download Cloudflare IPs automatically</span>
<span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;CF-Connecting-IP&quot;</span><span class="w">  </span><span class="c1"># Cloudflare header for client IP</span>
<span class="nt">REAL_IP_RECURSIVE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-redirect">Redirect</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The Redirect plugin provides simple and efficient HTTP redirection capabilities for your BunkerWeb-protected websites. This feature enables you to easily redirect visitors from one site to another, supporting both full-domain redirects and path-preserving redirections.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a visitor accesses your website, BunkerWeb verifies whether a redirection is configured.</li>
<li>If enabled, BunkerWeb redirects the visitor to the specified destination URL.</li>
<li>You can configure whether to preserve the original request path (automatically appending it to the destination URL) or redirect to the exact destination URL.</li>
<li>The HTTP status code used for the redirection can be customized between permanent (301) and temporary (302) redirects.</li>
<li>This functionality is ideal for domain migrations, establishing canonical domains, or redirecting deprecated URLs.</li>
</ol>
<h3 id="features-how-to-use_24">How to Use</h3>
<p>Follow these steps to configure and use the Redirect feature:</p>
<ol>
<li><strong>Set the destination URL:</strong> Configure the target URL where visitors should be redirected using the <code>REDIRECT_TO</code> setting.</li>
<li><strong>Choose redirection type:</strong> Decide whether to preserve the original request path with the <code>REDIRECT_TO_REQUEST_URI</code> setting.</li>
<li><strong>Select status code:</strong> Set the appropriate HTTP status code with the <code>REDIRECT_TO_STATUS_CODE</code> setting to indicate permanent or temporary redirection.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, all requests to the site will be automatically redirected based on your settings.</li>
</ol>
<h3 id="features-configuration-settings_25">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REDIRECT_TO</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Destination URL:</strong> The target URL where visitors will be redirected. Leave empty to disable redirection.</td>
</tr>
<tr>
<td><code>REDIRECT_TO_REQUEST_URI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Preserve Path:</strong> When set to <code>yes</code>, appends the original request URI to the destination URL.</td>
</tr>
<tr>
<td><code>REDIRECT_TO_STATUS_CODE</code></td>
<td><code>301</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>HTTP Status Code:</strong> The HTTP status code to use for redirection. Options: <code>301</code> (permanent) or <code>302</code> (temporary).</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Choosing the Right Status Code</p>
<ul>
<li>Use <code>301</code> (Moved Permanently) when the redirect is permanent, such as for domain migrations or establishing canonical URLs. This helps search engines update their indexes.</li>
<li>Use <code>302</code> (Found/Temporary Redirect) when the redirect is temporary or if you may want to reuse the original URL in the future.</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">Path Preservation</p>
<p>When <code>REDIRECT_TO_REQUEST_URI</code> is set to <code>yes</code>, BunkerWeb preserves the original request path. For example, if a user visits <code>https://old-domain.com/blog/post-1</code> and you've set up a redirect to <code>https://new-domain.com</code>, they'll be redirected to <code>https://new-domain.com/blog/post-1</code>.</p>
</div>
<h3 id="features-example-configurations_26">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="35:4"><input checked="checked" id="features-__tabbed_35_1" name="features-__tabbed_35" type="radio" /><input id="features-__tabbed_35_2" name="features-__tabbed_35" type="radio" /><input id="features-__tabbed_35_3" name="features-__tabbed_35" type="radio" /><input id="features-__tabbed_35_4" name="features-__tabbed_35" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_35_1">Simple Domain Redirect</label><label for="features-__tabbed_35_2">Path-Preserving Redirect</label><label for="features-__tabbed_35_3">Temporary Redirect</label><label for="features-__tabbed_35_4">Subdomain Consolidation</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A configuration that redirects all visitors to a new domain:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://new-domain.com&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration that redirects visitors to a new domain while preserving the requested path:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://new-domain.com&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration for a temporary redirect to a maintenance site:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://maintenance.example.com&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;302&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration to redirect a subdomain to a specific path on the main domain:</p>
<div class="highlight"><pre><span></span><code><span class="nt">REDIRECT_TO</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/support&quot;</span>
<span class="nt">REDIRECT_TO_REQUEST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_TO_STATUS_CODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;301&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-redis">Redis</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Redis plugin integrates <a href="https://redis.io/">Redis</a> or <a href="https://valkey.io/">Valkey</a> into BunkerWeb for caching and fast data retrieval. This feature is essential for deploying BunkerWeb in high-availability environments where session data, metrics, and other shared information must be accessible across multiple nodes.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When enabled, BunkerWeb establishes a connection to your configured Redis or Valkey server.</li>
<li>Critical data such as session information, metrics, and security-related data are stored in Redis/Valkey.</li>
<li>Multiple BunkerWeb instances can share this data, enabling seamless clustering and load balancing.</li>
<li>The plugin supports various Redis/Valkey deployment options, including standalone servers, password authentication, SSL/TLS encryption, and Redis Sentinel for high availability.</li>
<li>Automatic reconnection and configurable timeouts ensure robustness in production environments.</li>
</ol>
<h3 id="features-how-to-use_25">How to Use</h3>
<p>Follow these steps to configure and use the Redis plugin:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>USE_REDIS</code> setting to <code>yes</code> to enable Redis/Valkey integration.</li>
<li><strong>Configure connection details:</strong> Specify your Redis/Valkey server's hostname/IP address and port.</li>
<li><strong>Set security options:</strong> Configure authentication credentials if your Redis/Valkey server requires them.</li>
<li><strong>Configure advanced options:</strong> Set the database selection, SSL options, and timeouts as needed.</li>
<li><strong>For high availability,</strong> configure Sentinel settings if you're using Redis Sentinel.</li>
</ol>
<h3 id="features-configuration-settings_26">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REDIS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Enable Redis:</strong> Set to <code>yes</code> to enable Redis/Valkey integration for cluster mode.</td>
</tr>
<tr>
<td><code>REDIS_HOST</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey Server:</strong> IP address or hostname of the Redis/Valkey server.</td>
</tr>
<tr>
<td><code>REDIS_PORT</code></td>
<td><code>6379</code></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey Port:</strong> Port number of the Redis/Valkey server.</td>
</tr>
<tr>
<td><code>REDIS_DATABASE</code></td>
<td><code>0</code></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey Database:</strong> Database number to use on the Redis/Valkey server (0-15).</td>
</tr>
<tr>
<td><code>REDIS_SSL</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey SSL:</strong> Set to <code>yes</code> to enable SSL/TLS encryption for the Redis/Valkey connection.</td>
</tr>
<tr>
<td><code>REDIS_SSL_VERIFY</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey SSL Verify:</strong> Set to <code>yes</code> to verify the Redis/Valkey server's SSL certificate.</td>
</tr>
<tr>
<td><code>REDIS_TIMEOUT</code></td>
<td><code>5</code></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey Timeout:</strong> Connection timeout in seconds for Redis/Valkey operations.</td>
</tr>
<tr>
<td><code>REDIS_USERNAME</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey Username:</strong> Username for Redis/Valkey authentication (Redis 6.0+).</td>
</tr>
<tr>
<td><code>REDIS_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Redis/Valkey Password:</strong> Password for Redis/Valkey authentication.</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_HOSTS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Sentinel Hosts:</strong> Space-separated list of Redis Sentinel hosts (hostname:port).</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_USERNAME</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Sentinel Username:</strong> Username for Redis Sentinel authentication.</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td><strong>Sentinel Password:</strong> Password for Redis Sentinel authentication.</td>
</tr>
<tr>
<td><code>REDIS_SENTINEL_MASTER</code></td>
<td><code>mymaster</code></td>
<td>global</td>
<td>no</td>
<td><strong>Sentinel Master:</strong> Name of the master in Redis Sentinel configuration.</td>
</tr>
<tr>
<td><code>REDIS_KEEPALIVE_IDLE</code></td>
<td><code>300</code></td>
<td>global</td>
<td>no</td>
<td><strong>Keepalive Idle:</strong> Time (in seconds) between TCP keepalive probes for idle connections.</td>
</tr>
<tr>
<td><code>REDIS_KEEPALIVE_POOL</code></td>
<td><code>3</code></td>
<td>global</td>
<td>no</td>
<td><strong>Keepalive Pool:</strong> Maximum number of Redis/Valkey connections kept in the pool.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">High Availability with Redis Sentinel</p>
<p>For production environments requiring high availability, configure Redis Sentinel settings. This provides automatic failover capabilities if the primary Redis server becomes unavailable.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<p>When using Redis in production:</p>
<ul>
<li>Always set strong passwords for both Redis and Sentinel authentication</li>
<li>Consider enabling SSL/TLS encryption for Redis connections</li>
<li>Ensure your Redis server is not exposed to the public internet</li>
<li>Restrict access to the Redis port using firewalls or network segmentation</li>
</ul>
</div>
<div class="admonition info">
<p class="admonition-title">Cluster Requirements</p>
<p>When deploying BunkerWeb in a cluster:</p>
<ul>
<li>All BunkerWeb instances should connect to the same Redis or Valkey server or Sentinel cluster</li>
<li>Configure the same database number across all instances</li>
<li>Ensure network connectivity between all BunkerWeb instances and Redis/Valkey servers</li>
</ul>
</div>
<h3 id="features-example-configurations_27">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="36:4"><input checked="checked" id="features-__tabbed_36_1" name="features-__tabbed_36" type="radio" /><input id="features-__tabbed_36_2" name="features-__tabbed_36" type="radio" /><input id="features-__tabbed_36_3" name="features-__tabbed_36" type="radio" /><input id="features-__tabbed_36_4" name="features-__tabbed_36" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_36_1">Basic Configuration</label><label for="features-__tabbed_36_2">Secure Configuration</label><label for="features-__tabbed_36_3">Redis Sentinel Configuration</label><label for="features-__tabbed_36_4">Advanced Tuning</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration for connecting to a Redis or Valkey server on the local machine:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;localhost&quot;</span>
<span class="nt">REDIS_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6379&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with password authentication and SSL enabled:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis.example.com&quot;</span>
<span class="nt">REDIS_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6379&quot;</span>
<span class="nt">REDIS_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-strong-password&quot;</span>
<span class="nt">REDIS_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_SSL_VERIFY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for high availability using Redis Sentinel:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_SENTINEL_HOSTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sentinel1:26379</span><span class="nv"> </span><span class="s">sentinel2:26379</span><span class="nv"> </span><span class="s">sentinel3:26379&quot;</span>
<span class="nt">REDIS_SENTINEL_MASTER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mymaster&quot;</span>
<span class="nt">REDIS_SENTINEL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;sentinel-password&quot;</span>
<span class="nt">REDIS_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis-password&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with advanced connection parameters for performance optimization:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;redis.example.com&quot;</span>
<span class="nt">REDIS_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;6379&quot;</span>
<span class="nt">REDIS_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-strong-password&quot;</span>
<span class="nt">REDIS_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">REDIS_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3&quot;</span>
<span class="nt">REDIS_KEEPALIVE_IDLE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60&quot;</span>
<span class="nt">REDIS_KEEPALIVE_POOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;5&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="features-redis-best-practices">Redis Best Practices</h3>
<p>When using Redis or Valkey with BunkerWeb, consider these best practices to ensure optimal performance, security, and reliability:</p>
<h4 id="features-memory-management">Memory Management</h4>
<ul>
<li><strong>Monitor memory usage:</strong> Configure Redis with appropriate <code>maxmemory</code> settings to prevent out-of-memory errors</li>
<li><strong>Set an eviction policy:</strong> Use <code>maxmemory-policy</code> (e.g., <code>volatile-lru</code> or <code>allkeys-lru</code>) appropriate for your use case</li>
<li><strong>Avoid large keys:</strong> Ensure individual Redis keys are kept to a reasonable size to prevent performance degradation</li>
</ul>
<h4 id="features-data-persistence">Data Persistence</h4>
<ul>
<li><strong>Enable RDB snapshots:</strong> Configure periodic snapshots for data persistence without significant performance impact</li>
<li><strong>Consider AOF:</strong> For critical data, enable AOF (Append-Only File) persistence with an appropriate fsync policy</li>
<li><strong>Backup strategy:</strong> Implement regular Redis backups as part of your disaster recovery plan</li>
</ul>
<h4 id="features-performance-optimization">Performance Optimization</h4>
<ul>
<li><strong>Connection pooling:</strong> BunkerWeb already implements this, but ensure other applications follow this practice</li>
<li><strong>Pipelining:</strong> When possible, use pipelining for bulk operations to reduce network overhead</li>
<li><strong>Avoid expensive operations:</strong> Be cautious with commands like KEYS in production environments</li>
<li><strong>Benchmark your workload:</strong> Use redis-benchmark to test your specific workload patterns</li>
</ul>
<h3 id="features-further-resources">Further Resources</h3>
<ul>
<li><a href="https://redis.io/documentation">Redis Documentation</a></li>
<li><a href="https://redis.io/topics/security">Redis Security Guide</a></li>
<li><a href="https://redis.io/topics/sentinel">Redis High Availability</a></li>
<li><a href="https://redis.io/topics/persistence">Redis Persistence</a></li>
</ul>
<h2 id="features-reporting-pro">Reporting <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Regular reporting of important data from BunkerWeb (global, attacks, bans, requests, reasons, AS...). Monitoring pro plugin needed to work.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REPORTING_SMTP</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable sending the report via email.</td>
</tr>
<tr>
<td><code>USE_REPORTING_WEBHOOK</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable sending the report via webhook.</td>
</tr>
<tr>
<td><code>REPORTING_SCHEDULE</code></td>
<td><code>weekly</code></td>
<td>global</td>
<td>no</td>
<td>The frequency at which reports are sent.</td>
</tr>
<tr>
<td><code>REPORTING_WEBHOOK_URLS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>List of webhook URLs to receive the report in Markdown (separated by spaces).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_EMAILS</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>List of email addresses to receive the report in HTML format (separated by spaces).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_HOST</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The host server used for SMTP sending.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_PORT</code></td>
<td><code>465</code></td>
<td>global</td>
<td>no</td>
<td>The port used for SMTP. Please note that there are different standards depending on the type of connection (SSL = 465, TLS = 587).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_EMAIL</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The email address used as the sender. Note that 2FA must be disabled for this email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_USER</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The user authentication value for sending via the from email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>The password authentication value for sending via the from email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SSL</code></td>
<td><code>SSL</code></td>
<td>global</td>
<td>no</td>
<td>Determine whether or not to use a secure connection for SMTP.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SUBJECT</code></td>
<td><code>BunkerWeb Report</code></td>
<td>global</td>
<td>no</td>
<td>The subject line of the email.</td>
</tr>
</tbody>
</table>
<h2 id="features-reverse-proxy">Reverse proxy</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Reverse Proxy plugin provides seamless proxying capabilities for BunkerWeb, allowing you to route requests to backend servers and services. This feature enables BunkerWeb to act as a secure frontend for your applications while providing additional benefits such as SSL termination and security filtering.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a client sends a request to BunkerWeb, the Reverse Proxy plugin forwards the request to your configured backend server.</li>
<li>BunkerWeb adds security headers, applies WAF rules, and performs other security checks before passing requests to your application.</li>
<li>The backend server processes the request and returns a response to BunkerWeb.</li>
<li>BunkerWeb applies additional security measures to the response before sending it back to the client.</li>
<li>The plugin supports both HTTP and TCP/UDP stream proxying, enabling a wide range of applications, including WebSockets and other non-HTTP protocols.</li>
</ol>
<h3 id="features-how-to-use_26">How to Use</h3>
<p>Follow these steps to configure and use the Reverse Proxy feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>USE_REVERSE_PROXY</code> setting to <code>yes</code> to enable reverse proxy functionality.</li>
<li><strong>Configure your backend servers:</strong> Specify the upstream servers using the <code>REVERSE_PROXY_HOST</code> setting.</li>
<li><strong>Adjust proxy settings:</strong> Fine-tune behavior with optional settings for timeouts, buffer sizes, and other parameters.</li>
<li><strong>Configure protocol-specific options:</strong> For WebSockets or special HTTP requirements, adjust the corresponding settings.</li>
<li><strong>Set up caching (optional):</strong> Enable and configure proxy caching to improve performance for frequently accessed content.</li>
</ol>
<h3 id="features-configuration-guide_2">Configuration Guide</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="37:8"><input checked="checked" id="features-__tabbed_37_1" name="features-__tabbed_37" type="radio" /><input id="features-__tabbed_37_2" name="features-__tabbed_37" type="radio" /><input id="features-__tabbed_37_3" name="features-__tabbed_37" type="radio" /><input id="features-__tabbed_37_4" name="features-__tabbed_37" type="radio" /><input id="features-__tabbed_37_5" name="features-__tabbed_37" type="radio" /><input id="features-__tabbed_37_6" name="features-__tabbed_37" type="radio" /><input id="features-__tabbed_37_7" name="features-__tabbed_37" type="radio" /><input id="features-__tabbed_37_8" name="features-__tabbed_37" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_37_1">Basic Configuration</label><label for="features-__tabbed_37_2">Connection Settings</label><label for="features-__tabbed_37_3">SSL/TLS Configuration</label><label for="features-__tabbed_37_4">Protocol Support</label><label for="features-__tabbed_37_5">Header Management</label><label for="features-__tabbed_37_6">Authentication</label><label for="features-__tabbed_37_7">Advanced Configuration</label><label for="features-__tabbed_37_8">Caching Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>Core Settings</strong></p>
<p>The essential configuration settings enable and control the basic functionality of the reverse proxy feature.</p>
<div class="admonition success">
<p class="admonition-title">Benefits of Reverse Proxy</p>
<ul>
<li><strong>Security Enhancement:</strong> All traffic passes through BunkerWeb's security layers before reaching your applications</li>
<li><strong>SSL Termination:</strong> Manage SSL/TLS certificates centrally while backend services can use unencrypted connections</li>
<li><strong>Protocol Handling:</strong> Support for HTTP, HTTPS, WebSockets, and other protocols</li>
<li><strong>Error Interception:</strong> Customize error pages for a consistent user experience</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REVERSE_PROXY</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Reverse Proxy:</strong> Set to <code>yes</code> to enable reverse proxy functionality.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_HOST</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Backend Host:</strong> Full URL of the proxied resource (proxy_pass).</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_URL</code></td>
<td><code>/</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Location URL:</strong> Path that will be proxied to the backend server.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_BUFFERING</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Response Buffering:</strong> Enable or disable buffering of responses from proxied resource.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_KEEPALIVE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Keep-Alive:</strong> Enable or disable keepalive connections with the proxied resource.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_CUSTOM_HOST</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Custom Host:</strong> Override Host header sent to upstream server.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_INTERCEPT_ERRORS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Intercept Errors:</strong> Whether to intercept and rewrite error responses from the backend.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Best Practices</p>
<ul>
<li>Always specify the full URL in <code>REVERSE_PROXY_HOST</code> including the protocol (http:// or https://)</li>
<li>Use <code>REVERSE_PROXY_INTERCEPT_ERRORS</code> to provide consistent error pages across all your services</li>
<li>When configuring multiple backends, use the numbered suffix format (e.g., <code>REVERSE_PROXY_HOST_2</code>, <code>REVERSE_PROXY_URL_2</code>)</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><strong>Connection and Timeout Configuration</strong></p>
<p>These settings control connection behavior, buffering, and timeout values for the proxied connections.</p>
<div class="admonition success">
<p class="admonition-title">Benefits</p>
<ul>
<li><strong>Optimized Performance:</strong> Adjust buffer sizes and connection settings based on your application needs</li>
<li><strong>Resource Management:</strong> Control memory usage through appropriate buffer configurations</li>
<li><strong>Reliability:</strong> Configure appropriate timeouts to handle slow connections or backend issues</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_CONNECT_TIMEOUT</code></td>
<td><code>60s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Connect Timeout:</strong> Maximum time to establish a connection to the backend server.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_READ_TIMEOUT</code></td>
<td><code>60s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Read Timeout:</strong> Maximum time between transmissions of two successive packets from the backend server.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_SEND_TIMEOUT</code></td>
<td><code>60s</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Send Timeout:</strong> Maximum time between transmissions of two successive packets to the backend server.</td>
</tr>
<tr>
<td><code>PROXY_BUFFERS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Buffers:</strong> Number and size of buffers for reading the response from the backend server.</td>
</tr>
<tr>
<td><code>PROXY_BUFFER_SIZE</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Buffer Size:</strong> Size of the buffer for reading the first part of the response from the backend server.</td>
</tr>
<tr>
<td><code>PROXY_BUSY_BUFFERS_SIZE</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Busy Buffers Size:</strong> Size of buffers that can be busy sending response to the client.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Timeout Considerations</p>
<ul>
<li>Setting timeouts too low may cause legitimate but slow connections to be terminated</li>
<li>Setting timeouts too high may leave connections open unnecessarily, potentially exhausting resources</li>
<li>For WebSocket applications, increase the read and send timeouts significantly (300s or more recommended)</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><strong>SSL/TLS Settings for Backend Connections</strong></p>
<p>These settings control how BunkerWeb establishes secure connections to backend servers.</p>
<div class="admonition success">
<p class="admonition-title">Benefits</p>
<ul>
<li><strong>End-to-End Encryption:</strong> Maintain encrypted connections from client to backend</li>
<li><strong>Certificate Validation:</strong> Control how backend server certificates are validated</li>
<li><strong>SNI Support:</strong> Specify Server Name Indication for backends that host multiple sites</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_SSL_SNI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>SSL SNI:</strong> Enable or disable sending SNI (Server Name Indication) to upstream.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_SSL_SNI_NAME</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>SSL SNI Name:</strong> Sets the SNI hostname to send to upstream when SSL SNI is enabled.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">SNI Explained</p>
<p>Server Name Indication (SNI) is a TLS extension that allows a client to specify the hostname it is attempting to connect to during the handshake process. This enables servers to present multiple certificates on the same IP address and port, allowing multiple secure (HTTPS) websites to be served from a single IP address without requiring all those sites to use the same certificate.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>Protocol-Specific Configuration</strong></p>
<p>Configure special protocol handling, particularly for WebSockets and other non-HTTP protocols.</p>
<div class="admonition success">
<p class="admonition-title">Benefits</p>
<ul>
<li><strong>Protocol Flexibility:</strong> Support for WebSockets enables real-time applications</li>
<li><strong>Modern Web Applications:</strong> Enable interactive features requiring bidirectional communication</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_WS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>WebSocket Support:</strong> Enable WebSocket protocol on the resource.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">WebSocket Configuration</p>
<ul>
<li>When enabling WebSockets with <code>REVERSE_PROXY_WS: "yes"</code>, consider increasing timeout values</li>
<li>WebSocket connections stay open longer than typical HTTP connections</li>
<li>For WebSocket applications, a recommended configuration is:
  <div class="highlight"><pre><span></span><code><span class="nt">REVERSE_PROXY_WS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_READ_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300s&quot;</span>
<span class="nt">REVERSE_PROXY_SEND_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300s&quot;</span>
</code></pre></div></li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><strong>HTTP Header Configuration</strong></p>
<p>Control which headers are sent to backend servers and to clients, allowing you to add, modify, or preserve HTTP headers.</p>
<div class="admonition success">
<p class="admonition-title">Benefits</p>
<ul>
<li><strong>Information Control:</strong> Precisely manage what information is shared between clients and backends</li>
<li><strong>Security Enhancement:</strong> Add security-related headers or remove headers that might leak sensitive information</li>
<li><strong>Integration Support:</strong> Provide necessary headers for authentication and proper backend operation</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_HEADERS</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Custom Headers:</strong> HTTP headers to send to backend separated with semicolons.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_HIDE_HEADERS</code></td>
<td><code>Upgrade</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Hide Headers:</strong> HTTP headers to hide from clients when received from the backend.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_HEADERS_CLIENT</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Client Headers:</strong> HTTP headers to send to client separated with semicolons.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_UNDERSCORES_IN_HEADERS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Underscores in Headers:</strong> Enable or disable the <code>underscores_in_headers</code> directive.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<p>When using the reverse proxy feature, be cautious about what headers you forward to your backend applications. Certain headers might expose sensitive information about your infrastructure or bypass security controls.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Header Format Examples</p>
<p>Custom headers to backend servers:
<div class="highlight"><pre><span></span><code>REVERSE_PROXY_HEADERS: &quot;X-Real-IP $remote_addr;X-Forwarded-For $proxy_add_x_forwarded_for;X-Forwarded-Proto $scheme&quot;
</code></pre></div></p>
<p>Custom headers to clients:
<div class="highlight"><pre><span></span><code>REVERSE_PROXY_HEADERS_CLIENT: &quot;X-Powered-By BunkerWeb;X-Frame-Options SAMEORIGIN&quot;
</code></pre></div></p>
</div>
</div>
<div class="tabbed-block">
<p><strong>External Authentication Configuration</strong></p>
<p>Integrate with external authentication systems to centralize authorization logic across your applications.</p>
<div class="admonition success">
<p class="admonition-title">Benefits</p>
<ul>
<li><strong>Centralized Authentication:</strong> Implement a single authentication point for multiple applications</li>
<li><strong>Consistent Security:</strong> Apply uniform authentication policies across different services</li>
<li><strong>Enhanced Control:</strong> Forward authentication details to backend applications via headers or variables</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_AUTH_REQUEST</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Auth Request:</strong> Enable authentication using an external provider.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_AUTH_REQUEST_SIGNIN_URL</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Sign-in URL:</strong> Redirect clients to sign-in URL when authentication fails.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_AUTH_REQUEST_SET</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Auth Request Set:</strong> Variables to set from the authentication provider.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Authentication Integration</p>
<ul>
<li>The auth request feature enables implementation of centralized authentication microservices</li>
<li>Your authentication service should return a 200 status code for successful authentication or 401/403 for failures</li>
<li>Use the auth_request_set directive to extract and forward information from the authentication service</li>
</ul>
</div>
</div>
<div class="tabbed-block">
<p><strong>Additional Configuration Options</strong></p>
<p>These settings provide further customization of the reverse proxy behavior for specialized scenarios.</p>
<div class="admonition success">
<p class="admonition-title">Benefits</p>
<ul>
<li><strong>Customization:</strong> Include additional configuration snippets for complex requirements</li>
<li><strong>Performance Optimization:</strong> Fine-tune request handling for specific use cases</li>
<li><strong>Flexibility:</strong> Adapt to unique application requirements with specialized configurations</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REVERSE_PROXY_INCLUDES</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Additional Configurations:</strong> Include additional configs in location block.</td>
</tr>
<tr>
<td><code>REVERSE_PROXY_PASS_REQUEST_BODY</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Pass Request Body:</strong> Enable or disable passing the request body.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<p>Be careful when including custom configuration snippets as they may override BunkerWeb's security settings or introduce vulnerabilities if not properly configured.</p>
</div>
</div>
<div class="tabbed-block">
<p><strong>Response Caching Settings</strong></p>
<p>Improve performance by caching responses from backend servers, reducing load and improving response times.</p>
<div class="admonition success">
<p class="admonition-title">Benefits</p>
<ul>
<li><strong>Performance:</strong> Reduce load on backend servers by serving cached content</li>
<li><strong>Reduced Latency:</strong> Faster response times for frequently requested content</li>
<li><strong>Bandwidth Savings:</strong> Minimize internal network traffic by caching responses</li>
<li><strong>Customization:</strong> Configure exactly what, when, and how content is cached</li>
</ul>
</div>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_PROXY_CACHE</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Caching:</strong> Set to <code>yes</code> to enable caching of backend responses.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_PATH_LEVELS</code></td>
<td><code>1:2</code></td>
<td>global</td>
<td>no</td>
<td><strong>Cache Path Levels:</strong> How to structure the cache directory hierarchy.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_PATH_ZONE_SIZE</code></td>
<td><code>10m</code></td>
<td>global</td>
<td>no</td>
<td><strong>Cache Zone Size:</strong> Size of the shared memory zone used for cache metadata.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_PATH_PARAMS</code></td>
<td><code>max_size=100m</code></td>
<td>global</td>
<td>no</td>
<td><strong>Cache Path Parameters:</strong> Additional parameters for the cache path.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_METHODS</code></td>
<td><code>GET HEAD</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Methods:</strong> HTTP methods that can be cached.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_MIN_USES</code></td>
<td><code>2</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Min Uses:</strong> Minimum number of requests before a response is cached.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_KEY</code></td>
<td><code>$scheme$host$request_uri</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Key:</strong> The key used to uniquely identify a cached response.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_VALID</code></td>
<td><code>200=24h 301=1h 302=24h</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Valid:</strong> How long to cache specific response codes.</td>
</tr>
<tr>
<td><code>PROXY_NO_CACHE</code></td>
<td><code>$http_pragma $http_authorization</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>No Cache:</strong> Conditions for not caching responses even if normally cacheable.</td>
</tr>
<tr>
<td><code>PROXY_CACHE_BYPASS</code></td>
<td><code>0</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Cache Bypass:</strong> Conditions under which to bypass the cache.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Caching Best Practices</p>
<ul>
<li>Cache only content that doesn't change frequently or isn't personalized</li>
<li>Use appropriate cache durations based on content type (static assets can be cached longer)</li>
<li>Configure <code>PROXY_NO_CACHE</code> to avoid caching sensitive or personalized content</li>
<li>Monitor cache hit rates and adjust settings accordingly</li>
</ul>
</div>
</div>
</div>
</div>
<div class="admonition danger">
<p class="admonition-title">Docker Compose Users - NGINX Variables</p>
<p>When using Docker Compose with NGINX variables in your configurations, you must escape the dollar sign (<code>$</code>) by using double dollar signs (<code>$$</code>). This applies to all settings that contain NGINX variables like <code>$remote_addr</code>, <code>$proxy_add_x_forwarded_for</code>, etc.</p>
<p>Without this escaping, Docker Compose will try to substitute these variables with environment variables, which typically don't exist, resulting in empty values in your NGINX configuration.</p>
</div>
<h3 id="features-example-configurations_28">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="38:6"><input checked="checked" id="features-__tabbed_38_1" name="features-__tabbed_38" type="radio" /><input id="features-__tabbed_38_2" name="features-__tabbed_38" type="radio" /><input id="features-__tabbed_38_3" name="features-__tabbed_38" type="radio" /><input id="features-__tabbed_38_4" name="features-__tabbed_38" type="radio" /><input id="features-__tabbed_38_5" name="features-__tabbed_38" type="radio" /><input id="features-__tabbed_38_6" name="features-__tabbed_38" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_38_1">Basic HTTP Proxy</label><label for="features-__tabbed_38_2">WebSocket Application</label><label for="features-__tabbed_38_3">Multiple Locations</label><label for="features-__tabbed_38_4">Caching Configuration</label><label for="features-__tabbed_38_5">Advanced Header Management</label><label for="features-__tabbed_38_6">Authentication Integration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration for proxying HTTP requests to a backend application server:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">REVERSE_PROXY_CONNECT_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10s&quot;</span>
<span class="nt">REVERSE_PROXY_SEND_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60s&quot;</span>
<span class="nt">REVERSE_PROXY_READ_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;60s&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration optimized for a WebSocket application with longer timeouts:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://websocket-app:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">REVERSE_PROXY_WS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_CONNECT_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10s&quot;</span>
<span class="nt">REVERSE_PROXY_SEND_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300s&quot;</span>
<span class="nt">REVERSE_PROXY_READ_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;300s&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for routing different paths to different backend services:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># API Backend</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://api-server:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/api/&quot;</span>

<span class="c1"># Admin Backend</span>
<span class="nt">REVERSE_PROXY_HOST_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://admin-server:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/admin/&quot;</span>

<span class="c1"># Frontend App</span>
<span class="nt">REVERSE_PROXY_HOST_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://frontend:3000&quot;</span>
<span class="nt">REVERSE_PROXY_URL_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with proxy caching enabled for better performance:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>
<span class="nt">USE_PROXY_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">PROXY_CACHE_VALID</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;200=24h</span><span class="nv"> </span><span class="s">301=1h</span><span class="nv"> </span><span class="s">302=24h&quot;</span>
<span class="nt">PROXY_CACHE_METHODS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;GET</span><span class="nv"> </span><span class="s">HEAD&quot;</span>
<span class="nt">PROXY_NO_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;$http_authorization&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with custom header manipulation:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>

<span class="c1"># Custom headers to backend</span>
<span class="nt">REVERSE_PROXY_HEADERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Real-IP</span><span class="nv"> </span><span class="s">$remote_addr;X-Forwarded-For</span><span class="nv"> </span><span class="s">$proxy_add_x_forwarded_for;X-Forwarded-Proto</span><span class="nv"> </span><span class="s">$scheme&quot;</span>

<span class="c1"># Custom headers to client</span>
<span class="nt">REVERSE_PROXY_HEADERS_CLIENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Powered-By</span><span class="nv"> </span><span class="s">BunkerWeb;X-Frame-Options</span><span class="nv"> </span><span class="s">SAMEORIGIN&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with external authentication:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://application:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/&quot;</span>

<span class="c1"># Authentication configuration</span>
<span class="nt">REVERSE_PROXY_AUTH_REQUEST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/auth&quot;</span>
<span class="nt">REVERSE_PROXY_AUTH_REQUEST_SIGNIN_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://login.example.com&quot;</span>
<span class="nt">REVERSE_PROXY_AUTH_REQUEST_SET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;$auth_user</span><span class="nv"> </span><span class="s">$upstream_http_x_user;$auth_role</span><span class="nv"> </span><span class="s">$upstream_http_x_role&quot;</span>

<span class="c1"># Auth service backend</span>
<span class="nt">REVERSE_PROXY_HOST_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://auth-service:8080&quot;</span>
<span class="nt">REVERSE_PROXY_URL_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/auth&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-reverse-scan">Reverse scan</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Reverse Scan plugin robustly protects against proxy bypass attempts by scanning clients' ports to detect whether they are running proxy servers or other network services. This feature helps identify and block potential threats from clients that may be attempting to hide their true identity or origin, thereby enhancing your website's security posture.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a client connects to your server, BunkerWeb attempts to scan specific ports on the client's IP address.</li>
<li>The plugin checks if any common proxy ports (such as 80, 443, 8080, etc.) are open on the client side.</li>
<li>If open ports are detected, indicating that the client may be running a proxy server, the connection is denied.</li>
<li>This adds an extra layer of security against automated tools, bots, and malicious users attempting to mask their identity.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Key benefits</p>
<ol>
<li><strong>Enhanced Security:</strong> Identifies clients potentially running proxy servers that could be used for malicious purposes.</li>
<li><strong>Proxy Detection:</strong> Helps detect and block clients attempting to hide their true identity.</li>
<li><strong>Configurable Settings:</strong> Customize which ports to scan based on your specific security requirements.</li>
<li><strong>Performance Optimized:</strong> Intelligent scanning with configurable timeouts to minimize impact on legitimate users.</li>
<li><strong>Seamless Integration:</strong> Works transparently with your existing security layers.</li>
</ol>
</div>
<h3 id="features-how-to-use_27">How to Use</h3>
<p>Follow these steps to configure and use the Reverse Scan feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>USE_REVERSE_SCAN</code> setting to <code>yes</code> to enable client port scanning.</li>
<li><strong>Configure ports to scan:</strong> Customize the <code>REVERSE_SCAN_PORTS</code> setting to specify which client ports should be checked.</li>
<li><strong>Set scan timeout:</strong> Adjust the <code>REVERSE_SCAN_TIMEOUT</code> to balance thorough scanning with performance.</li>
<li><strong>Monitor scan activity:</strong> Check logs and the <a href="#web-ui">web UI</a> to review scan results and potential security incidents.</li>
</ol>
<h3 id="features-configuration-settings_27">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REVERSE_SCAN</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Reverse Scan:</strong> Set to <code>yes</code> to enable scanning of clients ports.</td>
</tr>
<tr>
<td><code>REVERSE_SCAN_PORTS</code></td>
<td><code>22 80 443 3128 8000 8080</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Ports to Scan:</strong> Space-separated list of ports to check on the client side.</td>
</tr>
<tr>
<td><code>REVERSE_SCAN_TIMEOUT</code></td>
<td><code>500</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Scan Timeout:</strong> Maximum time in milliseconds allowed for scanning a port.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Performance Considerations</p>
<p>Scanning multiple ports can add latency to client connections. Use an appropriate timeout value and limit the number of ports scanned to maintain good performance.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Common Proxy Ports</p>
<p>The default configuration includes common ports used by proxy servers (80, 443, 8080, 3128) and SSH (22). You may want to customize this list based on your threat model.</p>
</div>
<h3 id="features-example-configurations_29">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="39:4"><input checked="checked" id="features-__tabbed_39_1" name="features-__tabbed_39" type="radio" /><input id="features-__tabbed_39_2" name="features-__tabbed_39" type="radio" /><input id="features-__tabbed_39_3" name="features-__tabbed_39" type="radio" /><input id="features-__tabbed_39_4" name="features-__tabbed_39" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_39_1">Basic Configuration</label><label for="features-__tabbed_39_2">Comprehensive Scanning</label><label for="features-__tabbed_39_3">Performance-Optimized Configuration</label><label for="features-__tabbed_39_4">High-Security Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration for enabling client port scanning:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;500&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">8080&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A more thorough configuration that checks additional ports:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1000&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;22</span><span class="nv"> </span><span class="s">80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">3128</span><span class="nv"> </span><span class="s">8080</span><span class="nv"> </span><span class="s">8000</span><span class="nv"> </span><span class="s">8888</span><span class="nv"> </span><span class="s">1080</span><span class="nv"> </span><span class="s">3333</span><span class="nv"> </span><span class="s">8081&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration tuned for better performance by checking fewer ports with lower timeout:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;250&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">8080&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration focused on maximum security with extended scanning:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_REVERSE_SCAN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REVERSE_SCAN_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1500&quot;</span>
<span class="nt">REVERSE_SCAN_PORTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;22</span><span class="nv"> </span><span class="s">25</span><span class="nv"> </span><span class="s">80</span><span class="nv"> </span><span class="s">443</span><span class="nv"> </span><span class="s">1080</span><span class="nv"> </span><span class="s">3128</span><span class="nv"> </span><span class="s">3333</span><span class="nv"> </span><span class="s">4444</span><span class="nv"> </span><span class="s">5555</span><span class="nv"> </span><span class="s">6588</span><span class="nv"> </span><span class="s">6666</span><span class="nv"> </span><span class="s">7777</span><span class="nv"> </span><span class="s">8000</span><span class="nv"> </span><span class="s">8080</span><span class="nv"> </span><span class="s">8081</span><span class="nv"> </span><span class="s">8800</span><span class="nv"> </span><span class="s">8888</span><span class="nv"> </span><span class="s">9999&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-ssl">SSL</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The SSL plugin provides robust SSL/TLS encryption capabilities for your BunkerWeb-protected websites. This core component enables secure HTTPS connections by configuring and optimizing cryptographic protocols, ciphers, and related security settings to protect data in transit between clients and your web services.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a client initiates an HTTPS connection to your website, BunkerWeb handles the SSL/TLS handshake using your configured settings.</li>
<li>The plugin enforces modern encryption protocols and strong cipher suites while disabling known vulnerable options.</li>
<li>Optimized SSL session parameters improve connection performance without sacrificing security.</li>
<li>Certificate presentation is configured according to best practices to ensure compatibility and security.</li>
</ol>
<div class="admonition success">
<p class="admonition-title">Security Benefits</p>
<ul>
<li><strong>Data Protection:</strong> Encrypts data in transit, preventing eavesdropping and man-in-the-middle attacks</li>
<li><strong>Authentication:</strong> Verifies the identity of your server to clients</li>
<li><strong>Integrity:</strong> Ensures data hasn't been tampered with during transmission</li>
<li><strong>Modern Standards:</strong> Configured for compliance with industry best practices and security standards</li>
</ul>
</div>
<h3 id="features-how-to-use_28">How to Use</h3>
<p>Follow these steps to configure and use the SSL feature:</p>
<ol>
<li><strong>Configure protocols:</strong> Choose which SSL/TLS protocol versions to support using the <code>SSL_PROTOCOLS</code> setting.</li>
<li><strong>Select cipher suites:</strong> Specify the encryption strength using the <code>SSL_CIPHERS_LEVEL</code> setting or provide custom ciphers with <code>SSL_CIPHERS_CUSTOM</code>.</li>
<li><strong>Configure HTTP to HTTPS redirection:</strong> Set up automatic redirection using the <code>AUTO_REDIRECT_HTTP_TO_HTTPS</code> or <code>REDIRECT_HTTP_TO_HTTPS</code> settings.</li>
</ol>
<h3 id="features-configuration-settings_28">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>REDIRECT_HTTP_TO_HTTPS</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Redirect HTTP to HTTPS:</strong> When set to <code>yes</code>, all HTTP requests are redirected to HTTPS.</td>
</tr>
<tr>
<td><code>AUTO_REDIRECT_HTTP_TO_HTTPS</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Auto Redirect HTTP to HTTPS:</strong> When set to <code>yes</code>, automatically redirects HTTP to HTTPS if HTTPS is detected.</td>
</tr>
<tr>
<td><code>SSL_PROTOCOLS</code></td>
<td><code>TLSv1.2 TLSv1.3</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>SSL Protocols:</strong> Space-separated list of SSL/TLS protocols to support.</td>
</tr>
<tr>
<td><code>SSL_CIPHERS_LEVEL</code></td>
<td><code>modern</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>SSL Ciphers Level:</strong> Preset security level for cipher suites (<code>modern</code>, <code>intermediate</code>, or <code>old</code>).</td>
</tr>
<tr>
<td><code>SSL_CIPHERS_CUSTOM</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Custom SSL Ciphers:</strong> Colon-separated list of cipher suites to use for SSL/TLS connections (overrides level).</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">SSL Labs Testing</p>
<p>After configuring your SSL settings, use the <a href="https://www.ssllabs.com/ssltest/">Qualys SSL Labs Server Test</a> to verify your configuration and check for potential security issues. A proper BunkerWeb SSL configuration should achieve an A+ rating.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Protocol Selection</p>
<p>Support for older protocols like SSLv3, TLSv1.0, and TLSv1.1 is intentionally disabled by default due to known vulnerabilities. Only enable these protocols if you absolutely need to support legacy clients and understand the security implications of doing so.</p>
</div>
<h3 id="features-example-configurations_30">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="40:4"><input checked="checked" id="features-__tabbed_40_1" name="features-__tabbed_40" type="radio" /><input id="features-__tabbed_40_2" name="features-__tabbed_40" type="radio" /><input id="features-__tabbed_40_3" name="features-__tabbed_40" type="radio" /><input id="features-__tabbed_40_4" name="features-__tabbed_40" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_40_1">Modern Security (Default)</label><label for="features-__tabbed_40_2">Maximum Security</label><label for="features-__tabbed_40_3">Legacy Compatibility</label><label for="features-__tabbed_40_4">Custom Ciphers</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The default configuration that provides strong security while maintaining compatibility with modern browsers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.2</span><span class="nv"> </span><span class="s">TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;modern&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration focused on maximum security, potentially with reduced compatibility for older clients:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;modern&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with broader compatibility for older clients (use only if necessary):</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.2</span><span class="nv"> </span><span class="s">TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;old&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using custom cipher specification:</p>
<div class="highlight"><pre><span></span><code><span class="nt">LISTEN_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SSL_PROTOCOLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;TLSv1.2</span><span class="nv"> </span><span class="s">TLSv1.3&quot;</span>
<span class="nt">SSL_CIPHERS_CUSTOM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305&quot;</span>
<span class="nt">AUTO_REDIRECT_HTTP_TO_HTTPS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-securitytxt">Security.txt</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Security.txt plugin implements the <a href="https://securitytxt.org/">Security.txt</a> standard (<a href="https://www.rfc-editor.org/rfc/rfc9116">RFC 9116</a>) for your website. This feature helps security researchers access your security policies and provides a standardized way for them to report security vulnerabilities they discover in your systems.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When enabled, BunkerWeb creates a <code>/.well-known/security.txt</code> file at the root of your website.</li>
<li>This file contains information about your security policies, contacts, and other relevant details.</li>
<li>Security researchers and automated tools can easily find this file at the standard location.</li>
<li>The content is configured using simple settings that allow you to specify contact information, encryption keys, policies, and acknowledgments.</li>
<li>BunkerWeb automatically formats the file in accordance with RFC 9116.</li>
</ol>
<h3 id="features-how-to-use_29">How to Use</h3>
<p>Follow these steps to configure and use the Security.txt feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>USE_SECURITYTXT</code> setting to <code>yes</code> to enable the security.txt file.</li>
<li><strong>Configure contact information:</strong> Specify at least one contact method using the <code>SECURITYTXT_CONTACT</code> setting.</li>
<li><strong>Set additional information:</strong> Configure optional fields like expiration date, encryption, acknowledgments, and policy URLs.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, BunkerWeb will automatically create and serve the security.txt file at the standard location.</li>
</ol>
<h3 id="features-configuration-settings_29">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_SECURITYTXT</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Security.txt:</strong> Set to <code>yes</code> to enable the security.txt file.</td>
</tr>
<tr>
<td><code>SECURITYTXT_URI</code></td>
<td><code>/.well-known/security.txt</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Security.txt URI:</strong> Indicates the URI where the security.txt file will be accessible.</td>
</tr>
<tr>
<td><code>SECURITYTXT_CONTACT</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Contact Information:</strong> How security researchers can contact you (e.g., <code>mailto:security@example.com</code>).</td>
</tr>
<tr>
<td><code>SECURITYTXT_EXPIRES</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>Expiration Date:</strong> When this security.txt file should be considered expired (ISO 8601 format).</td>
</tr>
<tr>
<td><code>SECURITYTXT_ENCRYPTION</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Encryption:</strong> URL pointing to encryption keys to be used for secure communication.</td>
</tr>
<tr>
<td><code>SECURITYTXT_ACKNOWLEDGEMENTS</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Acknowledgements:</strong> URL where security researchers are recognized for their reports.</td>
</tr>
<tr>
<td><code>SECURITYTXT_POLICY</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Security Policy:</strong> URL pointing to the security policy describing how to report vulnerabilities.</td>
</tr>
<tr>
<td><code>SECURITYTXT_HIRING</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Security Jobs:</strong> URL pointing to security-related job openings.</td>
</tr>
<tr>
<td><code>SECURITYTXT_CANONICAL</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>Canonical URL:</strong> The canonical URI(s) for this security.txt file.</td>
</tr>
<tr>
<td><code>SECURITYTXT_PREFERRED_LANG</code></td>
<td><code>en</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Preferred Language:</strong> The language(s) used in communications. Specified as an ISO 639-1 language code.</td>
</tr>
<tr>
<td><code>SECURITYTXT_CSAF</code></td>
<td></td>
<td>multisite</td>
<td>yes</td>
<td><strong>CSAF:</strong> Link to the provider-metadata.json of your Common Security Advisory Framework provider.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Expiration Date Required</p>
<p>According to RFC 9116, the <code>Expires</code> field is required. If you don't provide a value for <code>SECURITYTXT_EXPIRES</code>, BunkerWeb automatically sets the expiration date to one year from the current date.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Contact Information Is Essential</p>
<p>The <code>Contact</code> field is the most important part of the security.txt file. You should provide at least one way for security researchers to contact you. This can be an email address, a web form, a phone number, or any other method that works for your organization.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">URLs Must Use HTTPS</p>
<p>According to RFC 9116, all URLs in the security.txt file (except for <code>mailto:</code> and <code>tel:</code> links) MUST use HTTPS. Non-HTTPS URLs will automatically be converted to HTTPS by BunkerWeb to ensure compliance with the standard.</p>
</div>
<h3 id="features-example-configurations_31">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="41:3"><input checked="checked" id="features-__tabbed_41_1" name="features-__tabbed_41" type="radio" /><input id="features-__tabbed_41_2" name="features-__tabbed_41" type="radio" /><input id="features-__tabbed_41_3" name="features-__tabbed_41" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_41_1">Basic Configuration</label><label for="features-__tabbed_41_2">Comprehensive Configuration</label><label for="features-__tabbed_41_3">Multiple Contacts Configuration</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A minimal configuration with just contact information:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_SECURITYTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SECURITYTXT_CONTACT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mailto:security@example.com&quot;</span>
<span class="nt">SECURITYTXT_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-policy&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A more complete configuration with all fields:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_SECURITYTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SECURITYTXT_CONTACT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mailto:security@example.com&quot;</span>
<span class="nt">SECURITYTXT_CONTACT_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-contact-form&quot;</span>
<span class="nt">SECURITYTXT_EXPIRES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2023-12-31T23:59:59+00:00&quot;</span>
<span class="nt">SECURITYTXT_ENCRYPTION</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/pgp-key.txt&quot;</span>
<span class="nt">SECURITYTXT_ACKNOWLEDGEMENTS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/hall-of-fame&quot;</span>
<span class="nt">SECURITYTXT_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-policy&quot;</span>
<span class="nt">SECURITYTXT_HIRING</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/jobs/security&quot;</span>
<span class="nt">SECURITYTXT_CANONICAL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/.well-known/security.txt&quot;</span>
<span class="nt">SECURITYTXT_PREFERRED_LANG</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;en&quot;</span>
<span class="nt">SECURITYTXT_CSAF</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/provider-metadata.json&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with multiple contact methods:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_SECURITYTXT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SECURITYTXT_CONTACT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mailto:security@example.com&quot;</span>
<span class="nt">SECURITYTXT_CONTACT_2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tel:+1-201-555-0123&quot;</span>
<span class="nt">SECURITYTXT_CONTACT_3</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-form&quot;</span>
<span class="nt">SECURITYTXT_POLICY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/security-policy&quot;</span>
<span class="nt">SECURITYTXT_EXPIRES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;2024-06-30T23:59:59+00:00&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-self-signed-certificate">Self-signed certificate</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Self-signed Certificate plugin automatically generates and manages SSL/TLS certificates directly within BunkerWeb, enabling secure HTTPS connections without requiring an external certificate authority. This feature is particularly useful in development environments, internal networks, or whenever you need to quickly deploy HTTPS without configuring external certificates.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When enabled, BunkerWeb automatically generates a self-signed SSL/TLS certificate for your configured domains.</li>
<li>The certificate includes all server names defined in your configuration, ensuring proper SSL validation for each domain.</li>
<li>Certificates are stored securely and used to encrypt all HTTPS traffic to your websites.</li>
<li>The certificate is automatically renewed before expiration, ensuring continuous HTTPS availability.</li>
</ol>
<div class="admonition warning">
<p class="admonition-title">Browser Security Warnings</p>
<p>Browsers will display security warnings when users visit sites using self-signed certificates, as these certificates aren't validated by a trusted certificate authority. For production environments, consider using <a href="#features-lets-encrypt">Let's Encrypt</a> instead.</p>
</div>
<h3 id="features-how-to-use_30">How to Use</h3>
<p>Follow these steps to configure and use the Self-signed Certificate feature:</p>
<ol>
<li><strong>Enable the feature:</strong> Set the <code>GENERATE_SELF_SIGNED_SSL</code> setting to <code>yes</code> to enable self-signed certificate generation.</li>
<li><strong>Choose cryptographic algorithm:</strong> Select your preferred algorithm using the <code>SELF_SIGNED_SSL_ALGORITHM</code> setting.</li>
<li><strong>Configure validity period:</strong> Optionally set how long the certificate should be valid using the <code>SELF_SIGNED_SSL_EXPIRY</code> setting.</li>
<li><strong>Set certificate subject:</strong> Configure the certificate subject using the <code>SELF_SIGNED_SSL_SUBJ</code> setting.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, certificates are automatically generated and applied to your domains.</li>
</ol>
<div class="admonition tip">
<p class="admonition-title">Stream Mode Configuration</p>
<p>For stream mode, configure the <code>LISTEN_STREAM_PORT_SSL</code> setting to specify the SSL/TLS listening port. This step is essential for proper operation in stream mode.</p>
</div>
<h3 id="features-configuration-settings_30">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>GENERATE_SELF_SIGNED_SSL</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Self-signed:</strong> Set to <code>yes</code> to enable automatic self-signed certificate generation.</td>
</tr>
<tr>
<td><code>SELF_SIGNED_SSL_ALGORITHM</code></td>
<td><code>ec-prime256v1</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificate Algorithm:</strong> Algorithm used for certificate generation: <code>ec-prime256v1</code>, <code>ec-secp384r1</code>, <code>rsa-2048</code>, or <code>rsa-4096</code>.</td>
</tr>
<tr>
<td><code>SELF_SIGNED_SSL_EXPIRY</code></td>
<td><code>365</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificate Validity:</strong> Number of days the self-signed certificate should be valid (default: 1 year).</td>
</tr>
<tr>
<td><code>SELF_SIGNED_SSL_SUBJ</code></td>
<td><code>/CN=www.example.com/</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Certificate Subject:</strong> Subject field for the certificate that identifies the domain.</td>
</tr>
</tbody>
</table>
<div class="admonition tip">
<p class="admonition-title">Development Environments</p>
<p>Self-signed certificates are ideal for development and testing environments where you need HTTPS but do not require certificates trusted by public browsers.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Certificate Information</p>
<p>The generated self-signed certificates use the specified algorithm (defaulting to Elliptic Curve cryptography with the prime256v1 curve) and include the configured subject, ensuring proper functionality for your domains.</p>
</div>
<h3 id="features-example-configurations_32">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="42:3"><input checked="checked" id="features-__tabbed_42_1" name="features-__tabbed_42" type="radio" /><input id="features-__tabbed_42_2" name="features-__tabbed_42" type="radio" /><input id="features-__tabbed_42_3" name="features-__tabbed_42" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_42_1">Basic Configuration</label><label for="features-__tabbed_42_2">Short-lived Certificates</label><label for="features-__tabbed_42_3">Testing with RSA Certificates</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration using self-signed certificates with default settings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">GENERATE_SELF_SIGNED_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SELF_SIGNED_SSL_ALGORITHM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ec-prime256v1&quot;</span>
<span class="nt">SELF_SIGNED_SSL_EXPIRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;365&quot;</span>
<span class="nt">SELF_SIGNED_SSL_SUBJ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/CN=mysite.local/&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with certificates that expire more frequently (useful for regularly testing certificate renewal processes):</p>
<div class="highlight"><pre><span></span><code><span class="nt">GENERATE_SELF_SIGNED_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SELF_SIGNED_SSL_ALGORITHM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ec-prime256v1&quot;</span>
<span class="nt">SELF_SIGNED_SSL_EXPIRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;90&quot;</span>
<span class="nt">SELF_SIGNED_SSL_SUBJ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/CN=dev.example.com/&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for a testing environment where a domain uses self-signed RSA certificates:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;test.example.com&quot;</span>
<span class="nt">GENERATE_SELF_SIGNED_SSL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SELF_SIGNED_SSL_ALGORITHM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;rsa-4096&quot;</span>
<span class="nt">SELF_SIGNED_SSL_EXPIRY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;365&quot;</span>
<span class="nt">SELF_SIGNED_SSL_SUBJ</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/CN=test.example.com/&quot;</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-sessions">Sessions</h2>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Sessions plugin provides robust HTTP session management for BunkerWeb, enabling secure and reliable user session tracking across requests. This core feature is essential for maintaining user state, authentication persistence, and supporting other features that require identity continuity, such as <a href="#features-antibot">anti‑bot</a> protection and user authentication systems.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>When a user first interacts with your website, BunkerWeb creates a unique session identifier.</li>
<li>This identifier is securely stored in a cookie on the user's browser.</li>
<li>On subsequent requests, BunkerWeb retrieves the session identifier from the cookie and uses it to access the user's session data.</li>
<li>Session data can be stored locally or in <a href="#features-redis">Redis</a> for distributed environments with multiple BunkerWeb instances.</li>
<li>Sessions are automatically managed with configurable timeouts, ensuring security while maintaining usability.</li>
<li>The cryptographic security of sessions is ensured through a secret key that is used to sign session cookies.</li>
</ol>
<h3 id="features-how-to-use_31">How to Use</h3>
<p>Follow these steps to configure and use the Sessions feature:</p>
<ol>
<li><strong>Configure session security:</strong> Set a strong, unique <code>SESSIONS_SECRET</code> to ensure session cookies cannot be forged. (The default value is "random" which triggers BunkerWeb to generate a random secret key.)</li>
<li><strong>Choose a session name:</strong> Optionally customize the <code>SESSIONS_NAME</code> to define what your session cookie will be called in the browser. (The default value is "random" which triggers BunkerWeb to generate a random name.)</li>
<li><strong>Set session timeouts:</strong> Configure how long sessions remain valid with the timeout settings (<code>SESSIONS_IDLING_TIMEOUT</code>, <code>SESSIONS_ROLLING_TIMEOUT</code>, <code>SESSIONS_ABSOLUTE_TIMEOUT</code>).</li>
<li><strong>Configure Redis integration:</strong> For distributed environments, set <code>USE_REDIS</code> to "yes" and configure your <a href="#features-redis">Redis connection</a> to share session data across multiple BunkerWeb nodes.</li>
<li><strong>Let BunkerWeb handle the rest:</strong> Once configured, session management happens automatically for your website.</li>
</ol>
<h3 id="features-configuration-settings_31">Configuration Settings</h3>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>SESSIONS_SECRET</code></td>
<td><code>random</code></td>
<td>global</td>
<td>no</td>
<td><strong>Session Secret:</strong> Cryptographic key used to sign session cookies. Should be a strong, random string unique to your site.</td>
</tr>
<tr>
<td><code>SESSIONS_NAME</code></td>
<td><code>random</code></td>
<td>global</td>
<td>no</td>
<td><strong>Cookie Name:</strong> The name of the cookie that will store the session identifier.</td>
</tr>
<tr>
<td><code>SESSIONS_IDLING_TIMEOUT</code></td>
<td><code>1800</code></td>
<td>global</td>
<td>no</td>
<td><strong>Idling Timeout:</strong> Maximum time (in seconds) of inactivity before the session is invalidated.</td>
</tr>
<tr>
<td><code>SESSIONS_ROLLING_TIMEOUT</code></td>
<td><code>3600</code></td>
<td>global</td>
<td>no</td>
<td><strong>Rolling Timeout:</strong> Maximum time (in seconds) before a session must be renewed.</td>
</tr>
<tr>
<td><code>SESSIONS_ABSOLUTE_TIMEOUT</code></td>
<td><code>86400</code></td>
<td>global</td>
<td>no</td>
<td><strong>Absolute Timeout:</strong> Maximum time (in seconds) before a session is destroyed regardless of activity.</td>
</tr>
<tr>
<td><code>SESSIONS_CHECK_IP</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Check IP:</strong> When set to <code>yes</code>, destroys the session if the client IP address changes.</td>
</tr>
<tr>
<td><code>SESSIONS_CHECK_USER_AGENT</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td><strong>Check User-Agent:</strong> When set to <code>yes</code>, destroys the session if the client User-Agent changes.</td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Security Considerations</p>
<p>The <code>SESSIONS_SECRET</code> setting is critical for security. In production environments:</p>
<ol>
<li>Use a strong, random value (at least 32 characters)</li>
<li>Keep this value confidential</li>
<li>Use the same value across all BunkerWeb instances in a cluster</li>
<li>Consider using environment variables or secrets management to avoid storing this in plain text</li>
</ol>
</div>
<div class="admonition tip">
<p class="admonition-title">Clustered Environments</p>
<p>If you're running multiple BunkerWeb instances behind a load balancer:</p>
<ol>
<li>Set <code>USE_REDIS</code> to <code>yes</code> and configure your Redis connection</li>
<li>Ensure all instances use the exact same <code>SESSIONS_SECRET</code> and <code>SESSIONS_NAME</code></li>
<li>This ensures users maintain their session regardless of which BunkerWeb instance handles their requests</li>
</ol>
</div>
<h3 id="features-example-configurations_33">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="43:4"><input checked="checked" id="features-__tabbed_43_1" name="features-__tabbed_43" type="radio" /><input id="features-__tabbed_43_2" name="features-__tabbed_43" type="radio" /><input id="features-__tabbed_43_3" name="features-__tabbed_43" type="radio" /><input id="features-__tabbed_43_4" name="features-__tabbed_43" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_43_1">Basic Configuration</label><label for="features-__tabbed_43_2">Enhanced Security</label><label for="features-__tabbed_43_3">Clustered Environment with Redis</label><label for="features-__tabbed_43_4">Long-lived Sessions</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration for a single BunkerWeb instance:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-strong-random-secret-key-here&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myappsession&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1800&quot;</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration with increased security settings:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-very-strong-random-secret-key-here&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;securesession&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;900&quot;</span><span class="w">  </span><span class="c1"># 15 minutes</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1800&quot;</span><span class="w">  </span><span class="c1"># 30 minutes</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;43200&quot;</span><span class="w">  </span><span class="c1"># 12 hours</span>
<span class="nt">SESSIONS_CHECK_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">SESSIONS_CHECK_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for multiple BunkerWeb instances sharing session data:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-strong-random-secret-key-here&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;clustersession&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1800&quot;</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;3600&quot;</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span>
<span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="c1"># Ensure Redis connection is configured correctly</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration for applications requiring extended session persistence:</p>
<div class="highlight"><pre><span></span><code><span class="nt">SESSIONS_SECRET</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;your-strong-random-secret-key-here&quot;</span>
<span class="nt">SESSIONS_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;persistentsession&quot;</span>
<span class="nt">SESSIONS_IDLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;86400&quot;</span><span class="w">  </span><span class="c1"># 1 day</span>
<span class="nt">SESSIONS_ROLLING_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;172800&quot;</span><span class="w">  </span><span class="c1"># 2 days</span>
<span class="nt">SESSIONS_ABSOLUTE_TIMEOUT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;604800&quot;</span><span class="w">  </span><span class="c1"># 7 days</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="features-ui">UI</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Integrate easily the BunkerWeb UI.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_UI</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td>Use UI</td>
</tr>
<tr>
<td><code>UI_HOST</code></td>
<td></td>
<td>global</td>
<td>no</td>
<td>Address of the web UI used for initial setup</td>
</tr>
</tbody>
</table>
<h2 id="features-user-manager-pro">User Manager <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style='transform : translateY(3px);'> (PRO)</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>Add the possibility to manage users on the web interface</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USERS_REQUIRE_2FA</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Require two-factor authentication for all users</td>
</tr>
</tbody>
</table>
<h2 id="features-whitelist">Whitelist</h2>
<p>STREAM support <img alt="⚠" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/26a0.svg" title=":warning:" /></p>
<p>The Whitelist plugin lets you define a list of trusted IP addresses that bypass other security filters.
For blocking unwanted clients instead, refer to the <a href="#features-blacklist">Blacklist plugin</a>.</p>
<p>The Whitelist plugin provides a comprehensive approach to explicitly allow access to your website based on various client attributes. This feature provides a security mechanism: visitors matching specific criteria are granted immediate access, while all others must pass regular security checks.</p>
<p><strong>How it works:</strong></p>
<ol>
<li>You define criteria for visitors who should be "whitelisted" (<em>IP addresses, networks, rDNS, ASN, User-Agent, or URI patterns</em>).</li>
<li>When a visitor attempts to access your site, BunkerWeb checks whether they match any of these whitelist criteria.</li>
<li>If a visitor matches any whitelist rule (and doesn't match any ignore rule), they are granted access to your site and <strong>bypass all other security checks</strong>.</li>
<li>If a visitor doesn't match any whitelist criteria, they proceed through all normal security checks as usual.</li>
<li>Whitelists can be automatically updated from external sources on a regular schedule.</li>
</ol>
<h3 id="features-how-to-use_32">How to Use</h3>
<p>Follow these steps to configure and use the Whitelist feature:</p>
<ol>
<li><strong>Enable the feature:</strong> The Whitelist feature is disabled by default. Set the <code>USE_WHITELIST</code> setting to <code>yes</code> to enable it.</li>
<li><strong>Configure allow rules:</strong> Define which IPs, networks, rDNS patterns, ASNs, User-Agents, or URIs should be whitelisted.</li>
<li><strong>Set up ignore rules:</strong> Specify any exceptions that should bypass the whitelist checks.</li>
<li><strong>Add external sources:</strong> Configure URLs for automatically downloading and updating whitelist data.</li>
<li><strong>Monitor access:</strong> Check the <a href="#web-ui">web UI</a> to see which visitors are being allowed or denied.</li>
</ol>
<div class="admonition info">
<p class="admonition-title">stream mode</p>
<p>When using stream mode, only IP, rDNS, and ASN checks are performed.</p>
</div>
<h3 id="features-configuration-settings_32">Configuration Settings</h3>
<p><strong>General</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_WHITELIST</code></td>
<td><code>no</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>Enable Whitelist:</strong> Set to <code>yes</code> to enable the whitelist feature.</td>
</tr>
</tbody>
</table>
<div class="tabbed-set tabbed-alternate" data-tabs="44:5"><input checked="checked" id="features-__tabbed_44_1" name="features-__tabbed_44" type="radio" /><input id="features-__tabbed_44_2" name="features-__tabbed_44" type="radio" /><input id="features-__tabbed_44_3" name="features-__tabbed_44" type="radio" /><input id="features-__tabbed_44_4" name="features-__tabbed_44" type="radio" /><input id="features-__tabbed_44_5" name="features-__tabbed_44" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_44_1">IP Address</label><label for="features-__tabbed_44_2">Reverse DNS</label><label for="features-__tabbed_44_3">ASN</label><label for="features-__tabbed_44_4">User Agent</label><label for="features-__tabbed_44_5">URI</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><strong>What this does:</strong> Whitelists visitors based on their IP address or network. These visitors will bypass all security checks.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WHITELIST_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Whitelist:</strong> List of IP addresses or networks (CIDR notation) to allow, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_IP</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Ignore List:</strong> List of IP addresses or networks that should bypass IP whitelist checks.</td>
</tr>
<tr>
<td><code>WHITELIST_IP_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Whitelist URLs:</strong> List of URLs containing IP addresses or networks to whitelist, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_IP_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>IP Ignore List URLs:</strong> List of URLs containing IP addresses or networks to ignore.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Whitelists visitors based on their domain name (in reverse). This is useful for allowing access to visitors from specific organizations or networks by their domain.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WHITELIST_RDNS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Whitelist:</strong> List of reverse DNS suffixes to allow, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_RDNS_GLOBAL</code></td>
<td><code>yes</code></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Global Only:</strong> Only perform rDNS whitelist checks on global IP addresses when set to <code>yes</code>.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_RDNS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Ignore List:</strong> List of reverse DNS suffixes that should bypass rDNS whitelist checks.</td>
</tr>
<tr>
<td><code>WHITELIST_RDNS_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Whitelist URLs:</strong> List of URLs containing reverse DNS suffixes to whitelist, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_RDNS_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>rDNS Ignore List URLs:</strong> List of URLs containing reverse DNS suffixes to ignore.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Whitelists visitors from specific network providers using Autonomous System Numbers. ASNs identify which provider or organization an IP belongs to.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WHITELIST_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Whitelist:</strong> List of Autonomous System Numbers to allow, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_ASN</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Ignore List:</strong> List of ASNs that should bypass ASN whitelist checks.</td>
</tr>
<tr>
<td><code>WHITELIST_ASN_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Whitelist URLs:</strong> List of URLs containing ASNs to whitelist, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_ASN_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>ASN Ignore List URLs:</strong> List of URLs containing ASNs to ignore.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Whitelists visitors based on what browser or tool they claim to be using. This is effective for allowing access to specific known tools or services.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WHITELIST_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Whitelist:</strong> List of User-Agent patterns (PCRE regex) to allow, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_USER_AGENT</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Ignore List:</strong> List of User-Agent patterns that should bypass User-Agent whitelist checks.</td>
</tr>
<tr>
<td><code>WHITELIST_USER_AGENT_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Whitelist URLs:</strong> List of URLs containing User-Agent patterns to whitelist.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_USER_AGENT_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>User-Agent Ignore List URLs:</strong> List of URLs containing User-Agent patterns to ignore.</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p><strong>What this does:</strong> Whitelists requests to specific URLs on your site. This is helpful for allowing access to specific endpoints regardless of other factors.</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>WHITELIST_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Whitelist:</strong> List of URI patterns (PCRE regex) to allow, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_URI</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Ignore List:</strong> List of URI patterns that should bypass URI whitelist checks.</td>
</tr>
<tr>
<td><code>WHITELIST_URI_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Whitelist URLs:</strong> List of URLs containing URI patterns to whitelist, separated by spaces.</td>
</tr>
<tr>
<td><code>WHITELIST_IGNORE_URI_URLS</code></td>
<td></td>
<td>multisite</td>
<td>no</td>
<td><strong>URI Ignore List URLs:</strong> List of URLs containing URI patterns to ignore.</td>
</tr>
</tbody>
</table>
</div>
</div>
</div>
<div class="admonition info">
<p class="admonition-title">URL Format Support</p>
<p>All <code>*_URLS</code> settings support HTTP/HTTPS URLs as well as local file paths using the <code>file:///</code> prefix. Basic authentication is supported using the <code>http://user:pass@url</code> format.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Regular Updates</p>
<p>Whitelists from URLs are automatically downloaded and updated hourly to ensure your protection remains current with the latest trusted sources.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Security Bypass</p>
<p>Whitelisted visitors will completely <strong>bypass all other security checks</strong> in BunkerWeb, including WAF rules, rate limiting, bad bot detection, and any other security mechanisms. Only use the whitelist for trusted sources you're absolutely confident in.</p>
</div>
<h3 id="features-example-configurations_34">Example Configurations</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="45:5"><input checked="checked" id="features-__tabbed_45_1" name="features-__tabbed_45" type="radio" /><input id="features-__tabbed_45_2" name="features-__tabbed_45" type="radio" /><input id="features-__tabbed_45_3" name="features-__tabbed_45" type="radio" /><input id="features-__tabbed_45_4" name="features-__tabbed_45" type="radio" /><input id="features-__tabbed_45_5" name="features-__tabbed_45" type="radio" /><div class="tabbed-labels"><label for="features-__tabbed_45_1">Basic Organization Access</label><label for="features-__tabbed_45_2">Advanced Configuration</label><label for="features-__tabbed_45_3">Using Local Files</label><label for="features-__tabbed_45_4">API Access Pattern</label><label for="features-__tabbed_45_5">Well-Known Crawlers</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>A simple configuration that whitelists company office IPs:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">10.0.0.0/8</span><span class="nv"> </span><span class="s">203.0.113.42&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A more comprehensive configuration with multiple whitelist criteria:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Company and trusted partner assets</span>
<span class="nt">WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24</span><span class="nv"> </span><span class="s">203.0.113.0/24&quot;</span>
<span class="nt">WHITELIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.company.com</span><span class="nv"> </span><span class="s">.partner-company.org&quot;</span>
<span class="nt">WHITELIST_ASN</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;12345</span><span class="nv"> </span><span class="s">67890&quot;</span><span class="w">  </span><span class="c1"># Company and partner ASNs</span>
<span class="nt">WHITELIST_USER_AGENT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;(?:\b)CompanyBot(?:\b)</span><span class="nv"> </span><span class="s">(?:\b)PartnerCrawler(?:\b)&quot;</span>

<span class="c1"># External trusted sources</span>
<span class="nt">WHITELIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-networks.txt&quot;</span>
<span class="nt">WHITELIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;https://example.com/trusted-crawlers.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Configuration using local files for whitelists:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">WHITELIST_IP_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/ip-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_RDNS_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/rdns-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_ASN_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/asn-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_USER_AGENT_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/user-agent-whitelist.txt&quot;</span>
<span class="nt">WHITELIST_URI_URLS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;file:///path/to/uri-whitelist.txt&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration focused on allowing access to only specific API endpoints:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="nt">WHITELIST_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;^/api/v1/public/</span><span class="nv"> </span><span class="s">^/api/v1/status&quot;</span>
<span class="nt">WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;192.168.1.0/24&quot;</span><span class="w">  </span><span class="c1"># Internal network for all endpoints</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>A configuration that whitelists common search engine and social media crawlers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">USE_WHITELIST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="c1"># Verification with reverse DNS for added security</span>
<span class="nt">WHITELIST_RDNS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;.googlebot.com</span><span class="nv"> </span><span class="s">.search.msn.com</span><span class="nv"> </span><span class="s">.crawl.yahoo.net</span><span class="nv"> </span><span class="s">.yandex.com</span><span class="nv"> </span><span class="s">.baidu.com</span><span class="nv"> </span><span class="s">.facebook.com&quot;</span>
<span class="nt">WHITELIST_RDNS_GLOBAL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w">  </span><span class="c1"># Only check global IPs</span>
</code></pre></div>
<p>This configuration allows legitimate crawlers to index your site without being subject to rate limiting or other security measures that might block them. The rDNS checks help verify that crawlers are actually coming from their claimed companies.</p>
</div>
</div>
</div></section><section class="print-page" id="advanced" heading-number="6"><h1 id="advanced-advanced-usages">Advanced usages</h1>
<p>Many real-world use case examples are available in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/examples">examples</a> folder of the GitHub repository.</p>
<p>We also provide numerous boilerplates, such as YAML files for various integrations and database types. These are available in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations</a> folder.</p>
<p>This section only focuses on advanced usages and security tuning, see the <a href="#features">settings section</a> of the documentation to see all the available settings.</p>
<h2 id="advanced-use-cases">Use cases</h2>
<div class="admonition tip">
<p class="admonition-title">Testing</p>
<p>To perform quick tests when multisite mode is enabled (and if you don't have the proper DNS entries set up for the domains) you can use curl with the HTTP Host header of your choice :
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: app1.example.com&quot;</span><span class="w"> </span>http://ip-or-fqdn-of-server
</code></pre></div></p>
<p>If you are using HTTPS, you will need to play with SNI :
<div class="highlight"><pre><span></span><code>curl<span class="w"> </span>-H<span class="w"> </span><span class="s2">&quot;Host: app1.example.com&quot;</span><span class="w"> </span>--resolve<span class="w"> </span>example.com:443:ip-of-server<span class="w"> </span>https://example.com
</code></pre></div></p>
</div>
<h3 id="advanced-behind-load-balancer-or-reverse-proxy">Behind load balancer or reverse proxy</h3>
<div class="admonition info">
<p class="admonition-title">Real IP</p>
<p>When BunkerWeb is itself behind a load balancer or a reverse proxy, you need to configure it so it can get the real IP address of the clients. <strong>If you don't, the security features will block the IP address of the load balancer or reverse proxy instead of the client's one</strong>.</p>
</div>
<p>BunkerWeb actually supports two methods to retrieve the real IP address of the client :</p>
<ul>
<li>Using the <code>PROXY protocol</code></li>
<li>Using a HTTP header like <code>X-Forwarded-For</code></li>
</ul>
<p>The following settings can be used :</p>
<ul>
<li><code>USE_REAL_IP</code> : enable/disable real IP retrieval</li>
<li><code>USE_PROXY_PROTOCOL</code> : enable/disable PROXY protocol support.</li>
<li><code>REAL_IP_FROM</code> : list of trusted IP/network address allowed to send us the "real IP"</li>
<li><code>REAL_IP_HEADER</code> : the HTTP header containing the real IP or special value <code>proxy_protocol</code> when using PROXY protocol</li>
</ul>
<p>You will find more settings about real IP in the <a href="#features-real-ip">settings section</a> of the documentation.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="advanced-__tabbed_1_1" name="advanced-__tabbed_1" type="radio" /><input id="advanced-__tabbed_1_2" name="advanced-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_1_1">HTTP header</label><label for="advanced-__tabbed_1_2">Proxy protocol</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>We will assume the following regarding the load balancers or reverse proxies (you will need to update the settings depending on your configuration) :</p>
<ul>
<li>They use the <code>X-Forwarded-For</code> header to set the real IP</li>
<li>They have IPs in the <code>1.2.3.0/24</code> and <code>100.64.0.0/10</code> networks</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="2:7"><input checked="checked" id="advanced-__tabbed_2_1" name="advanced-__tabbed_2" type="radio" /><input id="advanced-__tabbed_2_2" name="advanced-__tabbed_2" type="radio" /><input id="advanced-__tabbed_2_3" name="advanced-__tabbed_2" type="radio" /><input id="advanced-__tabbed_2_4" name="advanced-__tabbed_2" type="radio" /><input id="advanced-__tabbed_2_5" name="advanced-__tabbed_2" type="radio" /><input id="advanced-__tabbed_2_6" name="advanced-__tabbed_2" type="radio" /><input id="advanced-__tabbed_2_7" name="advanced-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_2_1">Web UI</label><label for="advanced-__tabbed_2_2">Linux</label><label for="advanced-__tabbed_2_3">All-in-one</label><label for="advanced-__tabbed_2_4">Docker</label><label for="advanced-__tabbed_2_5">Docker autoconf</label><label for="advanced-__tabbed_2_6">Kubernetes</label><label for="advanced-__tabbed_2_7">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navigate to the <strong>Global config</strong> page, select the <strong>Real IP</strong> plugin and fill out the following settings :</p>
<p><figure markdown><img align="center" alt="Real IP settings (header) using web UI" src="../assets/img/advanced-proxy1.png" /><figcaption>Real IP settings (header) using web UI</figcaption></figure></p>
<p>Please note that it's recommended to restart BunkerWeb when you change settings related to real IP.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the <code>/etc/bunkerweb/variables.env</code> file :</p>
<div class="highlight"><pre><span></span><code>...
USE_REAL_IP=yes
REAL_IP_FROM=1.2.3.0/24 100.64.0.0/16
REAL_IP_HEADER=X-Forwarded-For
...
</code></pre></div>
<p>Please note that it's recommended to issue a restart instead of reload when configuring settings related to real IP :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables when running the All-in-one container :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_REAL_IP</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_FROM</span><span class="o">=</span><span class="s2">&quot;1.2.3.0/24 100.64.0.0/10&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_HEADER</span><span class="o">=</span><span class="s2">&quot;X-Forwarded-For&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler containers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler containers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler pods.</p>
<p>Here is the corresponding part of your <code>values.yaml</code> file that you can use :</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#advanced-__tabbed_2_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler services:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;X-Forwarded-For&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Please note that if your service is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Read carefully</p>
<p>Only use the PROXY protocol if you are sure that your load balancer or reverse proxy is sending it. <strong>If you enable it and it's not used, you will get errors</strong>.</p>
</div>
<p>We will assume the following regarding the load balancers or reverse proxies (you will need to update the settings depending on your configuration) :</p>
<ul>
<li>They use the <code>PROXY protocol</code> v1 or v2 to set the real IP</li>
<li>They have IPs in the <code>1.2.3.0/24</code> and <code>100.64.0.0/10</code> networks</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="3:7"><input checked="checked" id="advanced-__tabbed_3_1" name="advanced-__tabbed_3" type="radio" /><input id="advanced-__tabbed_3_2" name="advanced-__tabbed_3" type="radio" /><input id="advanced-__tabbed_3_3" name="advanced-__tabbed_3" type="radio" /><input id="advanced-__tabbed_3_4" name="advanced-__tabbed_3" type="radio" /><input id="advanced-__tabbed_3_5" name="advanced-__tabbed_3" type="radio" /><input id="advanced-__tabbed_3_6" name="advanced-__tabbed_3" type="radio" /><input id="advanced-__tabbed_3_7" name="advanced-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_3_1">Web UI</label><label for="advanced-__tabbed_3_2">Linux</label><label for="advanced-__tabbed_3_3">All-in-one</label><label for="advanced-__tabbed_3_4">Docker</label><label for="advanced-__tabbed_3_5">Docker autoconf</label><label for="advanced-__tabbed_3_6">Kubernetes</label><label for="advanced-__tabbed_3_7">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navigate to the <strong>Global config</strong> page, select the <strong>Real IP</strong> plugin and fill out the following settings :</p>
<p><figure markdown><img align="center" alt="Real IP settings (PROXY protocol) using web UI" src="../assets/img/advanced-proxy2.png" /><figcaption>Real IP settings (PROXY protocol) using web UI</figcaption></figure></p>
<p>Please note that it's recommended to restart BunkerWeb when you change settings related to real IP.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the <code>/etc/bunkerweb/variables.env</code> file :</p>
<div class="highlight"><pre><span></span><code>...
USE_REAL_IP=yes
USE_PROXY_PROTOCOL=yes
REAL_IP_FROM=1.2.3.0/24 100.64.0.0/16
REAL_IP_HEADER=proxy_protocol
...
</code></pre></div>
<p>Please note that it's recommended to issue a restart instead of reload when configuring settings related to proxy protocols :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables when running the All-in-one container :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_REAL_IP</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_PROXY_PROTOCOL</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_FROM</span><span class="o">=</span><span class="s2">&quot;1.2.3.0/24 100.64.0.0/10&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REAL_IP_HEADER</span><span class="o">=</span><span class="s2">&quot;X-Forwarded-For&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler containers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler containers:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler pods.</p>
<p>Here is the corresponding part of your <code>values.yaml</code> file that you can use:</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_PROXY_PROTOCOL</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="nt">scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">extraEnvs</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_REAL_IP</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">USE_PROXY_PROTOCOL</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_FROM</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">REAL_IP_HEADER</span>
<span class="w">      </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#advanced-__tabbed_3_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>You will need to add the settings to the environment variables of both the BunkerWeb and scheduler services.</p>
<div class="highlight"><pre><span></span><code><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="nt">USE_REAL_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">USE_PROXY_PROTOCOL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_FROM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1.2.3.0/24</span><span class="nv"> </span><span class="s">100.64.0.0/10&quot;</span>
<span class="w">    </span><span class="nt">REAL_IP_HEADER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;proxy_protocol&quot;</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p>Please note that if your service is already created, you will need to delete it and recreate it so the new environment variables will be updated.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<h3 id="advanced-using-custom-dns-resolution-mechanisms">Using custom DNS resolution mechanisms</h3>
<p>BunkerWeb's NGINX configuration can be customized to use different DNS resolvers depending on your needs. This can be particularly useful in various scenarios:</p>
<ol>
<li>To respect entries in your local <code>/etc/hosts</code> file</li>
<li>When you need to use custom DNS servers for certain domains</li>
<li>To integrate with local DNS caching solutions</li>
</ol>
<h4 id="advanced-using-systemd-resolved">Using systemd-resolved</h4>
<p>Many modern Linux systems use <code>systemd-resolved</code> for DNS resolution. If you want BunkerWeb to respect the content of your <code>/etc/hosts</code> file and use the system's DNS resolution mechanism, you can configure it to use the local systemd-resolved DNS service.</p>
<p>To verify that systemd-resolved is running on your system, you can use:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>systemd-resolved
</code></pre></div>
<p>To enable systemd-resolved as your DNS resolver in BunkerWeb, set the <code>DNS_RESOLVERS</code> setting to <code>127.0.0.53</code>, which is the default listening address for systemd-resolved:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="advanced-__tabbed_4_1" name="advanced-__tabbed_4" type="radio" /><input id="advanced-__tabbed_4_2" name="advanced-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_4_1">Web UI</label><label for="advanced-__tabbed_4_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navigate to the <strong>Global config</strong> page and set the DNS resolvers to <code>127.0.0.53</code></p>
</div>
<div class="tabbed-block">
<p>You will need to modify the <code>/etc/bunkerweb/variables.env</code> file:</p>
<div class="highlight"><pre><span></span><code>...
DNS_RESOLVERS=127.0.0.53
...
</code></pre></div>
<p>After making this change, reload BunkerWeb to apply the configuration:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
</div>
</div>
<h4 id="advanced-using-dnsmasq">Using dnsmasq</h4>
<p><a href="http://www.thekelleys.org.uk/dnsmasq/doc.html">dnsmasq</a> is a lightweight DNS, DHCP, and TFTP server that's commonly used for local DNS caching and customization. It's particularly useful when you need more control over your DNS resolution than systemd-resolved provides.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="advanced-__tabbed_5_1" name="advanced-__tabbed_5" type="radio" /><input id="advanced-__tabbed_5_2" name="advanced-__tabbed_5" type="radio" /><input id="advanced-__tabbed_5_3" name="advanced-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_5_1">Linux</label><label for="advanced-__tabbed_5_2">All-in-one</label><label for="advanced-__tabbed_5_3">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>First, install and configure dnsmasq on your Linux system:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="advanced-__tabbed_6_1" name="advanced-__tabbed_6" type="radio" /><input id="advanced-__tabbed_6_2" name="advanced-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_6_1">Debian/Ubuntu</label><label for="advanced-__tabbed_6_2">RHEL/CentOS/Fedora</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Install dnsmasq</span>
sudo<span class="w"> </span>apt-get<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span>sudo<span class="w"> </span>apt-get<span class="w"> </span>install<span class="w"> </span>dnsmasq

<span class="c1"># Configure dnsmasq to listen only on localhost</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;listen-address=127.0.0.1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;bind-interfaces&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Add custom DNS entries if needed</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;address=/custom.example.com/192.168.1.10&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Restart dnsmasq</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>dnsmasq
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>dnsmasq
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="c1"># Install dnsmasq</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>dnsmasq

<span class="c1"># Configure dnsmasq to listen only on localhost</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;listen-address=127.0.0.1&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;bind-interfaces&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Add custom DNS entries if needed</span>
<span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;address=/custom.example.com/192.168.1.10&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>sudo<span class="w"> </span>tee<span class="w"> </span>-a<span class="w"> </span>/etc/dnsmasq.conf

<span class="c1"># Restart dnsmasq</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>restart<span class="w"> </span>dnsmasq
sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>dnsmasq
</code></pre></div>
</div>
</div>
</div>
<p>Then configure BunkerWeb to use dnsmasq by setting <code>DNS_RESOLVERS</code> to <code>127.0.0.1</code>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:2"><input checked="checked" id="advanced-__tabbed_7_1" name="advanced-__tabbed_7" type="radio" /><input id="advanced-__tabbed_7_2" name="advanced-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_7_1">Web UI</label><label for="advanced-__tabbed_7_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navigate to the <strong>Global config</strong> page, select the <strong>NGINX</strong> plugin and set the DNS resolvers to <code>127.0.0.1</code>.</p>
</div>
<div class="tabbed-block">
<p>You will need to modify the <code>/etc/bunkerweb/variables.env</code> file:</p>
<div class="highlight"><pre><span></span><code>...
DNS_RESOLVERS=127.0.0.1
...
</code></pre></div>
<p>After making this change, reload BunkerWeb:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<p>When using the All-in-one container, run dnsmasq in a separate container and configure BunkerWeb to use it:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a custom network for DNS communication</span>
docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>bw-dns

<span class="c1"># Run dnsmasq container using dockurr/dnsmasq with Quad9 DNS</span>
<span class="c1"># Quad9 provides security-focused DNS resolution with malware blocking</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>dnsmasq<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="w"> </span>bw-dns<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">DNS1</span><span class="o">=</span><span class="s2">&quot;9.9.9.9&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">DNS2</span><span class="o">=</span><span class="s2">&quot;149.112.112.112&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">53</span>:53/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">53</span>:53/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--cap-add<span class="o">=</span>NET_ADMIN<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--restart<span class="o">=</span>always<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>dockurr/dnsmasq

<span class="c1"># Run BunkerWeb All-in-one with dnsmasq DNS resolver</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="w"> </span>bw-dns<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">DNS_RESOLVERS</span><span class="o">=</span><span class="s2">&quot;dnsmasq&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Add a dnsmasq service to your docker-compose file and configure BunkerWeb to use it:</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">dnsmasq</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dockurr/dnsmasq</span>
<span class="w">    </span><span class="nt">container_name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">dnsmasq</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Using Quad9 DNS servers for enhanced security and privacy</span>
<span class="w">      </span><span class="c1"># Primary: 9.9.9.9 (Quad9 with malware blocking)</span>
<span class="w">      </span><span class="c1"># Secondary: 149.112.112.112 (Quad9 backup server)</span>
<span class="w">      </span><span class="nt">DNS1</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;9.9.9.9&quot;</span>
<span class="w">      </span><span class="nt">DNS2</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;149.112.112.112&quot;</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53:53/udp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">53:53/tcp</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_ADMIN</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">always</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>

<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DNS_RESOLVERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dnsmasq&quot;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DNS_RESOLVERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;dnsmasq&quot;</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># ...existing networks...</span>
<span class="w">  </span><span class="nt">bw-dns</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-dns</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="advanced-custom-configurations">Custom configurations</h3>
<p>To customize and add custom configurations to BunkerWeb, you can take advantage of its NGINX foundation. Custom NGINX configurations can be added in different NGINX contexts, including configurations for the ModSecurity Web Application Firewall (WAF), which is a core component of BunkerWeb. More details about ModSecurity configurations can be found <a href="#features-custom-configurations">here</a>.</p>
<p>Here are the available types of custom configurations:</p>
<ul>
<li><strong>http</strong>: Configurations at the HTTP level of NGINX.</li>
<li><strong>server-http</strong>: Configurations at the HTTP/Server level of NGINX.</li>
<li><strong>default-server-http</strong>: Configurations at the Server level of NGINX, specifically for the "default server" when the supplied client name doesn't match any server name in <code>SERVER_NAME</code>.</li>
<li><strong>modsec-crs</strong>: Configurations applied before the OWASP Core Rule Set is loaded.</li>
<li><strong>modsec</strong>: Configurations applied after the OWASP Core Rule Set is loaded, or used when the Core Rule Set is not loaded.</li>
<li><strong>crs-plugins-before</strong>: Configurations for the CRS plugins, applied before the CRS plugins are loaded.</li>
<li><strong>crs-plugins-after</strong>: Configurations for the CRS plugins, applied after the CRS plugins are loaded.</li>
<li><strong>stream</strong>: Configurations at the Stream level of NGINX.</li>
<li><strong>server-stream</strong>: Configurations at the Stream/Server level of NGINX.</li>
</ul>
<p>Custom configurations can be applied globally or specifically for a particular server, depending on the applicable context and whether the <a href="#concepts-multisite-mode">multisite mode</a> is enabled.</p>
<p>The method for applying custom configurations depends on the integration being used. However, the underlying process involves adding files with the <code>.conf</code> suffix to specific folders. To apply a custom configuration for a specific server, the file should be placed in a subfolder named after the primary server name.</p>
<p>Some integrations provide more convenient ways to apply configurations, such as using <a href="https://docs.docker.com/engine/swarm/configs/">Configs</a> in Docker Swarm or <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a> in Kubernetes. These options offer simpler approaches for managing and applying configurations.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:7"><input checked="checked" id="advanced-__tabbed_8_1" name="advanced-__tabbed_8" type="radio" /><input id="advanced-__tabbed_8_2" name="advanced-__tabbed_8" type="radio" /><input id="advanced-__tabbed_8_3" name="advanced-__tabbed_8" type="radio" /><input id="advanced-__tabbed_8_4" name="advanced-__tabbed_8" type="radio" /><input id="advanced-__tabbed_8_5" name="advanced-__tabbed_8" type="radio" /><input id="advanced-__tabbed_8_6" name="advanced-__tabbed_8" type="radio" /><input id="advanced-__tabbed_8_7" name="advanced-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_8_1">Web UI</label><label for="advanced-__tabbed_8_2">Linux</label><label for="advanced-__tabbed_8_3">All-in-one</label><label for="advanced-__tabbed_8_4">Docker</label><label for="advanced-__tabbed_8_5">Docker autoconf</label><label for="advanced-__tabbed_8_6">Kubernetes</label><label for="advanced-__tabbed_8_7">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Navigate to the <strong>Configs</strong> page, click on <strong>Create new custom config</strong>, you can then choose if it's a global one or specific to a service, the configuration type and the configuration name :</p>
<p><figure markdown><img align="center" alt="Custom configurations using web UI" src="../assets/img/advanced-config.png" /><figcaption>Custom configurations using web UI</figcaption></figure></p>
<p>Don't forget to click on the save button.</p>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-linux">Linux integration</a>, custom configurations must be written to the /etc/bunkerweb/configs folder.</p>
<p>Here is an example for server-http/hello-world.conf :</p>
<div class="highlight"><pre><span></span><code>location /hello {
  default_type &#39;text/plain&#39;;
  content_by_lua_block {
    ngx.say(&#39;world&#39;)
  }
}
</code></pre></div>
<p>Because BunkerWeb runs as an unprivileged user (nginx:nginx), you will need to edit the permissions :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:nginx<span class="w"> </span>/etc/bunkerweb/configs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>/etc/bunkerweb/configs
</code></pre></div>
<p>Now let's check the status of the Scheduler :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>If they are already running, we can reload it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>Otherwise, we will need to start it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-all-in-one-aio-image">All-in-one image</a>, you have two choices for adding custom configurations:</p>
<ul>
<li>Using specific settings <code>*_CUSTOM_CONF_*</code> as environment variables when running the container (recommended).</li>
<li>Writing <code>.conf</code> files to the <code>/data/configs/</code> directory within the volume mounted to <code>/data</code>.</li>
</ul>
<p><strong>Using settings (Environment Variables)</strong></p>
<p>The settings to use must follow the pattern <code>&lt;SITE&gt;_CUSTOM_CONF_&lt;TYPE&gt;_&lt;NAME&gt;</code>:</p>
<ul>
<li><code>&lt;SITE&gt;</code> : Optional primary server name if multisite mode is enabled and the config must be applied to a specific service.</li>
<li><code>&lt;TYPE&gt;</code> : The type of config, accepted values are <code>HTTP</code>, <code>DEFAULT_SERVER_HTTP</code>, <code>SERVER_HTTP</code>, <code>MODSEC</code>, <code>MODSEC_CRS</code>, <code>CRS_PLUGINS_BEFORE</code>, <code>CRS_PLUGINS_AFTER</code>, <code>STREAM</code> and <code>SERVER_STREAM</code>.</li>
<li><code>&lt;NAME&gt;</code> : The name of config without the <code>.conf</code> suffix.</li>
</ul>
<p>Here is a dummy example when running the All-in-one container:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="s2">&quot;CUSTOM_CONF_SERVER_HTTP_hello-world=location /hello { \</span>
<span class="s2">        default_type &#39;text/plain&#39;; \</span>
<span class="s2">        content_by_lua_block { \</span>
<span class="s2">          ngx.say(&#39;world&#39;); \</span>
<span class="s2">        } \</span>
<span class="s2">      }&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it for the new environment variables to be applied.</p>
<p><strong>Using files</strong></p>
<p>The first thing to do is to create the folders :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/configs/server-http
</code></pre></div>
<p>You can now write your configurations :</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;location /hello {</span>
<span class="s2">    default_type &#39;text/plain&#39;;</span>
<span class="s2">    content_by_lua_block {</span>
<span class="s2">        ngx.say(&#39;world&#39;)</span>
<span class="s2">    }</span>
<span class="s2">}&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>./bw-data/configs/server-http/hello-world.conf
</code></pre></div>
<p>Because the scheduler runs as an unprivileged user with UID and GID 101, you will need to edit the permissions :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>When starting the scheduler container, you will need to mount the folder on /data :</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>./bw-data:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-docker">Docker integration</a>, you have two choices for the addition of custom configurations :</p>
<ul>
<li>Using specific settings <code>*_CUSTOM_CONF_*</code> as environment variables (recommended)</li>
<li>Writing .conf files to the volume mounted on /data of the scheduler</li>
</ul>
<p><strong>Using settings</strong></p>
<p>The settings to use must follow the pattern <code>&lt;SITE&gt;_CUSTOM_CONF_&lt;TYPE&gt;_&lt;NAME&gt;</code> :</p>
<ul>
<li><code>&lt;SITE&gt;</code> : optional primary server name if multisite mode is enabled and the config must be applied to a specific service</li>
<li><code>&lt;TYPE&gt;</code> : the type of config, accepted values are <code>HTTP</code>, <code>DEFAULT_SERVER_HTTP</code>, <code>SERVER_HTTP</code>, <code>MODSEC</code>, <code>MODSEC_CRS</code>, <code>CRS_PLUGINS_BEFORE</code>, <code>CRS_PLUGINS_AFTER</code>, <code>STREAM</code> and <code>SERVER_STREAM</code></li>
<li><code>&lt;NAME&gt;</code> : the name of config without the .conf suffix</li>
</ul>
<p>Here is a dummy example using a docker-compose file :</p>
<div class="highlight"><pre><span></span><code><span class="nn">...</span>
<span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">CUSTOM_CONF_SERVER_HTTP_hello-world=</span>
<span class="w">      </span><span class="no">location /hello {</span>
<span class="w">        </span><span class="no">default_type &#39;text/plain&#39;;</span>
<span class="w">        </span><span class="no">content_by_lua_block {</span>
<span class="w">          </span><span class="no">ngx.say(&#39;world&#39;)</span>
<span class="w">          </span><span class="no">}</span>
<span class="w">      </span><span class="no">}</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p><strong>Using files</strong></p>
<p>The first thing to do is to create the folders :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/configs/server-http
</code></pre></div>
<p>You can now write your configurations :</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;location /hello {</span>
<span class="s2">    default_type &#39;text/plain&#39;;</span>
<span class="s2">    content_by_lua_block {</span>
<span class="s2">        ngx.say(&#39;world&#39;)</span>
<span class="s2">    }</span>
<span class="s2">}&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>./bw-data/configs/server-http/hello-world.conf
</code></pre></div>
<p>Because the scheduler runs as an unprivileged user with UID and GID 101, you will need to edit the permissions :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>When starting the scheduler container, you will need to mount the folder on /data :</p>
<div class="highlight"><pre><span></span><code><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-docker-autoconf">Docker autoconf integration</a>, you have two choices for adding custom configurations :</p>
<ul>
<li>Using specific settings <code>*_CUSTOM_CONF_*</code> as labels (easiest)</li>
<li>Writing .conf files to the volume mounted on /data of the scheduler</li>
</ul>
<p><strong>Using labels</strong></p>
<div class="admonition warning">
<p class="admonition-title">Limitations using labels</p>
<p>When using labels with the Docker autoconf integration, you can only apply custom configurations for the corresponding web service. Applying <strong>http</strong>, <strong>default-server-http</strong>, <strong>stream</strong> or any global configurations (like <strong>server-http</strong> or <strong>server-stream</strong> for all services) is not possible : you will need to mount files for that purpose.</p>
</div>
<p>The labels to use must follow the pattern <code>bunkerweb.CUSTOM_CONF_&lt;TYPE&gt;_&lt;NAME&gt;</code> :</p>
<ul>
<li><code>&lt;TYPE&gt;</code> : the type of config, accepted values are <code>SERVER_HTTP</code>, <code>MODSEC</code>, <code>MODSEC_CRS</code>, <code>CRS_PLUGINS_BEFORE</code>, <code>CRS_PLUGINS_AFTER</code> and <code>SERVER_STREAM</code></li>
<li><code>&lt;NAME&gt;</code> : the name of config without the .conf suffix</li>
</ul>
<p>Here is a dummy example using a docker-compose file :</p>
<div class="highlight"><pre><span></span><code><span class="nt">myapp</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">nginxdemos/nginx-hello</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">      </span><span class="no">bunkerweb.CUSTOM_CONF_SERVER_HTTP_hello-world=</span>
<span class="w">      </span><span class="no">location /hello {</span>
<span class="w">        </span><span class="no">default_type &#39;text/plain&#39;;</span>
<span class="w">        </span><span class="no">content_by_lua_block {</span>
<span class="w">            </span><span class="no">ngx.say(&#39;world&#39;)</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
<p><strong>Using files</strong></p>
<p>The first thing to do is to create the folders :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/configs/server-http
</code></pre></div>
<p>You can now write your configurations :</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;location /hello {</span>
<span class="s2">    default_type &#39;text/plain&#39;;</span>
<span class="s2">    content_by_lua_block {</span>
<span class="s2">        ngx.say(&#39;world&#39;)</span>
<span class="s2">    }</span>
<span class="s2">}&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>./bw-data/configs/server-http/hello-world.conf
</code></pre></div>
<p>Because the scheduler runs as an unprivileged user with UID and GID 101, you will need to edit the permissions :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>When starting the scheduler container, you will need to mount the folder on /data :</p>
<div class="highlight"><pre><span></span><code><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">  </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">  </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-kubernetes">Kubernetes integration</a>, custom configurations are managed using <a href="https://kubernetes.io/docs/concepts/configuration/configmap/">ConfigMap</a>.</p>
<p>To keep it simple, you don't even need to use the ConfigMap with a Pod (e.g. as environment variable or volume) : the autoconf Pod is listening for ConfigMap events and will update the custom configurations when needed.</p>
<p>When creating a ConfigMap, you will need to add special labels :</p>
<ul>
<li><strong>bunkerweb.io/CONFIG_TYPE</strong> : must be set to a valid custom configuration type (http, server-http, default-server-http, modsec, modsec-crs, crs-plugins-before, crs-plugins-after, stream or server-stream)</li>
<li><strong>bunkerweb.io/CONFIG_SITE</strong> : set to a server name to apply configuration to that specific server (optional, will be applied globally if unset)</li>
</ul>
<p>Here is the example :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cfg-bunkerweb-all-server-http</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">      </span><span class="nt">bunkerweb.io/CONFIG_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;server-http&quot;</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myconf</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">|</span>
<span class="w">    </span><span class="no">location /hello {</span>
<span class="w">        </span><span class="no">default_type &#39;text/plain&#39;;</span>
<span class="w">        </span><span class="no">content_by_lua_block {</span>
<span class="w">            </span><span class="no">ngx.say(&#39;world&#39;)</span>
<span class="w">        </span><span class="no">}</span>
<span class="w">    </span><span class="no">}</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Custom Extra Config</p>
<p>Since the <code>1.6.0-rc3</code> version, you can add/override settings using the <code>bunkerweb.io/CONFIG_TYPE=settings</code> annotation. Here is an example :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ConfigMap</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">cfg-bunkerweb-extra-settings</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/CONFIG_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;settings&quot;</span>
<span class="nt">data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">USE_ANTIBOT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;captcha&quot;</span><span class="w"> </span><span class="c1"># multisite setting that will be applied to all services that do not override it</span>
<span class="w">  </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># global setting that will be applied globally</span>
<span class="w">  </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#advanced-__tabbed_5_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>When using the <a href="#integrations-swarm">Swarm integration</a>, custom configurations are managed using <a href="https://docs.docker.com/engine/swarm/configs/">Docker Configs</a>.</p>
<p>To keep it simple, you don't even need to attach the Config to a service : the autoconf service is listening for Config events and will update the custom configurations when needed.</p>
<p>When creating a Config, you will need to add special labels :</p>
<ul>
<li><strong>bunkerweb.CONFIG_TYPE</strong> : must be set to a valid custom configuration type (http, server-http, default-server-http, modsec, modsec-crs, crs-plugins-before, crs-plugins-after, stream or server-stream)</li>
<li><strong>bunkerweb.CONFIG_SITE</strong> : set to a server name to apply configuration to that specific server (optional, will be applied globally if unset)</li>
</ul>
<p>Here is the example :</p>
<div class="highlight"><pre><span></span><code><span class="nb">echo</span><span class="w"> </span><span class="s2">&quot;location /hello {</span>
<span class="s2">    default_type &#39;text/plain&#39;;</span>
<span class="s2">    content_by_lua_block {</span>
<span class="s2">        ngx.say(&#39;world&#39;)</span>
<span class="s2">    }</span>
<span class="s2">}&quot;</span><span class="w"> </span><span class="p">|</span><span class="w"> </span>docker<span class="w"> </span>config<span class="w"> </span>create<span class="w"> </span>-l<span class="w"> </span>bunkerweb.CONFIG_TYPE<span class="o">=</span>server-http<span class="w"> </span>my-config<span class="w"> </span>-
</code></pre></div>
<p>There is no update mechanism : the alternative is to remove an existing config using <code>docker config rm</code> and then recreate it.</p>
</div>
</div>
</div>
<h3 id="advanced-running-many-services-in-production">Running many services in production</h3>
<h4 id="advanced-global-crs">Global CRS</h4>
<div class="admonition warning">
<p class="admonition-title">CRS plugins</p>
<p>When the CRS is loaded globally, <strong>CRS plugins are not supported</strong>. If you need to use them, you will need to load the CRS per service.</p>
</div>
<p>If you use BunkerWeb in production with a large number of services, and you enable the ModSecurity feature globally with CRS rules, the time required to load BunkerWeb configurations may become too long, potentially resulting in a timeout.</p>
<p>The workaround is to load the CRS rules globally rather than per service. This behavior is not enabled by default for backward compatibility reasons and because it has a drawback: if you enable global CRS rule loading, it will no longer be possible to define modsec-crs rules (executed before the CRS rules) on a per-service basis. However, this limitation can be bypassed by writing global <code>modsec-crs</code> exclusion rules like this:</p>
<div class="highlight"><pre><span></span><code>SecRule REQUEST_FILENAME &quot;@rx ^/somewhere$&quot; &quot;nolog,phase:4,allow,id:1010,chain&quot;
SecRule REQUEST_HEADERS:Host &quot;@rx ^app1\.example\.com$&quot; &quot;nolog&quot;
</code></pre></div>
<p>You can enable the global CRS loading by setting <code>USE_MODSECURITY_GLOBAL_CRS</code> to <code>yes</code>.</p>
<h4 id="advanced-adjust-max_allowed_packet-for-mariadbmysql">Adjust max_allowed_packet for MariaDB/MySQL</h4>
<p>It appears that the default value for the <code>max_allowed_packet</code> parameter in MariaDB and MySQL database servers is not sufficient when using BunkerWeb with a large number of services.</p>
<p>If you encounter errors like this, especially on the scheduler:</p>
<div class="highlight"><pre><span></span><code>[Warning] Aborted connection 5 to db: &#39;db&#39; user: &#39;bunkerweb&#39; host: &#39;172.20.0.4&#39; (Got a packet bigger than &#39;max_allowed_packet&#39; bytes)
</code></pre></div>
<p>You will need to increase the <code>max_allowed_packet</code> on your database server.</p>
<h3 id="advanced-persistence-of-bans-and-reports">Persistence of bans and reports</h3>
<p>By default, BunkerWeb stores bans and reports in a local Lua datastore. While simple and efficient, this setup means that data is lost when the instance is restarted. To ensure that bans and reports persist across restarts, you can configure BunkerWeb to use a remote <a href="https://redis.io/">Redis</a> or <a href="https://valkey.io/">Valkey</a> server.</p>
<p><strong>Why Use Redis/Valkey?</strong></p>
<p>Redis and Valkey are powerful, in-memory data stores commonly used as databases, caches, and message brokers. They are highly scalable and support a variety of data structures, including:</p>
<ul>
<li><strong>Strings</strong>: Basic key-value pairs.</li>
<li><strong>Hashes</strong>: Field-value pairs within a single key.</li>
<li><strong>Lists</strong>: Ordered collections of strings.</li>
<li><strong>Sets</strong>: Unordered collections of unique strings.</li>
<li><strong>Sorted Sets</strong>: Ordered collections with scores.</li>
</ul>
<p>By leveraging Redis or Valkey, BunkerWeb can persistently store bans, reports, and cache data, ensuring durability and scalability.</p>
<p><strong>Enabling Redis/Valkey Support</strong></p>
<p>To enable Redis or Valkey support, configure the following settings in your BunkerWeb configuration file:</p>
<div class="highlight"><pre><span></span><code># Enable Redis/Valkey support
USE_REDIS=yes

# Redis/Valkey server hostname or IP address
REDIS_HOST=&lt;hostname&gt;

# Redis/Valkey server port number (default: 6379)
REDIS_PORT=6379

# Redis/Valkey database number (default: 0)
REDIS_DATABASE=0
</code></pre></div>
<ul>
<li><strong><code>USE_REDIS</code></strong>: Set to <code>yes</code> to enable Redis/Valkey integration.</li>
<li><strong><code>REDIS_HOST</code></strong>: Specify the hostname or IP address of the Redis/Valkey server.</li>
<li><strong><code>REDIS_PORT</code></strong>: Specify the port number for the Redis/Valkey server. Defaults to <code>6379</code>.</li>
<li><strong><code>REDIS_DATABASE</code></strong>: Specify the Redis/Valkey database number to use. Defaults to <code>0</code>.</li>
</ul>
<p>If you require more advanced settings, such as authentication, SSL/TLS support, or Sentinel mode, refer to the <a href="#features-redis">Redis plugin settings documentation</a> for detailed guidance.</p>
<h3 id="advanced-protect-udptcp-applications">Protect UDP/TCP applications</h3>
<div class="admonition example">
<p class="admonition-title">Experimental feature</p>
<p>This feature is not production-ready. Feel free to test it and report us any bug using <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a> in the GitHub repository.</p>
</div>
<p>BunkerWeb offers the capability to function as a <strong>generic UDP/TCP reverse proxy</strong>, allowing you to protect any network-based applications operating at least on layer 4 of the OSI model. Instead of utilizing the "classical" HTTP module, BunkerWeb leverages the <a href="https://nginx.org/en/docs/stream/ngx_stream_core_module.html">stream module</a> of NGINX.</p>
<p>It's important to note that <strong>not all settings and security features are available when using the stream module</strong>. Additional information on this can be found in the <a href="#features">settings</a> sections of the documentation.</p>
<p>Configuring a basic reverse proxy is quite similar to the HTTP setup, as it involves using the same settings: <code>USE_REVERSE_PROXY=yes</code> and <code>REVERSE_PROXY_HOST=myapp:9000</code>. Even when BunkerWeb is positioned behind a Load Balancer, the settings remain the same (with <strong>PROXY protocol</strong> being the supported option due to evident reasons).</p>
<p>On top of that, the following specific settings are used :</p>
<ul>
<li><code>SERVER_TYPE=stream</code> : activate <code>stream</code> mode (generic UDP/TCP) instead of <code>http</code> one (which is the default)</li>
<li><code>LISTEN_STREAM_PORT=4242</code> : the listening "plain" (without SSL/TLS) port that BunkerWeb will listen on</li>
<li><code>LISTEN_STREAM_PORT_SSL=4343</code> : the listening "ssl/tls" port that BunkerWeb will listen on</li>
<li><code>USE_UDP=no</code> : listen for and forward UDP packets instead of TCP</li>
</ul>
<p>For complete list of settings regarding <code>stream</code> mode, please refer to the <a href="#features">settings</a> section of the documentation.</p>
<div class="admonition tip">
<p class="admonition-title">multiple listening ports</p>
<p>Since the <code>1.6.0-rc2</code> version, BunkerWeb supports multiple listening ports for the <code>stream</code> mode. You can specify them using the <code>LISTEN_STREAM_PORT</code> and <code>LISTEN_STREAM_PORT_SSL</code> settings.</p>
<p>Here is an example :</p>
<div class="highlight"><pre><span></span><code>...
LISTEN_STREAM_PORT=4242
LISTEN_STREAM_PORT_SSL=4343
LISTEN_STREAM_PORT_1=4244
LISTEN_STREAM_PORT_SSL_1=4344
...
</code></pre></div>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="9:6"><input checked="checked" id="advanced-__tabbed_9_1" name="advanced-__tabbed_9" type="radio" /><input id="advanced-__tabbed_9_2" name="advanced-__tabbed_9" type="radio" /><input id="advanced-__tabbed_9_3" name="advanced-__tabbed_9" type="radio" /><input id="advanced-__tabbed_9_4" name="advanced-__tabbed_9" type="radio" /><input id="advanced-__tabbed_9_5" name="advanced-__tabbed_9" type="radio" /><input id="advanced-__tabbed_9_6" name="advanced-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_9_1">All-in-one</label><label for="advanced-__tabbed_9_2">Docker</label><label for="advanced-__tabbed_9_3">Docker autoconf</label><label for="advanced-__tabbed_9_4">Swarm</label><label for="advanced-__tabbed_9_5">Kubernetes</label><label for="advanced-__tabbed_9_6">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>You will need to add the settings to the environment variables when running the All-in-one container. You will also need to expose the stream ports.</p>
<p>This example configures BunkerWeb to proxy two stream-based applications, <code>app1.example.com</code> and <code>app2.example.com</code>.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVICE_UI</span><span class="o">=</span><span class="s2">&quot;no&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVER_NAME</span><span class="o">=</span><span class="s2">&quot;app1.example.com app2.example.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">MULTISITE</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">USE_REVERSE_PROXY</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVER_TYPE</span><span class="o">=</span><span class="s2">&quot;stream&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app1.example.com_REVERSE_PROXY_HOST<span class="o">=</span><span class="s2">&quot;myapp1:9000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app1.example.com_LISTEN_STREAM_PORT<span class="o">=</span><span class="s2">&quot;10000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app2.example.com_REVERSE_PROXY_HOST<span class="o">=</span><span class="s2">&quot;myapp2:9000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app2.example.com_LISTEN_STREAM_PORT<span class="o">=</span><span class="s2">&quot;20000&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">10000</span>:10000/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">20000</span>:20000/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it for the new environment variables to be applied.</p>
<p>Your applications (<code>myapp1</code>, <code>myapp2</code>) should be running in separate containers (or be otherwise accessible) and their hostnames/IPs (e.g., <code>myapp1</code>, <code>myapp2</code> used in <code>_REVERSE_PROXY_HOST</code>) must be resolvable and reachable from the <code>bunkerweb-aio</code> container. This typically involves connecting them to a shared Docker network.</p>
<div class="admonition note">
<p class="admonition-title">Deactivate UI Service</p>
<p>Deactivating the UI service (e.g., by setting <code>SERVICE_UI=no</code> as an environment variable) is recommended as the Web UI is not compatible with <code>SERVER_TYPE=stream</code>.</p>
</div>
</div>
<div class="tabbed-block">
<p>When using Docker integration, the easiest way of protecting existing network applications is to add the services in the <code>bw-services</code> network :</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for all services</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080&quot;</span><span class="w"> </span><span class="c1"># Keep it if you want to use Let&#39;s Encrypt automation when using http challenge type</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10000:10000&quot;</span><span class="w"> </span><span class="c1"># app1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;20000:20000&quot;</span><span class="w"> </span><span class="c1"># app2</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This setting is mandatory to specify the BunkerWeb instance</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;app1.example.com</span><span class="nv"> </span><span class="s">app2.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Will be applied to all services</span>
<span class="w">      </span><span class="nt">SERVER_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span><span class="w"> </span><span class="c1"># Will be applied to all services</span>
<span class="w">      </span><span class="nt">app1.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp1:9000&quot;</span>
<span class="w">      </span><span class="nt">app1.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10000&quot;</span>
<span class="w">      </span><span class="nt">app2.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp2:9000&quot;</span>
<span class="w">      </span><span class="nt">app2.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20000&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Before running the <a href="#integrations-docker-autoconf">Docker autoconf integration</a> stack on your machine, you will need to edit the ports :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080&quot;</span><span class="w"> </span><span class="c1"># Keep it if you want to use Let&#39;s Encrypt automation when using http challenge type</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;10000:10000&quot;</span><span class="w"> </span><span class="c1"># app1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;20000:20000&quot;</span><span class="w"> </span><span class="c1"># app2</span>
<span class="nn">...</span>
</code></pre></div>
<p>Once the stack is running, you can connect your existing applications to the <code>bw-services</code> network and configure BunkerWeb with labels :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp1:9000&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=10000&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp2:9000&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=20000&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#advanced-__tabbed_4_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>Before running the <a href="#integrations-swarm">Swarm integration</a> stack on your machine, you will need to edit the ports :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="c1"># Keep it if you want to use Let&#39;s Encrypt automation when using http challenge type</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="c1"># app1</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="c1"># app2</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="nn">...</span>
</code></pre></div>
<p>Once the stack is running, you can connect your existing applications to the <code>bw-services</code> network and configure BunkerWeb with labels :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>

<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp1:9000&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=10000&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="w"> </span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="w"> </span><span class="p p-Indicator">]</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_TYPE=stream&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=myapp2:9000&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.LISTEN_STREAM_PORT=20000&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition example">
<p class="admonition-title">Experimental feature</p>
<p>At the moment, <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingresses</a> does not support the <code>stream</code> mode. <strong>What we are doing here is a workaround to make it work.</strong></p>
<p>Feel free to test it and report us any bug using <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a> in the GitHub repository.</p>
</div>
<p>Before running the <a href="#integrations-kubernetes">Kubernetes integration</a> stack on your machine, you will need to open the ports on your load balancer :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">lb</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">LoadBalancer</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">http</span><span class="w"> </span><span class="c1"># Keep it if you want to use Let&#39;s Encrypt automation when using http challenge type</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10000</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">20000</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
</code></pre></div>
<p>Once the stack is running, you can create your ingress resources :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">networking.k8s.io/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Ingress</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ingress</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="w">  </span><span class="nt">annotations</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb.io/SERVER_TYPE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;stream&quot;</span><span class="w"> </span><span class="c1"># Will be applied to all services</span>
<span class="w">    </span><span class="nt">bunkerweb.io/app1.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;10000&quot;</span>
<span class="w">    </span><span class="nt">bunkerweb.io/app2.example.com_LISTEN_STREAM_PORT</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;20000&quot;</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">rules</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span><span class="w"> </span><span class="c1"># This isn&#39;t used in stream mode but is required</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app1</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">host</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2.example.com</span>
<span class="w">      </span><span class="nt">http</span><span class="p">:</span>
<span class="w">        </span><span class="nt">paths</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">path</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/</span><span class="w"> </span><span class="c1"># This isn&#39;t used in stream mode but is required</span>
<span class="w">            </span><span class="nt">pathType</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Prefix</span>
<span class="w">            </span><span class="nt">backend</span><span class="p">:</span>
<span class="w">              </span><span class="nt">service</span><span class="p">:</span>
<span class="w">                </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app2</span>
<span class="w">                </span><span class="nt">port</span><span class="p">:</span>
<span class="w">                  </span><span class="nt">number</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app1&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app1</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app1</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="w">  </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">istio/tcp-echo-server:1.3</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;9000&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;app2&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">containerPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="nn">---</span>
<span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Service</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">svc-app2</span>
<span class="w">  </span><span class="nt">namespace</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">services</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">app2</span>
<span class="w">  </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">TCP</span>
<span class="w">      </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
<span class="w">      </span><span class="nt">targetPort</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">9000</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the <code>/etc/bunkerweb/variables.env</code> file :</p>
<div class="highlight"><pre><span></span><code>...
SERVER_NAME=app1.example.com app2.example.com
MULTISITE=yes
USE_REVERSE_PROXY=yes
SERVER_TYPE=stream
app1.example.com_REVERSE_PROXY_HOST=myapp1.domain.or.ip:9000
app1.example.com_LISTEN_STREAM_PORT=10000
app2.example.com_REVERSE_PROXY_HOST=myapp2.domain.or.ip:9000
app2.example.com_LISTEN_STREAM_PORT=20000
...
</code></pre></div>
<p>Now let's check the status of the Scheduler :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>If they are already running, we can reload it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>Otherwise, we will need to start it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
</div>
</div>
<h3 id="advanced-php">PHP</h3>
<div class="admonition example">
<p class="admonition-title">Experimental feature</p>
<p>At the moment, PHP support with BunkerWeb is still in beta and we recommend you use a reverse-proxy architecture if you can. By the way, PHP is not supported at all for some integrations like Kubernetes.</p>
</div>
<p>BunkerWeb supports PHP using external or remote <a href="https://www.php.net/manual/en/install.fpm.php">PHP-FPM</a> instances. We will assume that you are already familiar with managing that kind of services.</p>
<p>The following settings can be used :</p>
<ul>
<li><code>REMOTE_PHP</code> : Hostname of the remote PHP-FPM instance.</li>
<li><code>REMOTE_PHP_PATH</code> : Root folder containing files in the remote PHP-FPM instance.</li>
<li><code>REMOTE_PHP_PORT</code> : Port of the remote PHP-FPM instance (<em>default is 9000</em>).</li>
<li><code>LOCAL_PHP</code> : Path to the local socket file of PHP-FPM instance.</li>
<li><code>LOCAL_PHP_PATH</code> : Root folder containing files in the local PHP-FPM instance.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="10:6"><input checked="checked" id="advanced-__tabbed_10_1" name="advanced-__tabbed_10" type="radio" /><input id="advanced-__tabbed_10_2" name="advanced-__tabbed_10" type="radio" /><input id="advanced-__tabbed_10_3" name="advanced-__tabbed_10" type="radio" /><input id="advanced-__tabbed_10_4" name="advanced-__tabbed_10" type="radio" /><input id="advanced-__tabbed_10_5" name="advanced-__tabbed_10" type="radio" /><input id="advanced-__tabbed_10_6" name="advanced-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_10_1">All-in-one</label><label for="advanced-__tabbed_10_2">Docker</label><label for="advanced-__tabbed_10_3">Docker autoconf</label><label for="advanced-__tabbed_10_4">Swarm</label><label for="advanced-__tabbed_10_5">Kubernetes</label><label for="advanced-__tabbed_10_6">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>When using the <a href="#integrations-all-in-one-aio-image">All-in-one image</a>, to support PHP applications, you will need to :</p>
<ul>
<li>Mount your PHP files into the <code>/var/www/html</code> folder of BunkerWeb.</li>
<li>Set up a PHP-FPM container for your application and mount the folder containing PHP files.</li>
<li>Use the specific settings <code>REMOTE_PHP</code> and <code>REMOTE_PHP_PATH</code> as environment variables when running BunkerWeb.</li>
</ul>
<p>If you enable the <a href="#concepts-multisite-mode">multisite mode</a>, you will need to create separate directories for each of your applications. Each subdirectory should be named using the first value of <code>SERVER_NAME</code>. Here is a dummy example :</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
└── app2.example.com
    └── index.php

2 directories, 2 files
</code></pre></div>
<p>We will assume that your PHP apps are located into a folder named <code>www</code>. Please note that you will need to fix the permissions so BunkerWeb (UID/GID 101) can at least read files and list folders and PHP-FPM (UID/GID 33 if you use the <code>php:fpm</code> image) is the owner of the files and folders :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>./www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>You can now run BunkerWeb, configure it for your PHP application and also run the PHP apps. You will need to create a custom Docker network to allow BunkerWeb to communicate with your PHP-FPM containers.</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Create a custom network</span>
docker<span class="w"> </span>network<span class="w"> </span>create<span class="w"> </span>php-network

<span class="c1"># Run PHP-FPM containers</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>myapp1-php<span class="w"> </span>--network<span class="w"> </span>php-network<span class="w"> </span>-v<span class="w"> </span>./www/app1.example.com:/app<span class="w"> </span>php:fpm
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span>--name<span class="w"> </span>myapp2-php<span class="w"> </span>--network<span class="w"> </span>php-network<span class="w"> </span>-v<span class="w"> </span>./www/app2.example.com:/app<span class="w"> </span>php:fpm

<span class="c1"># Run BunkerWeb All-in-one</span>
docker<span class="w"> </span>run<span class="w"> </span>-d<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--name<span class="w"> </span>bunkerweb-aio<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>--network<span class="w"> </span>php-network<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>./www:/var/www/html<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-v<span class="w"> </span>bw-storage:/data<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">SERVER_NAME</span><span class="o">=</span><span class="s2">&quot;app1.example.com app2.example.com&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">MULTISITE</span><span class="o">=</span><span class="s2">&quot;yes&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span><span class="nv">REMOTE_PHP_PATH</span><span class="o">=</span><span class="s2">&quot;/app&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app1.example.com_REMOTE_PHP<span class="o">=</span><span class="s2">&quot;myapp1-php&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-e<span class="w"> </span>app2.example.com_REMOTE_PHP<span class="o">=</span><span class="s2">&quot;myapp2-php&quot;</span><span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">80</span>:8080/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/tcp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>-p<span class="w"> </span><span class="m">443</span>:8443/udp<span class="w"> </span><span class="se">\</span>
<span class="w">    </span>bunkerity/bunkerweb-all-in-one:1.6.2
</code></pre></div>
<p>Please note that if your container is already created, you will need to delete it and recreate it for the new environment variables to be applied.</p>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-docker">Docker integration</a>, to support PHP applications, you will need to :</p>
<ul>
<li>Mount your PHP files into the <code>/var/www/html</code> folder of BunkerWeb</li>
<li>Set up a PHP-FPM container for your application and mount the folder containing PHP files</li>
<li>Use the specific settings <code>REMOTE_PHP</code> and <code>REMOTE_PHP_PATH</code> as environment variables when starting BunkerWeb</li>
</ul>
<p>If you enable the <a href="#concepts-multisite-mode">multisite mode</a>, you will need to create separate directories for each of your applications. Each subdirectory should be named using the first value of <code>SERVER_NAME</code>. Here is a dummy example :</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directories, 3 files
</code></pre></div>
<p>We will assume that your PHP apps are located into a folder named <code>www</code>. Please note that you will need to fix the permissions so BunkerWeb (UID/GID 101) can at least read files and list folders and PHP-FPM (UID/GID 33 if you use the <code>php:fpm</code> image) is the owner of the files and folders :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>./www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>You can now run BunkerWeb, configure it for your PHP application and also run the PHP apps :</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for all services</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www:/var/www/html</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This setting is mandatory to specify the BunkerWeb instance</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;app1.example.com</span><span class="nv"> </span><span class="s">app2.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REMOTE_PHP_PATH</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/app&quot;</span><span class="w"> </span><span class="c1"># Will be applied to all services thanks to the MULTISITE setting</span>
<span class="w">      </span><span class="nt">app1.example.com_REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp1&quot;</span>
<span class="w">      </span><span class="nt">app2.example.com_REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp2&quot;</span>
<span class="w">      </span><span class="nt">app3.example.com_REMOTE_PHP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;myapp3&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app1.example.com:/app</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app2.example.com:/app</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">myapp3</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app3.example.com:/app</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition info">
<p class="admonition-title">Multisite mode enabled</p>
<p>The <a href="#integrations-docker-autoconf">Docker autoconf integration</a> integration implies the use of multisite mode : protecting one PHP application is the same as protecting multiple ones.</p>
</div>
<p>When using the <a href="#integrations-docker-autoconf">Docker autoconf integration</a>, to support PHP applications, you will need to :</p>
<ul>
<li>Mount your PHP files into the <code>/var/www/html</code> folder of BunkerWeb</li>
<li>Set up a PHP-FPM containers for your applications and mount the folder containing PHP apps</li>
<li>Use the specific settings <code>REMOTE_PHP</code> and <code>REMOTE_PHP_PATH</code> as labels for your PHP-FPM container</li>
</ul>
<p>Since the Docker autoconf implies using the <a href="#concepts-multisite-mode">multisite mode</a>, you will need to create separate directories for each of your applications. Each subdirectory should be named using the first value of <code>SERVER_NAME</code>. Here is a dummy example :</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directories, 3 files
</code></pre></div>
<p>Once the folders are created, copy your files and fix the permissions so BunkerWeb (UID/GID 101) can at least read files and list folders and PHP-FPM (UID/GID 33 if you use the <code>php:fpm</code> image) is the owner of the files and folders :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>./www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>./www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>When you start the BunkerWeb autoconf stack, mount the <code>www</code> folder into <code>/var/www/html</code> for the <strong>Scheduler</strong> container :</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-api-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-api-env</span>
<span class="w">  </span><span class="c1"># We use an anchor to avoid repeating the same settings for all services</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www:/var/www/html</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-api-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># We don&#39;t need to specify the BunkerWeb instance here as they are automatically detected by the autoconf service</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># The server name will be filled with services labels</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory setting for autoconf</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># The Docker socket</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
</code></pre></div>
<p>You can now create your PHP-FPM containers, mount the correct subfolders and use labels to configure BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app1.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp1</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp1&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app2.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp2</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp2&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp3</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app3.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp3</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app3.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp3&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#advanced-__tabbed_6_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<div class="admonition info">
<p class="admonition-title">Multisite mode enabled</p>
<p>The <a href="#integrations-docker-autoconf">Swarm integration</a> integration implies the use of multisite mode : protecting one PHP application is the same as protecting multiple ones.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Shared volume</p>
<p>Using PHP with the Docker Swarm integration needs a shared volume between all BunkerWeb and PHP-FPM instances which is not covered in this documentation.</p>
</div>
<p>When using the <a href="#integrations-docker-autoconf">Docker autoconf integration</a>, to support PHP applications, you will need to :</p>
<ul>
<li>Mount your PHP files into the <code>/var/www/html</code> folder of BunkerWeb</li>
<li>Set up a PHP-FPM containers for your applications and mount the folder containing PHP apps</li>
<li>Use the specific settings <code>REMOTE_PHP</code> and <code>REMOTE_PHP_PATH</code> as labels for your PHP-FPM container</li>
</ul>
<p>Since the Swarm integration implies using the <a href="#concepts-multisite-mode">multisite mode</a>, you will need to create separate directories for each of your applications. Each subdirectory should be named using the first value of <code>SERVER_NAME</code>. Here is a dummy example :</p>
<div class="highlight"><pre><span></span><code>www
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directories, 3 files
</code></pre></div>
<p>As an example, we will consider that you have a shared folder mounted on your worker nodes on the <code>/shared</code> endpoint.</p>
<p>Once the folders are created, copy your files and fix the permissions so BunkerWeb (UID/GID 101) can at least read files and list folders and PHP-FPM (UID/GID 33 if you use the <code>php:fpm</code> image) is the owner of the files and folders :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">33</span>:101<span class="w"> </span>/shared/www<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/shared/www<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/shared/www<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>When you start the BunkerWeb stack, mount the <code>/shared/www</code> folder into <code>/var/www/html</code> for the <strong>Scheduler</strong> container :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/shared/www:/var/www/html</span>
<span class="nn">...</span>
</code></pre></div>
<p>You can now create your PHP-FPM services, mount the correct subfolders and use labels to configure BunkerWeb :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">myapp1</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app1.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp1</span>
<span class="w">      </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">          </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app1.example.com&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp1&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp2</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app2.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp2</span>
<span class="w">      </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">          </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app2.example.com&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp2&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="w">  </span><span class="nt">myapp3</span><span class="p">:</span>
<span class="w">      </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">php:fpm</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./www/app3.example.com:/app</span>
<span class="w">      </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">        </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">            </span><span class="nt">aliases</span><span class="p">:</span>
<span class="w">              </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">myapp3</span>
<span class="w">      </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">        </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">          </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role==worker&quot;</span>
<span class="w">        </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=app3.example.com&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP=myapp3&quot;</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REMOTE_PHP_PATH=/app&quot;</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">external</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">PHP is not supported for Kubernetes</p>
<p>Kubernetes integration allows configuration through <a href="https://kubernetes.io/docs/concepts/services-networking/ingress/">Ingress</a> and the BunkerWeb controller only supports HTTP applications at the moment.</p>
</div>
</div>
<div class="tabbed-block">
<p>We will assume that you already have the <a href="#integrations-linux">Linux integration</a> stack running on your machine.</p>
<p>By default, BunkerWeb will search for web files inside the <code>/var/www/html</code> folder. You can use it to store your PHP applications. Please note that you will need to configure your PHP-FPM service to get or set the user/group of the running processes and the UNIX socket file used to communicate with BunkerWeb.</p>
<p>First of all, you will need to make sure that your PHP-FPM instance can access the files inside the <code>/var/www/html</code> folder and also that BunkerWeb can access the UNIX socket file in order to communicate with PHP-FPM. We recommend to set a different user like <code>www-data</code> for the PHP-FPM service and to give the nginx group access to the UNIX socket file. Here is corresponding PHP-FPM configuration :</p>
<div class="highlight"><pre><span></span><code><span class="na">...</span>
<span class="k">[www]</span>
<span class="na">user</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">www-data</span>
<span class="na">group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">www-data</span>
<span class="na">listen</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">/run/php/php-fpm.sock</span>
<span class="na">listen.owner</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">www-data</span>
<span class="na">listen.group</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">nginx</span>
<span class="na">listen.mode</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">0660</span>
<span class="na">...</span>
</code></pre></div>
<p>Don't forget to restart your PHP-FPM service :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>php-fpm
</code></pre></div>
<p>If you enable the <a href="#concepts-multisite-mode">multisite mode</a>, you will need to create separate directories for each of your applications. Each subdirectory should be named using the first value of <code>SERVER_NAME</code>. Here is a dummy example :</p>
<div class="highlight"><pre><span></span><code>/var/www/html
├── app1.example.com
│   └── index.php
├── app2.example.com
│   └── index.php
└── app3.example.com
    └── index.php

3 directories, 3 files
</code></pre></div>
<p>Please note that you will need to fix the permissions so BunkerWeb (group <code>nginx</code>) can at least read files and list folders and PHP-FPM (user <code>www-data</code> but it might be different depending on your system) is the owner of the files and folders :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>www-data:nginx<span class="w"> </span>/var/www/html<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/var/www/html<span class="w"> </span>-type<span class="w"> </span>f<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0640</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
find<span class="w"> </span>/var/www/html<span class="w"> </span>-type<span class="w"> </span>d<span class="w"> </span>-exec<span class="w"> </span>chmod<span class="w"> </span><span class="m">0750</span><span class="w"> </span><span class="o">{}</span><span class="w"> </span><span class="se">\;</span>
</code></pre></div>
<p>You can now edit the <code>/etc/bunkerweb/variable.env</code> file :</p>
<div class="highlight"><pre><span></span><code>HTTP_PORT=80
HTTPS_PORT=443
DNS_RESOLVERS=9.9.9.9 8.8.8.8 8.8.4.4
API_LISTEN_IP=127.0.0.1
MULTISITE=yes
SERVER_NAME=app1.example.com app2.example.com app3.example.com
app1.example.com_LOCAL_PHP=/run/php/php-fpm.sock
app1.example.com_LOCAL_PHP_PATH=/var/www/html/app1.example.com
app2.example.com_LOCAL_PHP=/run/php/php-fpm.sock
app2.example.com_LOCAL_PHP_PATH=/var/www/html/app2.example.com
app3.example.com_LOCAL_PHP=/run/php/php-fpm.sock
app3.example.com_LOCAL_PHP_PATH=/var/www/html/app3.example.com
</code></pre></div>
<p>Now let's check the status of the Scheduler :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>If they are already running, we can reload it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
<p>Otherwise, we will need to start it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</div>
</div>
</div>
<h3 id="advanced-ipv6">IPv6</h3>
<div class="admonition example">
<p class="admonition-title">Experimental feature</p>
<p>This feature is not production-ready. Feel free to test it and report us any bug using <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a> in the GitHub repository.</p>
</div>
<p>By default, BunkerWeb will only listen on IPv4 addresses and won't use IPv6 for network communications. If you want to enable IPv6 support, you need to set <code>USE_IPV6=yes</code>. Please note that IPv6 configuration of your network and environment is out-of-the-scope of this documentation.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="advanced-__tabbed_11_1" name="advanced-__tabbed_11" type="radio" /><input id="advanced-__tabbed_11_2" name="advanced-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_11_1">Docker / Autoconf / Swarm</label><label for="advanced-__tabbed_11_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>First of all, you will need to configure your Docker daemon to enable IPv6 support for containers and use ip6tables if needed. Here is sample configuration for your <code>/etc/docker/daemon.json</code> file :</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;experimental&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ipv6&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;ip6tables&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;fixed-cidr-v6&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;fd00:dead:beef::/48&quot;</span>
<span class="p">}</span>
</code></pre></div>
<p>You can now restart the Docker service to apply the changes :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>docker
</code></pre></div>
<p>Once Docker is setup to support IPv6 you can add the <code>USE_IPV6</code> setting and configure the <code>bw-services</code> for IPv6 :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">USE_IPv6</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>

<span class="nn">...</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">enable_ipv6</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fd00:13:37::/48</span>
<span class="w">          </span><span class="nt">gateway</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">fd00:13:37::1</span>

<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>You will need to add the settings to the <code>/etc/bunkerweb/variables.env</code> file :</p>
<div class="highlight"><pre><span></span><code>...
USE_IPV6=yes
...
</code></pre></div>
<p>Let's check the status of BunkerWeb :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb
</code></pre></div>
<p>If they are already running, we can restart it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb
</code></pre></div>
<p>Otherwise, we will need to start it :</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
</div>
</div>
<h2 id="advanced-security-tuning">Security tuning</h2>
<p>BunkerWeb offers many security features that you can configure with <a href="#features">settings</a>. Even if the default values of settings ensure a minimal "security by default", we strongly recommend you tune them. By doing so you will be able to ensure the security level of your choice but also manage false positives.</p>
<div class="admonition tip">
<p class="admonition-title">Other settings</p>
<p>This section only focuses on security tuning, see the <a href="#features">settings section</a> of the documentation for other settings.</p>
</div>
<figure>
<p><img align="center" alt="Overview" src="../assets/img/core-order.svg" />
  </p>
<figcaption>Overview and order of the core security plugins</figcaption>
</figure>
<h2 id="advanced-crowdsec-console-integration">CrowdSec Console integration</h2>
<p>If you aren’t already familiar with CrowdSec Console integration, <a href="https://www.crowdsec.net/?utm_campaign=bunkerweb&amp;utm_source=doc">CrowdSec</a> leverages crowdsourced intelligence to combat cyber threats. Think of it as the "Waze of cybersecurity"—when one server is attacked, other systems worldwide are alerted and protected from the same attackers. You can learn more about it <a href="https://www.crowdsec.net/about?utm_campaign=bunkerweb&amp;utm_source=blog">here</a>.</p>
<p><strong>Congratulations, your BunkerWeb instance is now enrolled in your CrowdSec Console!</strong></p>
<p>Pro tip: When viewing your alerts, click the "columns" option and check the "context" checkbox to access BunkerWeb-specific data.</p>
<figure>
<p><img align="center" alt="Overview" src="../assets/img/crowdity4.png" />
  </p>
<figcaption>BunkerWeb data shown in the context column</figcaption>
</figure>
<h2 id="advanced-monitoring-and-reporting">Monitoring and reporting</h2>
<h4 id="advanced-monitoring-pro">Monitoring <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The monitoring plugin lets you collect and retrieve metrics about BunkerWeb. By enabling it, your instance(s) will start collecting various data related to attacks, requests and performance. You can then retrieve them by calling the <code>/monitoring</code> API endpoint on regular basis or by using other plugins like the Prometheus exporter one.</p>
<p><strong>List of features</strong></p>
<ul>
<li>Enable collection of various BunkerWeb metrics</li>
<li>Retrieve metrics from the API</li>
<li>Use in combination with other plugins (e.g. Prometheus exporter)</li>
<li>Dedicate UI page to monitor your instance(s)</li>
</ul>
<p><strong>List of settings</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_MONITORING</code></td>
<td><code>yes</code></td>
<td>global</td>
<td>no</td>
<td>Enable monitoring of BunkerWeb.</td>
</tr>
<tr>
<td><code>MONITORING_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Size of the dict to store monitoring metrics.</td>
</tr>
</tbody>
</table>
<h4 id="advanced-prometheus-exporter-pro">Prometheus exporter <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The Prometheus exporter plugin adds a <a href="https://prometheus.io/docs/instrumenting/exporters/">Prometheus exporter</a> on your BunkerWeb instance(s). When enabled, you can configure your Prometheus instance(s) to scrape a specific endpoint on Bunkerweb and gather internal metrics.</p>
<p>We also provide a <a href="https://grafana.com/grafana/dashboards/20755-bunkerweb/">Grafana dashboard</a> that you can import into your own instance and connect to your own Prometheus datasource.</p>
<p><strong>Please note that the use of Prometheus exporter plugin requires to enable the Monitoring plugin (<code>USE_MONITORING=yes</code>)</strong></p>
<p><strong>List of features</strong></p>
<ul>
<li>Prometheus exporter providing internal BunkerWeb metrics</li>
<li>Dedicated and configurable port, listen IP and URL</li>
<li>Whitelist IP/network for maximum security</li>
</ul>
<p><strong>List of settings</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_PROMETHEUS_EXPORTER</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable the Prometheus export.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_IP</code></td>
<td><code>0.0.0.0</code></td>
<td>global</td>
<td>no</td>
<td>Listening IP of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_PORT</code></td>
<td><code>9113</code></td>
<td>global</td>
<td>no</td>
<td>Listening port of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_URL</code></td>
<td><code>/metrics</code></td>
<td>global</td>
<td>no</td>
<td>HTTP URL of the Prometheus exporter.</td>
</tr>
<tr>
<td><code>PROMETHEUS_EXPORTER_ALLOW_IP</code></td>
<td><code>127.0.0.0/8 10.0.0.0/8 172.16.0.0/12 192.168.0.0/16</code></td>
<td>global</td>
<td>no</td>
<td>List of IP/networks allowed to contact the Prometheus exporter endpoint.</td>
</tr>
</tbody>
</table>
<h4 id="advanced-reporting-pro">Reporting <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<div class="admonition warning">
<p class="admonition-title">Monitoring plugin needed</p>
<p>This plugins requires the Monitoring Pro plugin to be installed and enabled with the <code>USE_MONITORING</code> setting set to <code>yes</code>.</p>
</div>
<p>The Reporting plugin provides a comprehensive solution for regular reporting of important data from BunkerWeb, including global statistics, attacks, bans, requests, reasons, and AS information. It offers a wide range of features, including automatic report creation, customization options, and seamless integration with monitoring pro plugin. With the Reporting plugin, you can easily generate and manage reports to monitor the performance and security of your application.</p>
<p><strong>List of features</strong></p>
<ul>
<li>Regular reporting of important data from BunkerWeb, including global statistics, attacks, bans, requests, reasons, and AS information.</li>
<li>Integration with Monitoring Pro plugin for seamless integration and enhanced reporting capabilities.</li>
<li>Support for webhooks (classic, Discord, and Slack) for real-time notifications.</li>
<li>Support for SMTP for email notifications.</li>
<li>Configuration options for customization and flexibility.</li>
</ul>
<p><strong>List of settings</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_REPORTING_SMTP</code></td>
<td><code>no</code></td>
<td>global</td>
<td>Enable sending the report via email.</td>
</tr>
<tr>
<td><code>USE_REPORTING_WEBHOOK</code></td>
<td><code>no</code></td>
<td>global</td>
<td>Enable sending the report via webhook.</td>
</tr>
<tr>
<td><code>REPORTING_SCHEDULE</code></td>
<td><code>weekly</code></td>
<td>global</td>
<td>The frequency at which reports are sent.</td>
</tr>
<tr>
<td><code>REPORTING_WEBHOOK_URLS</code></td>
<td></td>
<td>global</td>
<td>List of webhook URLs to receive the report in Markdown (separated by spaces).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_EMAILS</code></td>
<td></td>
<td>global</td>
<td>List of email addresses to receive the report in HTML format (separated by spaces).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_HOST</code></td>
<td></td>
<td>global</td>
<td>The host server used for SMTP sending.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_PORT</code></td>
<td><code>465</code></td>
<td>global</td>
<td>The port used for SMTP. Please note that there are different standards depending on the type of connection (SSL = 465, TLS = 587).</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_EMAIL</code></td>
<td></td>
<td>global</td>
<td>The email address used as the sender. Note that 2FA must be disabled for this email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_USER</code></td>
<td></td>
<td>global</td>
<td>The user authentication value for sending via the from email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_FROM_PASSWORD</code></td>
<td></td>
<td>global</td>
<td>The password authentication value for sending via the from email address.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SSL</code></td>
<td><code>SSL</code></td>
<td>global</td>
<td>Determine whether or not to use a secure connection for SMTP.</td>
</tr>
<tr>
<td><code>REPORTING_SMTP_SUBJECT</code></td>
<td><code>BunkerWeb Report</code></td>
<td>global</td>
<td>The subject line of the email.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Information and behavior</p>
<ul>
<li>case <code>USE_REPORTING_SMTP</code> is set to <code>yes</code>, the setting <code>REPORTING_SMTP_EMAILS</code> must be set.</li>
<li>case <code>USE_REPORTING_WEBHOOK</code> is set to <code>yes</code>, the setting <code>REPORTING_WEBHOOK_URLS</code> must be set.</li>
<li>Accepted values for <code>REPORTING_SCHEDULE</code> are <code>daily</code>, <code>weekly</code>and <code>monthly</code>.</li>
<li>case no <code>REPORTING_SMTP_FROM_USER</code> and <code>REPORTING_SMTP_FROM_PASSWORD</code> are set, the plugin will try to send the email without authentication.</li>
<li>case <code>REPORTING_SMTP_FROM_USER</code> isn't set but <code>REPORTING_SMTP_FROM_PASSWORD</code> is set, the plugin will use the <code>REPORTING_SMTP_FROM_EMAIL</code> as the username.</li>
<li>case the job fails, the plugin will retry sending the report in the next execution.</li>
</ul>
</div>
<h3 id="advanced-backup-and-restore">Backup and restore</h3>
<h4 id="advanced-backup-s3-pro">Backup S3 <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h4>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Backup S3 tool seamlessly automates data protection, similar to the community backup plugin. However, it stands out by securely storing backups directly in an S3 bucket.</p>
<p>By activating this feature, you're proactively safeguarding your <strong>data's integrity</strong>. Storing backups <strong>remotely</strong> shields crucial information from threats like <strong>hardware failures</strong>, <strong>cyberattacks</strong>, or <strong>natural disasters</strong>. This ensures both <strong>security</strong> and <strong>availability</strong>, enabling swift recovery during <strong>unexpected events</strong>, preserving <strong>operational continuity</strong>, and ensuring <strong>peace of mind</strong>.</p>
<div class="admonition warning">
<p class="admonition-title">Information for Red Hat Enterprise Linux (RHEL) 8.9 users</p>
<p>If you are using <strong>RHEL 8.9</strong> and plan on using an <strong>external database</strong>, you will need to install the <code>mysql-community-client</code> package to ensure the <code>mysqldump</code> command is available. You can install the package by executing the following commands:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="12:2"><input checked="checked" id="advanced-__tabbed_12_1" name="advanced-__tabbed_12" type="radio" /><input id="advanced-__tabbed_12_2" name="advanced-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_12_1">MySQL/MariaDB</label><label for="advanced-__tabbed_12_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Install the MySQL repository configuration package</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>https://dev.mysql.com/get/mysql80-community-release-el8-9.noarch.rpm
</code></pre></div>
</li>
<li>
<p><strong>Enable the MySQL repository</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--enable<span class="w"> </span>mysql80-community
</code></pre></div>
</li>
<li>
<p><strong>Install the MySQL client</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql-community-client
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Install the PostgreSQL repository configuration package</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">/pgdg-redhat-repo-latest.noarch.rpm&quot;</span>
</code></pre></div>
</li>
<li>
<p><strong>Install the PostgreSQL client</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span>postgresql&lt;version&gt;
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</div>
<p><strong>List of features</strong></p>
<ul>
<li>Automatic data backup to an S3 bucket</li>
<li>Flexible scheduling options: daily, weekly, or monthly</li>
<li>Rotation management for controlling the number of backups to keep</li>
<li>Customizable compression level for backup files</li>
</ul>
<p><strong>List of settings</strong></p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_BACKUP_S3</code></td>
<td><code>no</code></td>
<td>global</td>
<td>Enable or disable the S3 backup feature</td>
</tr>
<tr>
<td><code>BACKUP_S3_SCHEDULE</code></td>
<td><code>daily</code></td>
<td>global</td>
<td>The frequency of the backup</td>
</tr>
<tr>
<td><code>BACKUP_S3_ROTATION</code></td>
<td><code>7</code></td>
<td>global</td>
<td>The number of backups to keep</td>
</tr>
<tr>
<td><code>BACKUP_S3_ENDPOINT</code></td>
<td></td>
<td>global</td>
<td>The S3 endpoint</td>
</tr>
<tr>
<td><code>BACKUP_S3_BUCKET</code></td>
<td></td>
<td>global</td>
<td>The S3 bucket</td>
</tr>
<tr>
<td><code>BACKUP_S3_DIR</code></td>
<td></td>
<td>global</td>
<td>The S3 directory</td>
</tr>
<tr>
<td><code>BACKUP_S3_REGION</code></td>
<td></td>
<td>global</td>
<td>The S3 region</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_ID</code></td>
<td></td>
<td>global</td>
<td>The S3 access key ID</td>
</tr>
<tr>
<td><code>BACKUP_S3_ACCESS_KEY_SECRET</code></td>
<td></td>
<td>global</td>
<td>The S3 access key secret</td>
</tr>
<tr>
<td><code>BACKUP_S3_COMP_LEVEL</code></td>
<td><code>6</code></td>
<td>global</td>
<td>The compression level of the backup zip file</td>
</tr>
</tbody>
</table>
<h5 id="advanced-manual-backup">Manual backup</h5>
<p>To manually initiate a backup, execute the following command:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="advanced-__tabbed_13_1" name="advanced-__tabbed_13" type="radio" /><input id="advanced-__tabbed_13_2" name="advanced-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_13_1">Linux</label><label for="advanced-__tabbed_13_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
</div>
</div>
<p>This command will create a backup of your database and store it in the S3 bucket specified in the <code>BACKUP_S3_BUCKET</code> setting.</p>
<p>You can also specify a custom S3 bucket for the backup by providing the <code>BACKUP_S3_BUCKET</code> environment variable when executing the command:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="advanced-__tabbed_14_1" name="advanced-__tabbed_14" type="radio" /><input id="advanced-__tabbed_14_2" name="advanced-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_14_1">Linux</label><label for="advanced-__tabbed_14_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">BACKUP_S3_BUCKET</span><span class="o">=</span>your-bucket-name<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">BACKUP_S3_BUCKET</span><span class="o">=</span>your-bucket-name<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>save
</code></pre></div>
</div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Specifications for MariaDB/MySQL</p>
<p>In case you are using MariaDB/MySQL, you may encounter the following error when trying to backup your database:</p>
<div class="highlight"><pre><span></span><code>caching_sha2_password<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>loaded:<span class="w"> </span>Error<span class="w"> </span>loading<span class="w"> </span>shared<span class="w"> </span>library<span class="w"> </span>/usr/lib/mariadb/plugin/caching_sha2_password.so
</code></pre></div>
<p>To resolve this issue, you can execute the following command to change the authentication plugin to <code>mysql_native_password</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;yourusername&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">mysql_native_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;youpassword&#39;</span><span class="p">;</span>
</code></pre></div>
<p>If you're using the Docker integration, you can add the following command to the <code>docker-compose.yml</code> file to automatically change the authentication plugin:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="advanced-__tabbed_15_1" name="advanced-__tabbed_15" type="radio" /><input id="advanced-__tabbed_15_2" name="advanced-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_15_1">MariaDB</label><label for="advanced-__tabbed_15_2">MySQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<h5 id="advanced-manual-restore">Manual restore</h5>
<p>To manually initiate a restore, execute the following command:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="advanced-__tabbed_16_1" name="advanced-__tabbed_16" type="radio" /><input id="advanced-__tabbed_16_2" name="advanced-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_16_1">Linux</label><label for="advanced-__tabbed_16_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
</div>
</div>
<p>This command will create a temporary backup of your database in the S3 bucket specified in the <code>BACKUP_S3_BUCKET</code> setting and restore your database to the latest backup available in the bucket.</p>
<p>You can also specify a custom backup file for the restore by providing the path to it as an argument when executing the command:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="advanced-__tabbed_17_1" name="advanced-__tabbed_17" type="radio" /><input id="advanced-__tabbed_17_2" name="advanced-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_17_1">Linux</label><label for="advanced-__tabbed_17_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore<span class="w"> </span>s3_backup_file.zip
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>restore<span class="w"> </span>s3_backup_file.zip
</code></pre></div>
</div>
</div>
</div>
<div class="admonition example">
<p class="admonition-title">In case of failure</p>
<p>Don't worry if the restore fails, you can always restore your database to the previous state by executing the command again as a backup is created before the restore:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="advanced-__tabbed_18_1" name="advanced-__tabbed_18" type="radio" /><input id="advanced-__tabbed_18_2" name="advanced-__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_18_1">Linux</label><label for="advanced-__tabbed_18_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup_s3<span class="w"> </span>restore
</code></pre></div>
</div>
</div>
</div>
</div>
<h3 id="advanced-migration-pro">Migration <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h3>
<p>STREAM support <img alt="✅" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/2705.svg" title=":white_check_mark:" /></p>
<p>The Migration plugin <strong>revolutionizes</strong> BunkerWeb configuration transfers between instances with its <strong>user-friendly web interface</strong>, simplifying the entire migration journey. Whether you're upgrading systems, scaling infrastructure, or transitioning environments, this tool empowers you to effortlessly transfer <strong>settings, preferences, and data</strong> with unmatched ease and confidence. Say goodbye to cumbersome manual processes and hello to a <strong>seamless, hassle-free migration experience</strong>.</p>
<p><strong>List of features</strong></p>
<ul>
<li>
<p><strong>Effortless Migration:</strong> Easily transfer BunkerWeb configurations between instances without the complexities of manual procedures.</p>
</li>
<li>
<p><strong>Intuitive Web Interface:</strong> Navigate through the migration process effortlessly with a user-friendly web interface designed for intuitive operation.</p>
</li>
<li>
<p><strong>Cross-Database Compatibility:</strong> Enjoy seamless migration across various database platforms, including SQLite, MySQL, MariaDB, and PostgreSQL, ensuring compatibility with your preferred database environment.</p>
</li>
</ul>
<h4 id="advanced-create-a-migration-file">Create a migration file</h4>
<p>To manually create a migration file, execute the following command:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="advanced-__tabbed_19_1" name="advanced-__tabbed_19" type="radio" /><input id="advanced-__tabbed_19_2" name="advanced-__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_19_1">Linux</label><label for="advanced-__tabbed_19_2">Docker</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>create<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p>Create a migration file:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>create<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
<li>
<p>Copy the migration file to your local machine:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/migration/file<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
<p>This command will create a backup of your database and store it in the backup directory specified in the command.</p>
<div class="admonition note">
<p class="admonition-title">Specifications for MariaDB/MySQL</p>
<p>In case you are using MariaDB/MySQL, you may encounter the following error when trying to backup your database:</p>
<div class="highlight"><pre><span></span><code>caching_sha2_password<span class="w"> </span>could<span class="w"> </span>not<span class="w"> </span>be<span class="w"> </span>loaded:<span class="w"> </span>Error<span class="w"> </span>loading<span class="w"> </span>shared<span class="w"> </span>library<span class="w"> </span>/usr/lib/mariadb/plugin/caching_sha2_password.so
</code></pre></div>
<p>To resolve this issue, you can execute the following command to change the authentication plugin to <code>mysql_native_password</code>:</p>
<div class="highlight"><pre><span></span><code><span class="k">ALTER</span><span class="w"> </span><span class="k">USER</span><span class="w"> </span><span class="s1">&#39;yourusername&#39;</span><span class="o">@</span><span class="s1">&#39;localhost&#39;</span><span class="w"> </span><span class="n">IDENTIFIED</span><span class="w"> </span><span class="k">WITH</span><span class="w"> </span><span class="n">mysql_native_password</span><span class="w"> </span><span class="k">BY</span><span class="w"> </span><span class="s1">&#39;youpassword&#39;</span><span class="p">;</span>
</code></pre></div>
<p>If you're using the Docker integration, you can add the following command to the <code>docker-compose.yml</code> file to automatically change the authentication plugin:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="advanced-__tabbed_20_1" name="advanced-__tabbed_20" type="radio" /><input id="advanced-__tabbed_20_2" name="advanced-__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_20_1">MariaDB</label><label for="advanced-__tabbed_20_2">MySQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mysql:&lt;version&gt;</span>
<span class="w">    </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">--default-authentication-plugin=mysql_native_password</span>
<span class="w">    </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</div>
</div>
</div>
</div>
<h4 id="advanced-initialize-a-migration">Initialize a migration</h4>
<p>To manually initialize a migration, execute the following command:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:3"><input checked="checked" id="advanced-__tabbed_21_1" name="advanced-__tabbed_21" type="radio" /><input id="advanced-__tabbed_21_2" name="advanced-__tabbed_21" type="radio" /><input id="advanced-__tabbed_21_3" name="advanced-__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="advanced-__tabbed_21_1">Linux</label><label for="advanced-__tabbed_21_2">Docker</label><label for="advanced-__tabbed_21_3">All-in-one</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>migrate<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p>Copy the migration file to the container:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>/path/to/migration/file<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/migration/file
</code></pre></div>
</li>
<li>
<p>Initialize the migration:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>migrate<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p>Copy the migration file to the container:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>/path/to/migration/file<span class="w"> </span>bunkerweb-aio:/path/to/migration/file
</code></pre></div>
</li>
<li>
<p>Initialize the migration:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>bunkerweb-aio<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>migration<span class="w"> </span>migrate<span class="w"> </span>/path/to/migration/file
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
<p>This command seamlessly migrates your BunkerWeb data to precisely match the configuration outlined in the migration file.</p>
<h2 id="advanced-anti-ddos-pro">Anti DDoS <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h2>
<p>STREAM support <img alt="❌" class="twemoji" src="https://cdn.jsdelivr.net/gh/jdecked/twemoji@15.1.0/assets/svg/274c.svg" title=":x:" /></p>
<p>The <strong>Anti DDoS</strong> Plugin provides advanced protection against Distributed Denial of Service (DDoS) attacks by monitoring, analyzing, and filtering suspicious traffic in real-time.</p>
<p>By employing a <strong>sliding window mechanism</strong>, the plugin maintains an in-memory dictionary of request timestamps to detect abnormal traffic spikes from individual IP addresses. Based on the configured security mode, it can either block offending connections or log the suspicious activity for further review.</p>
<h4 id="advanced-features">Features</h4>
<ul>
<li><strong>Real-Time Traffic Analysis:</strong> Continuously monitors incoming requests to detect potential DDoS attacks.</li>
<li><strong>Sliding Window Mechanism:</strong> Tracks recent request activity within a configurable time window.</li>
<li><strong>Configurable Thresholds:</strong> Allows you to define the maximum number of suspicious requests per IP.</li>
<li><strong>Advanced Blocking Logic:</strong> Evaluates both per-IP request counts and the number of distinct IPs exceeding the threshold.</li>
<li><strong>Flexible Security Modes:</strong> Choose between immediate connection blocking or detection-only (logging) mode.</li>
<li><strong>Optimized In-Memory Datastore:</strong> Ensures high-speed lookups and efficient metric tracking.</li>
<li><strong>Automatic Housekeeping:</strong> Periodically clears outdated data to maintain optimal performance.</li>
</ul>
<h4 id="advanced-configuration">Configuration</h4>
<p>Customize the plugin behavior using the following settings:</p>
<table>
<thead>
<tr>
<th>Setting</th>
<th>Default</th>
<th>Context</th>
<th>Multiple</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>USE_ANTIDDOS</code></td>
<td><code>no</code></td>
<td>global</td>
<td>no</td>
<td>Enable or disable the Anti DDoS protection. Set to <code>"yes"</code> to activate the plugin.</td>
</tr>
<tr>
<td><code>ANTIDDOS_METRICS_DICT_SIZE</code></td>
<td><code>10M</code></td>
<td>global</td>
<td>no</td>
<td>Size of the in-memory datastore for tracking DDoS metrics (e.g., <code>10M</code>, <code>500k</code>).</td>
</tr>
<tr>
<td><code>ANTIDDOS_THRESHOLD</code></td>
<td><code>100</code></td>
<td>global</td>
<td>no</td>
<td>Maximum number of suspicious requests allowed per IP within the defined time window.</td>
</tr>
<tr>
<td><code>ANTIDDOS_WINDOW_TIME</code></td>
<td><code>10</code></td>
<td>global</td>
<td>no</td>
<td>Time window in seconds during which suspicious requests are tallied.</td>
</tr>
<tr>
<td><code>ANTIDDOS_STATUS_CODES</code></td>
<td><code>429 403 444</code></td>
<td>global</td>
<td>no</td>
<td>HTTP status codes considered suspicious and used to trigger anti-DDoS actions.</td>
</tr>
<tr>
<td><code>ANTIDDOS_DISTINCT_IP</code></td>
<td><code>5</code></td>
<td>global</td>
<td>no</td>
<td>Minimum number of distinct IPs that must exceed the threshold before enforcing the block mode.</td>
</tr>
</tbody>
</table>
<h4 id="advanced-best-practices">Best Practices</h4>
<ul>
<li><strong>Threshold Tuning:</strong> Adjust <code>ANTIDDOS_THRESHOLD</code> and <code>ANTIDDOS_WINDOW_TIME</code> based on your typical traffic patterns.</li>
<li><strong>Status Code Review:</strong> Regularly update <code>ANTIDDOS_STATUS_CODES</code> to capture new or evolving suspicious behaviors.</li>
<li><strong>Monitoring:</strong> Analyze logs and metrics periodically to fine-tune settings and improve overall protection.</li>
</ul>
<h2 id="advanced-user-manager-pro">User Manager <img src='../assets/img/pro-icon.svg' alt='crow pro icon' height='24px' width='24px' style="transform : translateY(3px);"> (PRO)</h2>
<p>The User Management Plugin offers a robust interface for administering user accounts within your system.</p>
<p>With this plugin, administrators can effortlessly create, update, and disable user accounts, manage user roles, toggle two-factor authentication (2FA), and view detailed user information such as last login timestamps and account statuses (active or inactive). Designed with security and ease-of-use in mind, this plugin simplifies routine user management tasks while ensuring compliance and auditability.</p>
<h4 id="advanced-features_1">Features</h4>
<ul>
<li><strong>User Account Operations:</strong> Create, edit, and delete user accounts with ease.</li>
<li><strong>Role-Based Access Control:</strong> Assign and modify user roles to manage permissions and access levels.</li>
<li><strong>2FA Management:</strong> Disable two-factor authentication based on administrative decisions.</li>
<li><strong>Comprehensive User Insights:</strong> Monitor key user data including last login times, account creation dates, and active/inactive status.</li>
<li><strong>Audit Logging:</strong> Maintain an audit trail for all user management actions for enhanced security and compliance.</li>
</ul>
<figure>
<p><img align="center" alt="Overview" src="../assets/img/user-manager.png" />
  </p>
<figcaption>User Manager page</figcaption>
</figure>
<figure>
<p><img align="center" alt="Create user form" src="../assets/img/user-manager-create.png" />
  </p>
<figcaption>User Manager - Create user form</figcaption>
</figure>
<figure>
<p><img align="center" alt="Activities page" src="../assets/img/user-manager-activities.png" />
  </p>
<figcaption>User Manager - Activities page</figcaption>
</figure></section><section class="print-page" id="web-ui" heading-number="7"><h1 id="web-ui-web-ui">Web UI</h1>
<h2 id="web-ui-overview">Overview</h2>
<p align="center">
    <iframe style="display: block;" width="560" height="315" data-src="https://www.youtube-nocookie.com/embed/tGS3pzquEjY" title="BunkerWeb web UI" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
</p>

<p>The "Web UI" is a web application that helps you manage your BunkerWeb instance using a user-friendly interface instead of relying solely on the command line.</p>
<p>Here is a list of features offered by the web UI:</p>
<ul>
<li>Get a comprehensive view of blocked attacks</li>
<li>Start, stop, restart, and reload your BunkerWeb instance</li>
<li>Add, edit, and delete settings for your web applications</li>
<li>Add, edit, and delete custom configurations for NGINX and ModSecurity</li>
<li>Install and uninstall external plugins</li>
<li>Explore cached files</li>
<li>Monitor job execution and restart them as needed</li>
<li>View logs and search for patterns</li>
</ul>
<h2 id="web-ui-prerequisites">Prerequisites</h2>
<p>Since the web UI is a web application, the recommended architecture is to run BunkerWeb in front of it as a reverse proxy. The recommended installation procedure is to use the setup wizard, which will guide you step by step as described in the <a href="#quickstart-guide">quickstart guide</a>.</p>
<div class="admonition warning">
<p class="admonition-title">Security considerations</p>
<p>The security of the web UI is extremely important. If an unauthorized person gains access to the application, not only will they be able to edit your configurations, but they might also execute code in the context of BunkerWeb (for example, via a custom configuration containing LUA code). We highly recommend that you follow minimal security best practices, such as:</p>
<ul>
<li>Choose a strong password for the login (<strong>at least 8 characters, including 1 lowercase letter, 1 uppercase letter, 1 digit, and 1 special character</strong>)</li>
<li>Place the web UI under a "hard-to-guess" URI</li>
<li>Enable two-factor authentication (2FA)</li>
<li>Do not expose the web UI on the Internet without additional restrictions</li>
<li>Apply best practices listed in the <a href="#advanced-security-tuning">advanced usages section</a> of the documentation depending on your use case</li>
</ul>
</div>
<h2 id="web-ui-upgrade-to-pro">Upgrade to PRO</h2>
<div class="admonition tip">
<p class="admonition-title">BunkerWeb PRO free trial</p>
<p>Want to quickly test BunkerWeb PRO for one month? Use the code <code>freetrial</code> when placing your order on the <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">BunkerWeb panel</a> or by clicking <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">here</a> to directly to apply the promo code (will be effective at checkout).</p>
</div>
<p>Once you have your PRO license key from the <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">BunkerWeb panel</a>, you can paste it into the PRO page of the web UI.</p>
<figure>
<p><img align="center," alt="PRO upgrade" src="../assets/img/pro-ui-upgrade.png" width="700" />
  </p>
<figcaption>Upgrade to PRO from the web UI</figcaption>
</figure>
<div class="admonition warning">
<p class="admonition-title">Upgrade time</p>
<p>The PRO version is downloaded in the background by the scheduler, it may take some time to upgrade.</p>
</div>
<p>When your BunkerWeb instance has upgraded to the PRO version, you will see your license expiration date and the maximum number of services you can protect.</p>
<figure>
<p><img align="center," alt="PRO upgrade" src="../assets/img/ui-pro.png" width="700" />
  </p>
<figcaption>PRO license information</figcaption>
</figure>
<h2 id="web-ui-accessing-logs">Accessing logs</h2>
<p>Beginning with version <code>1.6</code>, the method of accessing logs has changed. This update specifically impacts container-based integrations: the web UI will now read the log files from the <code>/var/log/bunkerweb</code> directory.</p>
<p>To keep the logs accessible from the web UI, we recommend that you use a syslog server, such as <code>syslog-ng</code>, to read the logs and create the corresponding files in the <code>/var/log/bunkerweb</code> directory.</p>
<div class="admonition warning">
<p class="admonition-title">Using local folder for logs</p>
<p>The web UI runs as an <strong>unprivileged user with UID 101 and GID 101</strong> inside the container for security reasons: in case a vulnerability is exploited, the attacker won't have full root (UID/GID 0) privileges.</p>
<p>However, there is a downside: if you use a <strong>local folder for logs</strong>, you must <strong>set the correct permissions</strong> so that the unprivileged user can read the log files. For example:</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
<p>Alternatively, if the folder already exists:</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
<p>If you are using <a href="https://docs.docker.com/engine/security/rootless">Docker in rootless mode</a> or <a href="https://podman.io/">podman</a>, UIDs and GIDs in the container will be mapped to different ones in the host. You will first need to check your initial subuid and subgid:</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>For example, if you have a value of <strong>100000</strong>, the mapped UID/GID will be <strong>100100</strong> (100000 + 100):</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
<p>Or if the folder already exists:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-logs<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-logs
</code></pre></div>
</div>
<h3 id="web-ui-compose-boilerplates">Compose boilerplates</h3>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="web-ui-__tabbed_1_1" name="web-ui-__tabbed_1" type="radio" /><input id="web-ui-__tabbed_1_2" name="web-ui-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="web-ui-__tabbed_1_1">Docker</label><label for="web-ui-__tabbed_1_2">Docker Autoconf</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>To forward the logs correctly to the <code>/var/log/bunkerweb</code> directory on the Docker integration, you will need to stream the logs to a file using <code>syslog-ng</code>. Here is an example of how to do this:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-bw-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-env</span>
<span class="w">  </span><span class="c1"># We anchor the environment variables to avoid duplication</span>
<span class="w">  </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This will be the tag used by syslog-ng to create the log file</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># This is the syslog-ng container address</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Make sure to set the correct instance name</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">SERVE_FILES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="w">      </span><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_TEMPLATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ui&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/changeme&quot;</span><span class="w"> </span><span class="c1"># Change it to a hard-to-guess URI</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-scheduler&quot;</span><span class="w"> </span><span class="c1"># This will be the tag used by syslog-ng to create the log file</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># This is the syslog-ng container address</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the admin user</span>
<span class="w">      </span><span class="nt">TOTP_SECRETS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger secret key (see the Prerequisites section)</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span><span class="w"> </span><span class="c1"># This is the volume used to store the logs</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-ui&quot;</span><span class="w"> </span><span class="c1"># This will be the tag used by syslog-ng to create the log file</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># This is the syslog-ng container address</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-syslog</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balabit/syslog-ng:4.8.0</span>
<span class="w">    </span><span class="c1"># image: lscr.io/linuxserver/syslog-ng:4.8.1-r1-ls147 # For aarch64 architecture</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span><span class="w">  </span><span class="c1"># Bind to low ports</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BROADCAST</span><span class="w">  </span><span class="c1"># Send broadcasts</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_RAW</span><span class="w">  </span><span class="c1"># Use raw sockets</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_READ_SEARCH</span><span class="w">  </span><span class="c1"># Read files bypassing permissions</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_OVERRIDE</span><span class="w">  </span><span class="c1"># Override file permissions</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CHOWN</span><span class="w">  </span><span class="c1"># Change ownership</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SYSLOG</span><span class="w">  </span><span class="c1"># Write to system logs</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span><span class="w"> </span><span class="c1"># This is the volume used to store the logs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./syslog-ng.conf:/etc/syslog-ng/syslog-ng.conf</span><span class="w"> </span><span class="c1"># This is the syslog-ng configuration file</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.254</span><span class="w"> </span><span class="c1"># Make sure to set the correct IP address</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-logs</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>To forward the logs correctly to the <code>/var/log/bunkerweb</code> directory on the Autoconf integration, you will need to stream the logs to a file using <code>syslog-ng</code>. Here is an example of how to do this:</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;bw-ui-env</span>
<span class="w">  </span><span class="c1"># We anchor the environment variables to avoid duplication</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># QUIC</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># This will be the tag used by syslog-ng to create the log file</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># This is the syslog-ng container address</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># We don&#39;t need to specify the BunkerWeb instance here as they are automatically detected by the autoconf service</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span><span class="w"> </span><span class="c1"># The server name will be filled with services labels</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span><span class="w"> </span><span class="c1"># Mandatory setting for autoconf / ui</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/24</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-scheduler&quot;</span><span class="w"> </span><span class="c1"># This will be the tag used by syslog-ng to create the log file</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># This is the syslog-ng container address</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span><span class="w"> </span><span class="c1"># This is the Docker socket address</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-autoconf&quot;</span><span class="w"> </span><span class="c1"># This will be the tag used by syslog-ng to create the log file</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># This is the syslog-ng container address</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*bw-ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the admin user</span>
<span class="w">      </span><span class="nt">TOTP_SECRETS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger secret key (see the Prerequisites section)</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_TEMPLATE=ui&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/changeme&quot;</span><span class="w"> </span><span class="c1"># Change it to a hard-to-guess URI</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://bw-ui:7000&quot;</span>
<span class="w">    </span><span class="nt">logging</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">syslog</span>
<span class="w">      </span><span class="nt">options</span><span class="p">:</span>
<span class="w">        </span><span class="nt">tag</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-ui&quot;</span><span class="w"> </span><span class="c1"># This will be the tag used by syslog-ng to create the log file</span>
<span class="w">        </span><span class="nt">syslog-address</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;udp://10.20.30.254:514&quot;</span><span class="w"> </span><span class="c1"># This is the syslog-ng container address</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">restart</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;unless-stopped&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-syslog</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">balabit/syslog-ng:4.8.0</span>
<span class="w">    </span><span class="c1"># image: lscr.io/linuxserver/syslog-ng:4.8.1-r1-ls147 # For aarch64 architecture</span>
<span class="w">    </span><span class="nt">cap_add</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BIND_SERVICE</span><span class="w">  </span><span class="c1"># Bind to low ports</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_BROADCAST</span><span class="w">  </span><span class="c1"># Send broadcasts</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">NET_RAW</span><span class="w">  </span><span class="c1"># Use raw sockets</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_READ_SEARCH</span><span class="w">  </span><span class="c1"># Read files bypassing permissions</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">DAC_OVERRIDE</span><span class="w">  </span><span class="c1"># Override file permissions</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">CHOWN</span><span class="w">  </span><span class="c1"># Change ownership</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">SYSLOG</span><span class="w">  </span><span class="c1"># Write to system logs</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-logs:/var/log/bunkerweb</span><span class="w"> </span><span class="c1"># This is the volume used to store the logs</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./syslog-ng.conf:/etc/syslog-ng/syslog-ng.conf</span><span class="w"> </span><span class="c1"># This is the syslog-ng configuration file</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">        </span><span class="nt">ipv4_address</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.254</span><span class="w"> </span><span class="c1"># Make sure to set the correct IP address</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-logs</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
</code></pre></div>
</div>
</div>
</div>
<h3 id="web-ui-syslog-ng-configuration">Syslog-ng configuration</h3>
<p>Here is an example of a <code>syslog-ng.conf</code> file that you can use to forward the logs to a file:</p>
<div class="highlight"><pre><span></span><code>@version: 4.8

# Source configuration to receive logs from Docker containers
source s_net {
  udp(
    ip(&quot;0.0.0.0&quot;)
  );
};

# Template to format log messages
template t_imp {
  template(&quot;$MSG\n&quot;);
  template_escape(no);
};

# Destination configuration to write logs to dynamically named files
destination d_dyna_file {
  file(
    &quot;/var/log/bunkerweb/${PROGRAM}.log&quot;
    template(t_imp)
    owner(&quot;101&quot;)
    group(&quot;101&quot;)
    dir_owner(&quot;root&quot;)
    dir_group(&quot;101&quot;)
    perm(0440)
    dir_perm(0770)
    create_dirs(yes)
  );
};

# Log path to direct logs to dynamically named files
log {
  source(s_net);
  destination(d_dyna_file);
};
</code></pre></div>
<h2 id="web-ui-account-management">Account management</h2>
<p>You can access the account management page by clicking on the profile image in the top right corner:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/manage-account.png" width="400" />
  </p>
<figcaption>Account page access from top right corner</figcaption>
</figure>
<h3 id="web-ui-username-password">Username / Password</h3>
<div class="admonition warning">
<p class="admonition-title">Lost password/username</p>
<p>In case you forgot your UI credentials, you can reset them from the CLI following <a href="#troubleshooting-web-ui">the steps described in the troubleshooting section</a>.</p>
</div>
<p>You can update your username or password by filling the dedicated forms in the <strong>Security</strong> tab. For security reason, you need to enter your current password even if you are connected.</p>
<p>Please note that when your username or password is updated, you will be logout from the web UI to log in again.</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/profile-username-password.png" width="650" />
  </p>
<figcaption>Username / Password form</figcaption>
</figure>
<h3 id="web-ui-two-factor-authentication">Two-Factor authentication</h3>
<div class="admonition warning">
<p class="admonition-title">Lost secret key</p>
<p>In case you lost your secret key, two options are available:</p>
<ul>
<li>You can recover your account using one of the provided recovery codes when you enabled 2FA (a recovery code can only be used once).</li>
<li>You can disable 2FA from the CLI following <a href="#troubleshooting-web-ui">the steps described in the troubleshooting section</a>.</li>
</ul>
</div>
<p>You can power-up your login security by adding <strong>Two-Factor Authentication (2FA)</strong> to your account. By doing so, an extra code will be needed in addition to your password.</p>
<p>The web UI uses <a href="https://en.wikipedia.org/wiki/Time-based_one-time_password">Time based One Time Password (TOTP)</a> as 2FA implementation: using a <strong>secret key</strong>, the algorithm will generate <strong>one time passwords only valid for a short period of time</strong>.</p>
<p>Any TOTP client such as Google Authenticator, Authy, FreeOTP, ... can be used to store the secret key and generate the codes. Please note that once TOTP is enabled, <strong>you won't be able to retrieve it from the web UI</strong>.</p>
<p>The following steps are needed to enable the TOTP feature from the web UI:</p>
<ul>
<li>Copy the secret key or use the QR code on your authenticator app</li>
<li>Enter the current TOTP code in the 2FA input</li>
<li>Enter your current password</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Secret key refresh</p>
<p>A new secret key is <strong>generated each time</strong> you visit the page or submit the form. In case something went wrong (e.g.: expired TOTP code), you will need to copy the new secret key to your authenticator app until 2FA is successfully enabled.</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Recovery codes</p>
<p>When you enable 2FA, you will be provided with <strong>5 recovery codes</strong>. These codes can be used to recover your account in case you have lost your TOTP secret key. Each code can only be used once. <strong>These codes will only be shown once so make sure to store them in a safe place</strong>.</p>
<p>If you ever lose your recovery codes, <strong>you can refresh them via the TOTP section of the account management page</strong>. Please note that the old recovery codes will be invalidated.</p>
</div>
<p>You can enable or disable 2FA and also refresh recovery codes in the <strong>Security</strong> tab:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/profile-totp.png" width="800" />
  </p>
<figcaption>TOTP enable / disable / refresh recovery codes forms</figcaption>
</figure>
<p>After a successful login/password combination, you will be prompted to enter your TOTP code:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/profile-2fa.png" width="400" />
  </p>
<figcaption>2FA on login page</figcaption>
</figure>
<h3 id="web-ui-current-sessions">Current sessions</h3>
<p>In the <strong>Session</strong> tab, you will be able to list and revoke current sessions:</p>
<figure>
<p><img align="center," alt="Overview" src="../assets/img/sessions.png" width="800" />
  </p>
<figcaption>Manage sessions</figcaption>
</figure>
<h2 id="web-ui-advanced-installation">Advanced installation</h2>
<p>The web UI can be deployed and configured without going through the setup wizard process: configuration is done through environment variables, which can be added directly to the containers or in the <code>/etc/bunkerweb/ui.env</code> file in the case of a Linux integration.</p>
<div class="admonition tip">
<p class="admonition-title">Web UI specific environment variables</p>
<p>The web UI uses the following environment variables:</p>
<ul>
<li><code>OVERRIDE_ADMIN_CREDS</code>: set it to <code>yes</code> to enable the override even if the admin credentials are already set (default is <code>no</code>).</li>
<li><code>ADMIN_USERNAME</code>: username to access the web UI.</li>
<li><code>ADMIN_PASSWORD</code>: password to access the web UI.</li>
<li><code>FLASK_SECRET</code>: a secret key used to encrypt the session cookie (if not set, a random key will be generated).</li>
<li><code>TOTP_SECRETS</code>: a list of TOTP secrets separated by spaces or a dictionary (e.g.: <code>{"1": "mysecretkey"}</code> or <code>mysecretkey</code> or <code>mysecretkey mysecretkey1</code>). <strong>We strongly recommend you to set this variable if you want to use 2FA, as it will be used to encrypt the TOTP secret keys</strong> (if not set, a random number of secret keys will be generated). Check out the <a href="https://passlib.readthedocs.io/en/stable/narr/totp-tutorial.html#application-secrets">passlib documentation</a> for more information.</li>
<li><code>LISTEN_ADDR</code>: the address where the web UI will listen (default is <code>0.0.0.0</code> in <strong>Docker images</strong> and <code>127.0.0.1</code> on <strong>Linux installations</strong>).</li>
<li><code>LISTEN_PORT</code>: the port where the web UI will listen (default is <code>7000</code>).</li>
<li><code>MAX_WORKERS</code>: the number of workers used by the web UI (default is the number of CPUs).</li>
<li><code>MAX_THREADS</code>: the number of threads used by the web UI (default is <code>MAX_WORKERS</code> * 2).</li>
<li><code>FORWARDED_ALLOW_IPS</code>: a list of IP addresses or networks that are allowed to be used in the <code>X-Forwarded-For</code> header (default is <code>*</code> in <strong>Docker images</strong> and <code>127.0.0.1</code> on <strong>Linux installations</strong>).</li>
<li><code>CHECK_PRIVATE_IP</code>: set it to <code>yes</code> to not disconnect users that have their IP address changed during a session if they are in a private network (default is <code>yes</code>). (Non-private IP addresses are always checked).</li>
<li><code>ENABLE_HEALTHCHECK</code>: set it to <code>yes</code> to enable the <code>/healthcheck</code> endpoint that returns a simple JSON response with status information (default is <code>no</code>).</li>
</ul>
<p>The web UI will use these variables to authenticate you and handle the 2FA feature.</p>
</div>
<div class="admonition example">
<p class="admonition-title">Generating recommended secrets</p>
<p>To generate a valid <strong>ADMIN_PASSWORD</strong>, we recommend you to <strong>use a password manager</strong> or a <strong>password generator</strong>.</p>
<p>You can generate a valid <strong>FLASK_SECRET</strong> using the following command:</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import secrets; print(secrets.token_hex(64))&quot;</span>
</code></pre></div>
<p>You can generate valid space-separated <strong>TOTP_SECRETS</strong> using the following command (you will need the <code>passlib</code> package):</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;from passlib import totp; print(totp.generate_secret())&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="2:5"><input checked="checked" id="web-ui-__tabbed_2_1" name="web-ui-__tabbed_2" type="radio" /><input id="web-ui-__tabbed_2_2" name="web-ui-__tabbed_2" type="radio" /><input id="web-ui-__tabbed_2_3" name="web-ui-__tabbed_2" type="radio" /><input id="web-ui-__tabbed_2_4" name="web-ui-__tabbed_2" type="radio" /><input id="web-ui-__tabbed_2_5" name="web-ui-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="web-ui-__tabbed_2_1">Linux</label><label for="web-ui-__tabbed_2_2">Docker</label><label for="web-ui-__tabbed_2_3">Docker autoconf</label><label for="web-ui-__tabbed_2_4">Kubernetes</label><label for="web-ui-__tabbed_2_5">Swarm</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>The installation of the web UI using the <a href="#integrations-linux">Linux integration</a> is pretty straightforward because it is installed with BunkerWeb.</p>
<p>The web UI comes as systemd service named <code>bunkerweb-ui</code>, please ensure that it's enabled:</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span><span class="nb">enable</span><span class="w"> </span>bunkerweb-ui<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>systemctl<span class="w"> </span>status<span class="w"> </span>bunkerweb-ui
</code></pre></div>
<p>A dedicated environment file located at <code>/etc/bunkerweb/ui.env</code> is used to configure the web UI:</p>
<div class="highlight"><pre><span></span><code>ADMIN_USERNAME=changeme
ADMIN_PASSWORD=changeme
TOTP_SECRETS=mysecret
</code></pre></div>
<p>Replace the <code>changeme</code> data with your own values.</p>
<p>Remember to set a stronger secret key for the <code>TOTP_SECRETS</code>.</p>
<p>Each time you edit the <code>/etc/bunkerweb/ui.env</code> file, you will need to restart the service:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>restart<span class="w"> </span>bunkerweb-ui
</code></pre></div>
<p>Accessing the web UI through BunkerWeb is a classical <a href="#quickstart-guide">reverse proxy setup</a>. Please note that the web UI is listening on the <code>7000</code> port and only on the loopback interface.</p>
<p>Here is the <code>/etc/bunkerweb/variables.env</code> boilerplate you can use:</p>
<div class="highlight"><pre><span></span><code>HTTP_PORT=80
HTTPS_PORT=443
DNS_RESOLVERS=9.9.9.9 8.8.8.8 8.8.4.4
API_LISTEN_IP=127.0.0.1
SERVER_NAME=www.example.com
MULTISITE=yes
www.example.com_USE_TEMPLATE=ui
www.example.com_USE_REVERSE_PROXY=yes
www.example.com_REVERSE_PROXY_URL=/changeme
www.example.com_REVERSE_PROXY_HOST=http://127.0.0.1:7000
</code></pre></div>
<p>Don't forget to reload the <code>bunkerweb</code> service:</p>
<div class="highlight"><pre><span></span><code>systemctl<span class="w"> </span>reload<span class="w"> </span>bunkerweb
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The web UI can be deployed using a dedicated container which is available on <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-ui
</code></pre></div>
<p>Alternatively, you can also build it yourself:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-bunkerweb-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<p>Accessing the web UI through BunkerWeb is a classical <a href="#quickstart-guide">reverse proxy setup</a>. We recommend you to connect BunkerWeb and web UI using a dedicated network (like <code>bw-universe</code> also used by the scheduler) so it won't be on the same network of your web services for obvious security reasons. Please note that the web UI container is listening on the <code>7000</code> port.</p>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>If you want another Database backend than MariaDB please refer to the docker-compose files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository.</p>
</div>
<p>Here is the docker-compose boilerplate that you can use (don't forget to edit the <code>changeme</code> data):</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;ui-env</span>
<span class="w">  </span><span class="c1"># We anchor the environment variables to avoid duplication</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># For QUIC / HTTP3 support</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># Make sure to set the correct IP range so the scheduler can send the configuration to the instance</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span><span class="w"> </span><span class="c1"># Make sure to set the correct instance name</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span><span class="w"> </span><span class="c1"># We mirror the API_WHITELIST_IP from the bunkerweb service</span>
<span class="w">      </span><span class="nt">SERVE_FILES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;no&quot;</span>
<span class="w">      </span><span class="nt">DISABLE_DEFAULT_SERVER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_CLIENT_CACHE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_GZIP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_TEMPLATE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;ui&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_USE_REVERSE_PROXY</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_URL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger URI</span>
<span class="w">      </span><span class="nt">www.example.com_REVERSE_PROXY_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;http://bw-ui:7000&quot;</span><span class="w"> </span><span class="c1"># The web UI container is listening on the 7000 port by default</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the changeme user</span>
<span class="w">      </span><span class="nt">TOTP_SECRETS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger secret key (see the Prerequisites section)</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The web UI can be deployed using a dedicated container which is available on <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-ui
</code></pre></div>
<p>Alternatively, you can also build it yourself:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-bunkerweb-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Environment variables</p>
<p>Please read the <a href="#web-ui-prerequisites">Prerequisites</a> section to check out all the environment variables you can set to customize the web UI.</p>
</div>
<p>Accessing the web UI through BunkerWeb is a classical <a href="#quickstart-guide">reverse proxy setup</a>. We recommend you to connect BunkerWeb and web UI using a dedicated network (like <code>bw-universe</code> also used by the scheduler and autoconf) so it won't be on the same network of your web services for obvious security reasons. Please note that the web UI container is listening on the <code>7000</code> port.</p>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>If you want another Database backend than MariaDB please refer to the docker-compose files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository.</p>
</div>
<p>Here is the docker-compose boilerplate that you can use (don't forget to edit the <code>changeme</code> data):</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;ui-env</span>
<span class="w">  </span><span class="c1"># We anchor the environment variables to avoid duplication</span>
<span class="w">  </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;80:8080/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/tcp&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;443:8443/udp&quot;</span><span class="w"> </span><span class="c1"># For QUIC / HTTP3 support</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span><span class="w"> </span><span class="c1"># We set the instance label to allow the autoconf to detect the instance</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">AUTOCONF_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">depends_on</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the changeme user</span>
<span class="w">      </span><span class="nt">TOTP_SECRETS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger secret key (see the Prerequisites section)</span>
<span class="w">    </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_TEMPLATE=ui&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/changeme&quot;</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://bw-ui:7000&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">default</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>The web UI can be deployed using a dedicated container which is available on <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a> and you can deploy as a standard <a href="https://kubernetes.io/docs/concepts/workloads/controllers/deployment/">Deployment</a>.</p>
<p>Accessing the web UI through BunkerWeb is a classical <a href="#quickstart-guide">reverse proxy setup</a>. Network segmentation between web UI and web services is not covered in this documentation. Please note that the web UI container is listening on the <code>7000</code> port.</p>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>If you want another Database backend than MariaDB please refer to the yaml files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository.</p>
</div>
<p>Here is the corresponding part of your values.yaml file that you can use:</p>
<div class="highlight"><pre><span></span><code><span class="nt">settings</span><span class="p">:</span>
<span class="w">  </span><span class="c1"># Use an existing secret named bunkerweb and containing the following values:</span>
<span class="w">  </span><span class="c1"># - admin-username</span>
<span class="w">  </span><span class="c1"># - admin-password</span>
<span class="w">  </span><span class="c1"># - flask-secret</span>
<span class="w">  </span><span class="c1"># - totp-secrets</span>
<span class="w">  </span><span class="nt">existingSecret</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;secret-bunkerweb&quot;</span>
<span class="nt">ui</span><span class="p">:</span>
<span class="w">  </span><span class="nt">wizard</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">false</span>
<span class="w">  </span><span class="nt">ingress</span><span class="p">:</span>
<span class="w">    </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">serverName</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;www.example.com&quot;</span>
<span class="w">    </span><span class="nt">serverPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/admin&quot;</span>
<span class="w">  </span><span class="nt">overrideAdminCreds</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#integrations-kubernetes">Kubernetes integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>The web UI can be deployed using a dedicated container which is available on <a href="https://hub.docker.com/r/bunkerity/bunkerweb-ui">Docker Hub</a>:</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>pull<span class="w"> </span>bunkerity/bunkerweb-ui
</code></pre></div>
<p>Alternatively, you can also build it yourself:</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb.git<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
docker<span class="w"> </span>build<span class="w"> </span>-t<span class="w"> </span>my-bunkerweb-ui<span class="w"> </span>-f<span class="w"> </span>src/ui/Dockerfile<span class="w"> </span>.
</code></pre></div>
<p>Accessing the web UI through BunkerWeb is a classical <a href="#quickstart-guide">reverse proxy setup</a>. We recommend you to connect BunkerWeb and web UI using a dedicated network (like <code>bw-universe</code> also used by the scheduler and autoconf) so it won't be on the same network of your web services for obvious security reasons. Please note that the web UI container is listening on the <code>7000</code> port.</p>
<div class="admonition info">
<p class="admonition-title">Database backend</p>
<p>If you want another Database backend than MariaDB please refer to the stack files in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/misc/integrations">misc/integrations folder</a> of the repository.</p>
</div>
<p>Here is the stack boilerplate that you can use (don't forget to edit the <code>changeme</code> data):</p>
<div class="highlight"><pre><span></span><code><span class="nt">x-ui-env</span><span class="p">:</span><span class="w"> </span><span class="nl">&amp;ui-env</span>
<span class="w">  </span><span class="c1"># We anchor the environment variables to avoid duplication</span>
<span class="w">  </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">  </span><span class="nt">DATABASE_URI</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@bw-db:3306/db&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>

<span class="nt">services</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">    </span><span class="nt">ports</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">80</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8080</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tcp</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">published</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">443</span>
<span class="w">        </span><span class="nt">target</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">8443</span>
<span class="w">        </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">host</span>
<span class="w">        </span><span class="nt">protocol</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">udp</span><span class="w"> </span><span class="c1"># For QUIC / HTTP3 support</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">SWARM_MODE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">mode</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">global</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">worker&quot;</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.INSTANCE=yes&quot;</span>

<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">BUNKERWEB_INSTANCES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">SERVER_NAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;&quot;</span>
<span class="w">      </span><span class="nt">API_WHITELIST_IP</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;127.0.0.0/8</span><span class="nv"> </span><span class="s">10.20.30.0/24&quot;</span>
<span class="w">      </span><span class="nt">MULTISITE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">USE_REDIS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">REDIS_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bw-redis&quot;</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-storage:/data</span><span class="w"> </span><span class="c1"># This is used to persist the cache and other data like the backups</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">DOCKER_HOST</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;tcp://bw-docker:2375&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">tecnativa/docker-socket-proxy:nightly</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/var/run/docker.sock:/var/run/docker.sock:ro</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">CONFIGS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">CONTAINERS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SERVICES</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">SWARM</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">TASKS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;1&quot;</span>
<span class="w">      </span><span class="nt">LOG_LEVEL</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;warning&quot;</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">placement</span><span class="p">:</span>
<span class="w">        </span><span class="nt">constraints</span><span class="p">:</span>
<span class="w">          </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;node.role</span><span class="nv"> </span><span class="s">==</span><span class="nv"> </span><span class="s">manager&quot;</span>

<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">mariadb:11</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">MYSQL_RANDOM_ROOT_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_DATABASE</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;db&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_USER</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;bunkerweb&quot;</span>
<span class="w">      </span><span class="nt">MYSQL_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the database</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-data:/var/lib/mysql</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>

<span class="w">  </span><span class="nt">bw-redis</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">redis:7-alpine</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>

<span class="w">  </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">    </span><span class="nt">environment</span><span class="p">:</span>
<span class="w">      </span><span class="nt">&lt;&lt;</span><span class="p">:</span><span class="w"> </span><span class="nv">*ui-env</span>
<span class="w">      </span><span class="nt">ADMIN_USERNAME</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span>
<span class="w">      </span><span class="nt">ADMIN_PASSWORD</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;changeme&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger password for the changeme user</span>
<span class="w">      </span><span class="nt">TOTP_SECRETS</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mysecret&quot;</span><span class="w"> </span><span class="c1"># Remember to set a stronger secret key (see the Prerequisites section)</span>
<span class="w">    </span><span class="nt">networks</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">deploy</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.SERVER_NAME=www.example.com&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_TEMPLATE=ui&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.USE_REVERSE_PROXY=yes&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_URL=/changeme&quot;</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="s">&quot;bunkerweb.REVERSE_PROXY_HOST=http://bw-ui:7000&quot;</span>

<span class="nt">volumes</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-data</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-storage</span><span class="p">:</span>

<span class="nt">networks</span><span class="p">:</span>
<span class="w">  </span><span class="nt">bw-universe</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-universe</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">    </span><span class="nt">ipam</span><span class="p">:</span>
<span class="w">      </span><span class="nt">config</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">subnet</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">10.20.30.0/24</span>
<span class="w">  </span><span class="nt">bw-services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-services</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-docker</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-docker</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
<span class="w">  </span><span class="nt">bw-db</span><span class="p">:</span>
<span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bw-db</span>
<span class="w">    </span><span class="nt">driver</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">overlay</span>
<span class="w">    </span><span class="nt">attachable</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">true</span>
</code></pre></div>
</div>
</div>
</div>
<h2 id="web-ui-language-support-localization">Language Support &amp; Localization</h2>
<p>The BunkerWeb UI supports multiple languages. Translations are managed in the <code>src/ui/app/static/locales</code> directory. The following languages are currently available:</p>
<ul>
<li>English (en)</li>
<li>French (fr)</li>
<li>Arabic (ar)</li>
<li>Bengali (bn)</li>
<li>Spanish (es)</li>
<li>Hindi (hi)</li>
<li>Portuguese (pt)</li>
<li>Russian (ru)</li>
<li>Urdu (ur)</li>
<li>Chinese (zh)</li>
<li>German (de)</li>
<li>Italian (it)</li>
</ul>
<p>See the <a href="https://github.com/bunkerity/bunkerweb/raw/v1.6.2/src/ui/app/static/locales/README.md">locales/README.md</a> for details on translation provenance and review status.</p>
<h3 id="web-ui-contributing-translations">Contributing Translations</h3>
<p>We welcome contributions to improve or add new locale files!</p>
<p><strong>How to contribute a translation:</strong></p>
<ol>
<li>Edit the <code>src/ui/app/lang_config.py</code> file to add your language (code, name, flag, english_name).</li>
<li>Copy <code>en.json</code> as a template in <code>src/ui/app/static/locales/</code>, rename it to your language code (e.g., <code>de.json</code> for German).</li>
<li>Translate the values in your new file.</li>
<li>Update the table in <code>locales/README.md</code> to add your language and indicate who created/reviewed it.</li>
<li>Submit a pull request.</li>
</ol>
<p>For updates, edit the relevant file and update the provenance table as needed.</p>
<p>See the <a href="https://github.com/bunkerity/bunkerweb/raw/v1.6.2/src/ui/app/static/locales/README.md">locales/README.md</a> for full guidelines.</p></section><section class="print-page" id="upgrading" heading-number="8"><h1 id="upgrading-upgrading">Upgrading</h1>
<h2 id="upgrading-upgrade-from-16x">Upgrade from 1.6.X</h2>
<div class="admonition warning">
<p class="admonition-title">Read me first</p>
<p>We often add new features and settings to BunkerWeb. We recommend you read the <a href="#features">settings</a> sections of the documentation or the GitHub releases to see what's new.</p>
</div>
<h3 id="upgrading-procedure">Procedure</h3>
<ol>
<li>
<p><strong>Backup the database</strong>:</p>
<ul>
<li>Before proceeding with the database upgrade, ensure that you perform a complete backup of the current state of the database.</li>
<li>Use appropriate tools to backup the entire database, including data, schemas, and configurations.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="upgrading-__tabbed_1_1" name="upgrading-__tabbed_1" type="radio" /><input id="upgrading-__tabbed_1_2" name="upgrading-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_1_1">Docker</label><label for="upgrading-__tabbed_1_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/backup/directory<span class="w"> </span>/path/to/backup/directory
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Information for Red Hat Enterprise Linux (RHEL) 8.10 users</p>
<p>If you are using <strong>RHEL 8.10</strong> and plan on using an <strong>external database</strong>, you will need to install the <code>mysql-community-client</code> package to ensure the <code>mysqldump</code> command is available. You can install the package by executing the following commands:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:2"><input checked="checked" id="upgrading-__tabbed_2_1" name="upgrading-__tabbed_2" type="radio" /><input id="upgrading-__tabbed_2_2" name="upgrading-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_2_1">MySQL/MariaDB</label><label for="upgrading-__tabbed_2_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Install the MySQL repository configuration package</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>https://dev.mysql.com/get/mysql80-community-release-el8-9.noarch.rpm
</code></pre></div>
</li>
<li>
<p><strong>Enable the MySQL repository</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--enable<span class="w"> </span>mysql80-community
</code></pre></div>
</li>
<li>
<p><strong>Install the MySQL client</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql-community-client
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Install the PostgreSQL repository configuration package</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">/pgdg-redhat-repo-latest.noarch.rpm&quot;</span>
</code></pre></div>
</li>
<li>
<p><strong>Install the PostgreSQL client</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span>postgresql&lt;version&gt;
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p><strong>Upgrade BunkerWeb</strong>:</p>
<ul>
<li>
<p>Upgrade BunkerWeb to the latest version.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="upgrading-__tabbed_3_1" name="upgrading-__tabbed_3" type="radio" /><input id="upgrading-__tabbed_3_2" name="upgrading-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_3_1">Docker</label><label for="upgrading-__tabbed_3_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Update the Docker Compose file</strong>: Update the Docker Compose file to use the new version of the BunkerWeb image.
    <div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Restart the containers</strong>: Restart the containers to apply the changes.
    <div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div></p>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Stop the services</strong>:
    <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb-ui
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb-scheduler
</code></pre></div></p>
</li>
<li>
<p><strong>Update BunkerWeb</strong>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="4:2"><input checked="checked" id="upgrading-__tabbed_4_1" name="upgrading-__tabbed_4" type="radio" /><input id="upgrading-__tabbed_4_2" name="upgrading-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_4_1">Debian/Ubuntu</label><label for="upgrading-__tabbed_4_2">Fedora/RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>First, if you have previously held the BunkerWeb package, unhold it :</p>
<p>You can print a list of packages on hold with <code>apt-mark showhold</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>unhold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>Then, you can update the BunkerWeb package :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.2
</code></pre></div>
<p>To prevent the BunkerWeb package from upgrading when executing <code>apt upgrade</code>, you can use the following command :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>More details in the <a href="#integrations-__tabbed_1_1">integration Linux page</a>.</p>
</div>
<div class="tabbed-block">
<p>First, if you have previously held the BunkerWeb package, unhold it :</p>
<p>You can print a list of packages on hold with <code>dnf versionlock list</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>nginx
</code></pre></div>
<p>Then, you can update the BunkerWeb package :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-1.6.2
</code></pre></div>
<p>To prevent the BunkerWeb package from upgrading when executing <code>dnf upgrade</code>, you can use the following command :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx
</code></pre></div>
<p>More details in the <a href="#integrations-__tabbed_1_3">integration Linux page</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p><strong>Start the services</strong>:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-ui
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
        Or reboot the system:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>reboot
</code></pre></div></p>
</li>
</ol>
</div>
</div>
</div>
</li>
</ul>
</li>
<li>
<p><strong>Check the logs</strong>: Check the logs of the scheduler service to ensure that the migration was successful.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="5:2"><input checked="checked" id="upgrading-__tabbed_5_1" name="upgrading-__tabbed_5" type="radio" /><input id="upgrading-__tabbed_5_2" name="upgrading-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_5_1">Docker</label><label for="upgrading-__tabbed_5_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>&lt;scheduler_container&gt;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-u<span class="w"> </span>bunkerweb<span class="w"> </span>--no-pager
</code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p><strong>Verify the database</strong>: Verify that the database upgrade was successful by checking the data and configurations in the new database container.</p>
</li>
</ol>
<h3 id="upgrading-rollback">Rollback</h3>
<div class="admonition failure">
<p class="admonition-title">In case of issues</p>
<p>If you encounter any issues during the upgrade, you can rollback to the previous version of the database by restoring the backup taken in <a href="#upgrading-__tabbed_1_1">step 1</a>.</p>
<p>Get support and more information :</p>
<ul>
<li><a href="https://panel.bunkerweb.io/?utm_source=doc&amp;utm_campaign=self">Order professional support</a></li>
<li><a href="https://github.com/bunkerity/bunkerweb/issues">Create an issue on GitHub</a></li>
<li><a href="https://discord.bunkerity.com">Join the BunkerWeb Discord server</a></li>
</ul>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="6:2"><input checked="checked" id="upgrading-__tabbed_6_1" name="upgrading-__tabbed_6" type="radio" /><input id="upgrading-__tabbed_6_2" name="upgrading-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_6_1">Docker</label><label for="upgrading-__tabbed_6_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extract the backup if zipped</strong>.</p>
<p>Extract the backup zip file first:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="7:3"><input checked="checked" id="upgrading-__tabbed_7_1" name="upgrading-__tabbed_7" type="radio" /><input id="upgrading-__tabbed_7_2" name="upgrading-__tabbed_7" type="radio" /><input id="upgrading-__tabbed_7_3" name="upgrading-__tabbed_7" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_7_1">SQLite</label><label for="upgrading-__tabbed_7_2">MySQL/MariaDB</label><label for="upgrading-__tabbed_7_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Remove the existing database file.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Fix permissions.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Stop the stack.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;your_password&gt;<span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Stop the stack.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Remove the existing database.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Recreate the database.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Stop the stack.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Downgrade BunkerWeb</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</li>
<li>
<p><strong>Start the containers</strong>.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extract the backup if zipped</strong>.</p>
<p>Extract the backup zip file first:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Stop the services</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="8:3"><input checked="checked" id="upgrading-__tabbed_8_1" name="upgrading-__tabbed_8" type="radio" /><input id="upgrading-__tabbed_8_2" name="upgrading-__tabbed_8" type="radio" /><input id="upgrading-__tabbed_8_3" name="upgrading-__tabbed_8" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_8_1">SQLite</label><label for="upgrading-__tabbed_8_2">MySQL/MariaDB</label><label for="upgrading-__tabbed_8_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
sudo<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Remove the existing database.</strong></p>
<div class="highlight"><pre><span></span><code>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Recreate the database.</strong></p>
<div class="highlight"><pre><span></span><code>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Start the services</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Downgrade BunkerWeb</strong>.</p>
<ul>
<li>Downgrade BunkerWeb to the previous version by following the same steps as when upgrading BunkerWeb in the <a href="#integrations-linux">integration Linux page</a></li>
</ul>
</li>
</ol>
</div>
</div>
</div>
<h2 id="upgrading-upgrade-from-15x">Upgrade from 1.5.X</h2>
<h3 id="upgrading-what-changed">What changed?</h3>
<h4 id="upgrading-scheduler">Scheduler</h4>
<p>Unlike the 1.5.X releases, the Scheduler service <strong>no longer uses the <em>docker socket proxy</em> to fetch BunkerWeb's instances</strong>. Instead, it uses the new <code>BUNKERWEB_INSTANCES</code> environment variable.</p>
<div class="admonition info">
<p class="admonition-title">About the <code>BUNKERWEB_INSTANCES</code> environment variable</p>
<p>This new variable is a list of BunkerWeb instances separated by spaces in this format: <code>http://bunkerweb:5000 bunkerweb1:5000 bunkerweb2:5000 ...</code>. The scheduler will then use this list to fetch the instances' configuration and to send the configuration to them.</p>
<ul>
<li>The <code>http://</code> prefix is optional.</li>
<li>The port is optional and defaults to the value of the <code>API_HTTP_PORT</code> environment variable.</li>
<li>The default value of the <code>BUNKERWEB_INSTANCES</code> environment variable is <code>127.0.0.1</code>.</li>
</ul>
</div>
<p>In other words, the new system is fully agnostic and generic: the scheduler is in charge of managing a list of BunkerWeb instances and doesn't need to care about the environment.</p>
<div class="admonition tip">
<p class="admonition-title">Autoconf/Kubernetes/Swarm integrations</p>
<p>If you are using the <code>Autoconf</code>, <code>Kubernetes</code>, or <code>Swarm</code> integrations, you can set the <code>BUNKERWEB_INSTANCES</code> environment variable to an empty string (so that it doesn't try to send the configuration to the default one which is <code>127.0.0.1</code>).</p>
<p><strong>The instances will be automatically fetched by the controller</strong>. You can also add custom instances to the list that may not be picked up by the controller.</p>
</div>
<p>Since the <code>1.6</code>, the Scheduler also have a new <a href="#concepts">built-in healthcheck system</a>, that will check the health of the instances. If an instance becomes unhealthy, the scheduler will stop sending the configuration to it. If the instance becomes healthy again, the scheduler will start sending the configuration to it again.</p>
<h4 id="upgrading-bunkerweb-container">BunkerWeb container</h4>
<p>Another important change is that the <strong>settings</strong> that were previously declared on the BunkerWeb container <strong>are now declared on the scheduler</strong>. This means that you'll have to move your settings from the BunkerWeb container to the Scheduler container.</p>
<p>While the settings are now declared on the Scheduler container, <strong>you'll still need to declare api related mandatory settings on the BunkerWeb container</strong> like the <code>API_WHITELIST_IP</code> setting which is used to whitelist the Scheduler's IP address, so that it can send the configuration to the instance.</p>
<div class="admonition warning">
<p class="admonition-title">BunkerWeb's container settings</p>
<p>Every API related setting that you declare on the BunkerWeb container <strong>have to be mirrored on the Scheduler container</strong> so that it keeps working, as the configuration will be overwritten by the Scheduler's generated configuration.</p>
</div>
<h4 id="upgrading-default-values-and-new-settings">Default values and new settings</h4>
<p>We tried our best not to change default value but we have added many other settings. It's highly recommended to read the <a href="#advanced-security-tuning">security tuning</a> and <a href="#features">settings</a> sections of the documentation.</p>
<h4 id="upgrading-templates">Templates</h4>
<p>We added a new feature called <strong>templates</strong>. Templates provide a structured and standardized approach to defining settings and custom configurations, check the <a href="#concepts-templates">concepts/templates</a> section for more information.</p>
<h4 id="upgrading-autoconf-namespaces">Autoconf namespaces</h4>
<p>We added a <strong>namespace</strong> feature to the autoconf integrations. Namespaces allow you to group your instances and apply settings only to them. Check the following sections according to your Integration for more information:</p>
<ul>
<li><a href="#integrations-namespaces">Autoconf/namespaces</a></li>
<li><a href="#integrations-namespaces_1">Kubernetes/namespaces</a></li>
<li><a href="#integrations-namespaces_2">Swarm/namespaces</a></li>
</ul>
<h3 id="upgrading-procedure_1">Procedure</h3>
<ol>
<li>
<p><strong>Backup the database</strong>:</p>
<ul>
<li>Before proceeding with the database upgrade, ensure that you perform a complete backup of the current state of the database.</li>
<li>Use appropriate tools to backup the entire database, including data, schemas, and configurations.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="9:2"><input checked="checked" id="upgrading-__tabbed_9_1" name="upgrading-__tabbed_9" type="radio" /><input id="upgrading-__tabbed_9_2" name="upgrading-__tabbed_9" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_9_1">1.5.7 and later</label><label for="upgrading-__tabbed_9_2">1.5.6 and earlier</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="10:2"><input checked="checked" id="upgrading-__tabbed_10_1" name="upgrading-__tabbed_10" type="radio" /><input id="upgrading-__tabbed_10_2" name="upgrading-__tabbed_10" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_10_1">Docker</label><label for="upgrading-__tabbed_10_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>cp<span class="w"> </span>&lt;scheduler_container&gt;:/path/to/backup/directory<span class="w"> </span>/path/to/backup/directory
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Information for Red Hat Enterprise Linux (RHEL) 8.10 users</p>
<p>If you are using <strong>RHEL 8.10</strong> and plan on using an <strong>external database</strong>, you will need to install the <code>mysql-community-client</code> package to ensure the <code>mysqldump</code> command is available. You can install the package by executing the following commands:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="11:2"><input checked="checked" id="upgrading-__tabbed_11_1" name="upgrading-__tabbed_11" type="radio" /><input id="upgrading-__tabbed_11_2" name="upgrading-__tabbed_11" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_11_1">MySQL/MariaDB</label><label for="upgrading-__tabbed_11_2">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Install the MySQL repository configuration package</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>https://dev.mysql.com/get/mysql80-community-release-el8-9.noarch.rpm
</code></pre></div>
</li>
<li>
<p><strong>Enable the MySQL repository</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>config-manager<span class="w"> </span>--enable<span class="w"> </span>mysql80-community
</code></pre></div>
</li>
<li>
<p><strong>Install the MySQL client</strong></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>mysql-community-client
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Install the PostgreSQL repository configuration package</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span><span class="s2">&quot;https://download.postgresql.org/pub/repos/yum/reporpms/EL-8-</span><span class="k">$(</span>uname<span class="w"> </span>-m<span class="k">)</span><span class="s2">/pgdg-redhat-repo-latest.noarch.rpm&quot;</span>
</code></pre></div>
</li>
<li>
<p><strong>Install the PostgreSQL client</strong></p>
<div class="highlight"><pre><span></span><code>dnf<span class="w"> </span>install<span class="w"> </span>postgresql&lt;version&gt;
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</div>
<div class="highlight"><pre><span></span><code><span class="nv">BACKUP_DIRECTORY</span><span class="o">=</span>/path/to/backup/directory<span class="w"> </span>bwcli<span class="w"> </span>plugin<span class="w"> </span>backup<span class="w"> </span>save
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="12:4"><input checked="checked" id="upgrading-__tabbed_12_1" name="upgrading-__tabbed_12" type="radio" /><input id="upgrading-__tabbed_12_2" name="upgrading-__tabbed_12" type="radio" /><input id="upgrading-__tabbed_12_3" name="upgrading-__tabbed_12" type="radio" /><input id="upgrading-__tabbed_12_4" name="upgrading-__tabbed_12" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_12_1">SQLite</label><label for="upgrading-__tabbed_12_2">MariaDB</label><label for="upgrading-__tabbed_12_3">MySQL</label><label for="upgrading-__tabbed_12_4">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="13:2"><input checked="checked" id="upgrading-__tabbed_13_1" name="upgrading-__tabbed_13" type="radio" /><input id="upgrading-__tabbed_13_2" name="upgrading-__tabbed_13" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_13_1">Docker</label><label for="upgrading-__tabbed_13_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>We first need to install the <code>sqlite</code> package in the container.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>apk<span class="w"> </span>add<span class="w"> </span>sqlite
</code></pre></div>
<p>Then, backup the database.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span><span class="s2">&quot;.dump&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span><span class="s2">&quot;.dump&quot;</span><span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="14:2"><input checked="checked" id="upgrading-__tabbed_14_1" name="upgrading-__tabbed_14" type="radio" /><input id="upgrading-__tabbed_14_2" name="upgrading-__tabbed_14" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_14_1">Docker</label><label for="upgrading-__tabbed_14_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mariadb-dump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>mariadb-dump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="15:2"><input checked="checked" id="upgrading-__tabbed_15_1" name="upgrading-__tabbed_15" type="radio" /><input id="upgrading-__tabbed_15_2" name="upgrading-__tabbed_15" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_15_1">Docker</label><label for="upgrading-__tabbed_15_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mysqldump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>mysqldump<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="16:2"><input checked="checked" id="upgrading-__tabbed_16_1" name="upgrading-__tabbed_16" type="radio" /><input id="upgrading-__tabbed_16_2" name="upgrading-__tabbed_16" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_16_1">Docker</label><label for="upgrading-__tabbed_16_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-it<span class="w"> </span>-e<span class="w"> </span><span class="nv">PGPASSWORD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>pg_dump<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code><span class="nv">PGPASSWORD</span><span class="o">=</span>&lt;database_password&gt;<span class="w"> </span>pg_dump<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&gt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</li>
<li>
<p><strong>Upgrade BunkerWeb</strong>:</p>
<ul>
<li>
<p>Upgrade BunkerWeb to the latest version.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="17:2"><input checked="checked" id="upgrading-__tabbed_17_1" name="upgrading-__tabbed_17" type="radio" /><input id="upgrading-__tabbed_17_2" name="upgrading-__tabbed_17" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_17_1">Docker</label><label for="upgrading-__tabbed_17_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Update the Docker Compose file</strong>: Update the Docker Compose file to use the new version of the BunkerWeb image.
    <div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:1.6.2</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div></p>
</li>
<li>
<p><strong>Restart the containers</strong>: Restart the containers to apply the changes.
    <div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div></p>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Stop the services</strong>:
    <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb-ui
</code></pre></div></p>
</li>
<li>
<p><strong>Update BunkerWeb</strong>:</p>
<div class="tabbed-set tabbed-alternate" data-tabs="18:2"><input checked="checked" id="upgrading-__tabbed_18_1" name="upgrading-__tabbed_18" type="radio" /><input id="upgrading-__tabbed_18_2" name="upgrading-__tabbed_18" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_18_1">Debian/Ubuntu</label><label for="upgrading-__tabbed_18_2">Fedora/RedHat</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>First, if you have previously held the BunkerWeb package, unhold it :</p>
<p>You can print a list of packages on hold with <code>apt-mark showhold</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>unhold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>Then, you can update the BunkerWeb package :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>update<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allow-downgrades<span class="w"> </span><span class="nv">bunkerweb</span><span class="o">=</span><span class="m">1</span>.6.2
</code></pre></div>
<p>To prevent the BunkerWeb package from upgrading when executing <code>apt upgrade</code>, you can use the following command :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt-mark<span class="w"> </span>hold<span class="w"> </span>bunkerweb<span class="w"> </span>nginx
</code></pre></div>
<p>More details in the <a href="#integrations-__tabbed_1_1">integration Linux page</a>.</p>
</div>
<div class="tabbed-block">
<p>First, if you have previously held the BunkerWeb package, unhold it :</p>
<p>You can print a list of packages on hold with <code>dnf versionlock list</code></p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>delete<span class="w"> </span>package<span class="w"> </span>nginx
</code></pre></div>
<p>Then, you can update the BunkerWeb package :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>makecache<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>-y<span class="w"> </span>--allowerasing<span class="w"> </span>bunkerweb-1.6.2
</code></pre></div>
<p>To prevent the BunkerWeb package from upgrading when executing <code>dnf upgrade</code>, you can use the following command :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>bunkerweb<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>dnf<span class="w"> </span>versionlock<span class="w"> </span>add<span class="w"> </span>nginx
</code></pre></div>
<p>More details in the <a href="#integrations-__tabbed_1_3">integration Linux page</a>.</p>
</div>
</div>
</div>
</li>
<li>
<p><strong>Start the services</strong>:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb
sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb-ui
</code></pre></div>
        Or reboot the system:
        <div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>reboot
</code></pre></div></p>
</li>
</ol>
</div>
</div>
</div>
</li>
</ul>
</li>
<li>
<p><strong>Check the logs</strong>: Check the logs of the scheduler service to ensure that the migration was successful.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="19:2"><input checked="checked" id="upgrading-__tabbed_19_1" name="upgrading-__tabbed_19" type="radio" /><input id="upgrading-__tabbed_19_2" name="upgrading-__tabbed_19" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_19_1">Docker</label><label for="upgrading-__tabbed_19_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>logs<span class="w"> </span>&lt;scheduler_container&gt;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-u<span class="w"> </span>bunkerweb<span class="w"> </span>--no-pager
</code></pre></div>
</div>
</div>
</div>
</li>
<li>
<p><strong>Verify the database</strong>: Verify that the database upgrade was successful by checking the data and configurations in the new database container.</p>
</li>
</ol>
<h3 id="upgrading-rollback_1">Rollback</h3>
<div class="admonition failure">
<p class="admonition-title">In case of issues</p>
<p>If you encounter any issues during the upgrade, you can rollback to the previous version of the database by restoring the backup taken in <a href="#upgrading-__tabbed_1_1">step 1</a>.</p>
<p>Get support and more information :</p>
<ul>
<li><a href="https://panel.bunkerweb.io/?utm_source=doc&amp;utm_campaign=self">Order professional support</a></li>
<li><a href="https://github.com/bunkerity/bunkerweb/issues">Create an issue on GitHub</a></li>
<li><a href="https://discord.bunkerity.com">Join the BunkerWeb Discord server</a></li>
</ul>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="20:2"><input checked="checked" id="upgrading-__tabbed_20_1" name="upgrading-__tabbed_20" type="radio" /><input id="upgrading-__tabbed_20_2" name="upgrading-__tabbed_20" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_20_1">Docker</label><label for="upgrading-__tabbed_20_2">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extract the backup if zipped</strong>.</p>
<p>Extract the backup zip file first:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="21:3"><input checked="checked" id="upgrading-__tabbed_21_1" name="upgrading-__tabbed_21" type="radio" /><input id="upgrading-__tabbed_21_2" name="upgrading-__tabbed_21" type="radio" /><input id="upgrading-__tabbed_21_3" name="upgrading-__tabbed_21" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_21_1">SQLite</label><label for="upgrading-__tabbed_21_2">MySQL/MariaDB</label><label for="upgrading-__tabbed_21_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<ol>
<li>
<p><strong>Remove the existing database file.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Fix permissions.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-i<span class="w"> </span>&lt;scheduler_container&gt;<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</li>
<li>
<p><strong>Stop the stack.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-e<span class="w"> </span><span class="nv">MYSQL_PWD</span><span class="o">=</span>&lt;your_password&gt;<span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Stop the stack.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Remove the existing database.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Recreate the database.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-i<span class="w"> </span>&lt;database_container&gt;<span class="w"> </span>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
<li>
<p><strong>Stop the stack.</strong></p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>down
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Downgrade BunkerWeb</strong>.</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="w">    </span><span class="nt">bunkerweb</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-autoconf</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-autoconf:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
<span class="w">    </span><span class="nt">bw-ui</span><span class="p">:</span>
<span class="w">        </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-ui:&lt;old_version&gt;</span>
<span class="w">        </span><span class="l l-Scalar l-Scalar-Plain">...</span>
</code></pre></div>
</li>
<li>
<p><strong>Start the containers</strong>.</p>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>compose<span class="w"> </span>up<span class="w"> </span>-d
</code></pre></div>
</li>
</ol>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Extract the backup if zipped</strong>.</p>
<p>Extract the backup zip file first:</p>
<div class="highlight"><pre><span></span><code>unzip<span class="w"> </span>/path/to/backup/directory/backup.zip<span class="w"> </span>-d<span class="w"> </span>/path/to/backup/directory/
</code></pre></div>
</li>
<li>
<p><strong>Stop the services</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>stop<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup</strong>.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="22:3"><input checked="checked" id="upgrading-__tabbed_22_1" name="upgrading-__tabbed_22" type="radio" /><input id="upgrading-__tabbed_22_2" name="upgrading-__tabbed_22" type="radio" /><input id="upgrading-__tabbed_22_3" name="upgrading-__tabbed_22" type="radio" /><div class="tabbed-labels"><label for="upgrading-__tabbed_22_1">SQLite</label><label for="upgrading-__tabbed_22_2">MySQL/MariaDB</label><label for="upgrading-__tabbed_22_3">PostgreSQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>rm<span class="w"> </span>-f<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
sudo<span class="w"> </span>chown<span class="w"> </span>root:nginx<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
sudo<span class="w"> </span>chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="highlight"><pre><span></span><code>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</div>
<div class="tabbed-block">
<ol>
<li>
<p><strong>Remove the existing database.</strong></p>
<div class="highlight"><pre><span></span><code>dropdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>--force<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Recreate the database.</strong></p>
<div class="highlight"><pre><span></span><code>createdb<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>&lt;database_name&gt;
</code></pre></div>
</li>
<li>
<p><strong>Restore the backup.</strong></p>
<div class="highlight"><pre><span></span><code>psql<span class="w"> </span>-U<span class="w"> </span>&lt;username&gt;<span class="w"> </span>-d<span class="w"> </span>&lt;database_name&gt;<span class="w"> </span>&lt;<span class="w"> </span>/path/to/backup/directory/backup.sql
</code></pre></div>
</li>
</ol>
</div>
</div>
</div>
</li>
<li>
<p><strong>Start the services</strong>.</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>systemctl<span class="w"> </span>start<span class="w"> </span>bunkerweb<span class="w"> </span>bunkerweb-ui<span class="w"> </span>bunkerweb-scheduler
</code></pre></div>
</li>
<li>
<p><strong>Downgrade BunkerWeb</strong>.</p>
<ul>
<li>Downgrade BunkerWeb to the previous version by following the same steps as when upgrading BunkerWeb in the <a href="#integrations-linux">integration Linux page</a></li>
</ul>
</li>
</ol>
</div>
</div>
</div></section><section class="print-page" id="troubleshooting" heading-number="9"><h1 id="troubleshooting-troubleshooting">Troubleshooting</h1>
<div class="admonition info">
<p class="admonition-title">BunkerWeb Panel</p>
<p>If you are unable to resolve your issue, you can <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">contact us directly via our panel</a>. This centralizes all requests related to the BunkerWeb solution.</p>
</div>
<h2 id="troubleshooting-logs">Logs</h2>
<p>When troubleshooting, logs are your best friends. We try our best to provide user-friendly logs to help you understand what's happening.</p>
<p>Please note that you can set the <code>LOG_LEVEL</code> to <code>info</code> (default: <code>notice</code>) to increase BunkerWeb’s verbosity.</p>
<p>Here is how you can access the logs, depending on your integration :</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:6"><input checked="checked" id="troubleshooting-__tabbed_1_1" name="troubleshooting-__tabbed_1" type="radio" /><input id="troubleshooting-__tabbed_1_2" name="troubleshooting-__tabbed_1" type="radio" /><input id="troubleshooting-__tabbed_1_3" name="troubleshooting-__tabbed_1" type="radio" /><input id="troubleshooting-__tabbed_1_4" name="troubleshooting-__tabbed_1" type="radio" /><input id="troubleshooting-__tabbed_1_5" name="troubleshooting-__tabbed_1" type="radio" /><input id="troubleshooting-__tabbed_1_6" name="troubleshooting-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="troubleshooting-__tabbed_1_1">Docker</label><label for="troubleshooting-__tabbed_1_2">Docker autoconf</label><label for="troubleshooting-__tabbed_1_3">All-in-one</label><label for="troubleshooting-__tabbed_1_4">Swarm</label><label for="troubleshooting-__tabbed_1_5">Kubernetes</label><label for="troubleshooting-__tabbed_1_6">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">List containers</p>
<p>To list the running containers, you can use the following command :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps
</code></pre></div></p>
</div>
<p>You can use the <code>docker logs</code> command (replace <code>mybunker</code> with the name of your container) :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>mybunker
</code></pre></div></p>
<p>Here is the docker-compose equivalent (replace <code>mybunker</code> with the name of the services declared in the docker-compose.yml file) :
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>logs<span class="w"> </span>mybunker
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">List containers</p>
<p>To list the running containers, you can use the following command :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>ps
</code></pre></div></p>
</div>
<p>You can use the <code>docker logs</code> command (replace <code>mybunker</code> and <code>myautoconf</code> with the name of your containers) :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>mybunker
docker<span class="w"> </span>logs<span class="w"> </span>myautoconf
</code></pre></div></p>
<p>Here is the docker-compose equivalent (replace <code>mybunker</code> and <code>myautoconf</code> with the name of the services declared in the docker-compose.yml file) :
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span>logs<span class="w"> </span>mybunker
docker-compose<span class="w"> </span>logs<span class="w"> </span>myautoconf
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">Container name</p>
<p>The default container name for the All-in-one image is <code>bunkerweb-aio</code>. If you've used a different name, please adjust the command accordingly.</p>
</div>
<p>You can use the <code>docker logs</code> command:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>logs<span class="w"> </span>bunkerweb-aio
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#troubleshooting-__tabbed_1_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<div class="admonition tip">
<p class="admonition-title">List services</p>
<p>To list the services, you can use the following command :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>service<span class="w"> </span>ls
</code></pre></div></p>
</div>
<p>You can use the <code>docker service logs</code> command (replace <code>mybunker</code> and <code>myautoconf</code> with the name of your services) :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span>service<span class="w"> </span>logs<span class="w"> </span>mybunker
docker<span class="w"> </span>service<span class="w"> </span>logs<span class="w"> </span>myautoconf
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">List pods</p>
<p>To list the pods, you can use the following command :
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>get<span class="w"> </span>pods
</code></pre></div></p>
</div>
<p>You can use the <code>kubectl logs</code> command (replace <code>mybunker</code> and <code>myautoconf</code> with the name of your pods) :
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span>logs<span class="w"> </span>mybunker
kubectl<span class="w"> </span>logs<span class="w"> </span>myautoconf
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>For errors related to BunkerWeb services (e.g., not starting), you can use <code>journalctl</code> :
<div class="highlight"><pre><span></span><code>journalctl<span class="w"> </span>-u<span class="w"> </span>bunkerweb<span class="w"> </span>--no-pager
</code></pre></div></p>
<p>Common logs are located inside the <code>/var/log/bunkerweb</code> directory :
<div class="highlight"><pre><span></span><code>cat<span class="w"> </span>/var/log/bunkerweb/error.log
cat<span class="w"> </span>/var/log/bunkerweb/access.log
</code></pre></div></p>
</div>
</div>
</div>
<h2 id="troubleshooting-permissions">Permissions</h2>
<p>Don't forget that BunkerWeb runs as an unprivileged user for obvious security reasons. Double-check the permissions of files and folders used by BunkerWeb, especially if you use custom configurations (more info <a href="#advanced-custom-configurations">here</a>). You will need to set at least <strong>RW</strong> rights on files and <strong><em>RWX</em></strong> on folders.</p>
<h2 id="troubleshooting-ip-unban">IP unban</h2>
<p>You can manually unban an IP, which is useful when performing tests so that you can contact the internal API of BunkerWeb (replace <code>1.2.3.4</code> with the IP address to unban) :</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:6"><input checked="checked" id="troubleshooting-__tabbed_2_1" name="troubleshooting-__tabbed_2" type="radio" /><input id="troubleshooting-__tabbed_2_2" name="troubleshooting-__tabbed_2" type="radio" /><input id="troubleshooting-__tabbed_2_3" name="troubleshooting-__tabbed_2" type="radio" /><input id="troubleshooting-__tabbed_2_4" name="troubleshooting-__tabbed_2" type="radio" /><input id="troubleshooting-__tabbed_2_5" name="troubleshooting-__tabbed_2" type="radio" /><input id="troubleshooting-__tabbed_2_6" name="troubleshooting-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="troubleshooting-__tabbed_2_1">Docker</label><label for="troubleshooting-__tabbed_2_2">Docker autoconf</label><label for="troubleshooting-__tabbed_2_3">All-in-one</label><label for="troubleshooting-__tabbed_2_4">Swarm</label><label for="troubleshooting-__tabbed_2_5">Kubernetes</label><label for="troubleshooting-__tabbed_2_6">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>You can use the <code>docker exec</code> command (replace <code>mybunker</code> with the name of your container) :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>mybunker<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
<p>Here is the docker-compose equivalent (replace <code>mybunker</code> with the name of the services declared in the docker-compose.yml file) :
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>mybunker<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>You can use the <code>docker exec</code> command (replace <code>myautoconf</code> with the name of your container) :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>myautoconf<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
<p>Here is the docker-compose equivalent (replace <code>myautoconf</code> with the name of the services declared in the docker-compose.yml file) :
<div class="highlight"><pre><span></span><code>docker-compose<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>myautoconf<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition tip">
<p class="admonition-title">Container name</p>
<p>The default container name for the All-in-one image is <code>bunkerweb-aio</code>. If you've used a different name, please adjust the command accordingly.</p>
</div>
<p>You can use the <code>docker exec</code> command:
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>bunkerweb-aio<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#troubleshooting-__tabbed_2_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>You can use the <code>docker exec</code> command (replace <code>myautoconf</code> with the name of your service) :
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span><span class="k">$(</span>docker<span class="w"> </span>ps<span class="w"> </span>-q<span class="w"> </span>-f<span class="w"> </span><span class="nv">name</span><span class="o">=</span>myautoconf<span class="k">)</span><span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>You can use the <code>kubectl exec</code> command (replace <code>myautoconf</code> with the name of your pod) :
<div class="highlight"><pre><span></span><code>kubectl<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>myautoconf<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
<div class="tabbed-block">
<p>You can use the <code>bwcli</code> command (as root) :
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>bwcli<span class="w"> </span>unban<span class="w"> </span><span class="m">1</span>.2.3.4
</code></pre></div></p>
</div>
</div>
</div>
<h2 id="troubleshooting-false-positives">False positives</h2>
<h3 id="troubleshooting-detect-only-mode">Detect only mode</h3>
<p>For debugging/test purposes, you can set BunkerWeb in <a href="http://localhost:8000/advanced/#security-mode">detect only mode</a> so it won't block request and will act as a classical reverse proxy.</p>
<h3 id="troubleshooting-modsecurity">ModSecurity</h3>
<p>The default BunkerWeb configuration of ModSecurity is to load the Core Rule Set in anomaly scoring mode with a paranoia level (PL) of 1 :</p>
<ul>
<li>Each matched rule will increase an anomaly score (so many rules can match a single request)</li>
<li>PL1 includes rules with fewer chances of false positives (but less security than PL4)</li>
<li>the default threshold for anomaly score is 5 for requests and 4 for responses</li>
</ul>
<p>Let's take the following logs as an example of ModSecurity detection using default configuration (formatted for better readability) :</p>
<div class="highlight"><pre><span></span><code>2022/04/26 12:01:10 [warn] 85#85: *11 ModSecurity: Warning. Matched &quot;Operator `PmFromFile&#39; with parameter `lfi-os-files.data&#39; against variable `ARGS:id&#39; (Value: `/etc/passwd&#39; )
    [file &quot;/usr/share/bunkerweb/core/modsecurity/files/coreruleset/rules/REQUEST-930-APPLICATION-ATTACK-LFI.conf&quot;]
    [line &quot;78&quot;]
    [id &quot;930120&quot;]
    [rev &quot;&quot;]
    [msg &quot;OS File Access Attempt&quot;]
    [data &quot;Matched Data: etc/passwd found within ARGS:id: /etc/passwd&quot;]
    [severity &quot;2&quot;]
    [ver &quot;OWASP_CRS/3.3.2&quot;]
    [maturity &quot;0&quot;]
    [accuracy &quot;0&quot;]
    [tag &quot;application-multi&quot;]
    [tag &quot;language-multi&quot;]
    [tag &quot;platform-multi&quot;]
    [tag &quot;attack-lfi&quot;]
    [tag &quot;paranoia-level/1&quot;]
    [tag &quot;OWASP_CRS&quot;]
    [tag &quot;capec/1000/255/153/126&quot;]
    [tag &quot;PCI/6.5.4&quot;]
    [hostname &quot;172.17.0.2&quot;]
    [uri &quot;/&quot;]
    [unique_id &quot;165097447014.179282&quot;]
    [ref &quot;o1,10v9,11t:utf8toUnicode,t:urlDecodeUni,t:normalizePathWin,t:lowercase&quot;],
    client: 172.17.0.1, server: localhost, request: &quot;GET /?id=/etc/passwd HTTP/1.1&quot;, host: &quot;localhost&quot;
2022/04/26 12:01:10 [warn] 85#85: *11 ModSecurity: Warning. Matched &quot;Operator `PmFromFile&#39; with parameter `unix-shell.data&#39; against variable `ARGS:id&#39; (Value: `/etc/passwd&#39; )
    [file &quot;/usr/share/bunkerweb/core/modsecurity/files/coreruleset/rules/REQUEST-932-APPLICATION-ATTACK-RCE.conf&quot;]
    [line &quot;480&quot;]
    [id &quot;932160&quot;]
    [rev &quot;&quot;]
    [msg &quot;Remote Command Execution: Unix Shell Code Found&quot;]
    [data &quot;Matched Data: etc/passwd found within ARGS:id: /etc/passwd&quot;]
    [severity &quot;2&quot;]
    [ver &quot;OWASP_CRS/3.3.2&quot;]
    [maturity &quot;0&quot;]
    [accuracy &quot;0&quot;]
    [tag &quot;application-multi&quot;]
    [tag &quot;language-shell&quot;]
    [tag &quot;platform-unix&quot;]
    [tag &quot;attack-rce&quot;]
    [tag &quot;paranoia-level/1&quot;]
    [tag &quot;OWASP_CRS&quot;]
    [tag &quot;capec/1000/152/248/88&quot;]
    [tag &quot;PCI/6.5.2&quot;]
    [hostname &quot;172.17.0.2&quot;]
    [uri &quot;/&quot;]
    [unique_id &quot;165097447014.179282&quot;]
    [ref &quot;o1,10v9,11t:urlDecodeUni,t:cmdLine,t:normalizePath,t:lowercase&quot;],
    client: 172.17.0.1, server: localhost, request: &quot;GET /?id=/etc/passwd HTTP/1.1&quot;, host: &quot;localhost&quot;
2022/04/26 12:01:10 [error] 85#85: *11 [client 172.17.0.1] ModSecurity: Access denied with code 403 (phase 2). Matched &quot;Operator `Ge&#39; with parameter `5&#39; against variable `TX:ANOMALY_SCORE&#39; (Value: `10&#39; )
    [file &quot;/usr/share/bunkerweb/core/modsecurity/files/coreruleset/rules/REQUEST-949-BLOCKING-EVALUATION.conf&quot;]
    [line &quot;80&quot;]
    [id &quot;949110&quot;]
    [rev &quot;&quot;]
    [msg &quot;Inbound Anomaly Score Exceeded (Total Score: 10)&quot;]
    [data &quot;&quot;]
    [severity &quot;2&quot;]
    [ver &quot;OWASP_CRS/3.3.2&quot;]
    [maturity &quot;0&quot;]
    [accuracy &quot;0&quot;]
    [tag &quot;application-multi&quot;]
    [tag &quot;language-multi&quot;]
    [tag &quot;platform-multi&quot;]
    [tag &quot;attack-generic&quot;]
    [hostname &quot;172.17.0.2&quot;]
    [uri &quot;/&quot;]
    [unique_id &quot;165097447014.179282&quot;]
    [ref &quot;&quot;],
    client: 172.17.0.1, server: localhost, request: &quot;GET /?id=/etc/passwd HTTP/1.1&quot;, host: &quot;localhost&quot;
</code></pre></div>
<p>As we can see, there are 3 different logs :</p>
<ol>
<li>Rule <strong>930120</strong> matched</li>
<li>Rule <strong>932160</strong> matched</li>
<li>Access denied (rule <strong>949110</strong>)</li>
</ol>
<p>One important thing to understand is that rule <strong>949110</strong> is not a "real" one : it's the one that will deny the request because the anomaly threshold is reached (which is <strong>10</strong> in this example). You should never remove the <strong>949110</strong> rule !</p>
<p>If it's a false-positive, you should then focus on both <strong>930120</strong> and <strong>932160</strong> rules. ModSecurity and/or CRS tuning is out of the scope of this documentation but don't forget that you can apply custom configurations before and after the CRS is loaded (more info <a href="#advanced-custom-configurations">here</a>).</p>
<h3 id="troubleshooting-bad-behavior">Bad Behavior</h3>
<p>A common false-positive case is when the client is banned because of the "bad behavior" feature which means that too many suspicious HTTP status codes were generated within a time period (more info <a href="#features-bad-behavior">here</a>). You should start by reviewing the settings and then edit them according to your web application(s) like removing a suspicious HTTP code, decreasing the count time, increasing the threshold, ...</p>
<h3 id="troubleshooting-whitelisting">Whitelisting</h3>
<p>If you have bots (or admins) that need to access your website, the recommended way to avoid any false positive is to whitelist them using the <a href="#features-whitelist">whitelisting feature</a>. We don't recommend using the <code>WHITELIST_URI*</code> or <code>WHITELIST_USER_AGENT*</code> settings unless they are set to secret and unpredictable values. Common use cases are :</p>
<ul>
<li>Healthcheck / status bot</li>
<li>Callback like IPN or webhook</li>
<li>Social media crawler</li>
</ul>
<h2 id="troubleshooting-common-errors">Common errors</h2>
<h3 id="troubleshooting-upstream-sent-too-big-header">Upstream sent too big header</h3>
<p>If you see the following error <code>upstream sent too big header while reading response header from upstream</code> in the logs, you will need to tweak the various proxy buffers size using the following settings :</p>
<ul>
<li><code>PROXY_BUFFERS</code></li>
<li><code>PROXY_BUFFER_SIZE</code></li>
<li><code>PROXY_BUSY_BUFFERS_SIZE</code></li>
</ul>
<h3 id="troubleshooting-could-not-build-server_names_hash">Could not build server_names_hash</h3>
<p>If you see the following error <code>could not build server_names_hash, you should increase server_names_hash_bucket_size</code> in the logs, you will need to tweak the <code>SERVER_NAMES_HASH_BUCKET_SIZE</code> setting.</p>
<h2 id="troubleshooting-timezone">Timezone</h2>
<p>When using container-based integrations, the timezone of the container may not match that of the host machine. To resolve that, you can set the <code>TZ</code> environment variable to the timezone of your choice on your containers (e.g. <code>TZ=Europe/Paris</code>). You will find the list of timezone identifiers <a href="https://en.wikipedia.org/wiki/List_of_tz_database_time_zones#List">here</a>.</p>
<h2 id="troubleshooting-web-ui">Web UI</h2>
<p>In case you forgot your UI credentials or are experiencing 2FA issues, you can connect to the database to regain access.</p>
<p><strong>Access database</strong></p>
<div class="tabbed-set tabbed-alternate" data-tabs="3:2"><input checked="checked" id="troubleshooting-__tabbed_3_1" name="troubleshooting-__tabbed_3" type="radio" /><input id="troubleshooting-__tabbed_3_2" name="troubleshooting-__tabbed_3" type="radio" /><div class="tabbed-labels"><label for="troubleshooting-__tabbed_3_1">SQLite</label><label for="troubleshooting-__tabbed_3_2">MariaDB / MySQL</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<div class="tabbed-set tabbed-alternate" data-tabs="4:3"><input checked="checked" id="troubleshooting-__tabbed_4_1" name="troubleshooting-__tabbed_4" type="radio" /><input id="troubleshooting-__tabbed_4_2" name="troubleshooting-__tabbed_4" type="radio" /><input id="troubleshooting-__tabbed_4_3" name="troubleshooting-__tabbed_4" type="radio" /><div class="tabbed-labels"><label for="troubleshooting-__tabbed_4_1">Linux</label><label for="troubleshooting-__tabbed_4_2">Docker</label><label for="troubleshooting-__tabbed_4_3">All-in-one</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Install SQLite (Debian/Ubuntu):</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>apt<span class="w"> </span>install<span class="w"> </span>sqlite3
</code></pre></div>
<p>Install SQLite (Fedora/RedHat):</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>dnf<span class="w"> </span>install<span class="w"> </span>sqlite
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Get a shell into your scheduler container :</p>
<div class="admonition note">
<p class="admonition-title">Docker arguments</p>
<ul>
<li>the <code>-u 0</code> option is to run the command as root (mandatory)</li>
<li>the <code>-it</code> options are to run the command interactively (mandatory)</li>
<li><code>&lt;bunkerweb_scheduler_container&gt;</code> : the name or ID of your scheduler container</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>&lt;bunkerweb_scheduler_container&gt;<span class="w"> </span>bash
</code></pre></div>
<p>Install SQLite :</p>
<div class="highlight"><pre><span></span><code>apk<span class="w"> </span>add<span class="w"> </span>sqlite
</code></pre></div>
</div>
<div class="tabbed-block">
<p>Get a shell into your All-in-one container:</p>
<div class="admonition note">
<p class="admonition-title">Docker arguments</p>
<ul>
<li>the <code>-u 0</code> option is to run the command as root (mandatory).</li>
<li>the <code>-it</code> options are to run the command interactively (mandatory).</li>
<li><code>bunkerweb-aio</code> is the default container name; adjust if you used a custom name.</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>bunkerweb-aio<span class="w"> </span>bash
</code></pre></div>
</div>
</div>
</div>
<p>Access your database :</p>
<div class="admonition note">
<p class="admonition-title">Database path</p>
<p>We assume that you are using the default database path. If you are using a custom path, you will need to adapt the command.
For All-in-one, we assume the database is <code>db.sqlite3</code> located in the persistent <code>/data</code> volume (<code>/data/db.sqlite3</code>).</p>
</div>
<div class="highlight"><pre><span></span><code>sqlite3<span class="w"> </span>/var/lib/bunkerweb/db.sqlite3
</code></pre></div>
<p>You should see something like this :</p>
<div class="highlight"><pre><span></span><code>SQLite version &lt;VER&gt; &lt;DATE&gt;
Enter &quot;.help&quot; for usage hints.
sqlite&gt;
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition note">
<p class="admonition-title">MariaDB / MySQL only</p>
<p>The following steps are only valid for MariaDB / MySQL databases. If you are using another database, please refer to the documentation of your database.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Credentials and database name</p>
<p>You will need to use the same credentials and database named used in the <code>DATABASE_URI</code> setting.</p>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="5:3"><input checked="checked" id="troubleshooting-__tabbed_5_1" name="troubleshooting-__tabbed_5" type="radio" /><input id="troubleshooting-__tabbed_5_2" name="troubleshooting-__tabbed_5" type="radio" /><input id="troubleshooting-__tabbed_5_3" name="troubleshooting-__tabbed_5" type="radio" /><div class="tabbed-labels"><label for="troubleshooting-__tabbed_5_1">Linux</label><label for="troubleshooting-__tabbed_5_2">Docker</label><label for="troubleshooting-__tabbed_5_3">All-in-one</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Access your local database :</p>
<div class="highlight"><pre><span></span><code>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;user&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database&gt;
</code></pre></div>
<p>Then enter the database user’s password and you should be able to access your database.</p>
</div>
<div class="tabbed-block">
<p>Access your database container :</p>
<div class="admonition note">
<p class="admonition-title">Docker arguments</p>
<ul>
<li>the <code>-u 0</code> option is to run the command as root (mandatory)</li>
<li>the <code>-it</code> options are to run the command interactively (mandatory)</li>
<li><code>&lt;bunkerweb_db_container&gt;</code> : the name or ID of your database container</li>
<li><code>&lt;user&gt;</code> : the database user</li>
<li><code>&lt;database&gt;</code> : the database name</li>
</ul>
</div>
<div class="highlight"><pre><span></span><code>docker<span class="w"> </span><span class="nb">exec</span><span class="w"> </span>-u<span class="w"> </span><span class="m">0</span><span class="w"> </span>-it<span class="w"> </span>&lt;bunkerweb_db_container&gt;<span class="w"> </span>mysql<span class="w"> </span>-u<span class="w"> </span>&lt;user&gt;<span class="w"> </span>-p<span class="w"> </span>&lt;database&gt;
</code></pre></div>
<p>Then enter the database user’s password and you should be able to access your database.</p>
</div>
<div class="tabbed-block">
<p>The All-in-One image does not include a MariaDB/MySQL server. If you have configured the AIO to use an external MariaDB/MySQL database (by setting the <code>DATABASE_URI</code> environment variable), you should connect to that database directly using standard MySQL client tools.</p>
<p>The connection method would be similar to the "Linux" tab (if connecting from the host where AIO runs or another machine) or by running a MySQL client in a separate Docker container if preferred, targeting your external database's host and credentials.</p>
</div>
</div>
</div>
</div>
</div>
</div>
<p><strong>Troubleshooting actions</strong></p>
<div class="admonition info">
<p class="admonition-title">Tables schema</p>
<p>The schema of the <code>bw_ui_users</code> table is the following :</p>
<div class="highlight"><pre><span></span><code><span class="n">username</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="k">PRIMARY</span><span class="w"> </span><span class="k">KEY</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="n">email</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="k">UNIQUE</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span>
<span class="n">password</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">60</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="k">method</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;ui&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;scheduler&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;autoconf&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;manual&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;wizard&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="k">admin</span><span class="w"> </span><span class="nb">BOOLEAN</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="mi">0</span>
<span class="n">theme</span><span class="w"> </span><span class="n">ENUM</span><span class="p">(</span><span class="s1">&#39;light&#39;</span><span class="p">,</span><span class="w"> </span><span class="s1">&#39;dark&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="s1">&#39;light&#39;</span>
<span class="n">totp_secret</span><span class="w"> </span><span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span><span class="w"> </span><span class="k">DEFAULT</span><span class="w"> </span><span class="k">NULL</span>
<span class="n">creation_date</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
<span class="n">update_date</span><span class="w"> </span><span class="n">DATETIME</span><span class="w"> </span><span class="k">NOT</span><span class="w"> </span><span class="k">NULL</span>
</code></pre></div>
</div>
<div class="tabbed-set tabbed-alternate" data-tabs="6:4"><input checked="checked" id="troubleshooting-__tabbed_6_1" name="troubleshooting-__tabbed_6" type="radio" /><input id="troubleshooting-__tabbed_6_2" name="troubleshooting-__tabbed_6" type="radio" /><input id="troubleshooting-__tabbed_6_3" name="troubleshooting-__tabbed_6" type="radio" /><input id="troubleshooting-__tabbed_6_4" name="troubleshooting-__tabbed_6" type="radio" /><div class="tabbed-labels"><label for="troubleshooting-__tabbed_6_1">Retrieve username</label><label for="troubleshooting-__tabbed_6_2">Update admin user password</label><label for="troubleshooting-__tabbed_6_3">Disable 2FA authentication for admin user</label><label for="troubleshooting-__tabbed_6_4">Refresh 2FA recovery codes</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>Execute the following command to extract data from the <code>bw_ui_users</code> table :</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="p">;</span>
</code></pre></div>
<p>You should see something like this :</p>
<table>
<thead>
<tr>
<th>username</th>
<th>email</th>
<th>password</th>
<th>method</th>
<th>admin</th>
<th>theme</th>
<th>totp_secret</th>
<th>creation_date</th>
<th>update_date</th>
</tr>
</thead>
<tbody>
<tr>
<td>***</td>
<td>***</td>
<td>***</td>
<td>manual</td>
<td>1</td>
<td>light</td>
<td>***</td>
<td>***</td>
<td>***</td>
</tr>
</tbody>
</table>
</div>
<div class="tabbed-block">
<p>You first need to hash the new password using the bcrypt algorithm.</p>
<p>Install the Python bcrypt library :</p>
<div class="highlight"><pre><span></span><code>pip<span class="w"> </span>install<span class="w"> </span>bcrypt
</code></pre></div>
<p>Generate your hash (replace <code>mypassword</code> with your own password) :</p>
<div class="highlight"><pre><span></span><code>python3<span class="w"> </span>-c<span class="w"> </span><span class="s1">&#39;from bcrypt import hashpw, gensalt ; print(hashpw(b&quot;&quot;&quot;mypassword&quot;&quot;&quot;, gensalt(rounds=10)).decode(&quot;utf-8&quot;))&#39;</span>
</code></pre></div>
<p>You can update your username / password executing this command :</p>
<div class="highlight"><pre><span></span><code><span class="k">UPDATE</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">password</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;&lt;password_hash&gt;&#39;</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>If you check again your <code>bw_ui_users</code> table following this command :</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>You should see something like this :</p>
<table>
<thead>
<tr>
<th>username</th>
<th>email</th>
<th>password</th>
<th>method</th>
<th>admin</th>
<th>theme</th>
<th>totp_secret</th>
<th>creation_date</th>
<th>update_date</th>
</tr>
</thead>
<tbody>
<tr>
<td>***</td>
<td>***</td>
<td>***</td>
<td>manual</td>
<td>1</td>
<td>light</td>
<td>***</td>
<td>***</td>
<td>***</td>
</tr>
</tbody>
</table>
<p>You should now be able to use the new credentials to log into the web UI.</p>
</div>
<div class="tabbed-block">
<p>You can deactivate 2FA by executing this command :</p>
<div class="highlight"><pre><span></span><code><span class="k">UPDATE</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">totp_secret</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">NULL</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>If you check again your <code>bw_ui_users</code> table by following this command :</p>
<div class="highlight"><pre><span></span><code><span class="k">SELECT</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">bw_ui_users</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="k">admin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>
</code></pre></div>
<p>You should see something like this :</p>
<table>
<thead>
<tr>
<th>username</th>
<th>email</th>
<th>password</th>
<th>method</th>
<th>admin</th>
<th>theme</th>
<th>totp_secret</th>
<th>creation_date</th>
<th>update_date</th>
</tr>
</thead>
<tbody>
<tr>
<td>***</td>
<td>***</td>
<td>***</td>
<td>manual</td>
<td>1</td>
<td>light</td>
<td>NULL</td>
<td>***</td>
<td>***</td>
</tr>
</tbody>
</table>
<p>You should now be able to log into the web UI only using your username and password without 2FA.</p>
</div>
<div class="tabbed-block">
<p>The recovery codes can be refreshed in your <strong>profile page</strong> of the web UI under the <code>Security</code> tab.</p>
</div>
</div>
</div>
<p><strong>Upload plugin</strong></p>
<p>It may not be possible to upload a plugin from the UI in certain situations:</p>
<ul>
<li>Missing package to manage compressed files on your integration, in which case you will need to add the necessary packages</li>
<li>Safari browser : the 'safe mode' may prevent you from being able to add a plugin. You will need to make the necessary changes on your machine</li>
</ul></section><section class="print-page" id="plugins" heading-number="10"><h1 id="plugins-plugins">Plugins</h1>
<p>BunkerWeb comes with a plugin system making it possible to easily add new features. Once a plugin is installed, you can manage it using additional settings defined by the plugin.</p>
<h2 id="plugins-official-plugins">Official plugins</h2>
<p>Here is the list of "official" plugins that we maintain (see the <a href="https://github.com/bunkerity/bunkerweb-plugins">bunkerweb-plugins</a> repository for more information) :</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Name</th>
<th style="text-align: center;">Version</th>
<th style="text-align: left;">Description</th>
<th style="text-align: center;">Link</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><strong>ClamAV</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Automatically scans uploaded files with the ClamAV antivirus engine and denies the request when a file is detected as malicious.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/clamav">bunkerweb-plugins/clamav</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>Coraza</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Inspect requests using the Coraza WAF (alternative of ModSecurity).</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/coraza">bunkerweb-plugins/coraza</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>Discord</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Send security notifications to a Discord channel using a Webhook.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/discord">bunkerweb-plugins/discord</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>Slack</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Send security notifications to a Slack channel using a Webhook.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/slack">bunkerweb-plugins/slack</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>VirusTotal</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Automatically scans uploaded files with the VirusTotal API and denies the request when a file is detected as malicious.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/virustotal">bunkerweb-plugins/virustotal</a></td>
</tr>
<tr>
<td style="text-align: center;"><strong>WebHook</strong></td>
<td style="text-align: center;">1.9</td>
<td style="text-align: left;">Send security notifications to a custom HTTP endpoint using a  Webhook.</td>
<td style="text-align: center;"><a href="https://github.com/bunkerity/bunkerweb-plugins/tree/main/webhook">bunkerweb-plugins/webhook</a></td>
</tr>
</tbody>
</table>
<h2 id="plugins-how-to-use-a-plugin">How to use a plugin</h2>
<h3 id="plugins-automatic">Automatic</h3>
<p>If you want to quickly install external plugins, you can use the <code>EXTERNAL_PLUGIN_URLS</code> setting. It takes a list of URLs separated by spaces, each pointing to a compressed (zip format) archive containing one or more plugins.</p>
<p>You can use the following value if you want to automatically install the official plugins : <code>EXTERNAL_PLUGIN_URLS=https://github.com/bunkerity/bunkerweb-plugins/archive/refs/tags/v1.9.zip</code></p>
<h3 id="plugins-manual">Manual</h3>
<p>The first step is to install the plugin by placing its files inside the corresponding <code>plugins</code> data folder. The procedure depends on your integration :</p>
<div class="tabbed-set tabbed-alternate" data-tabs="1:5"><input checked="checked" id="plugins-__tabbed_1_1" name="plugins-__tabbed_1" type="radio" /><input id="plugins-__tabbed_1_2" name="plugins-__tabbed_1" type="radio" /><input id="plugins-__tabbed_1_3" name="plugins-__tabbed_1" type="radio" /><input id="plugins-__tabbed_1_4" name="plugins-__tabbed_1" type="radio" /><input id="plugins-__tabbed_1_5" name="plugins-__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="plugins-__tabbed_1_1">Docker</label><label for="plugins-__tabbed_1_2">Docker autoconf</label><label for="plugins-__tabbed_1_3">Swarm</label><label for="plugins-__tabbed_1_4">Kubernetes</label><label for="plugins-__tabbed_1_5">Linux</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>When using the <a href="#integrations-docker">Docker integration</a>, plugins must be placed in the volume mounted on <code>/data/plugins</code> in the scheduler container.</p>
<p>The first thing to do is to create the plugins folder :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<p>Then, you can drop the plugins of your choice into that folder :</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Using local folder for persistent data</p>
<p>The scheduler runs as an <strong>unprivileged user with UID 101 and GID 101</strong> inside the container. The reason behind this is security : in case a vulnerability is exploited, the attacker won't have full root (UID/GID 0) privileges.
But there is a downside : if you use a <strong>local folder for the persistent data</strong>, you will need to <strong>set the correct permissions</strong> so the unprivileged user can write data to it. Something like that should do the trick :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Alternatively, if the folder already exists :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span>root:101<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>If you are using <a href="https://docs.docker.com/engine/security/rootless">Docker in rootless mode</a> or <a href="https://podman.io/">podman</a>, UIDs and GIDs in the container will be mapped to different ones in the host. You will first need to check your initial subuid and subgid :</p>
<div class="highlight"><pre><span></span><code>grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subuid<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
grep<span class="w"> </span>^<span class="k">$(</span>whoami<span class="k">)</span>:<span class="w"> </span>/etc/subgid
</code></pre></div>
<p>For example, if you have a value of <strong>100000</strong>, the mapped UID/GID will be <strong>100100</strong> (100000 + 100) :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
sudo<span class="w"> </span>chgrp<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
<p>Or if the folder already exists :</p>
<div class="highlight"><pre><span></span><code>sudo<span class="w"> </span>chgrp<span class="w"> </span>-R<span class="w"> </span><span class="m">100100</span><span class="w"> </span>bw-data<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chmod<span class="w"> </span>-R<span class="w"> </span><span class="m">770</span><span class="w"> </span>bw-data
</code></pre></div>
</div>
<p>Then you can mount the volume when starting your Docker stack :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-docker-autoconf">Docker autoconf integration</a>, plugins must be placed in the volume mounted on <code>/data/plugins</code> in the scheduler container.</p>
<p>The first thing to do is to create the plugins folder :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<p>Then, you can drop the plugins of your choice into that folder :</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>./bw-data/plugins
</code></pre></div>
<p>Because the scheduler runs as an unprivileged user with UID and GID 101, you will need to edit the permissions :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">101</span>:101<span class="w"> </span>./bw-data
</code></pre></div>
<p>Then you can mount the volume when starting your Docker stack :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">./bw-data:/data</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<div class="admonition warning">
<p class="admonition-title">Deprecated</p>
<p>The Swarm integration is deprecated and will be removed in a future release. Please consider using the <a href="#plugins-__tabbed_1_2">Docker autoconf integration</a> instead.</p>
<p><strong>More information can be found in the <a href="#integrations-swarm">Swarm integration documentation</a>.</strong></p>
</div>
<p>When using the <a href="#integrations-swarm">Swarm integration</a>, plugins must be placed in the volume mounted on <code>/data/plugins</code> in the scheduler container.</p>
<div class="admonition info">
<p class="admonition-title">Swarm volume</p>
<p>Configuring a Swarm volume that will persist when the scheduler service is running on different nodes is not covered is in this documentation. We will assume that you have a shared folder mounted on <code>/shared</code> across all nodes.</p>
</div>
<p>The first thing to do is to create the plugins folder :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>-p<span class="w"> </span>/shared/bw-plugins
</code></pre></div>
<p>Then, you can drop the plugins of your choice into that folder :</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>/shared/bw-plugins
</code></pre></div>
<p>Because the scheduler runs as an unprivileged user with UID and GID 101, you will need to edit the permissions :</p>
<div class="highlight"><pre><span></span><code>chown<span class="w"> </span>-R<span class="w"> </span><span class="m">101</span>:101<span class="w"> </span>/shared/bw-plugins
</code></pre></div>
<p>Then you can mount the volume when starting your Swarm stack :</p>
<div class="highlight"><pre><span></span><code><span class="nt">services</span><span class="p">:</span>
<span class="nn">...</span>
<span class="w">  </span><span class="nt">bw-scheduler</span><span class="p">:</span>
<span class="w">    </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">    </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">      </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">/shared/bw-plugins:/data/plugins</span>
<span class="nn">...</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-kubernetes">Kubernetes integration</a>, plugins must be placed in the volume mounted on <code>/data/plugins</code> in the scheduler container.</p>
<p>The first thing to do is to declare a <a href="https://kubernetes.io/docs/concepts/storage/persistent-volumes/">PersistentVolumeClaim</a> that will contain our plugins data :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">PersistentVolumeClaim</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pvc-bunkerweb-plugins</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">accessModes</span><span class="p">:</span>
<span class="w">    </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">ReadWriteOnce</span>
<span class="nt">resources</span><span class="p">:</span>
<span class="w">  </span><span class="nt">requests</span><span class="p">:</span>
<span class="w">    </span><span class="nt">storage</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">5Gi</span>
</code></pre></div>
<p>You can now add the volume mount and an init container to automatically provision the volume :</p>
<div class="highlight"><pre><span></span><code><span class="nt">apiVersion</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">apps/v1</span>
<span class="nt">kind</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Deployment</span>
<span class="nt">metadata</span><span class="p">:</span>
<span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="nt">spec</span><span class="p">:</span>
<span class="w">  </span><span class="nt">replicas</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1</span>
<span class="w">  </span><span class="nt">strategy</span><span class="p">:</span>
<span class="w">    </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Recreate</span>
<span class="w">  </span><span class="nt">selector</span><span class="p">:</span>
<span class="w">    </span><span class="nt">matchLabels</span><span class="p">:</span>
<span class="w">      </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="w">  </span><span class="nt">template</span><span class="p">:</span>
<span class="w">    </span><span class="nt">metadata</span><span class="p">:</span>
<span class="w">      </span><span class="nt">labels</span><span class="p">:</span>
<span class="w">        </span><span class="nt">app</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="w">    </span><span class="nt">spec</span><span class="p">:</span>
<span class="w">      </span><span class="nt">serviceAccountName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">sa-bunkerweb</span>
<span class="w">      </span><span class="nt">containers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerity/bunkerweb-scheduler:1.6.2</span>
<span class="w">          </span><span class="nt">imagePullPolicy</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">Always</span>
<span class="w">          </span><span class="nt">env</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">KUBERNETES_MODE</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;yes&quot;</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;DATABASE_URI&quot;</span>
<span class="w">              </span><span class="nt">value</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;mariadb+pymysql://bunkerweb:changeme@svc-bunkerweb-db:3306/db&quot;</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/data/plugins&quot;</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vol-plugins</span>
<span class="w">      </span><span class="nt">initContainers</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">bunkerweb-scheduler-init</span>
<span class="w">          </span><span class="nt">image</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">alpine/git</span>
<span class="w">          </span><span class="nt">command</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;/bin/sh&quot;</span><span class="p p-Indicator">,</span><span class="w"> </span><span class="s">&quot;-c&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">args</span><span class="p">:</span><span class="w"> </span><span class="p p-Indicator">[</span><span class="s">&quot;git</span><span class="nv"> </span><span class="s">clone</span><span class="nv"> </span><span class="s">https://github.com/bunkerity/bunkerweb-plugins</span><span class="nv"> </span><span class="s">/data/plugins</span><span class="nv"> </span><span class="s">&amp;&amp;</span><span class="nv"> </span><span class="s">chown</span><span class="nv"> </span><span class="s">-R</span><span class="nv"> </span><span class="s">101:101</span><span class="nv"> </span><span class="s">/data/plugins&quot;</span><span class="p p-Indicator">]</span>
<span class="w">          </span><span class="nt">volumeMounts</span><span class="p">:</span>
<span class="w">            </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">mountPath</span><span class="p">:</span><span class="w"> </span><span class="s">&quot;/data/plugins&quot;</span>
<span class="w">              </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vol-plugins</span>
<span class="w">      </span><span class="nt">volumes</span><span class="p">:</span>
<span class="w">        </span><span class="p p-Indicator">-</span><span class="w"> </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">vol-plugins</span>
<span class="w">          </span><span class="nt">persistentVolumeClaim</span><span class="p">:</span>
<span class="w">            </span><span class="nt">claimName</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">pvc-bunkerweb-plugins</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>When using the <a href="#integrations-linux">Linux integration</a>, plugins must be written to the <code>/etc/bunkerweb/plugins</code> folder :</p>
<div class="highlight"><pre><span></span><code>git<span class="w"> </span>clone<span class="w"> </span>https://github.com/bunkerity/bunkerweb-plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
cp<span class="w"> </span>-rp<span class="w"> </span>./bunkerweb-plugins/*<span class="w"> </span>/etc/bunkerweb/plugins<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
chown<span class="w"> </span>-R<span class="w"> </span>nginx:nginx<span class="w"> </span>/etc/bunkerweb/plugins
</code></pre></div>
</div>
</div>
</div>
<h2 id="plugins-writing-a-plugin">Writing a plugin</h2>
<h3 id="plugins-structure">Structure</h3>
<div class="admonition tip">
<p class="admonition-title">Existing plugins</p>
<p>If the documentation is not enough, you can have a look at the existing source code of <a href="https://github.com/bunkerity/bunkerweb-plugins">official plugins</a> and the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/src/common/core">core plugins</a> (already included in BunkerWeb but they are plugins, technically speaking).</p>
</div>
<p>What a plugin structure looks like:
<div class="highlight"><pre><span></span><code>plugin /
    confs / conf_type / conf_name.conf
    ui / actions.py
         hooks.py
         template.html
         blueprints / &lt;blueprint_file(s)&gt;
              templates / &lt;blueprint_template(s)&gt;
    jobs / my-job.py
    templates / my-template.json
          my-template / configs / conf_type / conf_name.conf
    plugin.lua
    plugin.json
</code></pre></div></p>
<ul>
<li>
<p><strong>conf_name.conf</strong> : Add <a href="#advanced-custom-configurations">custom NGINX configurations</a> (as Jinja2 templates).</p>
</li>
<li>
<p><strong>actions.py</strong> : Script to execute on the Flask server. This script runs in a Flask context, giving you access to libraries and utilities like <code>jinja2</code> and <code>requests</code>.</p>
</li>
<li>
<p><strong>hooks.py</strong> : Custom Python file that contains flask's hooks and will be executed when the plugin is loaded.</p>
</li>
<li>
<p><strong>template.html</strong> : Custom plugin page accessed via the UI.</p>
</li>
<li>
<p><strong>blueprints folder (within ui)</strong>:
  This folder is used to override existing Flask blueprints or create new ones. Inside, you can include blueprint files and an optional <strong>templates</strong> subfolder for blueprint-specific templates.</p>
</li>
<li>
<p><strong>jobs py file</strong> : Custom Python files executed as jobs by the scheduler.</p>
</li>
<li>
<p><strong>my-template.json</strong> : Add <a href="#concepts-templates">custom templates</a> to override the default values of settings and apply custom configurations easily.</p>
</li>
<li>
<p><strong>plugin.lua</strong> : Code executed on NGINX using the <a href="https://github.com/openresty/lua-nginx-module">NGINX LUA module</a>.</p>
</li>
<li>
<p><strong>plugin.json</strong> : Metadata, settings, and job definitions for your plugin.</p>
</li>
</ul>
<h3 id="plugins-getting-started">Getting started</h3>
<p>The first step is to create a folder that will contain the plugin :</p>
<div class="highlight"><pre><span></span><code>mkdir<span class="w"> </span>myplugin<span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="se">\</span>
<span class="nb">cd</span><span class="w"> </span>myplugin
</code></pre></div>
<h3 id="plugins-metadata">Metadata</h3>
<p>A file named <strong>plugin.json</strong> and written at the root of the plugin folder must contain metadata about the plugin. Here is an example :</p>
<div class="highlight"><pre><span></span><code><span class="p">{</span>
<span class="w">  </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;myplugin&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;My Plugin&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Just an example plugin.&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;version&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1.0&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;stream&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;partial&quot;</span><span class="p">,</span>
<span class="w">  </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;DUMMY_SETTING&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;context&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;multisite&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;default&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1234&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;help&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Here is the help of the setting.&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;dummy-id&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;label&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Dummy setting&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;regex&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;^.*$&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">},</span>
<span class="w">  </span><span class="nt">&quot;jobs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
<span class="w">    </span><span class="p">{</span>
<span class="w">      </span><span class="nt">&quot;name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-job&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;file&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;my-job.py&quot;</span><span class="p">,</span>
<span class="w">      </span><span class="nt">&quot;every&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;hour&quot;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">  </span><span class="p">]</span>
<span class="p">}</span>
</code></pre></div>
<p>Here are the details of the fields :</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Field</th>
<th style="text-align: center;">Mandatory</th>
<th style="text-align: center;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>id</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Internal ID for the plugin : must be unique among other plugins (including "core" ones) and contain only lowercase chars.</td>
</tr>
<tr>
<td style="text-align: center;"><code>name</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Name of your plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>description</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Description of your plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>version</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Version of your plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>stream</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Information about stream support : <code>no</code>, <code>yes</code> or <code>partial</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>settings</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">dict</td>
<td style="text-align: left;">List of the settings of your plugin.</td>
</tr>
<tr>
<td style="text-align: center;"><code>jobs</code></td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">list</td>
<td style="text-align: left;">List of the jobs of your plugin.</td>
</tr>
</tbody>
</table>
<p>Each setting has the following fields (the key is the ID of the settings used in a configuration) :</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Field</th>
<th style="text-align: center;">Mandatory</th>
<th style="text-align: center;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>context</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Context of the setting : <code>multisite</code> or <code>global</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>default</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">The default value of the setting.</td>
</tr>
<tr>
<td style="text-align: center;"><code>help</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Help text about the plugin (shown in web UI).</td>
</tr>
<tr>
<td style="text-align: center;"><code>id</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Internal ID used by the web UI for HTML elements.</td>
</tr>
<tr>
<td style="text-align: center;"><code>label</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Label shown by the web UI.</td>
</tr>
<tr>
<td style="text-align: center;"><code>regex</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">The regex used to validate the value provided by the user.</td>
</tr>
<tr>
<td style="text-align: center;"><code>type</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">The type of the field : <code>text</code>, <code>check</code>, <code>select</code> or <code>password</code>.</td>
</tr>
<tr>
<td style="text-align: center;"><code>multiple</code></td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Unique ID to group multiple settings with numbers as suffix.</td>
</tr>
<tr>
<td style="text-align: center;"><code>select</code></td>
<td style="text-align: center;">no</td>
<td style="text-align: center;">list</td>
<td style="text-align: left;">List of possible string values when <code>type</code> is <code>select</code>.</td>
</tr>
</tbody>
</table>
<p>Each job has the following fields :</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Field</th>
<th style="text-align: center;">Mandatory</th>
<th style="text-align: center;">Type</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>name</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Name of the job.</td>
</tr>
<tr>
<td style="text-align: center;"><code>file</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Name of the file inside the jobs folder.</td>
</tr>
<tr>
<td style="text-align: center;"><code>every</code></td>
<td style="text-align: center;">yes</td>
<td style="text-align: center;">string</td>
<td style="text-align: left;">Job scheduling frequency : <code>minute</code>, <code>hour</code>, <code>day</code>, <code>week</code> or <code>once</code> (no frequency, only once before (re)generating the configuration).</td>
</tr>
</tbody>
</table>
<h3 id="plugins-configurations">Configurations</h3>
<p>You can add custom NGINX configurations by adding a folder named <strong>confs</strong> with content similar to the <a href="#advanced-custom-configurations">custom configurations</a>. Each subfolder inside the <strong>confs</strong> will contain <a href="https://jinja.palletsprojects.com">jinja2</a> templates that will be generated and loaded at the corresponding context (<code>http</code>, <code>server-http</code>, <code>default-server-http</code>, <code>stream</code>, <code>server-stream</code>, <code>modsec</code>, <code>modsec-crs</code>, <code>crs-plugins-before</code> and <code>crs-plugins-after</code>).</p>
<p>Here is an example for a configuration template file inside the <strong>confs/server-http</strong> folder named <strong>example.conf</strong> :</p>
<div class="highlight"><pre><span></span><code>location /setting {
    default_type &#39;text/plain&#39;;
    content_by_lua_block {
        ngx.say(&#39;{{ DUMMY_SETTING }}&#39;)
    }
}
</code></pre></div>
<p><code>{{ DUMMY_SETTING }}</code> will be replaced by the value of the <code>DUMMY_SETTING</code> chosen by the user of the plugin.</p>
<h3 id="plugins-templates">Templates</h3>
<p>Check the <a href="#concepts-templates">templates documentation</a> for more information.</p>
<h3 id="plugins-lua">LUA</h3>
<h4 id="plugins-main-script">Main script</h4>
<p>Under the hood, BunkerWeb is using the <a href="https://github.com/openresty/lua-nginx-module">NGINX LUA module</a> to execute code within NGINX. Plugins that need to execute code must provide a lua file at the root directory of the plugin folder using the <code>id</code> value of <strong>plugin.json</strong> as its name. Here is an example named <strong>myplugin.lua</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">class</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;middleclass&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">plugin</span><span class="w">    </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.plugin&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">utils</span><span class="w">     </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.utils&quot;</span>


<span class="kd">local</span><span class="w"> </span><span class="nv">myplugin</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nf">class</span><span class="p">(</span><span class="s2">&quot;myplugin&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">plugin</span><span class="p">)</span>


<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">initialize</span><span class="p">(</span><span class="nv">ctx</span><span class="p">)</span>
<span class="w">    </span><span class="nv">plugin</span><span class="p">.</span><span class="nf">initialize</span><span class="p">(</span><span class="nv">self</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;myplugin&quot;</span><span class="p">,</span><span class="w"> </span><span class="nv">ctx</span><span class="p">)</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">dummy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s2">&quot;dummy&quot;</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">init</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;init called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">set</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;set called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">access</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;access called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">log</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;log called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">log_default</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;log_default called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">preread</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;preread called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">function</span><span class="w"> </span><span class="nc">myplugin</span><span class="p">:</span><span class="nf">log_stream</span><span class="p">()</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;log_stream called&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="nv">self</span><span class="p">:</span><span class="nf">ret</span><span class="p">(</span><span class="kc">true</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;success&quot;</span><span class="p">)</span>
<span class="kr">end</span>

<span class="kr">return</span><span class="w"> </span><span class="nv">myplugin</span>
</code></pre></div>
<p>The declared functions are automatically called during specific contexts. Here are the details of each function :</p>
<table>
<thead>
<tr>
<th style="text-align: center;">Function</th>
<th style="text-align: center;">Context</th>
<th style="text-align: left;">Description</th>
<th style="text-align: left;">Return value</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align: center;"><code>init</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#init_by_lua">init_by_lua</a></td>
<td style="text-align: left;">Called when NGINX just started or received a reload order. the typical use case is to prepare any data that will be used by your plugin.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (boolean) : true if no error or else false</li><li><code>msg</code> (string) : success or error message</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>set</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#set_by_lua">set_by_lua</a></td>
<td style="text-align: left;">Called before each request received by the server.The typical use case is for computing before access phase.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (boolean) : true if no error or else false</li><li><code>msg</code> (string) : success or error message</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>access</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#access_by_lua">access_by_lua</a></td>
<td style="text-align: left;">Called on each request received by the server. The typical use case is to do the security checks here and deny the request if needed.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code>,<code>status</code>,<code>redirect</code><ul><li><code>ret</code> (boolean) : true if no error or else false</li><li><code>msg</code> (string) : success or error message</li><li><code>status</code> (number) : interrupt current process and return <a href="https://github.com/openresty/lua-nginx-module#http-status-constants">HTTP status</a></li><li><code>redirect</code> (URL) : if set will redirect to given URL</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>log</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#log_by_lua">log_by_lua</a></td>
<td style="text-align: left;">Called when a request has finished (and before it gets logged to the access logs). The typical use case is to make stats or compute counters for example.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (boolean) : true if no error or else false</li><li><code>msg</code> (string) : success or error message</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>log_default</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/lua-nginx-module#log_by_lua">log_by_lua</a></td>
<td style="text-align: left;">Same as <code>log</code> but only called on the default server.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (boolean) : true if no error or else false</li><li><code>msg</code> (string) : success or error message</li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>preread</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/stream-lua-nginx-module#preread_by_lua_block">preread_by_lua</a></td>
<td style="text-align: left;">Similar to the <code>access</code> function but for stream mode.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code>,<code>status</code><ul><li><code>ret</code> (boolean) : true if no error or else false</li><li><code>msg</code> (string) : success or error message</li><li><code>status</code> (number) : interrupt current process and return <a href="https://github.com/openresty/lua-nginx-module#http-status-constants">status</a></li></ul></td>
</tr>
<tr>
<td style="text-align: center;"><code>log_stream</code></td>
<td style="text-align: center;"><a href="https://github.com/openresty/stream-lua-nginx-module#log_by_lua_block">log_by_lua</a></td>
<td style="text-align: left;">Similar to the <code>log</code> function but for stream mode.</td>
<td style="text-align: left;"><code>ret</code>, <code>msg</code><ul><li><code>ret</code> (boolean) : true if no error or else false</li><li><code>msg</code> (string) : success or error message</li></ul></td>
</tr>
</tbody>
</table>
<h4 id="plugins-libraries">Libraries</h4>
<p>All directives from <a href="https://github.com/openresty/lua-nginx-module">NGINX LUA module</a> and are available and <a href="https://github.com/openresty/stream-lua-nginx-module">NGINX stream LUA module</a>. On top of that, you can use the LUA libraries included within BunkerWeb : see <a href="https://github.com/bunkerity/bunkerweb/blobsrc/deps/clone.sh">this script</a> for the complete list.</p>
<p>If you need additional libraries, you can put them in the root folder of the plugin and access them by prefixing them with your plugin ID. Here is an example file named <strong>mylibrary.lua</strong> :</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">_M</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{}</span>

<span class="nv">_M</span><span class="p">.</span><span class="py">dummy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kr">function</span><span class="w"> </span><span class="p">()</span>
<span class="w">    </span><span class="kr">return</span><span class="w"> </span><span class="s2">&quot;dummy&quot;</span>
<span class="kr">end</span>

<span class="kr">return</span><span class="w"> </span><span class="nv">_M</span>
</code></pre></div>
<p>And here is how you can use it from the <strong>myplugin.lua</strong> file :</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">mylibrary</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;myplugin.mylibrary&quot;</span>

<span class="p">...</span>

<span class="nv">mylibrary</span><span class="p">.</span><span class="nf">dummy</span><span class="p">()</span>

<span class="p">...</span>
</code></pre></div>
<h4 id="plugins-helpers">Helpers</h4>
<p>Some helpers modules provide common helpful helpers :</p>
<ul>
<li><code>self.variables</code> : allows to access and store plugins' attributes</li>
<li><code>self.logger</code> : print logs</li>
<li><code>bunkerweb.utils</code> : various useful functions</li>
<li><code>bunkerweb.datastore</code> : access the global shared data on one instance (key/value store)</li>
<li><code>bunkerweb.clusterstore</code> : access a Redis data store shared between BunkerWeb instances (key/value store)</li>
</ul>
<p>To access the functions, you first need to <strong>require</strong> the modules :</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">utils</span><span class="w">       </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.utils&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">datastore</span><span class="w">   </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.datastore&quot;</span>
<span class="kd">local</span><span class="w"> </span><span class="nv">clustestore</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nb">require</span><span class="w"> </span><span class="s2">&quot;bunkerweb.clustertore&quot;</span>
</code></pre></div>
<p>Retrieve a setting value :</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">myvar</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">variables</span><span class="p">[</span><span class="s2">&quot;DUMMY_SETTING&quot;</span><span class="p">]</span>
<span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">myvar</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ERR</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;can&#39;t retrieve setting DUMMY_SETTING&quot;</span><span class="p">)</span>
<span class="kr">else</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;DUMMY_SETTING = &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">value</span><span class="p">)</span>
<span class="kr">end</span>
</code></pre></div>
<p>Store something in the local cache :</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">ok</span><span class="p">,</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">self</span><span class="p">.</span><span class="py">datastore</span><span class="p">:</span><span class="nf">set</span><span class="p">(</span><span class="s2">&quot;plugin_myplugin_something&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;somevalue&quot;</span><span class="p">)</span>
<span class="kr">if</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">ok</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ERR</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;can&#39;t save plugin_myplugin_something into datastore : &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">err</span><span class="p">)</span>
<span class="kr">else</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;successfully saved plugin_myplugin_something into datastore&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</code></pre></div>
<p>Check if an IP address is global :</p>
<div class="highlight"><pre><span></span><code><span class="kd">local</span><span class="w"> </span><span class="nv">ret</span><span class="p">,</span><span class="w"> </span><span class="nv">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="nv">utils</span><span class="p">.</span><span class="nf">ip_is_global</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="p">)</span>
<span class="kr">if</span><span class="w"> </span><span class="nv">ret</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">nil</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">ERR</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;error while checking if IP &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot; is global or not : &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">err</span><span class="p">)</span>
<span class="kr">elseif</span><span class="w"> </span><span class="ow">not</span><span class="w"> </span><span class="nv">ret</span><span class="w"> </span><span class="kr">then</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;IP &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot; is not global&quot;</span><span class="p">)</span>
<span class="kr">else</span>
<span class="w">    </span><span class="nv">self</span><span class="p">.</span><span class="py">logger</span><span class="p">:</span><span class="nf">log</span><span class="p">(</span><span class="nv">ngx</span><span class="p">.</span><span class="py">NOTICE</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;IP &quot;</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="nv">ngx</span><span class="p">.</span><span class="py">ctx</span><span class="p">.</span><span class="py">bw</span><span class="p">.</span><span class="py">remote_addr</span><span class="w"> </span><span class="o">..</span><span class="w"> </span><span class="s2">&quot; is global&quot;</span><span class="p">)</span>
<span class="kr">end</span>
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">More examples</p>
<p>If you want to see the full list of available functions, you can have a look at the files present in the <a href="https://github.com/bunkerity/bunkerweb/tree/v1.6.2/src/bw/lua/bunkerweb">lua directory</a> of the repository.</p>
</div>
<h3 id="plugins-jobs">Jobs</h3>
<p>BunkerWeb uses an internal job scheduler for periodic tasks like renewing certificates with certbot, downloading blacklists, downloading MMDB files, ... You can add tasks of your choice by putting them inside a subfolder named <strong>jobs</strong> and listing them in the <strong>plugin.json</strong> metadata file. Don't forget to add the execution permissions for everyone to avoid any problems when a user is cloning and installing your plugin.</p>
<h3 id="plugins-plugin-page">Plugin page</h3>
<p>Everything related to the web UI is located inside the subfolder <strong>ui</strong> as we seen in the <a href="#plugins-structure">previous structure section.</a>.</p>
<h4 id="plugins-prerequisites">Prerequisites</h4>
<p>When you want to create a plugin page, you need two files :</p>
<ul>
<li>
<p><strong>template.html</strong> that will be accessible with a <strong>GET /plugins/&lt;<em>plugin_id</em>&gt;</strong>.</p>
</li>
<li>
<p><strong>actions.py</strong> where you can add some scripting and logic with a <strong>POST /plugins/&lt;<em>plugin_id</em>&gt;</strong>. Notice that this file <strong>need a function with the same name as the plugin</strong> to work. This file is needed even if the function is empty.</p>
</li>
</ul>
<h4 id="plugins-basic-example">Basic example</h4>
<div class="admonition info">
<p class="admonition-title">Jinja 2 template</p>
<p>The <strong>template.html</strong> file is a Jinja2 template, please refer to the <a href="https://jinja.palletsprojects.com">Jinja2 documentation</a> if needed.</p>
</div>
<p>We can put aside the <strong>actions.py</strong> file and start <strong>only using the template on a GET situation</strong>. The template can access app context and libs, so you can use Jinja, request or flask utils.</p>
<p>For example, you can get the request arguments in your template like this :</p>
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">p</span><span class="p">&gt;</span>request args : {{ request.args.get() }}.<span class="p">&lt;/</span><span class="nt">p</span><span class="p">&gt;</span>
</code></pre></div>
<h4 id="plugins-actionspy">Actions.py</h4>
<div class="admonition warning">
<p class="admonition-title">CSRF Token</p>
<p>Please note that every form submission is protected via a CSRF token, you will need to include the following snippet into your forms :
<div class="highlight"><pre><span></span><code><span class="p">&lt;</span><span class="nt">input</span> <span class="na">type</span><span class="o">=</span><span class="s">&quot;hidden&quot;</span> <span class="na">name</span><span class="o">=</span><span class="s">&quot;csrf_token&quot;</span> <span class="na">value</span><span class="o">=</span><span class="s">&quot;{{ csrf_token() }}&quot;</span> <span class="p">/&gt;</span>
</code></pre></div></p>
</div>
<p>You can power-up your plugin page with additional scripting with the <strong>actions.py</strong> file when sending a <strong>POST /plugins/&lt;<em>plugin_id</em>&gt;</strong>.</p>
<p>You have two functions by default in <strong>actions.py</strong> :</p>
<p><strong>pre_render function</strong></p>
<p>This allows you to retrieve data when you <strong>GET</strong> the template, and to use the data with the pre_render variable available in Jinja to display content more dynamically.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">pre_render</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="n">pre_render_data</span><span class="o">&gt;</span>
</code></pre></div>
<p>BunkerWeb will send you this type of response :</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;status&quot;</span><span class="p">:</span> <span class="s2">&quot;ok|ko&quot;</span><span class="p">,</span> <span class="s2">&quot;code&quot;</span> <span class="p">:</span> <span class="n">XXX</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">pre_render_data</span><span class="o">&gt;</span><span class="p">}),</span> <span class="mi">200</span>
</code></pre></div>
<p><strong>&lt;<em>plugin_id</em>&gt; function</strong></p>
<p>This allows you to retrieve data when you make a <strong>POST</strong> from the template endpoint, which must be used in AJAX.</p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">myplugin</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
  <span class="k">return</span> <span class="o">&lt;</span><span class="n">plugin_id_data</span><span class="o">&gt;</span>
</code></pre></div>
<p>BunkerWeb will send you this type of response :</p>
<div class="highlight"><pre><span></span><code><span class="k">return</span> <span class="n">jsonify</span><span class="p">({</span><span class="s2">&quot;message&quot;</span><span class="p">:</span> <span class="s2">&quot;ok&quot;</span><span class="p">,</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="o">&lt;</span><span class="n">plugin_id_data</span><span class="o">&gt;</span><span class="p">}),</span> <span class="mi">200</span>
</code></pre></div>
<p><strong>What you can access from action.py</strong></p>
<p>Here are the arguments that are passed and access on action.py functions:</p>
<div class="highlight"><pre><span></span><code><span class="n">function</span><span class="p">(</span><span class="n">app</span><span class="o">=</span><span class="n">app</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">request</span><span class="o">.</span><span class="n">args</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span> <span class="ow">or</span> <span class="n">request</span><span class="o">.</span><span class="n">json</span> <span class="ow">or</span> <span class="kc">None</span><span class="p">)</span>
</code></pre></div>
<div class="admonition info">
<p class="admonition-title">Python libraries</p>
<p>In addition, you can use Python libraries that are already available like :
<code>Flask</code>, <code>Flask-Login</code>, <code>Flask-WTF</code>, <code>beautifulsoup4</code>, <code>docker</code>, <code>Jinja2</code>, <code>python-magic</code> and <code>requests</code>. To see the full list, you can have a look at the Web UI <a href="https://github.com/bunkerity/bunkerweb/blobsrc/ui/requirements.txt">requirements.txt</a>. If you need external libraries, you can install them inside the <strong>ui</strong> folder of your plugin and then use the classical <strong>import</strong> directive.</p>
</div>
<p><strong>Some examples</strong></p>
<ul>
<li>Retrieve form submitted data</li>
</ul>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span><span class="w"> </span><span class="nf">myplugin</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">my_form_value</span> <span class="o">=</span> <span class="n">request</span><span class="o">.</span><span class="n">form</span><span class="p">[</span><span class="s2">&quot;my_form_input&quot;</span><span class="p">]</span>
  <span class="k">return</span> <span class="n">my_form_value</span>
</code></pre></div>
<ul>
<li>Access app config</li>
</ul>
<p><strong>action.py</strong>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span><span class="w"> </span><span class="nf">pre_render</span><span class="p">(</span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="p">:</span>
    <span class="n">config</span> <span class="o">=</span> <span class="n">kwargs</span><span class="p">[</span><span class="s1">&#39;app&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s2">&quot;CONFIG&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">get_config</span><span class="p">(</span><span class="n">methods</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
  <span class="k">return</span> <span class="n">config</span>
</code></pre></div></p>
<p><strong>template</strong>
<div class="highlight"><pre><span></span><code><span class="cm">&lt;!-- metadata + config --&gt;</span>
<span class="p">&lt;</span><span class="nt">div</span><span class="p">&gt;</span>{{ pre_render }}<span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</code></pre></div></p>
<h3 id="plugins-hookspy">Hooks.py</h3>
<p>This documentation outlines the lifecycle hooks used for managing different stages of a request within the application. Each hook is associated with a specific phase.</p>
<div class="tabbed-set tabbed-alternate" data-tabs="2:4"><input checked="checked" id="plugins-__tabbed_2_1" name="plugins-__tabbed_2" type="radio" /><input id="plugins-__tabbed_2_2" name="plugins-__tabbed_2" type="radio" /><input id="plugins-__tabbed_2_3" name="plugins-__tabbed_2" type="radio" /><input id="plugins-__tabbed_2_4" name="plugins-__tabbed_2" type="radio" /><div class="tabbed-labels"><label for="plugins-__tabbed_2_1">before_request</label><label for="plugins-__tabbed_2_2">after_request</label><label for="plugins-__tabbed_2_3">teardown_request</label><label for="plugins-__tabbed_2_4">context_processor</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p>These hooks are executed <strong>before</strong> processing an incoming request. They are typically used for pre-processing tasks such as authentication, validation, or logging.</p>
<p>If the hook returns a response object, Flask will skip the request handling and return the response directly. This can be useful for short-circuiting the request processing pipeline.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span><span class="p">,</span> <span class="n">Response</span>

<span class="k">def</span><span class="w"> </span><span class="nf">before_request</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before-request: Validating request...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Perform authentication, validation, or logging here</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">is_valid_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span> <span class="c1"># We are in the app context</span>
        <span class="k">return</span> <span class="n">Response</span><span class="p">(</span><span class="s2">&quot;Invalid request!&quot;</span><span class="p">,</span> <span class="n">status</span><span class="o">=</span><span class="mi">400</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">is_valid_request</span><span class="p">(</span><span class="n">request</span><span class="p">):</span>
    <span class="c1"># Dummy validation logic</span>
    <span class="k">return</span> <span class="s2">&quot;user&quot;</span> <span class="ow">in</span> <span class="n">request</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>These hooks that run <strong>after</strong> the request has been processed. They are ideal for post-processing tasks such as cleanup, additional logging, or modifying the response before it is sent back.</p>
<p>They receive the response object as an argument and can modify it before returning it. The first after_request hook to return a response will be used as the final response.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">request</span>

<span class="k">def</span><span class="w"> </span><span class="nf">after_request</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After-request: Logging response...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Perform logging, cleanup, or response modifications here</span>
    <span class="n">log_response</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">response</span>

<span class="k">def</span><span class="w"> </span><span class="nf">log_response</span><span class="p">(</span><span class="n">response</span><span class="p">):</span>
    <span class="c1"># Dummy logging logic</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Response logged:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>These hooks are invoked when the request context is being torn down. These hooks are used for releasing resources or handling errors that occurred during the request lifecycle.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">teardown_request</span><span class="p">(</span><span class="n">error</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Teardown-request: Cleaning up resources...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Perform cleanup, release resources, or handle errors here</span>
    <span class="k">if</span> <span class="n">error</span><span class="p">:</span>
        <span class="n">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>
    <span class="n">cleanup_resources</span><span class="p">()</span>

<span class="k">def</span><span class="w"> </span><span class="nf">handle_error</span><span class="p">(</span><span class="n">error</span><span class="p">):</span>
    <span class="c1"># Dummy error handling logic</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error encountered:&quot;</span><span class="p">,</span> <span class="n">error</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="k">def</span><span class="w"> </span><span class="nf">cleanup_resources</span><span class="p">():</span>
    <span class="c1"># Dummy resource cleanup logic</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resources have been cleaned up.&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</code></pre></div>
</div>
<div class="tabbed-block">
<p>These hooks are used to inject additional context into templates or views. They enrich the runtime context by passing common data (like user information or configuration settings) to the templates.</p>
<p>If a context processor returns a dictionary, the keys and values will be added to the context for all templates. This allows you to share data across multiple views or templates.</p>
<p><strong>Example:</strong></p>
<div class="highlight"><pre><span></span><code><span class="k">def</span><span class="w"> </span><span class="nf">context_processor</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Context-processor: Injecting context data...&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># Return a dictionary containing context data for templates/views</span>
    <span class="k">return</span> <span class="p">{</span>
        <span class="s2">&quot;current_user&quot;</span><span class="p">:</span> <span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
        <span class="s2">&quot;app_version&quot;</span><span class="p">:</span> <span class="s2">&quot;1.0.0&quot;</span><span class="p">,</span>
        <span class="s2">&quot;feature_flags&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;new_ui&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">}</span>
    <span class="p">}</span>
</code></pre></div>
</div>
</div>
</div>
<p>This lifecycle hook design provides a modular and systematic approach to managing various aspects of a request's lifecycle:</p>
<ul>
<li><strong>Modularity:</strong> Each hook is responsible for a distinct phase, ensuring that concerns are separated.</li>
<li><strong>Maintainability:</strong> Developers can easily add, modify, or remove hook implementations without impacting other parts of the request lifecycle.</li>
<li><strong>Extensibility:</strong> The framework is flexible, allowing for additional hooks or enhancements as application requirements evolve.</li>
</ul>
<p>By clearly defining the responsibilities of each hook and their associated logging prefixes, the system ensures that each stage of request processing is transparent and manageable.</p>
<h3 id="plugins-blueprints">Blueprints</h3>
<p>In Flask, <strong>blueprints</strong> serve as a modular way to organize related components—such as views, templates, and static files—within your application. They allow you to group functionality logically and can be used to create new sections of your app or override existing ones.</p>
<h4 id="plugins-creating-a-blueprint">Creating a Blueprint</h4>
<p>To define a blueprint, you create an instance of the <code>Blueprint</code> class, specifying its name and import path. You then define routes and views associated with this blueprint.</p>
<p><strong>Example: Defining a New Blueprint</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">dirname</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Blueprint</span><span class="p">,</span> <span class="n">render_template</span>

<span class="c1"># Define the blueprint</span>
<span class="n">my_blueprint</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">&#39;my_blueprint&#39;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">,</span> <span class="n">template_folder</span><span class="o">=</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/templates&#39;</span><span class="p">)</span> <span class="c1"># The template_folder is set to avoid conflicts with the original blueprint</span>

<span class="c1"># Define a route within the blueprint</span>
<span class="nd">@my_blueprint</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/my_blueprint&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">my_blueprint_page</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">render_template</span><span class="p">(</span><span class="s1">&#39;my_blueprint.html&#39;</span><span class="p">)</span>
</code></pre></div>
<p>In this example, a blueprint named <code>my_blueprint</code> is created, and a route <code>/my_blueprint</code> is defined within it.</p>
<h4 id="plugins-overriding-an-existing-blueprint">Overriding an Existing Blueprint</h4>
<p>Blueprints can also override existing ones to modify or extend functionality. To do this, ensure that the new blueprint has the same name as the one you're overriding and register it after the original.</p>
<p><strong>Example: Overriding an Existing Blueprint</strong></p>
<div class="highlight"><pre><span></span><code><span class="kn">from</span><span class="w"> </span><span class="nn">os.path</span><span class="w"> </span><span class="kn">import</span> <span class="n">dirname</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">flask</span><span class="w"> </span><span class="kn">import</span> <span class="n">Flask</span><span class="p">,</span> <span class="n">Blueprint</span>

<span class="c1"># Original blueprint</span>
<span class="n">instances</span> <span class="o">=</span> <span class="n">Blueprint</span><span class="p">(</span><span class="s1">&#39;instances&#39;</span><span class="p">,</span> <span class="vm">__name__</span><span class="p">,</span> <span class="n">template_folder</span><span class="o">=</span><span class="n">dirname</span><span class="p">(</span><span class="vm">__file__</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;/templates&#39;</span><span class="p">)</span> <span class="c1"># The template_folder is set to avoid conflicts with the original blueprint</span>

<span class="nd">@instances</span><span class="o">.</span><span class="n">route</span><span class="p">(</span><span class="s1">&#39;/instances&#39;</span><span class="p">)</span>
<span class="k">def</span><span class="w"> </span><span class="nf">override_instances</span><span class="p">():</span>
    <span class="k">return</span> <span class="s2">&quot;My new instances page&quot;</span>
</code></pre></div>
<p>In this scenario, accessing the URL <code>/instances</code> will display "My new instances page" because the <code>instances</code> blueprint, registered last, overrides the original <code>instances</code> blueprint.</p>
<div class="admonition warning">
<p class="admonition-title">About overriding</p>
<p>Be cautious when overriding existing blueprints, as it can impact the behavior of the application. Ensure that the changes align with the application's requirements and do not introduce unexpected side effects.</p>
<p>All existing routes will be removed from he original blueprint, so you will need to re-implement them if needed.</p>
</div>
<h4 id="plugins-naming-conventions">Naming Conventions</h4>
<div class="admonition danger">
<p class="admonition-title">Important</p>
<p>Ensure the blueprint’s name matches the blueprint variable name, else it will not be considered as a valid blueprint and will not be registered.</p>
</div>
<p>For consistency and clarity, it's advisable to follow these naming conventions:</p>
<ul>
<li>
<p><strong>Blueprint Names</strong>: Use short, all-lowercase names. Underscores can be used for readability, e.g., <code>user_auth</code>.</p>
</li>
<li>
<p><strong>File Names</strong>: Match the filename to the blueprint name, ensuring it's all lowercase with underscores as needed, e.g., <code>user_auth.py</code>.</p>
</li>
</ul>
<p>This practice aligns with Python's module naming conventions and helps maintain a clear project structure.</p>
<p><strong>Example: Blueprint and File Naming</strong></p>
<div class="highlight"><pre><span></span><code>plugin /
    ui / blueprints / user_auth.py
                      templates / user_auth.html
</code></pre></div>
<p>In this structure, <code>user_auth.py</code> contains the <code>user_auth</code> blueprint, and <code>user_auth.html</code> is the associated template, adhering to the recommended naming conventions.</p></section><section class="print-page" id="professional-services" heading-number="11"><h1 id="professional-services-professional-services">Professional services</h1>
<h2 id="professional-services-why-should-i-get-professional-services">Why should I get professional services?</h2>
<p>Since BunkerWeb is a free (as in freedom) software, you have the right to use it freely as long as you respect the <a href="https://www.gnu.org/licenses/agpl-3.0.en.html">AGPLv3 license</a>.</p>
<p>You can also upgrade BunkerWeb to the PRO version at any time. By doing so, you will get an enhanced experience to assist you in the security of your web services. Our goal is to help you focus on your business needs. The PRO version is updated regularly and we try our best to gather feedback from enterprises to include the needed features.</p>
<p>But dedicating time to a specific technology may not be easy depending on your business priorities. Not to mention that cybersecurity is a complex domain where being both judge and jury is not recommended.</p>
<p>Getting professional services in addition to the open-source or PRO version is the ideal solution to cover your business needs. You can focus on your top priorities and rely on a trusted partner when it comes to web security.</p>
<p>Please note that professional services are directly offered by <a href="https://www.bunkerity.com/?utm_campaign=self&amp;utm_source=doc">Bunkerity</a>, the company maintaining the BunkerWeb project, through our <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">BunkerWeb Panel</a> online platform.</p>
<h2 id="professional-services-which-professional-services-do-you-offer">Which professional services do you offer?</h2>
<p>We offer technical support and consulting around the BunkerWeb solution. By using this service, we will assist you on the technical issues (installation, configuration, false positive, ...). We can also offer custom SLA depending on your needs.</p>
<p>According to your needs you have the choice between "one time" and subscription offers.</p>
<h2 id="professional-services-how-can-i-get-more-information">How can I get more information?</h2>
<p>You will find more information by visiting the <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">BunkerWeb Panel</a>, our dedicated platform for professional services.</p>
<p>Don't hesitate to <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contact us</a> if you have any questions, we will be more than happy to respond to your needs.</p></section><section class="print-page" id="about" heading-number="12"><h1 id="about-about">About</h1>
<h2 id="about-who-maintains-bunkerweb">Who maintains BunkerWeb?</h2>
<p>BunkerWeb is maintained by <a href="https://www.bunkerity.com/?utm_campaign=self&amp;utm_source=doc">Bunkerity</a>, a French 🇫🇷 company specialized in Cybersecurity 🛡️.</p>
<h2 id="about-do-you-have-a-professional-version">Do you have a professional version?</h2>
<div class="admonition tip">
<p class="admonition-title">BunkerWeb PRO free trial</p>
<p>Want to quickly test BunkerWeb PRO for one month? Use the code <code>freetrial</code> when placing your order on the <a href="https://panel.bunkerweb.io/store/bunkerweb-pro?utm_campaign=self&amp;utm_source=doc">BunkerWeb panel</a> or by clicking <a href="https://panel.bunkerweb.io/cart.php?a=add&amp;pid=19&amp;promocode=freetrial&amp;utm_campaign=self&amp;utm_source=doc">here</a> to directly to apply the promo code (will be effective at checkout).</p>
</div>
<p>Yes, we do offer a professional version of BunkerWeb called "BunkerWeb PRO" with additional features and (optional) technical support.</p>
<p>Don't hesitate to <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contact us</a> if you have any questions, we will be more than happy to respond to your needs.</p>
<h2 id="about-do-you-offer-professional-services">Do you offer professional services?</h2>
<p>Yes, we offer professional services related to BunkerWeb.</p>
<p>You can get in touch with us about any of the following:</p>
<ul>
<li>Consulting</li>
<li>Support</li>
<li>Custom development</li>
<li>Partnerships</li>
</ul>
<p>We have a <a href="https://panel.bunkerweb.io/?utm_campaign=self&amp;utm_source=doc">dedicated panel</a> to centralize all professional requests.</p>
<p>You can also <a href="https://panel.bunkerweb.io/contact.php?utm_campaign=self&amp;utm_source=doc">contact us</a> if you are interested.</p>
<h2 id="about-where-to-get-community-support">Where to get community support?</h2>
<p>To get free community support, you can use the following media:</p>
<ul>
<li>The #help channel of BunkerWeb in the <a href="https://discord.com/invite/fTf46FmtyD">Discord server</a></li>
<li>The help category of <a href="https://github.com/bunkerity/bunkerweb/discussions">GitHub discussions</a></li>
<li>The <a href="https://www.reddit.com/r/BunkerWeb">/r/BunkerWeb</a> subreddit</li>
<li>The <a href="https://serverfault.com/">Server Fault</a> and <a href="https://superuser.com/">Super User</a> forums</li>
</ul>
<p>Please don't use <a href="https://github.com/bunkerity/bunkerweb/issues">GitHub issues</a> to ask for help, use it only for bug reports and feature requests.</p>
<h2 id="about-how-can-i-contribute">How can I contribute?</h2>
<p>Here is a non-exhaustive list of what you can do:</p>
<ul>
<li>Join the <a href="https://discord.com/invite/fTf46FmtyD">Discord server</a>, <a href="https://www.reddit.com/r/BunkerWeb">/r/BunkerWeb</a> subreddit and <a href="https://github.com/bunkerity/bunkerweb/discussions">GitHub discussions</a> to talk about the project and help others</li>
<li>Follow us on <a href="https://www.linkedin.com/company/bunkerity/">LinkedIn</a>, <a href="https://twitter.com/bunkerity">Twitter</a> and <a href="https://github.com/bunkerity">GitHub</a></li>
<li>Report bugs and propose new features using <a href="https://github.com/bunkerity/bunkerweb/issues">issues</a></li>
<li>Contribute to the code using <a href="https://github.com/bunkerity/bunkerweb/pulls">pull requests</a></li>
<li>Write an awesome <a href="#plugins">plugin</a></li>
<li>Talk about BunkerWeb to your friends/colleagues, on social media, on your blog, ...</li>
</ul>
<h2 id="about-how-to-report-security-issues">How to report security issues?</h2>
<p>Please contact us at <a href="mailto:security@bunkerity.com">security@bunkerity.com</a>.</p></section></div><style>.print-site-enumerate-headings #index > h1:before { content: '1 ' }

                .print-site-enumerate-headings #index h2:before { content: '1.' counter(counter-index-2) ' ' }
                .print-site-enumerate-headings #index h2 {  counter-reset: counter-index-3 ;  counter-increment: counter-index-2 }
            
                .print-site-enumerate-headings #index h3:before { content: '1.' counter(counter-index-2) '.' counter(counter-index-3) ' ' }
                .print-site-enumerate-headings #index h3 {  counter-increment: counter-index-3 }
            
.print-site-enumerate-headings #concepts > h1:before { content: '2 ' }

                .print-site-enumerate-headings #concepts h2:before { content: '2.' counter(counter-concepts-2) ' ' }
                .print-site-enumerate-headings #concepts h2 {  counter-reset: counter-concepts-3 ;  counter-increment: counter-concepts-2 }
            
                .print-site-enumerate-headings #concepts h3:before { content: '2.' counter(counter-concepts-2) '.' counter(counter-concepts-3) ' ' }
                .print-site-enumerate-headings #concepts h3 {  counter-increment: counter-concepts-3 }
            
.print-site-enumerate-headings #integrations > h1:before { content: '3 ' }

                .print-site-enumerate-headings #integrations h2:before { content: '3.' counter(counter-integrations-2) ' ' }
                .print-site-enumerate-headings #integrations h2 {  counter-reset: counter-integrations-3 ;  counter-increment: counter-integrations-2 }
            
                .print-site-enumerate-headings #integrations h3:before { content: '3.' counter(counter-integrations-2) '.' counter(counter-integrations-3) ' ' }
                .print-site-enumerate-headings #integrations h3 {  counter-increment: counter-integrations-3 }
            
.print-site-enumerate-headings #quickstart-guide > h1:before { content: '4 ' }

                .print-site-enumerate-headings #quickstart-guide h2:before { content: '4.' counter(counter-quickstart-guide-2) ' ' }
                .print-site-enumerate-headings #quickstart-guide h2 {  counter-reset: counter-quickstart-guide-3 ;  counter-increment: counter-quickstart-guide-2 }
            
                .print-site-enumerate-headings #quickstart-guide h3:before { content: '4.' counter(counter-quickstart-guide-2) '.' counter(counter-quickstart-guide-3) ' ' }
                .print-site-enumerate-headings #quickstart-guide h3 {  counter-increment: counter-quickstart-guide-3 }
            
.print-site-enumerate-headings #features > h1:before { content: '5 ' }

                .print-site-enumerate-headings #features h2:before { content: '5.' counter(counter-features-2) ' ' }
                .print-site-enumerate-headings #features h2 {  counter-reset: counter-features-3 ;  counter-increment: counter-features-2 }
            
                .print-site-enumerate-headings #features h3:before { content: '5.' counter(counter-features-2) '.' counter(counter-features-3) ' ' }
                .print-site-enumerate-headings #features h3 {  counter-increment: counter-features-3 }
            
.print-site-enumerate-headings #advanced > h1:before { content: '6 ' }

                .print-site-enumerate-headings #advanced h2:before { content: '6.' counter(counter-advanced-2) ' ' }
                .print-site-enumerate-headings #advanced h2 {  counter-reset: counter-advanced-3 ;  counter-increment: counter-advanced-2 }
            
                .print-site-enumerate-headings #advanced h3:before { content: '6.' counter(counter-advanced-2) '.' counter(counter-advanced-3) ' ' }
                .print-site-enumerate-headings #advanced h3 {  counter-increment: counter-advanced-3 }
            
.print-site-enumerate-headings #web-ui > h1:before { content: '7 ' }

                .print-site-enumerate-headings #web-ui h2:before { content: '7.' counter(counter-web-ui-2) ' ' }
                .print-site-enumerate-headings #web-ui h2 {  counter-reset: counter-web-ui-3 ;  counter-increment: counter-web-ui-2 }
            
                .print-site-enumerate-headings #web-ui h3:before { content: '7.' counter(counter-web-ui-2) '.' counter(counter-web-ui-3) ' ' }
                .print-site-enumerate-headings #web-ui h3 {  counter-increment: counter-web-ui-3 }
            
.print-site-enumerate-headings #upgrading > h1:before { content: '8 ' }

                .print-site-enumerate-headings #upgrading h2:before { content: '8.' counter(counter-upgrading-2) ' ' }
                .print-site-enumerate-headings #upgrading h2 {  counter-reset: counter-upgrading-3 ;  counter-increment: counter-upgrading-2 }
            
                .print-site-enumerate-headings #upgrading h3:before { content: '8.' counter(counter-upgrading-2) '.' counter(counter-upgrading-3) ' ' }
                .print-site-enumerate-headings #upgrading h3 {  counter-increment: counter-upgrading-3 }
            
.print-site-enumerate-headings #troubleshooting > h1:before { content: '9 ' }

                .print-site-enumerate-headings #troubleshooting h2:before { content: '9.' counter(counter-troubleshooting-2) ' ' }
                .print-site-enumerate-headings #troubleshooting h2 {  counter-reset: counter-troubleshooting-3 ;  counter-increment: counter-troubleshooting-2 }
            
                .print-site-enumerate-headings #troubleshooting h3:before { content: '9.' counter(counter-troubleshooting-2) '.' counter(counter-troubleshooting-3) ' ' }
                .print-site-enumerate-headings #troubleshooting h3 {  counter-increment: counter-troubleshooting-3 }
            
.print-site-enumerate-headings #plugins > h1:before { content: '10 ' }

                .print-site-enumerate-headings #plugins h2:before { content: '10.' counter(counter-plugins-2) ' ' }
                .print-site-enumerate-headings #plugins h2 {  counter-reset: counter-plugins-3 ;  counter-increment: counter-plugins-2 }
            
                .print-site-enumerate-headings #plugins h3:before { content: '10.' counter(counter-plugins-2) '.' counter(counter-plugins-3) ' ' }
                .print-site-enumerate-headings #plugins h3 {  counter-increment: counter-plugins-3 }
            
.print-site-enumerate-headings #professional-services > h1:before { content: '11 ' }

                .print-site-enumerate-headings #professional-services h2:before { content: '11.' counter(counter-professional-services-2) ' ' }
                .print-site-enumerate-headings #professional-services h2 {  counter-reset: counter-professional-services-3 ;  counter-increment: counter-professional-services-2 }
            
                .print-site-enumerate-headings #professional-services h3:before { content: '11.' counter(counter-professional-services-2) '.' counter(counter-professional-services-3) ' ' }
                .print-site-enumerate-headings #professional-services h3 {  counter-increment: counter-professional-services-3 }
            
.print-site-enumerate-headings #about > h1:before { content: '12 ' }

                .print-site-enumerate-headings #about h2:before { content: '12.' counter(counter-about-2) ' ' }
                .print-site-enumerate-headings #about h2 {  counter-reset: counter-about-3 ;  counter-increment: counter-about-2 }
            
                .print-site-enumerate-headings #about h3:before { content: '12.' counter(counter-about-2) '.' counter(counter-about-3) ' ' }
                .print-site-enumerate-headings #about h3 {  counter-increment: counter-about-3 }
            </style>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; <script>document.write(new Date().getFullYear())</script> Bunkerity
    </div>
  
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://discord.com/invite/fTf46FmtyD" target="_blank" rel="noopener" title="discord.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 640 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M524.531 69.836a1.5 1.5 0 0 0-.764-.7A485 485 0 0 0 404.081 32.03a1.82 1.82 0 0 0-1.923.91 338 338 0 0 0-14.9 30.6 447.9 447.9 0 0 0-134.426 0 310 310 0 0 0-15.135-30.6 1.89 1.89 0 0 0-1.924-.91 483.7 483.7 0 0 0-119.688 37.107 1.7 1.7 0 0 0-.788.676C39.068 183.651 18.186 294.69 28.43 404.354a2.02 2.02 0 0 0 .765 1.375 487.7 487.7 0 0 0 146.825 74.189 1.9 1.9 0 0 0 2.063-.676A348 348 0 0 0 208.12 430.4a1.86 1.86 0 0 0-1.019-2.588 321 321 0 0 1-45.868-21.853 1.885 1.885 0 0 1-.185-3.126 251 251 0 0 0 9.109-7.137 1.82 1.82 0 0 1 1.9-.256c96.229 43.917 200.41 43.917 295.5 0a1.81 1.81 0 0 1 1.924.233 235 235 0 0 0 9.132 7.16 1.884 1.884 0 0 1-.162 3.126 301.4 301.4 0 0 1-45.89 21.83 1.875 1.875 0 0 0-1 2.611 391 391 0 0 0 30.014 48.815 1.86 1.86 0 0 0 2.063.7A486 486 0 0 0 610.7 405.729a1.88 1.88 0 0 0 .765-1.352c12.264-126.783-20.532-236.912-86.934-334.541M222.491 337.58c-28.972 0-52.844-26.587-52.844-59.239s23.409-59.241 52.844-59.241c29.665 0 53.306 26.82 52.843 59.239 0 32.654-23.41 59.241-52.843 59.241m195.38 0c-28.971 0-52.843-26.587-52.843-59.239s23.409-59.241 52.843-59.241c29.667 0 53.307 26.82 52.844 59.239 0 32.654-23.177 59.241-52.844 59.241"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://github.com/bunkerity" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.linkedin.com/company/bunkerity/" target="_blank" rel="noopener" title="www.linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M416 32H31.9C14.3 32 0 46.5 0 64.3v383.4C0 465.5 14.3 480 31.9 480H416c17.6 0 32-14.5 32-32.3V64.3c0-17.8-14.4-32.3-32-32.3M135.4 416H69V202.2h66.5V416zm-33.2-243c-21.3 0-38.5-17.3-38.5-38.5S80.9 96 102.2 96c21.2 0 38.5 17.3 38.5 38.5 0 21.3-17.2 38.5-38.5 38.5m282.1 243h-66.4V312c0-24.8-.5-56.7-34.5-56.7-34.6 0-39.9 27-39.9 54.9V416h-66.4V202.2h63.7v29.2h.9c8.9-16.8 30.6-34.5 62.9-34.5 67.2 0 79.7 44.3 79.7 101.9z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://twitter.com/bunkerity" target="_blank" rel="noopener" title="twitter.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512"><!--! Font Awesome Free 6.7.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M459.37 151.716c.325 4.548.325 9.097.325 13.645 0 138.72-105.583 298.558-298.558 298.558-59.452 0-114.68-17.219-161.137-47.106 8.447.974 16.568 1.299 25.34 1.299 49.055 0 94.213-16.568 130.274-44.832-46.132-.975-84.792-31.188-98.112-72.772 6.498.974 12.995 1.624 19.818 1.624 9.421 0 18.843-1.3 27.614-3.573-48.081-9.747-84.143-51.98-84.143-102.985v-1.299c13.969 7.797 30.214 12.67 47.431 13.319-28.264-18.843-46.781-51.005-46.781-87.391 0-19.492 5.197-37.36 14.294-52.954 51.655 63.675 129.3 105.258 216.365 109.807-1.624-7.797-2.599-15.918-2.599-24.04 0-57.828 46.782-104.934 104.934-104.934 30.213 0 57.502 12.67 76.67 33.137 23.715-4.548 46.456-13.32 66.599-25.34-7.798 24.366-24.366 44.833-46.132 57.827 21.117-2.273 41.584-8.122 60.426-16.243-14.292 20.791-32.161 39.308-52.628 54.253"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      <script id="__config" type="application/json">{"base": "/latest", "features": ["navigation.tracking", "navigation.tabs", "navigation.tabs.sticky", "toc.integrate", "content.code.copy"], "search": "../assets/javascripts/workers/search.d50fe291.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike", "version": "latest"}}</script>
    
    
      <script src="../assets/javascripts/bundle.56ea9cef.min.js"></script>
      
        <script src="../js/print-site.js"></script>
      
        <script src="../assets/extra.js"></script>
      
    
  </body>
</html>